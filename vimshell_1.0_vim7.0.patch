Index: runtime/doc/vimshell.txt
===================================================================
--- runtime/doc/vimshell.txt	(.../branches/V7_0)	(revision 0)
+++ runtime/doc/vimshell.txt	(.../trunk)	(revision 120)
@@ -0,0 +1,93 @@
+*vimshell.txt*   For Vim version 7.0.  Last change: 2006 Sep 2
+
+
+		  VIM REFERENCE MANUAL    by Bram Moolenaar
+
+
+The VIM-Shell                                            *vimshell*
+
+1. What is VIM-Shell?
+
+The VIM-shell is a extension for VIM, a very popular programmer's editor for
+many platforms, written by Bram Moolenaar et al. VIM features split windows,
+and this patch makes it possible to start shells in those windows. It is only
+available for POSIX systems like Linux, FreeBSD, OpenBSD, NetBSD and MacOS X.
+I don't think the Windows-VIM needs such a patch, because I think the command
+line there isn't really popular.
+
+==============================================================================
+2. How to use the VIM-Shell
+
+2.1 General concept: ":vimshell"
+
+The whole VIM-Shell functionality is hidden behind one single command:
+:vimshell.
+
+:vimshell[!] [params] tries to close your active buffer and creates a new one.
+This behaves exactly the same as the :enew command (see :help enew im VIM for
+details). If you have local modifications to your buffer, the command will be
+aborted (but you can override this by adding a ! at the end, in this case the
+active buffer will be dismissed in any case). The window containing this empty
+buffer is then converted to a VIM-Shell.
+
+:vimshell
+
+starts a VIM-Shell in your current window. I strongly suggest you open a new
+window before doing that. By default, without any parameters, /bin/sh will be
+spawned.
+
+:vimshell bash
+
+When called with parameters, VIM-Shell passes these parameters verbatim to
+execvp when starting a shell. Your current $PATH will be searched for the
+command.
+
+:vimshell irssi -n anonymous -c vienna.irc.at
+
+starts the textmode IRC client "irssi" with the abovementioned parameters.
+
+:vimshell mutt
+
+Never lose track of your e-mails while working in VIM!
+
+When you exit such a shell, or the program running in it terminates, the
+buffer will be converted back to a normal, empty VIM-buffer. The window will
+not be closed.
+
+2.2 Navigation
+
+When the currently active window is a VIM-Shell, every character entered gets
+routed to the shell, and no mapping expansion takes place. VIM doesn't get any
+notice of the characters that you type in a VIM-Shell.
+
+The big exception is Ctrl_W, which is passed through to VIM, so you can close
+the VIM-shell (Ctrl_W + c), change to another window, resize the window, etc.
+Key mappings
+
+Because I feel that opening up a window and then typing :vimshell is a bit
+cumbersome, I suggest you use the following key mappings in your .vimrc:
+
+	" VIM-Shell
+	" Ctrl_W e opens up a vimshell in a horizontally split window
+	" Ctrl_W E opens up a vimshell in a vertically split window
+	" The shell window will be auto closed after termination
+	nmap <C-W>e :new \| vimshell bash<CR>
+	nmap <C-W>E :vnew \| vimshell bash<CR>
+
+Just hitting Ctrl_W and e to drop a shell window in your VIM session is
+really, really comfortable :-) 
+
+This is a small introduction on how to use the new features in your
+VIM-Shell-enabled VIM.
+
+==============================================================================
+3. Authorship
+
+The VIM-Shell was written in 2004, 2005, 2006 by Thomas Wana <thomas@wana.at>.
+Homepage: http://www.wana.at/vimshell/
+
+The VIM-Shell is published under the GNU GPL license (which is compatible with
+the VIM license). The copyright remains by the author.
+
+==============================================================================
+ vim:tw=78:ts=8:ft=help:norl:
Index: src/ex_docmd.c
===================================================================
--- src/ex_docmd.c	(.../branches/V7_0)	(revision 120)
+++ src/ex_docmd.c	(.../trunk)	(revision 120)
@@ -146,6 +146,7 @@
 static void	ex_quit __ARGS((exarg_T *eap));
 static void	ex_cquit __ARGS((exarg_T *eap));
 static void	ex_quit_all __ARGS((exarg_T *eap));
+static void	ex_vimshell __ARGS((exarg_T *eap));
 #ifdef FEAT_WINDOWS
 static void	ex_close __ARGS((exarg_T *eap));
 static void	ex_win_close __ARGS((int forceit, win_T *win, tabpage_T *tp));
@@ -10861,3 +10862,115 @@
     ml_clearmarked();	   /* clear rest of the marks */
 }
 #endif
+
+#ifdef FEAT_VIMSHELL
+/*
+ * ":vimshell": creates an empty buffer in the current window and starts a 
+ * VIM-Shell inside.
+ * ":vimshellac": same as "vimshell" but closes the window after the shell
+ * terminated (ac = "auto-close"). This is useful for redefinitions of 'Man'
+ * etc.
+ */
+    static void
+ex_vimshell(eap)
+    exarg_T	*eap;
+{
+    unsigned char *argv[50], argidx, *p;
+    unsigned char cmdline[500];
+    char cmdbuf[50];
+
+    if(curbuf->is_shell!=0)
+    {
+	emsg("VIMSHELL: current buffer is already a shell!");
+	return;
+    }
+
+    snprintf(cmdbuf, sizeof(cmdbuf), ":enew%s", eap->forceit==TRUE ? "!" : "");
+
+    /*
+     * Do a ":enew" command to get a new buffer in the current window. 
+     * Also assures that we don't throw away any unsaved changes the user
+     * made to the previous buffer.
+     */
+    did_emsg=FALSE;
+    if(do_cmdline_cmd(cmdbuf)==FAIL || did_emsg==TRUE)
+    {
+	return;
+    }
+
+    /*
+     * Set buffer read only (the user can't write into it anyway, but just
+     * to make sure. We want to be able to close the buffer without any
+     * problems any time).
+     */
+    curbuf->b_p_ro=TRUE;
+
+    /*
+     * Parse command line arguments. If none given, default to '/bin/sh'
+     */
+    snprintf(cmdline, sizeof(cmdline), "%s", eap->arg);
+    p=cmdline;
+    argidx=0;
+    if(!strcmp(p, ""))
+    {
+	argv[0]="/bin/sh";
+    }
+    else
+    {
+	argv[argidx]=p;
+	do
+	{
+	    if(*p==' ')
+	    {
+		argidx++;
+		if(argidx+1 >= sizeof(argv)/sizeof(argv[0]))
+		{
+		    /*
+		     * Too many command line arguments, drop out
+		     */
+		    emsg("VIMSHELL: too many command line arguments");
+		    return;
+		}
+
+		/*
+		 * Convert all ' ' to \0
+		 */
+		for(;*p==' ';p++)
+		    *p=0;
+		if(*p!=0)
+		{
+		    argv[argidx]=p;
+		}
+	    }
+	} while(*p++);
+    }
+    argv[++argidx]=NULL;
+
+    /*
+     * Convert the current buffer into a shell window.
+     */
+    curbuf->shell=(struct vim_shell_window *)vim_shell_new(W_WIDTH(curwin), curwin->w_height);
+    if(curbuf->shell==NULL)
+    {
+	EMSG2("VIMSHELL: error creating a new shell: %s", vim_shell_strerror());
+	return;
+    }
+    curbuf->is_shell=1;
+    curbuf->gtk_input_id=0;
+
+    /*
+     * start the shell
+     */
+    if(vim_shell_start(curbuf->shell, (char **)argv)<0)
+    {
+	EMSG2("VIMSHELL: error starting the shell: %s", vim_shell_strerror());
+
+	vim_shell_delete(curbuf);
+	return;
+    }
+
+    /*
+     * we're up and running.
+     */
+}
+#endif
Index: src/vim_shell.c
===================================================================
--- src/vim_shell.c	(.../branches/V7_0)	(revision 0)
+++ src/vim_shell.c	(.../trunk)	(revision 120)
@@ -0,0 +1,910 @@
+/*
+ * vim_shell.c
+ *
+ * This is the interface layer of the VIM-Shell. VIM only calls functions from this module,
+ * e.g. create a new VIM-Shell, read characters from the shell or write characters to the
+ * shell. The respective functions pass these things down to the terminal layer, implemented
+ * in terminal.c.
+ *
+ * This file is part of the VIM-Shell project. http://vimshell.wana.at
+ *
+ * Author: Thomas Wana <thomas@wana.at>
+ *
+ */
+
+static char *RCSID="$Id$";
+
+#include "vim.h"
+
+#include <errno.h>
+#include <stdlib.h>
+#include <string.h>
+#include <unistd.h>
+#include <ctype.h>
+#include <sys/types.h>
+#include <sys/wait.h>
+#include <signal.h>
+#ifdef HAVE_PTY_H
+#include <pty.h>
+#endif
+#ifdef HAVE_TERMIOS_H
+#include <termios.h>
+#endif
+#ifdef HAVE_LIBUTIL_H
+#include <libutil.h>
+#endif
+#include <fcntl.h>
+
+#if !defined(TIOCSWINSZ)
+#  error "VIMSHELL: needs TIOCSWINSZ at the moment, not available on your system, sorry."
+#endif
+
+#ifdef VIMSHELL_DEBUG
+#  define CHILDDEBUG
+#  define SIGDEBUG
+#endif
+
+#ifdef CHILDDEBUG
+#  define CHILDDEBUGPRINTF(a...) if(vimshell_debug_fp) fprintf(vimshell_debug_fp, a)
+#else
+#  define CHILDDEBUGPRINTF(a...)
+#endif
+
+#ifdef SIGDEBUG
+#  define SIGDEBUGPRINTF(a...) if(vimshell_debug_fp) fprintf(vimshell_debug_fp, a)
+#else
+#  define SIGDEBUGPRINTF(a...)
+#endif
+
+
+int vimshell_errno;
+
+FILE *vimshell_debug_fp=NULL;
+
+/*
+ * Main initialization function. Sets up global things always needed for the VIM shell.
+ */
+int vim_shell_init()
+{
+#ifdef VIMSHELL_DEBUG
+	vimshell_debug_fp=fopen("vimshell.debug", "w");
+#endif
+
+	/*
+	 * Everything went OK
+	 */
+	return 0;
+}
+
+/*
+ * A routine that prints a buffer in 'hexdump -C'-style via printf
+ */
+static void hexdump(FILE *fp, unsigned char *buffer, long len)
+{
+	unsigned long pos=0;
+
+	while(len>0)
+	{
+		int i;
+		fprintf(fp,"%08x  ",(unsigned int)pos);
+		for(i=0;i<16 && i<len;i++)
+		{
+			fprintf(fp,"%02x ",buffer[pos+i]);
+			if(i==7 || i==15)
+				fprintf(fp," ");
+		}
+		fprintf(fp,"|");
+		for(i=0;i<16 && i<len;i++)
+		{
+			unsigned char c=buffer[pos+i];
+			if(isprint(c))
+			{
+				fprintf(fp,"%c",c);
+			}
+			else
+			{
+				fprintf(fp,".");
+			}
+		}
+		fprintf(fp,"|\n");
+		len-=16;
+		pos+=16;
+	}
+}
+
+/*
+ * Create a new window.
+ * @return: pointer to a new struct vim_shell_window on success
+ *          NULL on failure
+ */
+struct vim_shell_window *vim_shell_new(uint16_t width, uint16_t height)
+{
+	struct vim_shell_window *rval;
+	int i;
+
+	rval=(struct vim_shell_window *)vim_shell_malloc(sizeof(struct vim_shell_window));
+	if(rval==NULL)
+	{
+		vimshell_errno=VIMSHELL_OUT_OF_MEMORY;
+		return NULL;
+	}
+
+	memset(rval, 0, sizeof(struct vim_shell_window));
+
+	rval->size_x=width;
+	rval->size_y=height;
+
+	rval->fgcolor=VIMSHELL_COLOR_DEFAULT;
+	rval->bgcolor=VIMSHELL_COLOR_DEFAULT;
+
+	rval->G0_charset='B';  // United States (USASCII)
+	rval->G1_charset='0';  // Special graphics characters and line drawing set
+	rval->active_charset=0;
+
+	rval->winbuf=(uint8_t *)vim_shell_malloc(width*height);
+	rval->fgbuf=(uint8_t *)vim_shell_malloc(width*height);
+	rval->bgbuf=(uint8_t *)vim_shell_malloc(width*height);
+	rval->rendbuf=(uint8_t *)vim_shell_malloc(width*height);
+	rval->charset=(uint8_t *)vim_shell_malloc(width*height);
+	rval->tabline=(uint8_t *)vim_shell_malloc(width);
+	//rval->phys_screen=(uint32_t *)vim_shell_malloc(width*height*4);
+	if(rval->winbuf==NULL || rval->fgbuf==NULL || rval->bgbuf==NULL || rval->rendbuf==NULL || rval->charset==NULL ||
+			rval->tabline==NULL /* || rval->phys_screen==NULL */)
+	{
+		vimshell_errno=VIMSHELL_OUT_OF_MEMORY;
+		// VIMSHELL TODO: cleanup, free the buffers that were successfully allocated
+		vim_shell_free(rval);
+		return NULL;
+	}
+	memset(rval->winbuf, ' ', width*height);
+	memset(rval->fgbuf, rval->fgcolor, width*height);
+	memset(rval->bgbuf, rval->bgcolor, width*height);
+	memset(rval->rendbuf, 0, width*height);
+	memset(rval->charset, 0, width*height);
+	memset(rval->tabline, 0, width);
+
+#if 0
+	for(i=0;i<width*height;i++)
+	{
+		/*
+		 * This is: default foreground, default background, no rendering attributes, ' ' as character
+		 */
+		rval->phys_screen[i]=0x09090020;
+	}
+#endif
+
+	/*
+	 * Set a tab every 8 columns (default)
+	 */
+	for(i=1;i<width;i++)
+	{
+		if((i+1)%8==0 && i+1<width)
+			rval->tabline[i]=1;
+	}
+
+	rval->wraparound=1;
+
+	rval->cursor_x=0;
+	rval->cursor_y=0;
+	rval->cursor_visible=1;
+
+	rval->scroll_top_margin=0;
+	rval->scroll_bottom_margin=height-1;
+
+	CHILDDEBUGPRINTF("%s: vimshell created, width = %d, height = %d\n",
+			__FUNCTION__, width, height);
+
+	vimshell_errno=VIMSHELL_SUCCESS;
+	return rval;
+}
+
+/*
+ * start the program in argv in the shell window.
+ */
+int vim_shell_start(struct vim_shell_window *shell, char *argv[])
+{
+	struct winsize winsize;
+	struct termios termios;
+
+	memset(&termios, 0, sizeof(struct termios));
+
+	/*
+	 * Set terminal parameters.
+	 */
+	termios.c_iflag=ICRNL;
+	termios.c_oflag=ONLCR | OPOST;
+	termios.c_cflag=CS8 | CREAD | HUPCL;
+	termios.c_lflag=ECHO | ECHOE | ECHOK | ECHOKE | ISIG | ECHOCTL | ICANON;
+	termios.c_cc[VMIN]=1;
+	termios.c_cc[VTIME]=0;
+	termios.c_cc[VINTR]=003;
+	termios.c_cc[VQUIT]=034;
+	termios.c_cc[VERASE]=0177;
+	termios.c_cc[VKILL]=025;
+	termios.c_cc[VEOF]=004;
+	termios.c_cc[VSTART]=021;
+	termios.c_cc[VSTOP]=023;
+	termios.c_cc[VSUSP]=032;
+	
+	winsize.ws_row=shell->size_y;
+	winsize.ws_col=shell->size_x;
+	winsize.ws_xpixel=0;
+	winsize.ws_ypixel=0;
+
+	/*
+	 * allocate a pty, fork and exec the command
+	 */
+	shell->pid=forkpty(&shell->fd_master, NULL, &termios, &winsize);
+	if(shell->pid==0)
+	{
+		/*
+		 * child code
+		 */
+		setenv("TERM", "screen", 1);
+		if(execvp(*argv, argv)<0)
+		{
+			vimshell_errno=VIMSHELL_EXECV_ERROR;
+			// VIMSHELL TODO close fds??
+			return -1;
+		}
+	}
+	else if(shell->pid<0)
+	{
+		vimshell_errno=VIMSHELL_FORKPTY_ERROR;
+		return -1;
+	}
+
+	/*
+	 * Set the file descriptor to non-blocking
+	 */
+	if(fcntl(shell->fd_master, F_SETFL, fcntl(shell->fd_master, F_GETFL) | O_NONBLOCK)<0)
+	{
+		vimshell_errno=VIMSHELL_FCNTL_ERROR;
+		return -1;
+	}
+
+	/*
+	 * parent code
+	 */
+	if(ioctl(shell->fd_master, TIOCSWINSZ, &winsize)<0)
+	{
+		CHILDDEBUGPRINTF( "%s: ERROR: ioctl to change window size: %s\n", 
+				__FUNCTION__,strerror(errno));
+	}
+
+	return 0;
+}
+
+/*
+ * this is much like strerror, only with vimshell_errno. Additionally, if errno is not
+ * null, the formatted error message (strerror) will be appended to the output.
+ */
+char *vim_shell_strerror()
+{
+	static char errbuf[200];
+	static char *errmsg[]={"Success",
+		"Out of memory",
+		"forkpty error",
+		"read error",
+		"write error",
+		"execv error",
+		"sigaction error",
+	        "read (EOF)",
+	        "fcntl error"};
+
+	if(errno==0)
+		return errmsg[vimshell_errno];
+
+	snprintf(errbuf, sizeof(errbuf), "%s: %s", errmsg[vimshell_errno], strerror(errno));
+	return errbuf;
+}
+
+/*
+ * Read what is available from the master pty and tear it through the
+ * terminal emulation. This will fill the window buffer.
+ */
+int vim_shell_read(struct vim_shell_window *shell)
+{
+	// for now, copy what we have into the window buffer.
+	char input[2000];
+	int rval;
+
+retry:
+	if((rval=read(shell->fd_master, input, sizeof(input)))<0)
+	{
+		if(errno==EINTR)
+			goto retry;
+		if(errno==EAGAIN)
+		{
+			/*
+			 * This function should only be called when there really
+			 * are bytes available to read from the fd_master. This
+			 * is ensured by calling select() before this function.
+			 * But it seems that there is a race with a SIGWINSZ right
+			 * in the middle of a select() (reporting there are characters
+			 * available) and the following read() that will block forever.
+			 * It seems that SIGWINSZ flushes the processes input queue, at
+			 * least on Linux.
+			 *
+			 * So if we get here although there is nothing to read, don't
+			 * report an error, just return successfully.
+			 */
+			goto success;
+		}
+
+		vimshell_errno=VIMSHELL_READ_ERROR;
+		return -1;
+	}
+
+	if(rval==0)
+	{
+		/*
+		 * This means end-of-file, the subprocess exited.
+		 */
+		vimshell_errno=VIMSHELL_READ_EOF;
+		return -1;
+	}
+
+#ifdef RAWDEBUG
+	fprintf(vimshell_debug_fp, "\nincoming bytes:\n");
+	hexdump(vimshell_debug_fp, input, rval);
+#endif
+
+	/*
+	 * Interface to the terminal layer: give the input buffer to the
+	 * terminal emulator for processing.
+	 */
+	vim_shell_terminal_input(shell, input, rval);
+
+success:
+	vimshell_errno=VIMSHELL_SUCCESS;
+	return 0;
+}
+
+/*
+ * Write a character to the VIM-Shell.
+ * Blow it through terminal_output so it gets translated correctly etc...
+ */
+int vim_shell_write(struct vim_shell_window *shell, int c)
+{
+	if(vim_shell_terminal_output(shell, c)<0)
+	{
+		vimshell_errno=VIMSHELL_WRITE_ERROR;
+		return -1;
+	}
+	
+	vimshell_errno=VIMSHELL_SUCCESS;
+	return 0;
+}
+
+/*
+ * Free everything that is associated with this shell window.
+ * Also terminates the process. The shell pointer will be set to NULL.
+ * The buffer will be restored to a usable, empty buffer.
+ */
+void vim_shell_delete(buf_T *buf)
+{
+	struct vim_shell_window *sh=buf->shell;
+	int status;
+	pid_t pid;
+
+	/*
+	 * First, kill the child and wait for it.
+	 * VIMSHELL TODO: this can be extended a lot. e.g. using a SIGCHLD handler
+	 * or an SIGALRM handler and kill(SIGKILL) the process when the alarm fires
+	 * etc. But for now (and most of all cases) this should be OK.
+	 */
+	pid=sh->pid;
+	if(pid>0)
+	{
+		kill(pid, SIGTERM);
+		kill(pid, SIGHUP);
+		while(waitpid(pid, &status, 0)<0 && errno==EINTR);
+		CHILDDEBUGPRINTF( "%s: PID %u terminated, exit status = %d\n", __FUNCTION__, pid,
+			WEXITSTATUS(status));
+	}
+
+	/*
+	 * The child is dead. Clean up
+	 */
+	close(sh->fd_master);
+	if(sh->alt)
+	{
+		vim_shell_free(sh->alt->winbuf);
+		vim_shell_free(sh->alt->fgbuf);
+		vim_shell_free(sh->alt->bgbuf);
+		vim_shell_free(sh->alt->rendbuf);
+		vim_shell_free(sh->alt->tabline);
+		vim_shell_free(sh->alt->charset);
+		vim_shell_free(sh->alt);
+		sh->alt=NULL;
+	}
+	vim_shell_free(sh->winbuf);
+	vim_shell_free(sh->fgbuf);
+	vim_shell_free(sh->bgbuf);
+	vim_shell_free(sh->rendbuf);
+	vim_shell_free(sh->tabline);
+	vim_shell_free(sh->charset);
+	vim_shell_free(sh);
+
+	CHILDDEBUGPRINTF( "%s: vimshell %p freed.\n", __FUNCTION__, sh);
+	
+	buf->is_shell=0;
+	buf->shell=NULL;
+	buf->b_p_ro=FALSE;
+}
+
+/*
+ * Does the work of actually resizing the shell's buffers. Deallocating them, 
+ * reallocating them, copying over the old contents to the right places, etc...
+ * rval: 0 = success, <0 = error
+ */
+static int internal_screenbuf_resize(struct vim_shell_window *shell, int width, int height)
+{
+	uint8_t *owinbuf, *ofgbuf, *obgbuf, *orendbuf, *otabline, *ocharset;
+	int x, y, len, vlen;
+	uint16_t oldwidth, oldheight;
+
+	oldwidth=shell->size_x;
+	oldheight=shell->size_y;
+	shell->size_x=(uint16_t)width;
+	shell->size_y=(uint16_t)height;
+
+	owinbuf=shell->winbuf;
+	ofgbuf=shell->fgbuf;
+	obgbuf=shell->bgbuf;
+	orendbuf=shell->rendbuf;
+	ocharset=shell->charset;
+	otabline=shell->tabline;
+
+	shell->winbuf=(uint8_t *)vim_shell_malloc(width*height);
+	shell->fgbuf=(uint8_t *)vim_shell_malloc(width*height);
+	shell->bgbuf=(uint8_t *)vim_shell_malloc(width*height);
+	shell->rendbuf=(uint8_t *)vim_shell_malloc(width*height);
+	shell->charset=(uint8_t *)vim_shell_malloc(width*height);
+	shell->tabline=(uint8_t *)vim_shell_malloc(width);
+	if(shell->winbuf==NULL || shell->fgbuf==NULL || shell->bgbuf==NULL || shell->rendbuf==NULL || shell->charset==NULL ||
+			shell->tabline==NULL)
+	{
+		vimshell_errno=VIMSHELL_OUT_OF_MEMORY;
+		if(shell->winbuf) vim_shell_free(shell->winbuf);
+		if(shell->fgbuf) vim_shell_free(shell->fgbuf);
+		if(shell->bgbuf) vim_shell_free(shell->bgbuf);
+		if(shell->rendbuf) vim_shell_free(shell->rendbuf);
+		if(shell->charset) vim_shell_free(shell->charset);
+		if(shell->tabline) vim_shell_free(shell->tabline);
+
+		/* 
+		 * Reassign the old buffers, they are still valid. And bring the shell
+		 * back to a sane state.
+		 */
+		shell->winbuf=owinbuf;
+		shell->fgbuf=ofgbuf;
+		shell->bgbuf=obgbuf;
+		shell->rendbuf=orendbuf;
+		shell->charset=ocharset;
+		shell->tabline=otabline;
+
+		shell->size_x=oldwidth;
+		shell->size_y=oldheight;
+		
+		return -1;
+	}
+	memset(shell->winbuf, ' ', width*height);
+	memset(shell->fgbuf, shell->fgcolor, width*height);
+	memset(shell->bgbuf, shell->bgcolor, width*height);
+	memset(shell->rendbuf, 0, width*height);
+	memset(shell->charset, 0, width*height);
+	memset(shell->tabline, 0, width);
+
+	CHILDDEBUGPRINTF( "%s: width = %d, height = %d, oldwidth = %d, oldheight = %d\n",__FUNCTION__,width,height,
+			oldwidth,oldheight);
+
+	/*
+	 * copy over the old contents of the screen, line by line (!)
+	 */
+	len=(oldwidth<width ? oldwidth : width);
+	vlen=(oldheight<height ? oldheight : height);
+	for(y=0;y<vlen;y++)
+	{
+		int y_off;
+		y_off=oldheight-vlen;
+		memcpy(shell->winbuf+y*width, owinbuf+(y+y_off)*oldwidth, len);
+		memcpy(shell->fgbuf+y*width, ofgbuf+(y+y_off)*oldwidth, len);
+		memcpy(shell->bgbuf+y*width, obgbuf+(y+y_off)*oldwidth, len);
+		memcpy(shell->rendbuf+y*width, orendbuf+(y+y_off)*oldwidth, len);
+		memcpy(shell->charset+y*width, ocharset+(y+y_off)*oldwidth, len);
+	}
+	memcpy(shell->tabline, otabline, len);
+
+	/*
+	 * free the old contents
+	 */
+	vim_shell_free(owinbuf);
+	vim_shell_free(ofgbuf);
+	vim_shell_free(obgbuf);
+	vim_shell_free(orendbuf);
+	vim_shell_free(otabline);
+	vim_shell_free(ocharset);
+
+	/*
+	 * Correct tabs
+	 */
+	if(oldwidth<width)
+	{
+		for(x=oldwidth;x<width;x++)
+		{
+			if((x+1)%8==0 && x+1<width)
+				shell->tabline[x]=1;
+		}
+	}
+
+	/*
+	 * Correct cursor
+	 */
+	if(shell->cursor_x>=shell->size_x)
+		shell->cursor_x=shell->size_x-1;
+	if(shell->cursor_y>=shell->size_y)
+		shell->cursor_y=shell->size_y-1;
+
+	/*
+	 * Update scroll region
+	 */
+	shell->scroll_top_margin=0;
+	shell->scroll_bottom_margin=shell->size_y-1;
+
+	/*
+	 * Invalidate the vimshell screen buffer, so vim_shell_redraw redraws the whole
+	 * screen.
+	 */
+	shell->force_redraw=1;
+
+	return 0;
+}
+
+/*
+ * Resizes the shell.
+ * It reallocates all the size dependant buffers and instructs the shell to change
+ * its size.
+ * The width and height parameters are the *desired* width and height. The actual
+ * width and height is dependant on wether all windows that currently render this shell
+ * are able to display this width and height.
+ */
+void vim_shell_resize(struct vim_shell_window *shell, int want_width, int want_height)
+{
+	int width, height;
+	struct winsize ws;
+	win_T *win;
+
+	width=want_width;
+	height=want_height;
+	FOR_ALL_WINDOWS(win)
+	{
+		if(win->w_buffer && win->w_buffer->is_shell && win->w_buffer->shell==shell)
+		{
+			if(win->w_width<width)
+				width=win->w_width;
+			if(win->w_height<height)
+				height=win->w_height;
+		}
+	}
+
+	CHILDDEBUGPRINTF( "%s: resizing to %d, %d\n",__FUNCTION__,width,height);
+
+	if(internal_screenbuf_resize(shell, width, height)<0)
+	{
+		CHILDDEBUGPRINTF("%s: error while resizing.\n", __FUNCTION__);
+		return;
+	}
+	if(shell->alt!=NULL)
+	{
+		if(internal_screenbuf_resize(shell->alt, width, height)<0)
+		{
+			CHILDDEBUGPRINTF("%s: error while resizing the backup screen. Recovering...\n", __FUNCTION__);
+
+			/*
+			 * We now really have a problem. The main shell window is already
+			 * resized and this one didn't work. What should we do? Just destroy the screen
+			 * backup so it never gets restored. internal_screenbuf_resize already did
+			 * the job to of freeing the SINGle buffers, we just have to free the remaining struct.
+			 */
+			vim_shell_free(shell->alt);
+			shell->alt=NULL;
+		}
+	}
+
+	/*
+	 * Tell the shell that the size has changed. 
+	 */
+	ws.ws_row=height;
+	ws.ws_col=width;
+	ws.ws_xpixel=0;
+	ws.ws_ypixel=0;
+	if(ioctl(shell->fd_master, TIOCSWINSZ, &ws)<0)
+	{
+		CHILDDEBUGPRINTF( "%s: ERROR: ioctl to change window size: %s\n", 
+				__FUNCTION__,strerror(errno));
+	}
+}
+
+/*
+ * Draws the Shell-Buffer into the VIM-Window. 
+ */
+void vim_shell_redraw(struct vim_shell_window *shell, win_T *win)
+{	
+	int x, y;
+	int win_row, win_col;
+	int off;
+	int last_set_fg, last_set_bg;
+	int cs_state;
+	int term_is_bold, term_is_underline, term_is_negative;
+	int saved_screen_cur_row, saved_screen_cur_col;
+	int force_redraw;
+	int using_gui=0;
+
+#ifdef FEAT_GUI
+	if(gui.in_use)
+	{
+		using_gui=1;
+	}
+#endif
+
+	win_row=W_WINROW(win);
+	win_col=W_WINCOL(win);
+
+	force_redraw=shell->force_redraw;
+
+	// invalidate the color cache
+	last_set_fg=last_set_bg=-1;
+	cs_state=VIMSHELL_CHARSET_USASCII;
+
+	saved_screen_cur_row=screen_cur_row;
+	saved_screen_cur_col=screen_cur_col;
+
+	// go to normal mode
+	term_is_bold=term_is_underline=term_is_negative=0;
+	screen_stop_highlight();
+
+	for(y=0;y<shell->size_y;y++)
+	{	
+		size_t index=y*shell->size_x;
+		int skipped, y_reposition_necessary;
+
+		off=LineOffset[win_row+y]+win_col;
+		skipped=0;
+		y_reposition_necessary=1;
+		for(x=0;x<shell->size_x;x++)
+		{
+			uint8_t c=shell->winbuf[index];
+			sattr_T r=(sattr_T)shell->rendbuf[index];
+			uint8_t fg=shell->fgbuf[index];
+			uint8_t bg=shell->bgbuf[index];
+			uint8_t cs=shell->charset[index];
+			uint8_t fg_color=fg&0xF;
+			uint8_t bg_color=bg&0xF;
+
+			/*
+			 * Switch terminal charset if necessary
+			 */
+			if(cs_state!=cs)
+			{
+				cs_state=cs;
+				if(cs==VIMSHELL_CHARSET_USASCII)
+				{
+					// VIMSHELL TODO: make a term code out of this hack
+					out_str_nf("\033(B");
+					CHILDDEBUGPRINTF( "%s: switched terminal to normal charset\n",__FUNCTION__);
+				}
+				else if(cs==VIMSHELL_CHARSET_DRAWING)
+				{
+					// VIMSHELL TODO: make a term code out of this hack
+					out_str_nf("\033(0");
+					CHILDDEBUGPRINTF( "%s: switched terminal to alternate charset\n",__FUNCTION__);
+				}
+			}	
+
+			/*
+			 * Store the foreground and background color along with the rendering attributes.
+			 */
+			r |= (fg&0x0F)<<12 | (bg&0x0F)<<8;
+
+			/*
+			 * Only do an update if render attributes or the character
+			 * has changed at this position.
+			 */
+			if(ScreenLines[off]!=c || ScreenAttrs[off]!=r || force_redraw)
+			{
+				// render attributes
+				if( ((r & RENDITION_BOLD)==0) == (term_is_bold==0) &&
+						((r & RENDITION_UNDERSCORE)==0) == (term_is_underline==0) &&
+						((r & RENDITION_NEGATIVE)==0) == (term_is_negative==0))
+				{
+					/*
+					 * already in the right rendition mode ...
+					 */
+				}
+				else if(using_gui==0)
+				{
+					out_str_nf(T_ME);
+					term_is_bold=term_is_underline=term_is_negative=0;
+					last_set_fg=last_set_bg=-1;
+					if ((r & RENDITION_BOLD) && !term_is_bold)
+					{
+						if(T_MD!=NULL)
+							out_str_nf(T_MD);
+						term_is_bold=1;
+					}
+					if ((r & RENDITION_UNDERSCORE) && !term_is_underline)
+					{
+						if(T_US != NULL)
+							out_str_nf(T_US);
+						term_is_underline=1;
+					}
+					if ((r & RENDITION_NEGATIVE) && !term_is_negative)
+					{
+						if(T_MR!=NULL)
+							out_str_nf(T_MR);
+						term_is_negative=1;
+					}
+				}
+
+				// colors
+				if(t_colors > 1 && using_gui==0)
+				{
+					// VIMSHELL TODO: not every terminal will understand these colors ...
+					// look at tag:cterm_normal_fg_color
+					if(last_set_fg!=fg_color)
+					{
+						term_fg_color(fg_color);
+						last_set_fg=fg_color;
+					}
+					if(last_set_bg!=bg_color)
+					{
+						term_bg_color(bg_color);
+						last_set_bg=bg_color;
+					}
+				}
+
+				ScreenLines[off]=c; 
+				ScreenAttrs[off]=r;
+
+				if(y_reposition_necessary || skipped>0)
+				{
+					/*
+					 * Bring the cursor to where we need it.
+					 */
+					term_windgoto(win_row+y, win_col+x);
+					skipped=0;
+					y_reposition_necessary=0;
+				}
+
+				// print it
+				out_char(c);
+			}
+			else
+			{
+				skipped++;
+			}
+
+			off++;
+			index++;
+		}
+	}
+	/* 
+	 * Always leave this function with the normal ASCII charset enabled and
+	 * with sane rendering attributes (normal mode).
+	 */
+	if(cs_state!=VIMSHELL_CHARSET_USASCII)
+	{
+		// VIMSHELL TODO: make a term code out of this hack
+		out_str_nf("\033(B");
+		CHILDDEBUGPRINTF( "%s: switched terminal to normal charset\n",__FUNCTION__);
+	}
+
+	/*
+	 * Move the cursor to where VIM thinks it is :)
+	 */
+	term_windgoto(saved_screen_cur_row, saved_screen_cur_col);
+
+	/*
+	 * Position the cursor.
+	 * VIMSHELL TODO: we could cache that, e.g. when the cursor didn't move don't turn
+	 * it on again etc.
+	 */
+	win->w_wrow=shell->cursor_y;
+	win->w_wcol=shell->cursor_x;
+	setcursor();
+	cursor_on();
+
+	/*
+	 * Restore the rendering attributes
+	 */
+	out_str_nf(T_ME);
+	screen_start_highlight(screen_attr);
+	out_flush();
+
+	if(shell->force_redraw)
+		shell->force_redraw=0;
+}
+
+/*
+ * Really do the read, finally :)
+ * Returns 1 if the contents of the window are VALID (in VIM speak)
+ * Returns 2 if the contents have to be CLEARed (after the shell has died)
+ */
+int vim_shell_do_read_lowlevel(buf_T *buf)
+{
+	int rval=1;
+	if(vim_shell_read(buf->shell)<0)
+	{
+		/*
+		 * Shell died? Cleanup. Also remove the RO attribute from the
+		 * buffer.
+		 */
+		vim_shell_delete(buf);
+		rval=2;
+	}
+
+	return rval;
+}
+
+/*
+ * This function is called from two places: os_unix.c and ui.c, and handles
+ * shell reads that are necessary because a select() became ready. This function
+ * is here to avoid identical code in both places.
+ * It returns the number of shell-reads.
+ * If there was no activity in any of the shells, it returns 0.
+ */
+int vim_shell_do_read_select(fd_set rfds)
+{
+	/*
+	 * Loop through all buffers and see if they are vimshells.
+	 * If yes, check if there are read events ready for the appropriate
+	 * fds. If so, call the shell's read handler.
+	 */
+	buf_T *buf;
+	int did_redraw=0;
+	int rval=0;
+
+	for(buf=firstbuf;buf!=NULL;buf=buf->b_next)
+	{
+		if(buf->is_shell != 0)
+		{
+			if(FD_ISSET(buf->shell->fd_master, &rfds))
+			{
+				int r;
+
+				r=vim_shell_do_read_lowlevel(buf);
+				if(r>did_redraw)
+					did_redraw=r;
+
+				rval++;
+
+				if(r==1 && updating_screen==FALSE)
+					redraw_buf_later(buf, VALID);
+				else if(r==2 && updating_screen==FALSE)
+					redraw_buf_later(buf, CLEAR);
+			}
+		}
+	}
+
+	/*
+	 * Only redraw if we aren't currently redrawing, to avoid endless recursions.
+	 * update_screen calls win_update, which calls win_line, which calls breakcheck,
+	 * which again calls RealWaitForChar which calls this function ...
+	 */
+	if(updating_screen==FALSE)
+	{
+		if(did_redraw==1)
+		{
+			update_screen(VALID);
+		}
+		else if(did_redraw==2 || did_redraw==3)
+		{
+			update_screen(CLEAR);
+			out_flush();
+		}
+	}
+
+	return rval;
+}

Property changes on: src/vim_shell.c
___________________________________________________________________
Name: svn:keywords
   + author date id revision
Name: svn:eol-style
   + native

Index: src/vim_shell.h
===================================================================
--- src/vim_shell.h	(.../branches/V7_0)	(revision 0)
+++ src/vim_shell.h	(.../trunk)	(revision 120)
@@ -0,0 +1,273 @@
+/*
+ * vim_shell.h
+ *
+ * Global include file for VIM-Shell. Defines structures and interfaces.
+ *
+ * This file is part of the VIM-Shell project. http://vimshell.wana.at
+ *
+ * Author: Thomas Wana <thomas@wana.at>
+ *
+ * $Id$
+ */
+
+#ifndef __VIMSHELL_H
+
+#define __VIMSHELL_H
+
+#include "vim.h"
+
+#include <stdio.h>
+#ifdef HAVE_STDINT_H
+#include <stdint.h>
+#endif
+#include <sys/types.h>
+#include <sys/select.h>
+
+/*
+ * Master debug flag. Disable this and no debug messages at all will
+ * be written anywhere.
+ */
+//#define VIMSHELL_DEBUG
+
+/*
+ * Rendition constants
+ */
+#define RENDITION_BOLD 1
+#define RENDITION_UNDERSCORE 2
+#define RENDITION_BLINK 4
+#define RENDITION_NEGATIVE 8
+#define RENDITION_DIM 16 
+#define RENDITION_HIDDEN 32
+
+/*
+ * charset constants
+ */
+#define VIMSHELL_CHARSET_USASCII 0
+#define VIMSHELL_CHARSET_DRAWING 1
+
+/*
+ * Color constants
+ */
+#define VIMSHELL_COLOR_BLACK 0
+#define VIMSHELL_COLOR_RED 1
+#define VIMSHELL_COLOR_GREEN 2
+#define VIMSHELL_COLOR_YELLOW 3
+#define VIMSHELL_COLOR_BLUE 4
+#define VIMSHELL_COLOR_MAGENTA 5
+#define VIMSHELL_COLOR_CYAN 6
+#define VIMSHELL_COLOR_WHITE 7
+#define VIMSHELL_COLOR_DEFAULT 9
+
+#define vim_shell_malloc alloc
+#define vim_shell_free vim_free
+
+/*
+ * The main vim_shell_window struct.
+ * Holds everything that is needed to know about a single
+ * vim shell. (like file descriptors, window buffers, window
+ * positions, etc)
+ */
+struct vim_shell_window
+{
+	/*
+	 * current dimensions of the window
+	 */
+	uint16_t size_x;
+	uint16_t size_y;
+
+	/*
+	 * cursor position and visible flag
+	 */
+	uint16_t cursor_x;
+	uint16_t cursor_y;
+	uint16_t cursor_visible;
+
+	/*
+	 * Saved cursor positions (ESC 7, ESC 8)
+	 */
+	uint16_t saved_cursor_x;
+	uint16_t saved_cursor_y;
+
+	/*
+	 * We support the xterm title hack and store the title in this buffer.
+	 */
+	char windowtitle[50];
+
+	/*
+	 * The output buffer. This is necessary because writes to the shell can be delayed,
+	 * e.g. if we are waiting for an incoming ESC sequence to complete.
+	 */
+	uint8_t outbuf[100];
+	uint8_t outbuf_pos;
+
+	/*
+	 * Pointer to the window buffer.
+	 * The window buffer is the internal representation of the
+	 * window's content. The vim shell receives characters from
+	 * the terminal, which the terminal emulation translates into
+	 * e.g. cursor positions or actual characters. These are placed
+	 * here at the right screen position. Its size is size_y*size_x.
+	 */
+	uint8_t *winbuf;
+	uint8_t *fgbuf;
+	uint8_t *bgbuf;
+	uint8_t *rendbuf;
+	uint8_t *charset;
+
+	/*
+	 * The tabulator line. It represents a single row. Zero means no
+	 * tab at this position, 1 means there is a tab.
+	 */
+	uint8_t *tabline;
+
+	/*
+	 * These buffers hold what's currently physical on the screen.
+	 * Note, not on the "virtual" screen, that is the image of the shell,
+	 * but the real screen that is printed out in vim_shell_redraw.
+	 * This is mainly to implement caching features...
+	 * We hold here:
+	 * 1 byte foreground-color
+	 * 1 byte background-color
+	 * 1 byte rendering attributes
+	 * 1 byte the actual character
+	 */
+	uint32_t *phys_screen;
+
+	/*
+	 * Flag that determines if we are right in the middle of an
+	 * escape sequence coming in.
+	 */
+	uint8_t in_esc_sequence;
+
+	/*
+	 * Buffer for a escape sequence in progress (see in_esc_sequence).
+	 */
+	uint8_t esc_sequence[50];
+
+	/*
+	 * Auto-Margin enabled?
+	 */
+	uint8_t wraparound;
+
+	/*
+	 * Caused the last character a warp around?
+	 */
+	uint8_t just_wrapped_around;
+
+	/*
+	 * The currently used rendition of the shell.
+	 */
+	uint8_t rendition;
+	uint8_t saved_rendition;
+
+	/*
+	 * The currently active colors.
+	 */
+	uint8_t fgcolor;
+	uint8_t bgcolor;
+	uint8_t saved_fgcolor;
+	uint8_t saved_bgcolor;
+
+	/*
+	 * Scroll region.
+	 */
+	uint8_t scroll_top_margin;
+	uint8_t scroll_bottom_margin;
+
+	/*
+	 * Charset configuration.
+	 */
+	uint8_t G0_charset;
+	uint8_t G1_charset;
+	uint8_t active_charset;
+	uint8_t saved_G0_charset;
+	uint8_t saved_G1_charset;
+	uint8_t saved_active_charset;
+
+	/*
+	 * Mode switches.
+	 */
+	uint8_t application_keypad_mode;
+	uint8_t application_cursor_mode;
+	uint8_t saved_application_keypad_mode;
+	uint8_t saved_application_cursor_mode;
+
+	uint8_t insert_mode;
+	uint8_t saved_insert_mode;
+
+	/*
+	 * This flag determines if the shell should be completely redrawn in the next
+	 * vim_shell_redraw, regardless of what we think to know about the screen.
+	 */
+	uint8_t force_redraw;
+
+	/*
+	 * Pointer to the alternate screen. If NULL, there is no alternate screen.
+	 * If not NULL, this holds a backup of the screen contents and properties
+	 * before the screen switch. Switching back means to copy back the contents
+	 * of the alternate screen to the main screen and freeing the alternate screen.
+	 */
+	struct vim_shell_window *alt;
+
+	/*
+	 * file descriptor of the master side of the pty
+	 */
+	int fd_master;
+
+	/*
+	 * pid of the subshell
+	 */
+	pid_t pid;
+
+};
+
+/*
+ * This is set when something goes wrong in one of the
+ * vim_shell functions.
+ */
+extern int vimshell_errno;
+
+/*
+ * The debug handle where debug-messages will be written
+ */
+extern FILE *vimshell_debug_fp;
+
+#define VIMSHELL_SUCCESS 0
+#define VIMSHELL_OUT_OF_MEMORY 1
+#define VIMSHELL_FORKPTY_ERROR 2
+#define VIMSHELL_READ_ERROR 3
+#define VIMSHELL_WRITE_ERROR 4
+#define VIMSHELL_EXECV_ERROR 5
+#define VIMSHELL_SIGACTION_ERROR 6
+#define VIMSHELL_READ_EOF 7
+#define VIMSHELL_FCNTL_ERROR 8
+
+/*
+ * vim_shell.c
+ */
+extern int vim_shell_init();
+extern struct vim_shell_window *vim_shell_new(uint16_t width, uint16_t height);
+extern int vim_shell_start(struct vim_shell_window *shell, char *argv[]);
+extern char *vim_shell_strerror();
+extern int vim_shell_read(struct vim_shell_window *shell);
+extern int vim_shell_write(struct vim_shell_window *shell, int c);
+extern void vim_shell_redraw(struct vim_shell_window *shell, win_T *win);
+extern int vim_shell_do_read_select(fd_set rfds);
+extern int vim_shell_do_read_lowlevel(buf_T *buf);
+extern void vim_shell_delete(buf_T *buf);
+extern void vim_shell_resize(struct vim_shell_window *shell, int width, int height);
+
+/*
+ * terminal.c
+ */
+extern void vim_shell_terminal_input(struct vim_shell_window *shell, char *input, int len);
+extern int vim_shell_terminal_output(struct vim_shell_window *shell, int c);
+
+/*
+ * screen.c
+ */
+extern int screen_cur_row, screen_cur_col;	/* last known cursor position */
+extern void screen_start_highlight __ARGS((int attr));
+extern int screen_attr;
+
+#endif

Property changes on: src/vim_shell.h
___________________________________________________________________
Name: svn:keywords
   + author date id revision
Name: svn:eol-style
   + native

Index: src/ex_cmds.h
===================================================================
--- src/ex_cmds.h	(.../branches/V7_0)	(revision 120)
+++ src/ex_cmds.h	(.../trunk)	(revision 120)
@@ -1001,6 +1001,10 @@
 			BANG|FILE1|EDITCMD|ARGOPT|TRLBAR),
 EX(CMD_view,		"view",		ex_edit,
 			BANG|FILE1|EDITCMD|ARGOPT|TRLBAR),
+#ifdef FEAT_VIMSHELL
+EX(CMD_vimshell,	"vimshell",	ex_vimshell,
+			EXTRA|BANG|TRLBAR|CMDWIN),
+#endif
 EX(CMD_vimgrep,		"vimgrep",	ex_vimgrep,
 			RANGE|NOTADR|BANG|NEEDARG|EXTRA|NOTRLCOM|TRLBAR|XFILE),
 EX(CMD_vimgrepadd,	"vimgrepadd",	ex_vimgrep,
Index: src/configure.in
===================================================================
--- src/configure.in	(.../branches/V7_0)	(revision 120)
+++ src/configure.in	(.../trunk)	(revision 120)
@@ -2867,6 +2867,23 @@
 fi
 AC_SUBST(DEPEND_CFLAGS_FILTER)
 
+dnl ------------------------------------------------------------------
+dnl VIMSHELL configure thingies
+dnl needs -lutil, but not on MacOS X
+dnl The $MACOSX variable isn't set on the Mac I can use for testing, so we
+dnl have to use other means to find out if this is a Mac. uname for example.
+if test "$(uname)" = "Darwin"; then
+      LIBS="$LIBS"
+else
+      LIBS="$LIBS -lutil"
+fi
+AC_CHECK_HEADERS(pty.h libutil.h stdint.h)
+AC_CHECK_FUNCS(forkpty)
+if test $ac_cv_func_forkpty = no; then
+    AC_MSG_ERROR(vimshell needs forkpty - sorry.)
+fi
+dnl ------------------------------------------------------------------
+
 dnl write output files
 AC_OUTPUT(auto/config.mk:config.mk.in)
 
Index: src/move.c
===================================================================
--- src/move.c	(.../branches/V7_0)	(revision 120)
+++ src/move.c	(.../trunk)	(revision 120)
@@ -666,6 +666,14 @@
     void
 validate_cursor()
 {
+#ifdef FEAT_VIMSHELL
+    /*
+     * The vimshell repositions its artificial cursor in vim_shell_redraw. Don't do the
+     * checks below.
+     */
+    if(curwin->w_buffer && curwin->w_buffer->is_shell!=0)
+	return;
+#endif
     check_cursor_moved(curwin);
     if ((curwin->w_valid & (VALID_WCOL|VALID_WROW)) != (VALID_WCOL|VALID_WROW))
 	curs_columns(TRUE);
Index: src/gui.c
===================================================================
--- src/gui.c	(.../branches/V7_0)	(revision 120)
+++ src/gui.c	(.../trunk)	(revision 120)
@@ -2419,6 +2419,7 @@
     long_u	old_hl_mask;
     int		off;
     sattr_T	first_attr;
+#endif
     int		idx, len;
     int		back, nback;
     int		retval = FALSE;
Index: src/testdir/test30.in
===================================================================
--- src/testdir/test30.in	(.../branches/V7_0)	(revision 120)
+++ src/testdir/test30.in	(.../trunk)	(revision 120)
@@ -201,8 +201,9 @@
 unix
 eof
 
-dos
-dos
+dos
+dos
 eof
 
-macmac
+mac
+mac
Index: src/testdir/test22.ok
===================================================================
--- src/testdir/test22.ok	(.../branches/V7_0)	(revision 120)
+++ src/testdir/test22.ok	(.../trunk)	(revision 120)
@@ -1,4 +1,4 @@
-this lines ends in a
+this lines ends in a
 this one doesn't
-this one does
+this one does
 and the last one doesn't
Index: src/testdir/test36.ok
===================================================================
--- src/testdir/test36.ok	(.../branches/V7_0)	(revision 120)
+++ src/testdir/test36.ok	(.../trunk)	(revision 120)
@@ -1,16 +1,24 @@
-	 !"#$%&'()#+'-./:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~ÄÇêõ¶±º«”È
+	
+ !"#$%&'()#+'-./:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~ÄÇêõ¶±º«”È
 0123456789
-	 !"#$%&'()#+'-./89:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~ÄÇêõ¶±º«”È
+	
+ !"#$%&'()#+'-./89:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~ÄÇêõ¶±º«”È
 01234567
-	 !"#$%&'()#+'-./:;<=>?@GHIXYZ[\]^_`ghiwxyz{|}~ÄÇêõ¶±º«”È
+	
+ !"#$%&'()#+'-./:;<=>?@GHIXYZ[\]^_`ghiwxyz{|}~ÄÇêõ¶±º«”È
 0123456789ABCDEFabcdef
-	 !"#$%&'()#+'-./:;<=>?@[\]^`{|}~ÄÇêõ¶±º«”È
+	
+ !"#$%&'()#+'-./:;<=>?@[\]^`{|}~ÄÇêõ¶±º«”È
 0123456789ABCDEFGHIXYZ_abcdefghiwxyz
-	 !"#$%&'()#+'-./0123456789:;<=>?@[\]^`{|}~ÄÇêõ¶±º«”È
+	
+ !"#$%&'()#+'-./0123456789:;<=>?@[\]^`{|}~ÄÇêõ¶±º«”È
 ABCDEFGHIXYZ_abcdefghiwxyz
-	 !"#$%&'()#+'-./0123456789:;<=>?@[\]^_`{|}~ÄÇêõ¶±º«”È
+	
+ !"#$%&'()#+'-./0123456789:;<=>?@[\]^_`{|}~ÄÇêõ¶±º«”È
 ABCDEFGHIXYZabcdefghiwxyz
-	 !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`{|}~ÄÇêõ¶±º«”È
+	
+ !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`{|}~ÄÇêõ¶±º«”È
 abcdefghiwxyz
-	 !"#$%&'()#+'-./0123456789:;<=>?@[\]^_`abcdefghiwxyz{|}~ÄÇêõ¶±º«”È
+	
+ !"#$%&'()#+'-./0123456789:;<=>?@[\]^_`abcdefghiwxyz{|}~ÄÇêõ¶±º«”È
 ABCDEFGHIXYZ
Index: src/testdir/dotest.in
===================================================================
--- src/testdir/dotest.in	(.../branches/V7_0)	(revision 120)
+++ src/testdir/dotest.in	(.../trunk)	(revision 120)
@@ -1,3 +1,8 @@
 :set cp
-:map dotest /^STARTTESTj:set ff=unix cpo-=A:.,/ENDTEST/-1w! Xdotest:set ff& cpo+=Anj0:so! Xdotestdotest
+:map dotest /^STARTTEST
+j:set ff=unix cpo-=A
+:.,/ENDTEST/-1w! Xdotest
+:set ff& cpo+=A
+nj0:so! Xdotest
 dotest
+dotest
Index: src/testdir/test22.in
===================================================================
--- src/testdir/test22.in	(.../branches/V7_0)	(revision 120)
+++ src/testdir/test22.in	(.../trunk)	(revision 120)
@@ -1,5 +1,5 @@
-Tests for file with some lines ending in CTRL-M, some not
-
+Tests for file with some lines ending in CTRL-M, some not
+
 STARTTEST
 :set ta tx
 :e!
@@ -7,7 +7,7 @@
 :qa!
 ENDTEST
 
-this lines ends in a
+this lines ends in a
 this one doesn't
-this one does
+this one does
 and the last one doesn't
Index: src/testdir/test36.in
===================================================================
--- src/testdir/test36.in	(.../branches/V7_0)	(revision 120)
+++ src/testdir/test36.in	(.../trunk)	(revision 120)
@@ -22,19 +22,35 @@
 ENDTEST
 
 start-here
-	 !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~ÄÇêõ¶±º«”È
-	 !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~ÄÇêõ¶±º«”È
-	 !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~ÄÇêõ¶±º«”È
-	 !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~ÄÇêõ¶±º«”È
-	 !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~ÄÇêõ¶±º«”È
-	 !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~ÄÇêõ¶±º«”È
-	 !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~ÄÇêõ¶±º«”È
-	 !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~ÄÇêõ¶±º«”È
-	 !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~ÄÇêõ¶±º«”È
-	 !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~ÄÇêõ¶±º«”È
-	 !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~ÄÇêõ¶±º«”È
-	 !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~ÄÇêõ¶±º«”È
-	 !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~ÄÇêõ¶±º«”È
-	 !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~ÄÇêõ¶±º«”È
-	 !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~ÄÇêõ¶±º«”È
-	 !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~ÄÇêõ¶±º«”È
+	
+ !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~ÄÇêõ¶±º«”È
+	
+ !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~ÄÇêõ¶±º«”È
+	
+ !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~ÄÇêõ¶±º«”È
+	
+ !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~ÄÇêõ¶±º«”È
+	
+ !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~ÄÇêõ¶±º«”È
+	
+ !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~ÄÇêõ¶±º«”È
+	
+ !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~ÄÇêõ¶±º«”È
+	
+ !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~ÄÇêõ¶±º«”È
+	
+ !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~ÄÇêõ¶±º«”È
+	
+ !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~ÄÇêõ¶±º«”È
+	
+ !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~ÄÇêõ¶±º«”È
+	
+ !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~ÄÇêõ¶±º«”È
+	
+ !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~ÄÇêõ¶±º«”È
+	
+ !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~ÄÇêõ¶±º«”È
+	
+ !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~ÄÇêõ¶±º«”È
+	
+ !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~ÄÇêõ¶±º«”È
Index: src/testdir/test3.in
===================================================================
--- src/testdir/test3.in	(.../branches/V7_0)	(revision 120)
+++ src/testdir/test3.in	(.../trunk)	(revision 120)
@@ -1014,7 +1014,12 @@
 STARTTEST
 :set cino= com=
 /comment
-olabel2: b();label3 /* post */:/* pre */ label4:f(/*com*/);if (/*com*/)cmd();
+olabel2: b();
+label3 /* post */:
+/* pre */ label4:
+f(/*com*/);
+if (/*com*/)
+cmd();
 ENDTEST
 
 a()
Index: src/testdir/test48.in
===================================================================
--- src/testdir/test48.in	(.../branches/V7_0)	(revision 120)
+++ src/testdir/test48.in	(.../trunk)	(revision 120)
@@ -14,7 +14,8 @@
 :"   Using "C" then then <CR> moves the last remaining character to the next
 :"    line.  (Mary Ellen Foster)
 j^/are
-Care belong to vim
+C
+are belong to vim
 :"
 :"   When past the end of a line that ends in a single character "b" skips
 :"    that word.
@@ -68,7 +69,8 @@
 this is a test
 this is a test
 "r"
-absd
+ab
+sd
 abcv6efi.him0kl
 
 
Index: src/vim.h
===================================================================
--- src/vim.h	(.../branches/V7_0)	(revision 120)
+++ src/vim.h	(.../trunk)	(revision 120)
@@ -359,6 +359,14 @@
 
 /*
  * The characters and attributes cached for the screen.
+ * VIM-Shell: the VIM-shell really needs more than one byte for the attributes.
+ *            Despite of a single warning during compilation, it seems to work
+ *            fine to simply change the type here.
+ *            We use the sattr_T as follows:
+ *            The lowest byte is handled the same as before, for rendering attributes.
+ *            The remaining byte is split, the uppermost 4 bits for the active foreground
+ *            color, and the lowermost 4 bits for the active background color (at this
+ *            screen position).
  */
 typedef char_u schar_T;
 #ifdef FEAT_SYN_HL
@@ -1980,6 +1988,10 @@
 # include <XSUB.h>
 #endif
 
+#ifdef FEAT_VIMSHELL
+#include "vim_shell.h"
+#endif
+
 /* values for vim_handle_signal() that are not a signal */
 #define SIGNAL_BLOCK	-1
 #define SIGNAL_UNBLOCK  -2
Index: src/structs.h
===================================================================
--- src/structs.h	(.../branches/V7_0)	(revision 120)
+++ src/structs.h	(.../trunk)	(revision 120)
@@ -1132,6 +1132,10 @@
 
 typedef struct file_buffer buf_T;
 
+#ifdef FEAT_VIMSHELL
+struct vim_shell_window;
+#endif
+
 struct file_buffer
 {
     memline_T	b_ml;		/* associated memline (also contains line
@@ -1576,6 +1580,11 @@
     int		b_was_netbeans_file;/* TRUE if b_netbeans_file was once set */
 #endif
 
+#ifdef FEAT_VIMSHELL
+    char	is_shell;                /* (flag) Is this buffer a shell? (0 = false) */
+    struct	vim_shell_window *shell; /* Pointer to the shell struct, or NULL */
+    int		gtk_input_id;            /* GTK-input id returned by gdk_input_add, only for GUI */
+#endif
 };
 
 
Index: src/ui.c
===================================================================
--- src/ui.c	(.../branches/V7_0)	(revision 120)
+++ src/ui.c	(.../trunk)	(revision 120)
@@ -1782,6 +1782,64 @@
     len = 0;	/* to avoid gcc warning */
     for (try = 0; try < 100; ++try)
     {
+#  ifdef FEAT_VIMSHELL
+	{
+	    /*
+	     * When we use the VIM shell, we use select to look if there was
+	     * some activity on the shells. This is because the read below after
+	     * this block blocks, and this sucks.
+	     *
+	     * This loop is basically here so the shells can send updates while
+	     * we are waiting for the read(2) on the read_cmd_fd to become available.
+	     */
+#  ifndef HAVE_SELECT
+#error sorry - vimshell needs select. programmer is too lazy to write this with poll (at this time)
+#  endif
+	    fd_set rdfd;
+	    buf_T *buf;
+	    int maxfd, ret, done;
+
+	    done=0;
+	    while(!done)
+	    {
+		FD_ZERO(&rdfd);
+		FD_SET(read_cmd_fd, &rdfd);
+		maxfd=read_cmd_fd;
+
+		for(buf=firstbuf; buf!=NULL; buf=buf->b_next)
+		{
+		    if(buf->is_shell!=0)
+		    {
+			FD_SET(buf->shell->fd_master, &rdfd);
+			if( maxfd < buf->shell->fd_master)
+			    maxfd = buf->shell->fd_master;
+		    }
+		}
+
+		ret=select(maxfd+1, &rdfd, NULL, NULL, NULL);
+		if(ret<0)
+		{
+		    /*
+		     * we fsck'd something up ... let's just get out of here
+		     */
+		    done=1;
+		}
+		else if(ret>0)
+		{
+		    if(FD_ISSET(read_cmd_fd, &rdfd))
+		    {
+			/*
+			 * we have what we came here for. exit this loop
+			 * (but only after processing available shell reads)
+			 */
+			done=1;
+		    }
+
+		    vim_shell_do_read_select(rdfd);
+		}
+	    } // while(!done)
+	}
+#  endif
 #  ifdef VMS
 	len = vms_read(
 #  else
Index: src/getchar.c
===================================================================
--- src/getchar.c	(.../branches/V7_0)	(revision 120)
+++ src/getchar.c	(.../trunk)	(revision 120)
@@ -1711,6 +1711,7 @@
     c = vgetc();
     if (c == NUL)
 	c = get_keystroke();
+
     return c;
 }
 
Index: src/feature.h
===================================================================
--- src/feature.h	(.../branches/V7_0)	(revision 120)
+++ src/feature.h	(.../trunk)	(revision 120)
@@ -1250,6 +1250,15 @@
 #endif
 
 /*
+ * The VIM-Shell. Only works on UNIX for now (more specifically,
+ * only Linux, *BSD and MacOS X, others not tested. Generally, if
+ * a system has a forkpty call, it should be working.)
+ */
+#if defined(FEAT_NORMAL) && (defined(UNIX) || defined(MACOS_X))
+#define FEAT_VIMSHELL
+#endif
+
+/*
  * +autochdir		'autochdir' option.
  */
 #if defined(FEAT_SUN_WORKSHOP) || defined(FEAT_NETBEANS_INTG) \
Index: src/buffer.c
===================================================================
--- src/buffer.c	(.../branches/V7_0)	(revision 120)
+++ src/buffer.c	(.../trunk)	(revision 120)
@@ -557,6 +557,17 @@
 #ifdef FEAT_TCL
     tcl_buffer_free(buf);
 #endif
+#ifdef FEAT_VIMSHELL
+    if(buf->is_shell!=0)
+    {
+	/*
+	 * It is guaranteed that this buffer isn't connected to a 
+	 * window anymore, or else we'd not come up here. So we can
+	 * savely scrap the shell here.
+	 */
+	vim_shell_delete(buf);
+    }
+#endif
     u_blockfree(buf);		    /* free the memory allocated for undo */
     ml_close(buf, TRUE);	    /* close and delete the memline/memfile */
     buf->b_ml.ml_line_count = 0;    /* no lines in buffer */
Index: src/main.c
===================================================================
--- src/main.c	(.../branches/V7_0)	(revision 120)
+++ src/main.c	(.../trunk)	(revision 120)
@@ -182,6 +182,10 @@
      */
     mch_early_init();
 
+#ifdef FEAT_VIMSHELL
+    vim_shell_init();
+#endif
+
     /* Many variables are in "params" so that we can pass them to invoked
      * functions without a lot of arguments.  "argc" and "argv" are also
      * copied, so that they can be changed. */
Index: src/syntax.c
===================================================================
--- src/syntax.c	(.../branches/V7_0)	(revision 120)
+++ src/syntax.c	(.../trunk)	(revision 120)
@@ -5936,6 +5936,10 @@
 syntax_present(buf)
     buf_T	*buf;
 {
+#ifdef FEAT_VIMSHELL
+    if(buf->is_shell!=0)
+	return 0;
+#endif
     return (buf->b_syn_patterns.ga_len != 0
 	    || buf->b_syn_clusters.ga_len != 0
 	    || curbuf->b_keywtab.ht_used > 0
Index: src/eval.c
===================================================================
--- src/eval.c	(.../branches/V7_0)	(revision 120)
+++ src/eval.c	(.../trunk)	(revision 120)
@@ -10923,6 +10923,9 @@
 #if defined(UNIX) && defined(FEAT_X11)
 	"X11",
 #endif
+#ifdef FEAT_VIMSHELL
+	"vimshell",
+#endif
 	NULL
     };
 
Index: src/normal.c
===================================================================
--- src/normal.c	(.../branches/V7_0)	(revision 120)
+++ src/normal.c	(.../trunk)	(revision 120)
@@ -615,10 +615,48 @@
     dont_scroll = FALSE;	/* allow scrolling here */
 #endif
 
+#ifdef FEAT_VIMSHELL
     /*
+     * We reroute ALL characters to the shell, EXCEPT Ctrl_W, so all
+     * Window-Commands should still be working (not unimportant, think of
+     * leaving the window ...)
+     * VIMSHELL TODO: what about mouse commands, GUI commands, etc
+     */
+    if(curbuf->is_shell)
+    {
+	no_mapping++;
+	allow_keys++;
+	c = safe_vgetc();
+	no_mapping--;
+	allow_keys--;
+
+	if(curbuf->is_shell && c!=Ctrl_W)
+	{
+	    if(vim_shell_write(curbuf->shell, c)<0)
+	    {
+		    /*
+		     * The shell died, clean up
+		     */
+		    vim_shell_delete(curbuf);
+		    curbuf->is_shell=0;
+		    curbuf->b_p_ro=FALSE;
+
+		    redraw_later(CLEAR);
+		    update_screen(CLEAR);
+	    }
+	    return;
+	}
+    }
+    else
+    {
+	c = safe_vgetc();
+    }
+#else
+    /*
      * Get the command character from the user.
      */
     c = safe_vgetc();
+#endif
 
 #ifdef FEAT_LANGMAP
     LANGMAP_ADJUST(c, TRUE);
Index: src/Makefile
===================================================================
--- src/Makefile	(.../branches/V7_0)	(revision 120)
+++ src/Makefile	(.../trunk)	(revision 120)
@@ -809,7 +809,6 @@
 ###	 For LynxOS 3.1.0, tested on PC
 #EXTRA_LIBS= -lXext -lSM -lICE -lnetinet -lXmu
 
-
 ### (V)  For CX/UX 6.2	(on Harris/Concurrent NightHawk 4800, 5800). Remove
 ###	 -Qtarget if only in a 5800 environment.  (Kipp E. Howard)
 #CFLAGS = -O -Qtarget=m88110compat
@@ -1259,7 +1258,6 @@
 # Use this for cproto 3 patchlevel 7 or above (use "cproto -V" to check):
 PROTO_FLAGS = -m -M__ARGS -d -E"$(CPP)" $(NO_ATTR)
 
-
 ################################################
 ##   no changes required below this line      ##
 ################################################
@@ -1375,6 +1373,8 @@
 	auto/pathdef.c \
 	popupmnu.c \
 	quickfix.c \
+	vim_shell.c \
+	terminal.c \
 	regexp.c \
 	screen.c \
 	search.c \
@@ -1446,6 +1446,8 @@
 	objects/pathdef.o \
 	objects/popupmnu.o \
 	objects/quickfix.o \
+	objects/vim_shell.o \
+	objects/terminal.o \
 	objects/regexp.o \
 	objects/screen.o \
 	objects/search.o \
@@ -2486,6 +2488,12 @@
 objects/quickfix.o: quickfix.c
 	$(CCC) -o $@ quickfix.c
 
+objects/vim_shell.o: vim_shell.c
+	$(CCC) -o $@ vim_shell.c
+
+objects/terminal.o: terminal.c
+	$(CCC) -o $@ terminal.c
+
 objects/regexp.o: regexp.c
 	$(CCC) -o $@ regexp.c
 
@@ -2748,6 +2756,8 @@
   auto/osdef.h ascii.h keymap.h term.h macros.h option.h structs.h \
   regexp.h gui.h gui_beval.h proto/gui_beval.pro ex_cmds.h proto.h \
   globals.h farsi.h arabic.h
+objects/terminal.o: terminal.c vim_shell.h
+objects/vim_shell.o: vim_shell.c vim_shell.h
 objects/regexp.o: regexp.c vim.h auto/config.h feature.h os_unix.h auto/osdef.h \
   ascii.h keymap.h term.h macros.h option.h structs.h regexp.h gui.h \
   gui_beval.h proto/gui_beval.pro ex_cmds.h proto.h globals.h farsi.h \
Index: src/colines.c
===================================================================
--- src/colines.c	(.../branches/V7_0)	(revision 0)
+++ src/colines.c	(.../trunk)	(revision 120)
@@ -0,0 +1,39 @@
+#include <stdio.h>
+#include <unistd.h>
+#include <stdlib.h>
+#include <signal.h>
+#include <termios.h>
+#include <sys/types.h>
+#include <pty.h>
+
+void sigwinch(int arg)
+{
+	struct winsize ws;
+	printf("window size is now: ");
+
+	if(ioctl(0, TIOCGWINSZ, &ws)<0)
+	{
+		perror("ioctl");
+		return;
+	}
+	printf("rows = %d, cols = %d\n", ws.ws_row, ws.ws_col);
+}
+
+int main()
+{
+	struct sigaction sa;
+	sa.sa_handler=sigwinch;
+	sigemptyset(&sa.sa_mask);
+	sa.sa_flags=0;
+	if(sigaction(SIGWINCH, &sa, NULL)<0)
+	{
+		perror("sigaction");
+		return -1;
+	}
+	sigwinch(0);
+	while(1)
+	{
+		sleep(10);
+	}
+	return 0;
+}

Property changes on: src/colines.c
___________________________________________________________________
Name: svn:keywords
   + author date id revision
Name: svn:eol-style
   + native

Index: src/terminal.c
===================================================================
--- src/terminal.c	(.../branches/V7_0)	(revision 0)
+++ src/terminal.c	(.../trunk)	(revision 120)
@@ -0,0 +1,1931 @@
+/*
+ * terminal.c
+ *
+ * This is the screen-like terminal emulator; it is a better vt100 and supports the
+ * same commands that screen does (including color etc).
+ *
+ * The interface is vim_shell_terminal_input and vim_shell_terminal_output. These 
+ * functions get characters from the shell (or from the user) and process them 
+ * accordingly to the terminal rules (ESC sequences etc). They then work directly 
+ * on the vim_shell-window-buffer, updating its contents.
+ *
+ * VIMSHELL TODO: *) don't scroll scroll region if cursor is outside
+ *                *) change the buffer name according to the window title
+ *                *) CSI (0x9B)
+ *                *) Get the ESC codes for switching charsets from terminfo/termcap
+ *                *) Origin mode
+ *                *) "erase with background color"
+ *
+ * This file is part of the VIM-Shell project. http://vimshell.wana.at
+ *
+ * Author: Thomas Wana <thomas@wana.at>
+ *
+ */
+
+static char *RCSID="$Id$";
+
+#include <string.h>
+#include <stdlib.h>
+#include <unistd.h>
+#include <ctype.h>
+#include <errno.h>
+
+#include "vim.h"
+
+#ifdef VIMSHELL_DEBUG
+#  define ESCDEBUG
+/* 
+ * Really extreme logging
+ * Log *every* character we write to the shell
+ */
+//#  define VERBOSE
+#endif
+
+#ifdef ESCDEBUG
+#  define ESCDEBUGPRINTF(a...) if(vimshell_debug_fp) { fprintf(vimshell_debug_fp, a); fflush(vimshell_debug_fp); }
+#else
+#  define ESCDEBUGPRINTF(a...)
+#endif
+
+#ifdef VERBOSE
+#  define VERBOSEPRINTF(a...) if(vimshell_debug_fp) { fprintf(vimshell_debug_fp, a); fflush(vimshell_debug_fp); }
+#else
+#  define VERBOSEPRINTF(a...)
+#endif
+
+/*
+ * These are the VIM keynames.
+ */
+#define VIMSHELL_KEY_DOWN	K_DOWN
+#define VIMSHELL_KEY_UP		K_UP
+#define VIMSHELL_KEY_LEFT	K_LEFT
+#define VIMSHELL_KEY_RIGHT	K_RIGHT
+#define VIMSHELL_KEY_HOME	K_HOME
+#define VIMSHELL_KEY_BACKSPACE	K_BS
+#define VIMSHELL_KEY_F1		K_F1
+#define VIMSHELL_KEY_F2		K_F2
+#define VIMSHELL_KEY_F3		K_F3
+#define VIMSHELL_KEY_F4		K_F4
+#define VIMSHELL_KEY_F5		K_F5
+#define VIMSHELL_KEY_F6		K_F6
+#define VIMSHELL_KEY_F7		K_F7
+#define VIMSHELL_KEY_F8		K_F8
+#define VIMSHELL_KEY_F9		K_F9
+#define VIMSHELL_KEY_F10	K_F10
+#define VIMSHELL_KEY_F11	K_F11
+#define VIMSHELL_KEY_F12	K_F12
+#define VIMSHELL_KEY_DC		K_DEL
+#define VIMSHELL_KEY_END	K_END
+#define VIMSHELL_KEY_IC		K_INS
+#define VIMSHELL_KEY_NPAGE	K_PAGEDOWN
+#define VIMSHELL_KEY_PPAGE	K_PAGEUP
+#define VIMSHELL_KEY_K0		K_K0
+#define VIMSHELL_KEY_K1		K_K1
+#define VIMSHELL_KEY_K2		K_K2
+#define VIMSHELL_KEY_K3		K_K3
+#define VIMSHELL_KEY_K4		K_K4
+#define VIMSHELL_KEY_K5		K_K5
+#define VIMSHELL_KEY_K6		K_K6
+#define VIMSHELL_KEY_K7		K_K7
+#define VIMSHELL_KEY_K8		K_K8
+#define VIMSHELL_KEY_K9		K_K9
+#define VIMSHELL_KEY_KPLUS	K_KPLUS
+#define VIMSHELL_KEY_KMINUS	K_KMINUS
+#define VIMSHELL_KEY_KDIVIDE	K_KDIVIDE
+#define VIMSHELL_KEY_KMULTIPLY	K_KMULTIPLY
+#define VIMSHELL_KEY_KENTER	K_KENTER
+#define VIMSHELL_KEY_KPOINT	K_KPOINT
+
+static void terminal_ED(struct vim_shell_window *shell, int argc, char argv[20][20]);
+static void terminal_CUP(struct vim_shell_window *shell, int argc, char argv[20][20]);
+static int terminal_flush_output(struct vim_shell_window *shell);
+
+/*
+ * A routine that prints a buffer in 'hexdump -C'-style via printf
+ */
+static void hexdump(FILE *fp, unsigned char *buffer, long len)
+{
+	unsigned long pos=0;
+
+	while(len>0)
+	{
+		int i;
+		fprintf(fp,"%08x  ",(unsigned int)pos);
+		for(i=0;i<16 && i<len;i++)
+		{
+			fprintf(fp,"%02x ",buffer[pos+i]);
+			if(i==7 || i==15)
+				fprintf(fp," ");
+		}
+		fprintf(fp,"|");
+		for(i=0;i<16 && i<len;i++)
+		{
+			unsigned char c=buffer[pos+i];
+			if(isprint(c))
+			{
+				fprintf(fp,"%c",c);
+			}
+			else
+			{
+				fprintf(fp,".");
+			}
+		}
+		fprintf(fp,"|\n");
+		len-=16;
+		pos+=16;
+	}
+}
+
+/*
+ * Tabulation Clear (TBC) 	
+ *
+ * 9/11 6/7
+ * CSI   g
+ *
+ * 	Clears a horizontal tab stop at cursor position.
+ *
+ * 	9/11 3/0 6/7 
+ * 	CSI   0   g
+ *
+ * 		Clears a horizontal tab stop at cursor position.
+ *
+ * 		9/11 3/3 6/7 
+ * 		CSI   3   g
+ *
+ * 			Clears all horizontal tab stops.
+ */
+static void terminal_TBC(struct vim_shell_window *shell, int argc, char argv[20][20])
+{
+	int param;
+
+	if(argc==0)
+	{
+		param=0;
+	}
+	else if(argc>1)
+	{
+		ESCDEBUGPRINTF("%s: sequence error\n", __FUNCTION__);
+		return;
+	}
+
+	// VIMSHELL TODO: DRINGEND! wenn argc==0 dann ist argv[0] NULL und wir crashen
+	// hier ... passiert in einigen Funktionen, dank copy+paste! Super gmocht Tom!
+	param=strtol(argv[0], NULL, 10);
+	switch(param)
+	{
+		case 0:
+			shell->tabline[shell->cursor_x]=0;
+			break;
+		case 3:
+			memset(shell->tabline, 0, shell->size_x);
+			break;
+		default:
+			ESCDEBUGPRINTF( "%s: sequence error (2)\n", __FUNCTION__);
+	}
+}
+
+/*
+ * CUB . Cursor Backward . Host to VT100 and VT100 to Host
+ * ESC [ Pn D 	default value: 1
+ *
+ * The CUB sequence moves the active position to the left. The distance moved is 
+ * determined by the parameter. If the parameter value is zero or one, the active 
+ * position is moved one position to the left. If the parameter value is n, the active 
+ * position is moved n positions to the left. If an attempt is made to move the cursor 
+ * to the left of the left margin, the cursor stops at the left margin. Editor Function
+ */
+static void terminal_CUB(struct vim_shell_window *shell, int argc, char argv[20][20])
+{
+	int distance;
+
+	if(argc==0)
+	{
+		distance=1;
+	}
+	else if(argc>1)
+	{
+		ESCDEBUGPRINTF( "%s: sequence error\n", __FUNCTION__);
+		return;
+	}
+
+	distance=strtol(argv[0], NULL, 10);
+	if(distance==0)
+		distance=1;
+
+	if(shell->cursor_x<distance)
+		shell->cursor_x=0;
+	else
+		shell->cursor_x-=distance;
+}
+
+/*
+ * CUU . Cursor Up . Host to VT100 and VT100 to Host
+ * ESC [ Pn A 	default value: 1
+ *
+ * Moves the active position upward without altering the column position. The 
+ * number of lines moved is determined by the parameter. A parameter value of zero 
+ * or one moves the active position one line upward. A parameter value of n moves the 
+ * active position n lines upward. If an attempt is made to move the cursor above the 
+ * top margin, the cursor stops at the top margin. Editor Function
+ */
+static void terminal_CUU(struct vim_shell_window *shell, int argc, char argv[20][20])
+{
+	int distance;
+
+	if(argc==0)
+	{
+		distance=1;
+	}
+	else if(argc>1)
+	{
+		ESCDEBUGPRINTF( "%s: sequence error\n", __FUNCTION__);
+		return;
+	}
+
+	distance=strtol(argv[0], NULL, 10);
+	if(distance==0)
+		distance=1;
+
+	if((int)shell->cursor_y-distance<shell->scroll_top_margin)
+		shell->cursor_y=shell->scroll_top_margin;
+	else
+		shell->cursor_y-=distance;
+}
+
+
+/*
+ * CUD . Cursor Down . Host to VT100 and VT100 to Host
+ * ESC [ Pn B 	default value: 1
+ *
+ * The CUD sequence moves the active position downward without altering the column 
+ * position. The number of lines moved is determined by the parameter. If the parameter 
+ * value is zero or one, the active position is moved one line downward. If the parameter 
+ * value is n, the active position is moved n lines downward. In an attempt is made to 
+ * move the cursor below the bottom margin, the cursor stops at the bottom margin. Editor Function
+ */
+static void terminal_CUD(struct vim_shell_window *shell, int argc, char argv[20][20])
+{
+	int distance;
+
+	if(argc==0)
+	{
+		distance=1;
+	}
+	else if(argc>1)
+	{
+		ESCDEBUGPRINTF( "%s: sequence error\n", __FUNCTION__);
+		return;
+	}
+
+	distance=strtol(argv[0], NULL, 10);
+	if(distance==0)
+		distance=1;
+
+	shell->cursor_y+=distance;
+	if(shell->cursor_y+1>=shell->scroll_bottom_margin)
+		shell->cursor_y=shell->scroll_bottom_margin;
+}
+
+/*
+ * CUF . Cursor Forward . Host to VT100 and VT100 to Host
+ * ESC [ Pn C 	default value: 1
+ *
+ * The CUF sequence moves the active position to the right. The distance moved is 
+ * determined by the parameter. A parameter value of zero or one moves the active 
+ * position one position to the right. A parameter value of n moves the active position n 
+ * positions to the right. If an attempt is made to move the cursor to the right 
+ * of the right margin, the cursor stops at the right margin. Editor Function
+ */
+static void terminal_CUF(struct vim_shell_window *shell, int argc, char argv[20][20])
+{
+	int distance;
+
+	if(argc==0)
+	{
+		distance=1;
+	}
+	else if(argc>1)
+	{
+		ESCDEBUGPRINTF( "%s: sequence error\n", __FUNCTION__);
+		return;
+	}
+
+	distance=strtol(argv[0], NULL, 10);
+	if(distance==0)
+		distance=1;
+
+	shell->cursor_x+=distance;
+	if(shell->cursor_x+1>=shell->size_x)
+		shell->cursor_x=shell->size_x+1;
+}
+
+/*
+ * SGR . Select Graphic Rendition
+ * ESC [ Ps ; . . . ; Ps m 	default value: 0
+ *
+ * Invoke the graphic rendition specified by the parameter(s). All following characters 
+ * transmitted to the VT100 are rendered according to the parameter(s) until the next 
+ * occurrence of SGR. Format Effector
+ * 
+ * Parameter 	Parameter Meaning
+ * 0 	Attributes off
+ * 1 	Bold or increased intensity
+ * 4 	Underscore
+ * 5 	Blink
+ * 7 	Negative (reverse) image
+ *
+ * All other parameter values are ignored.
+ *
+ * With the Advanced Video Option, only one type of character attribute is possible as 
+ * determined by the cursor selection; in that case specifying either the underscore or 
+ * the reverse attribute will activate the currently selected attribute. (See cursor 
+ * selection in Chapter 1).
+ */
+static void terminal_SGR(struct vim_shell_window *shell, int argc, char argv[20][20])
+{
+	if(argc==0)
+	{
+		shell->rendition=0;
+		shell->fgcolor=VIMSHELL_COLOR_DEFAULT;  // default fgcolor
+		shell->bgcolor=VIMSHELL_COLOR_DEFAULT;  // default bgcolor
+	}
+	else
+	{
+		int i;
+		for(i=0;i<argc;i++)
+		{
+			int val;
+			switch((val=strtol(argv[i], NULL, 10)))
+			{
+				case 0:
+					shell->rendition=0;
+					shell->fgcolor=VIMSHELL_COLOR_DEFAULT;
+					shell->bgcolor=VIMSHELL_COLOR_DEFAULT;
+					break;
+				case 1:
+					shell->rendition|=RENDITION_BOLD;
+					break;
+				case 2:
+					shell->rendition|=RENDITION_DIM;
+					break;
+				case 4:
+					shell->rendition|=RENDITION_UNDERSCORE;
+					break;
+				case 5:
+					shell->rendition|=RENDITION_BLINK;
+					break;
+				case 7:
+					shell->rendition|=RENDITION_NEGATIVE;
+					break;
+				case 8:
+					shell->rendition|=RENDITION_HIDDEN;
+					break;
+				case 22:
+					shell->rendition&=~RENDITION_BOLD;
+					break;
+				case 24:
+					shell->rendition&=~RENDITION_UNDERSCORE;
+					break;
+				case 25:
+					shell->rendition&=~RENDITION_BLINK;
+					break;
+				case 27:
+					shell->rendition&=~RENDITION_NEGATIVE;
+					break;
+				default:
+					if(val>=30 && val<=37)
+						shell->fgcolor=val-30;
+					else if(val>=40 && val<=47)
+						shell->bgcolor=val-40;
+					else if(val==39)
+						shell->fgcolor=VIMSHELL_COLOR_DEFAULT; // default fgcolor
+					else if(val==49)
+						shell->bgcolor=VIMSHELL_COLOR_DEFAULT; // default bgcolor
+					else
+						ESCDEBUGPRINTF( "%s: unknown rendition %s\n",
+								__FUNCTION__, argv[i]);
+			}
+		}
+	}
+	ESCDEBUGPRINTF("%s: rendition is now: %04x\n", __FUNCTION__, shell->rendition);
+	ESCDEBUGPRINTF("%s: foreground color: %d, background color: %d\n", __FUNCTION__, 
+			shell->fgcolor, shell->bgcolor);
+}
+
+/*
+ * Copy the screen contents to the alternate screen.
+ */
+static void terminal_backup_screen(struct vim_shell_window *shell)
+{
+	size_t len;
+	if(shell->alt!=NULL)
+	{
+		ESCDEBUGPRINTF( "%s: WARNING: alternate screen taken\n", __FUNCTION__);
+		vim_shell_free(shell->alt->winbuf);
+		vim_shell_free(shell->alt->bgbuf);
+		vim_shell_free(shell->alt->fgbuf);
+		vim_shell_free(shell->alt->rendbuf);
+		vim_shell_free(shell->alt->tabline);
+		vim_shell_free(shell->alt->charset);
+		vim_shell_free(shell->alt);
+		shell->alt=NULL;
+	}
+
+	shell->alt=(struct vim_shell_window *)vim_shell_malloc(sizeof(struct vim_shell_window));
+	if(shell->alt==NULL)
+	{
+		ESCDEBUGPRINTF( "%s: ERROR: unable to allocate a new screen\n", __FUNCTION__);
+		return;
+	}
+
+	*(shell->alt)=*shell;
+
+	len=shell->size_x*shell->size_y;
+	shell->alt->winbuf=(uint8_t *)vim_shell_malloc(len);
+	shell->alt->fgbuf=(uint8_t *)vim_shell_malloc(len);
+	shell->alt->bgbuf=(uint8_t *)vim_shell_malloc(len);
+	shell->alt->rendbuf=(uint8_t *)vim_shell_malloc(len);
+	shell->alt->tabline=(uint8_t *)vim_shell_malloc(shell->size_x);
+	shell->alt->charset=(uint8_t *)vim_shell_malloc(len);
+	if(shell->alt->winbuf==NULL || shell->alt->winbuf==NULL || shell->alt->winbuf==NULL || shell->alt->winbuf==NULL ||
+			shell->alt->charset==NULL || shell->alt->tabline==NULL)
+	{
+		ESCDEBUGPRINTF( "%s: ERROR: unable to allocate buffers\n", __FUNCTION__);
+		if(shell->alt->winbuf) vim_shell_free(shell->alt->winbuf);
+		if(shell->alt->fgbuf) vim_shell_free(shell->alt->fgbuf);
+		if(shell->alt->bgbuf) vim_shell_free(shell->alt->bgbuf);
+		if(shell->alt->rendbuf) vim_shell_free(shell->alt->rendbuf);
+		if(shell->alt->tabline) vim_shell_free(shell->alt->tabline);
+		if(shell->alt->charset) vim_shell_free(shell->alt->charset);
+		vim_shell_free(shell->alt);
+		shell->alt=NULL;
+		return;
+	}
+
+	memcpy(shell->alt->winbuf, shell->winbuf, len);
+	memcpy(shell->alt->fgbuf, shell->fgbuf, len);
+	memcpy(shell->alt->bgbuf, shell->bgbuf, len);
+	memcpy(shell->alt->rendbuf, shell->rendbuf, len);
+	memcpy(shell->alt->charset, shell->charset, len);
+	memcpy(shell->alt->tabline, shell->tabline, shell->size_x);
+}
+
+/*
+ * Restore the alternate screen
+ */
+static void terminal_restore_screen(struct vim_shell_window *shell)
+{
+	struct vim_shell_window *alt;
+	if(shell->alt==NULL)
+	{
+		ESCDEBUGPRINTF( "%s: WARNING: nothing to restore\n", __FUNCTION__);
+		return;
+	}
+
+	vim_shell_free(shell->winbuf);
+	vim_shell_free(shell->rendbuf);
+	vim_shell_free(shell->tabline);
+	vim_shell_free(shell->fgbuf);
+	vim_shell_free(shell->bgbuf);
+	vim_shell_free(shell->charset);
+
+	alt=shell->alt;
+	*shell=*(shell->alt);
+	shell->alt=NULL;
+
+	vim_shell_free(alt);
+
+	/*
+	 * Invalidate the shell so it will be fully redrawn
+	 */
+	shell->force_redraw=1;
+}
+
+/*
+ * Erases the whole screen and homes the cursor.
+ */
+static void terminal_init_screen(struct vim_shell_window *shell)
+{
+	char ed_argv[20][20];
+
+	strcpy(ed_argv[0], "2");
+
+	/*
+	 * Erase all of the display.
+	 */
+	terminal_ED(shell, 1, ed_argv);
+
+	/*
+	 * Cursor to HOME position.
+	 */
+	terminal_CUP(shell, 0, NULL);
+}
+
+static void terminal_mode(struct vim_shell_window *shell, int set, int argc, char argv[20][20])
+{
+	int i;
+
+	for(i=0;i<argc;i++)
+	{
+		if(!strcmp(argv[i], "4"))
+		{
+			shell->insert_mode=set;
+			ESCDEBUGPRINTF( "%s: insert mode: %d\n", __FUNCTION__, set);
+		}
+		else if(!strcmp(argv[i], "?1"))
+		{
+			shell->application_cursor_mode=set;
+			ESCDEBUGPRINTF( "%s: application cursor mode: %d\n", __FUNCTION__, set);
+		}
+		else if(!strcmp(argv[i], "?5"))
+		{
+			ESCDEBUGPRINTF("%s: background dark/light mode ignored\n", __FUNCTION__);
+		}
+		else if(!strcmp(argv[i], "?6"))
+		{
+			ESCDEBUGPRINTF("%s: set terminal width ignored\n", __FUNCTION__);
+		}
+		else if(!strcmp(argv[i], "?7"))
+		{
+			shell->wraparound=set;
+			ESCDEBUGPRINTF( "%s: wraparound: %d\n", __FUNCTION__, set);
+		}
+		else if(!strcmp(argv[i], "34") || !strcmp(argv[i], "?25"))
+		{
+			shell->cursor_visible=set;
+			ESCDEBUGPRINTF( "%s: cursor visible: %d\n", __FUNCTION__, set);
+		}
+		else if(!strcmp(argv[i], "?4"))
+		{
+			ESCDEBUGPRINTF("%s: selection between smooth and jump scrolling ignored\n",__FUNCTION__);
+		}
+		else if(!strcmp(argv[i], "?1049") || !strcmp(argv[i], "?1047"))
+		{
+			if(set==1)
+			{
+				terminal_backup_screen(shell);
+				terminal_init_screen(shell);
+				ESCDEBUGPRINTF( "%s: terminal screen backed up.\n", __FUNCTION__);
+			}
+			else
+			{
+				terminal_restore_screen(shell);
+				ESCDEBUGPRINTF( "%s: terminal screen restored from backup.\n", __FUNCTION__);
+			}
+		}
+		else
+		{
+			ESCDEBUGPRINTF( "%s: unimplemented terminal mode: %s\n", __FUNCTION__, argv[i]);
+		}
+	}
+}
+
+/*
+ * EL . Erase In Line
+ * ESC [ Ps K 	default value: 0
+ *
+ * Erases some or all characters in the active line according to the parameter. Editor Function
+ *
+ * Parameter 	Parameter Meaning
+ * 0 	Erase from the active position to the end of the line, inclusive (default)
+ * 1 	Erase from the start of the line to the active position, inclusive
+ * 2 	Erase all of the line, inclusive
+ */
+static void terminal_EL(struct vim_shell_window *shell, int argc, char argv[20][20])
+{
+	int i, size, pos;
+
+	if(argc==0)
+		i=0;
+	else if(argc==1)
+		i=strtol(argv[0], NULL, 10);
+	else
+	{
+		/*
+		 * Error in sequence
+		 */
+		ESCDEBUGPRINTF( "%s: error in sequence\n", __FUNCTION__);
+		return;
+	}
+
+	size=shell->size_x*shell->size_y;
+	pos=shell->cursor_y*shell->size_x+shell->cursor_x;
+	if(i==0)
+	{
+		/*
+		 * erase from the active position to the end of line
+		 */
+
+		memset(shell->winbuf+pos, ' ', shell->size_x-shell->cursor_x);
+		memset(shell->fgbuf+pos,  VIMSHELL_COLOR_DEFAULT, shell->size_x-shell->cursor_x);
+		memset(shell->bgbuf+pos,  VIMSHELL_COLOR_DEFAULT, shell->size_x-shell->cursor_x);
+		memset(shell->rendbuf+pos, 0, shell->size_x-shell->cursor_x);
+		memset(shell->charset+pos, 0, shell->size_x-shell->cursor_x);
+		ESCDEBUGPRINTF( "%s: erase from active position to end of line\n", __FUNCTION__);
+
+	}
+	else if(i==1)
+	{
+		/*
+		 * erase from start of the line to the active position, inclusive
+		 */
+
+		memset(shell->winbuf+shell->cursor_y*shell->size_x, ' ', shell->cursor_x);
+		memset(shell->fgbuf+ shell->cursor_y*shell->size_x, VIMSHELL_COLOR_DEFAULT, shell->cursor_x);
+		memset(shell->bgbuf+ shell->cursor_y*shell->size_x, VIMSHELL_COLOR_DEFAULT, shell->cursor_x);
+		memset(shell->rendbuf+shell->cursor_y*shell->size_x, 0, shell->cursor_x);
+		memset(shell->charset+shell->cursor_y*shell->size_x, 0, shell->cursor_x);
+		ESCDEBUGPRINTF( "%s: erase from start of line to active position\n", __FUNCTION__);
+	}
+	else if(i==2)
+	{
+		/*
+		 * Erase all of the line
+		 */
+
+		memset(shell->winbuf +shell->cursor_y*shell->size_x, ' ', shell->size_x);
+		memset(shell->fgbuf  +shell->cursor_y*shell->size_x, VIMSHELL_COLOR_DEFAULT, shell->size_x);
+		memset(shell->bgbuf  +shell->cursor_y*shell->size_x, VIMSHELL_COLOR_DEFAULT, shell->size_x);
+		memset(shell->rendbuf+shell->cursor_y*shell->size_x, 0, shell->size_x);
+		memset(shell->charset+shell->cursor_y*shell->size_x, 0, shell->size_x);
+		ESCDEBUGPRINTF( "%s: erase all of the line\n", __FUNCTION__);
+	}
+	else
+	{
+		ESCDEBUGPRINTF( "%s: error in sequence (2)\n", __FUNCTION__);
+		return;
+	}
+}
+
+/*
+ * ED . Erase In Display
+ * ESC [ Ps J 	default value: 0
+ *
+ * This sequence erases some or all of the characters in the display according 
+ * to the parameter. Any complete line erased by this sequence will return that 
+ * line to single width mode. Editor Function
+ *
+ * Parameter 	Parameter Meaning
+ * 0 	Erase from the active position to the end of the screen, inclusive (default)
+ * 1 	Erase from start of the screen to the active position, inclusive
+ * 2 	Erase all of the display . all lines are erased, changed to single-width, and the cursor does not move.
+ */
+static void terminal_ED(struct vim_shell_window *shell, int argc, char argv[20][20])
+{
+	int i, size, pos;
+
+	if(argc==0)
+		i=0;
+	else if(argc==1)
+		i=strtol(argv[0], NULL, 10);
+	else
+	{
+		/*
+		 * Error in sequence
+		 */
+		ESCDEBUGPRINTF( "%s: error in sequence\n", __FUNCTION__);
+		return;
+	}
+
+	size=shell->size_x*shell->size_y;
+	pos=shell->cursor_y*shell->size_x+shell->cursor_x;
+	if(i==0)
+	{
+		/*
+		 * erase from the active position to the end of screen
+		 */
+
+		memset(shell->winbuf+pos, ' ', size-pos);
+		memset(shell->fgbuf+pos, VIMSHELL_COLOR_DEFAULT, size-pos);
+		memset(shell->bgbuf+pos, VIMSHELL_COLOR_DEFAULT, size-pos);
+		memset(shell->rendbuf+pos, 0, size-pos);
+		memset(shell->charset+pos, 0, size-pos);
+		ESCDEBUGPRINTF( "%s: erase from active position to end of screen\n", __FUNCTION__);
+
+	}
+	else if(i==1)
+	{
+		/*
+		 * erase from start of the screen to the active position, inclusive
+		 */
+
+		memset(shell->winbuf, ' ', pos);
+		memset(shell->fgbuf, VIMSHELL_COLOR_DEFAULT, pos);
+		memset(shell->bgbuf, VIMSHELL_COLOR_DEFAULT, pos);
+		memset(shell->rendbuf, 0, pos);
+		memset(shell->charset, 0, pos);
+		ESCDEBUGPRINTF( "%s: erase from start of screen to active position\n", __FUNCTION__);
+	}
+	else if(i==2)
+	{
+		/*
+		 * Erase all of the display
+		 */
+
+		memset(shell->winbuf, ' ', size);
+		memset(shell->fgbuf, VIMSHELL_COLOR_DEFAULT, size);
+		memset(shell->bgbuf, VIMSHELL_COLOR_DEFAULT, size);
+		memset(shell->rendbuf, 0, size);
+		memset(shell->charset, 0, size);
+		ESCDEBUGPRINTF( "%s: erase all of the display\n", __FUNCTION__);
+	}
+	else
+	{
+		ESCDEBUGPRINTF( "%s: error in sequence (2)\n", __FUNCTION__);
+		return;
+	}
+}
+
+/*
+ * CUP . Cursor Position
+ * ESC [ Pn ; Pn H 	default value: 1
+ *
+ * The CUP sequence moves the active position to the position specified by 
+ * the parameters. This sequence has two parameter values, the first specifying 
+ * the line position and the second specifying the column position. A parameter 
+ * value of zero or one for the first or second parameter moves the active 
+ * position to the first line or column in the display, respectively. The default 
+ * condition with no parameters present is equivalent to a cursor to home action. 
+ * In the VT100, this control behaves identically with its format effector 
+ * counterpart, HVP. Editor Function
+ *
+ * The numbering of lines depends on the state of the Origin Mode (DECOM).
+ */
+static void terminal_CUP(struct vim_shell_window *shell, int argc, char argv[20][20])
+{
+	if(argc==0)
+	{
+		/*
+		 * goto home position
+		 */
+		shell->cursor_x=0;
+		shell->cursor_y=0;
+	}
+	else if(argc==2)
+	{
+		int x, y;
+
+		y=strtol(argv[0], NULL, 10);
+		x=strtol(argv[1], NULL, 10);
+		if(x==0)
+			x++;
+		if(y==0)
+			y++;
+
+		shell->cursor_y=y-1;
+		shell->cursor_x=x-1;
+
+		// VIMSHELL TODO: if origin mode enabled, position at the
+		//                top margin or so :)
+
+		if(shell->cursor_x>=shell->size_x)
+			shell->cursor_x=shell->size_x-1;
+		if(shell->cursor_y>=shell->size_y)
+			shell->cursor_y=shell->size_y-1;
+	}
+	else
+	{
+		/*
+		 * Error in sequence
+		 */
+		ESCDEBUGPRINTF( "%s: error in sequence\n", __FUNCTION__);
+		return;
+	}
+	ESCDEBUGPRINTF( "%s: moved to X = %d, Y = %d\n", __FUNCTION__, shell->cursor_x, shell->cursor_y);
+}
+
+/*
+ * DECSTBM . Set Top and Bottom Margins (DEC Private)
+ * ESC [ Pn; Pn r 	default values: see below
+ *
+ * This sequence sets the top and bottom margins to define the scrolling region. 
+ * The first parameter is the line number of the first line in the scrolling region; the 
+ * second parameter is the line number of the bottom line in the scrolling region. Default 
+ * is the entire screen (no margins). The minimum size of the scrolling region allowed is 
+ * two lines, i.e., the top margin must be less than the bottom margin. The cursor is placed 
+ * in the home position (see Origin Mode DECOM).
+ */
+static void terminal_DECSTBM(struct vim_shell_window *shell, int argc, char argv[20][20])
+{
+	if(argc!=2)
+	{
+		ESCDEBUGPRINTF( "%s: sequence error\n", __FUNCTION__);
+		return;
+	}
+
+	shell->scroll_top_margin=strtol(argv[0], NULL, 10)-1;
+	shell->scroll_bottom_margin=strtol(argv[1], NULL, 10)-1;
+	
+	ESCDEBUGPRINTF( "%s: top margin = %d, bottom margin = %d\n", __FUNCTION__,
+			shell->scroll_top_margin, shell->scroll_bottom_margin);
+
+	if(shell->scroll_top_margin>=shell->scroll_bottom_margin)
+	{
+		ESCDEBUGPRINTF( "%s: scroll margin error %d >= %d\n", __FUNCTION__,
+				shell->scroll_top_margin, shell->scroll_bottom_margin);
+
+		shell->scroll_top_margin=0;
+		shell->scroll_bottom_margin=shell->size_y-1;
+		
+		return;
+	}
+
+	// Move cursor into home position
+	terminal_CUP(shell, 0, NULL);
+}
+
+
+// Status: 100%
+static void terminal_scroll_up(struct vim_shell_window *shell)
+{
+	// VIMSHELL TODO: maintain a scrollback buffer? copy the first line into
+	// a scrollback buffer.
+	
+	/*
+	 * scroll up by moving up the screen buffer a whole line. blank out
+	 * the last line.
+	 */
+	int len, from, to;
+
+	ESCDEBUGPRINTF( "%s: done\n", __FUNCTION__);
+
+	len=shell->scroll_bottom_margin-shell->scroll_top_margin;
+	len*=shell->size_x;
+
+	to=shell->scroll_top_margin*shell->size_x;
+	from=shell->size_x+shell->scroll_top_margin*shell->size_x;
+	
+	memmove(shell->winbuf+to, shell->winbuf+from, len);
+	memmove(shell->fgbuf+to, shell->fgbuf+from, len);
+	memmove(shell->bgbuf+to, shell->bgbuf+from, len);
+	memmove(shell->rendbuf+to, shell->rendbuf+from, len);
+	memmove(shell->charset+to, shell->charset+from, len);
+	
+	memset(shell->winbuf+shell->scroll_bottom_margin*shell->size_x, ' ', shell->size_x);
+	memset(shell->fgbuf+shell->scroll_bottom_margin*shell->size_x, VIMSHELL_COLOR_DEFAULT, shell->size_x);
+	memset(shell->bgbuf+shell->scroll_bottom_margin*shell->size_x, VIMSHELL_COLOR_DEFAULT, shell->size_x);
+	memset(shell->rendbuf+shell->scroll_bottom_margin*shell->size_x, 0, shell->size_x);
+	memset(shell->charset+shell->scroll_bottom_margin*shell->size_x, 0, shell->size_x);
+}
+
+// Status: unknown
+static void terminal_scroll_down(struct vim_shell_window *shell)
+{
+	/*
+	 * scroll down by moving the screen buffer down a whole line, overwriting
+	 * the last line. Then, blank out the first line.
+	 */
+	size_t len;
+	int from, to;
+
+	ESCDEBUGPRINTF( "%s: done\n", __FUNCTION__);
+
+	len=shell->scroll_bottom_margin-shell->scroll_top_margin;
+	len*=shell->size_x;
+
+	to=shell->scroll_top_margin*shell->size_x+shell->size_x;
+	from=shell->scroll_top_margin*shell->size_x;
+
+	memmove(shell->winbuf+to, shell->winbuf+from, len);
+	memmove(shell->fgbuf+to, shell->fgbuf+from, len);
+	memmove(shell->bgbuf+to, shell->bgbuf+from, len);
+	memmove(shell->rendbuf+to, shell->rendbuf+from, len);
+	memmove(shell->charset+to, shell->charset+from, len);
+
+	memset(shell->winbuf+from, ' ', shell->size_x);
+	memset(shell->fgbuf+from, VIMSHELL_COLOR_DEFAULT, shell->size_x);
+	memset(shell->bgbuf+from, VIMSHELL_COLOR_DEFAULT, shell->size_x);
+	memset(shell->rendbuf+from, 0, shell->size_x);
+	memset(shell->charset+from, 0, shell->size_x);
+}
+
+/*
+ * Insert Line(s) (ANSI).
+ * ESC [ Pn L
+ * Inserts Pn lines at the cursor. If fewer than Pn lines remain from the current line to the 
+ * end of the scrolling region, the number of lines inserted is the lesser number. Lines within 
+ * the scrolling region at and below the cursor move down. Lines moved past the bottom margin 
+ * are lost. The cursor is reset to the first column. This sequence is ignored when the 
+ * cursor is outside the scrolling region.
+ */
+// Status: unknown
+static void terminal_IL(struct vim_shell_window *shell, int argc, char argv[20][20])
+{
+	int lines, bak_top;
+	if(argc>1)
+	{
+		ESCDEBUGPRINTF( "%s: sequence error\n", __FUNCTION__);
+		return;
+	}
+
+	if(argc==0)
+		lines=1;
+	else
+	{
+		lines=strtol(argv[0], NULL, 10);
+		if(lines==0)
+			lines=1;
+	}
+
+	if(shell->scroll_bottom_margin-shell->cursor_y < lines)
+		lines=shell->scroll_bottom_margin-shell->cursor_y;
+
+	bak_top=shell->scroll_top_margin;
+
+	ESCDEBUGPRINTF( "%s: inserted %d lines\n", __FUNCTION__, lines);
+
+	/*
+	 * Set a scrolling region around the part we want to move and scroll down 'lines' times.
+	 */
+	shell->scroll_top_margin=shell->cursor_y;
+	while(lines--)
+		terminal_scroll_down(shell);
+	
+	shell->scroll_top_margin=bak_top;
+
+	shell->cursor_x=0;
+}
+
+/*
+ * Delete Line(s) (ANSI).
+ * ESC [ Pn M
+ * Deletes Pn lines starting at the line with the cursor. If fewer than Pn lines remain from 
+ * the current line to the end of the scrolling region, the number of lines deleted is the 
+ * lesser number. As lines are deleted, lines within the scrolling region and below the cursor move 
+ * up, and blank lines are added at the bottom of the scrolling region. The cursor is reset to the 
+ * first column. This sequence is ignored when the cursor is outside the scrolling region.
+ * VIMSHELL TODO last sentence
+ */
+// Status: unknown
+static void terminal_DL(struct vim_shell_window *shell, int argc, char argv[20][20])
+{
+	int lines, bak_top;
+	if(argc>1)
+	{
+		ESCDEBUGPRINTF( "%s: sequence error\n", __FUNCTION__);
+		return;
+	}
+
+	if(argc==0)
+		lines=1;
+	else
+	{
+		lines=strtol(argv[0], NULL, 10);
+		if(lines==0)
+			lines=1;
+	}
+
+	if(shell->scroll_bottom_margin-shell->cursor_y < lines)
+		lines=shell->scroll_bottom_margin-shell->cursor_y;
+
+	bak_top=shell->scroll_top_margin;
+
+	ESCDEBUGPRINTF( "%s: deleted %d lines\n", __FUNCTION__, lines);
+
+	/*
+	 * Set a scrolling region around the part we want to move and scroll up 'lines' times.
+	 */
+	shell->scroll_top_margin=shell->cursor_y;
+	while(lines--)
+		terminal_scroll_up(shell);
+	
+	shell->scroll_top_margin=bak_top;
+
+	shell->cursor_x=0;
+}
+
+/*
+ * Insert Characters (ANSI)
+ * ESC [ Pn @
+ * Insert Pn blank characters at the cursor position, with the character attributes set to 
+ * normal. The cursor does not move and remains at the beginning of the inserted blank characters. 
+ * A parameter of 0 or 1 inserts one blank character. Data on the line is shifted forward as 
+ * in character insertion.
+ */
+static void terminal_ICH(struct vim_shell_window *shell, int argc, char argv[20][20])
+{
+	int chars;
+	int curpos;
+	size_t len;
+	if(argc>1)
+	{
+		ESCDEBUGPRINTF( "%s: sequence error\n", __FUNCTION__);
+		return;
+	}
+
+	if(argc==0)
+		chars=1;
+	else
+	{
+		chars=strtol(argv[0], NULL, 10);
+		if(chars==0)
+			chars=1;
+	}
+
+	curpos=shell->cursor_y*shell->size_x+shell->cursor_x;
+	len=shell->size_x-shell->cursor_x-1;
+	
+	ESCDEBUGPRINTF( "%s: inserted %d characters\n", __FUNCTION__, chars);
+	
+	while(chars--)
+	{
+		memmove(shell->winbuf+curpos+1, shell->winbuf+curpos, len);
+		memmove(shell->fgbuf+curpos+1, shell->fgbuf+curpos, len);
+		memmove(shell->bgbuf+curpos+1, shell->bgbuf+curpos, len);
+		memmove(shell->rendbuf+curpos+1, shell->rendbuf+curpos, len);
+		memmove(shell->charset+curpos+1, shell->charset+curpos, len);
+
+		memset(shell->winbuf+curpos, ' ', 1);
+		memset(shell->fgbuf+curpos, VIMSHELL_COLOR_DEFAULT, 1);
+		memset(shell->bgbuf+curpos, VIMSHELL_COLOR_DEFAULT, 1);
+		memset(shell->rendbuf+curpos, 0, 1);
+		memset(shell->charset+curpos, 0, 1);
+	}
+}
+
+/*
+ * Delete Characters (ANSI)
+ * ESC [ Pn P
+ * Deletes Pn characters starting with the character at the cursor position. When a character 
+ * is deleted, all characters to the right of the cursor move to the left. This creates a space 
+ * character at the right margin for each character deleted. Character attributes move with the 
+ * characters. The spaces created at the end of the line have all their character attributes off.
+ */
+static void terminal_DCH(struct vim_shell_window *shell, int argc, char argv[20][20])
+{
+	int chars;
+	int curpos;
+	size_t len;
+	if(argc>1)
+	{
+		ESCDEBUGPRINTF( "%s: sequence error\n", __FUNCTION__);
+		return;
+	}
+
+	if(argc==0)
+		chars=1;
+	else
+	{
+		chars=strtol(argv[0], NULL, 10);
+		if(chars==0)
+			chars=1;
+	}
+
+	curpos=shell->cursor_y*shell->size_x+shell->cursor_x;
+	len=shell->size_x-shell->cursor_x-1;
+
+	ESCDEBUGPRINTF( "%s: deleted %d characters\n", __FUNCTION__, chars);
+	
+	while(chars--)
+	{
+		memmove(shell->winbuf+curpos, shell->winbuf+curpos+1, len);
+		memmove(shell->fgbuf+curpos, shell->fgbuf+curpos+1, len);
+		memmove(shell->bgbuf+curpos, shell->bgbuf+curpos+1, len);
+		memmove(shell->rendbuf+curpos, shell->rendbuf+curpos+1, len);
+		memmove(shell->charset+curpos, shell->charset+curpos+1, len);
+
+		memset(shell->winbuf+curpos+len, ' ', 1);
+		memset(shell->fgbuf+curpos+len, VIMSHELL_COLOR_DEFAULT, 1);
+		memset(shell->bgbuf+curpos+len, VIMSHELL_COLOR_DEFAULT, 1);
+		memset(shell->rendbuf+curpos+len, 0, 1);
+		memset(shell->charset+curpos+len, 0, 1);
+	}
+}
+
+static void terminal_BEL(struct vim_shell_window *shell)
+{
+	/*
+	 * "Sound bell tone from keyboard."
+	 * Sure.
+	 */
+}
+
+static void terminal_BS(struct vim_shell_window *shell)
+{
+	/*
+	 * "Move the cursor to the left one character position, 
+	 * unless it is at the left margin, in which case no action occurs."
+	 */
+	if(shell->cursor_x>0)
+		shell->cursor_x--;
+}
+
+static void terminal_LF(struct vim_shell_window *shell)
+{
+	/*
+	 * "This code causes a line feed or a new line operation."
+	 */
+
+	if(shell->just_wrapped_around==1)
+	{
+		/*
+		 * Terminals which have the xenl capability ignore a linefeed after
+		 * an auto margin wrap.
+		 */
+		VERBOSEPRINTF( "%s: ignored LF because of earlier wrap around\n",
+				__FUNCTION__);
+		return;
+	}
+
+	shell->cursor_y++;
+	if(shell->cursor_y-1==shell->scroll_bottom_margin)
+	{
+		shell->cursor_y--;
+		terminal_scroll_up(shell);
+	}
+
+	VERBOSEPRINTF( "%s: did LF, cursor is now at X = %u, Y = %u\n", __FUNCTION__,
+			shell->cursor_x, shell->cursor_y);
+}
+
+static void terminal_CR(struct vim_shell_window *shell)
+{
+	/*
+	 * "Move cursor to the left margin on the current line."
+	 */
+	if(shell->just_wrapped_around==1)
+	{
+		/*
+		 * Terminals which have the xenl capability ignore a linefeed after
+		 * an auto margin wrap.
+		 */
+		VERBOSEPRINTF( "%s: ignored CR because of earlier wrap around\n",
+				__FUNCTION__);
+		return;
+	}
+	shell->cursor_x=0;
+	VERBOSEPRINTF( "%s: did CR, cursor is now at X = %u, Y = %u\n", __FUNCTION__,
+			shell->cursor_x, shell->cursor_y);
+}
+
+/*
+ * RI . Reverse Index
+ * ESC M 	 
+ *
+ * Move the active position to the same horizontal position on the preceding line. If the 
+ * active position is at the top margin, a scroll down is performed. Format Effector
+ */
+static void terminal_RI(struct vim_shell_window *shell)
+{
+	ESCDEBUGPRINTF( "%s: done\n", __FUNCTION__);
+	if(shell->cursor_y==shell->scroll_top_margin)
+		terminal_scroll_down(shell);
+	else
+		shell->cursor_y--;
+}
+
+/*
+ * IND . Index
+ * ESC D 	 
+ *
+ * This sequence causes the active position to move downward one line without changing the 
+ * column position. If the active position is at the bottom margin, a scroll up is performed. 
+ * Format Effector
+ */
+static void terminal_IND(struct vim_shell_window *shell)
+{
+	ESCDEBUGPRINTF( "%s: done\n", __FUNCTION__);
+	if(shell->cursor_y==shell->scroll_bottom_margin)
+		terminal_scroll_up(shell);
+	else
+		shell->cursor_y++;
+}
+
+/*
+ * ESC 7
+ * ESC [s (ANSI)
+ * Saves the current terminal rendering settings
+ */
+static void terminal_save_attributes(struct vim_shell_window *shell)
+{
+	shell->saved_cursor_x=shell->cursor_x;
+	shell->saved_cursor_y=shell->cursor_y;
+	shell->saved_rendition=shell->rendition;
+	shell->saved_fgcolor=shell->fgcolor;
+	shell->saved_bgcolor=shell->bgcolor;
+	shell->saved_G0_charset=shell->G0_charset;
+	shell->saved_G1_charset=shell->G1_charset;
+	shell->saved_application_keypad_mode=shell->application_keypad_mode;
+	shell->saved_application_cursor_mode=shell->application_cursor_mode;
+	shell->saved_insert_mode=shell->insert_mode;
+}
+
+/*
+ * ESC 8
+ * ESC [u (ANSI)
+ * Restores the current terminal rendering settings
+ */
+static void terminal_restore_attributes(struct vim_shell_window *shell)
+{
+	shell->cursor_x=shell->saved_cursor_x;
+	shell->cursor_y=shell->saved_cursor_y;
+	shell->rendition=shell->saved_rendition;
+	shell->fgcolor=shell->saved_fgcolor;
+	shell->bgcolor=shell->saved_bgcolor;
+	shell->G0_charset=shell->saved_G0_charset;
+	shell->G1_charset=shell->saved_G1_charset;
+	shell->application_keypad_mode=shell->saved_application_keypad_mode;
+	shell->application_cursor_mode=shell->saved_application_cursor_mode;
+	shell->insert_mode=shell->saved_insert_mode;
+}
+
+#define ADVANCE_PSEQ { pseq++; if(*pseq==0) return; }
+
+/*
+ * Attempts to parse the escape sequence stored in shell->esc_sequence.
+ * When it succeeds, it removes that escape sequence from the buffer and
+ * possibly clears shell->in_esc_sequence when there are no characters left,
+ * leaving ESC mode.
+ */
+static void terminal_parse_esc_sequence(struct vim_shell_window *shell)
+{
+	char *pseq;
+
+	if(shell->in_esc_sequence==0 || shell->esc_sequence[0]!=033)
+	{
+		ESCDEBUGPRINTF( "%s: invalid esc sequence in esc buffer\n",
+				__FUNCTION__);
+		/*
+		 * We would stick here forever, so flush the buffer
+		 */
+		shell->in_esc_sequence=0;
+		terminal_flush_output(shell);
+
+		return;
+	}
+
+	if(shell->in_esc_sequence==1)
+	{
+		ESCDEBUGPRINTF( "%s: not much in the buffer ...\n", __FUNCTION__);
+		return;
+	}
+
+	shell->esc_sequence[shell->in_esc_sequence]=0;
+	pseq=shell->esc_sequence+1;
+
+	if(*pseq=='[')
+	{
+		/*
+		 * Got a Control Sequence Introducer (CSI) = ESC [
+		 * Parse Parameters.
+		 */
+
+		int argc=0;
+		char argv[20][20];
+		
+		ADVANCE_PSEQ;
+
+		memset(argv, 0, sizeof(argv));
+
+		if((*pseq>='0' && *pseq<='9') || *pseq=='?' || *pseq==';')
+		{
+			int cont;
+			do
+			{
+				cont=0;
+				while((*pseq>='0' && *pseq<='9') || *pseq=='?')
+				{
+					char dummy[2];
+					dummy[0]=*pseq;
+					dummy[1]=0;
+					strcat(argv[argc], dummy);
+					ADVANCE_PSEQ;
+				}
+				if(argv[argc][0]==0)
+				{
+					strcpy(argv[argc], "0");
+				}
+				
+				argc++;
+				if(*pseq==';')
+				{
+					cont=1;
+					ADVANCE_PSEQ;
+				}
+			} while(cont==1);
+		}
+
+#ifdef ESCDEBUG
+		ESCDEBUGPRINTF("%s: sequence = '%s', argc = %d, ", __FUNCTION__, shell->esc_sequence, argc);
+		{
+			int i;
+			for(i=0;i<argc;i++)
+			{
+				ESCDEBUGPRINTF("argv[%d] = '%s', ",i, argv[i]);
+			}
+		}
+		ESCDEBUGPRINTF("\n");
+#endif
+
+		switch(*pseq)
+		{
+			case 'f':
+			case 'H':
+				terminal_CUP(shell, argc, argv);
+				break;
+			case 'J':
+				terminal_ED(shell, argc, argv);
+				break;
+			case 'K':
+				terminal_EL(shell, argc, argv);
+				break;
+			case 'C':
+				terminal_CUF(shell, argc, argv);
+				break;
+			case 'l':
+				terminal_mode(shell, 0, argc, argv);
+				break;
+			case 'h':
+				terminal_mode(shell, 1, argc, argv);
+				break;
+			case 'm':
+				terminal_SGR(shell, argc, argv);
+				break;
+			case 'r': // set scroll margins
+				terminal_DECSTBM(shell, argc, argv);
+				break;
+			case 'B': // cursor down
+				terminal_CUD(shell, argc, argv);
+				break;
+			case 'D': // cursor backward
+				terminal_CUB(shell, argc, argv);
+				break;
+			case 'A': // cursor up
+				terminal_CUU(shell, argc, argv);
+				break;
+			case 'M': // delete line
+				terminal_DL(shell, argc, argv);
+				break;
+			case 'L': // insert line
+				terminal_IL(shell, argc, argv);
+				break;
+			case '@': // insert characters
+				terminal_ICH(shell, argc, argv);
+				break;
+			case 'P': // delete characters
+				terminal_DCH(shell, argc, argv);
+				break;
+			case 'E': // new line
+				terminal_CR(shell);
+				terminal_LF(shell);
+				break;
+			case 's': // Save Cursor and attributes
+				terminal_save_attributes(shell);
+				break;
+			case 'u': // Restore Cursor and attributes
+				terminal_restore_attributes(shell);
+				break;
+			case 'g': // Tabulator clear
+				terminal_TBC(shell, argc, argv);
+				break;
+			default:
+				ESCDEBUGPRINTF( "%s: unimplemented CSI code: %c\n",
+						__FUNCTION__, *pseq);
+		}
+	}
+	else
+	{
+		ESCDEBUGPRINTF( "%s: sequence is (probably not yet complete) '%s'\n",
+				__FUNCTION__, shell->esc_sequence);
+		switch(*pseq)
+		{
+			case '#': 
+				ADVANCE_PSEQ;
+				if(*pseq=='8') // fill screen with E's
+				{
+					memset(shell->winbuf, 'E', shell->size_x*shell->size_y);
+				}
+				break;
+			case '(': // switch G0 charset
+				ADVANCE_PSEQ;
+				shell->G0_charset=*pseq;
+				ESCDEBUGPRINTF( "%s: G0 character set is now: %c\n", __FUNCTION__, *pseq);
+				break;
+			case ')': // switch G1 charset
+				ADVANCE_PSEQ;
+				shell->G1_charset=*pseq;
+				ESCDEBUGPRINTF( "%s: G1 character set is now: %c\n", __FUNCTION__, *pseq);
+				break;
+			case 'D': // index
+				terminal_IND(shell);
+				break;
+			case 'M': // reverse index
+				terminal_RI(shell);
+				break;
+			case '7': // Save Cursor
+				terminal_save_attributes(shell);
+				break;
+			case '8': // Restore Cursor
+				terminal_restore_attributes(shell);
+				break;
+			case '=': // Application Keypad Mode
+				shell->application_keypad_mode=1;
+				ESCDEBUGPRINTF( "%s: keypad switched to application mode\n", __FUNCTION__);
+				break;
+			case '>': // Numeric Keypad Mode
+				shell->application_keypad_mode=0;
+				ESCDEBUGPRINTF( "%s: keypad switched to numeric mode\n", __FUNCTION__);
+				break;
+			case 'H': // Set Horizontal Tab
+				shell->tabline[shell->cursor_x]=1;
+				break;
+			case 'E': // NEL - Moves cursor to first position on next line. If cursor is 
+				  // at bottom margin, screen performs a scroll-up.
+				terminal_IND(shell);
+				shell->cursor_x=0;
+				break;
+			case ']': // This could be the beginning of the xterm title hack
+				ADVANCE_PSEQ;
+				if(*pseq=='1' || *pseq=='2' || *pseq=='0')
+				{
+					char title[50];
+					ADVANCE_PSEQ;
+					if(*pseq==';')
+					{
+						int end;
+						title[0]=0;
+						/*
+						 * I know this loop is ugly but ADVANCE_PSEQ
+						 * is a macro, sorry
+						 */
+						for(end=0;!end;)
+						{
+							ADVANCE_PSEQ;
+							if(strlen(title)>sizeof(title)-2)
+								end=1;
+							if(*pseq==7)
+								end=1;
+							else
+							{
+								char dummy[2];
+								dummy[0]=*pseq;
+								dummy[1]=0;
+								strcat(title, dummy);
+							}
+						}
+
+						snprintf(shell->windowtitle, sizeof(shell->windowtitle),
+								"%s", title);
+
+						ESCDEBUGPRINTF( "%s: changing title to '%s'\n",
+								__FUNCTION__, shell->windowtitle);
+					}
+					else
+					{
+						ESCDEBUGPRINTF( "%s: error in xterm title hack "
+								"sequence: %c\n", __FUNCTION__, *pseq);
+					}
+				}
+				else
+				{
+					ESCDEBUGPRINTF( "%s: unimplemented xterm title hack "
+							"code: %d\n", __FUNCTION__, *pseq);
+				}
+				break;
+			default:
+				ESCDEBUGPRINTF( "%s: unimplemented esc code: %c\n",
+						__FUNCTION__, *pseq);
+		}
+	}
+
+	/*
+	 * when we end up here, we successfully completed the sequence.
+	 */
+	shell->in_esc_sequence=0;
+	terminal_flush_output(shell);
+
+#ifdef ESCDEBUG
+	pseq++;
+	if(*pseq!=0)
+	{
+		ESCDEBUGPRINTF( "WARNING: %s: sequence is not over! left in buffer: '%s'\n",
+				__FUNCTION__, pseq);
+	}
+#endif
+}
+
+
+/*
+ * Main character write part.
+ * This here runs most of the time, just writing the character to the
+ * right cursor position.
+ */
+static void terminal_normal_char(struct vim_shell_window *shell, char input)
+{
+	int pos;
+	uint8_t charset;
+
+	shell->just_wrapped_around=0;
+	/*
+	 * If the cursor is currently in the 'virtual' column (that is the column
+	 * after the physical line end), we wrap around now.
+	 */
+	if(shell->cursor_x==shell->size_x)
+	{
+		if(shell->wraparound==1)
+		{
+			terminal_CR(shell);
+			terminal_LF(shell);
+			shell->just_wrapped_around=1;
+			VERBOSEPRINTF( "%s: auto margin - wrapped around!\n",__FUNCTION__);
+		}
+		else
+		{
+			shell->cursor_x--;
+		}
+	}
+
+	/*
+	 * write the character at its right position.
+	 */
+	if(shell->insert_mode!=0)
+	{
+		/*
+		 * If insert mode is on, move all characters from the current position+1 to
+		 * the end of the row. The last character on the row falls out.
+		 * Fortunately, we already implemented this kind of operation :)
+		 */
+                terminal_ICH(shell, 0, NULL);
+	}
+	pos=shell->cursor_y*shell->size_x+shell->cursor_x;
+
+	/*
+	 * Select which character to display.
+	 */
+	if(shell->active_charset==1)
+		charset=shell->G1_charset=='0' ? VIMSHELL_CHARSET_DRAWING : VIMSHELL_CHARSET_USASCII;
+	else
+		charset=shell->G0_charset=='0' ? VIMSHELL_CHARSET_DRAWING : VIMSHELL_CHARSET_USASCII;
+
+	shell->winbuf[pos]=input;
+	shell->fgbuf[pos]=shell->fgcolor;
+	shell->bgbuf[pos]=shell->bgcolor;
+	shell->rendbuf[pos]=shell->rendition;
+	shell->charset[pos]=charset;
+	VERBOSEPRINTF( "%s: writing char '%c' to position X = %u, Y = %u (col: 0x%02x,0x%02x)\n", __FUNCTION__,
+			input, shell->cursor_x, shell->cursor_y, current_fg, current_bg);
+	shell->cursor_x++;
+}
+
+/*
+ * Here, all characters between 000 and 037 are processed. This is in a
+ * separate function because control characters can be in the normal
+ * flow of characters or in the middle of escape sequences.
+ */
+static void terminal_process_control_char(struct vim_shell_window *shell, char input)
+{
+	switch(input)
+	{
+		case 007: // BEL, Bell, 0x07
+			terminal_BEL(shell);
+			break;
+		case 010: // BS, Backspace, 0x08
+			terminal_BS(shell);
+			break;
+		case 011: // TAB
+			{
+				/*
+				 * Move to the next tabstop or stop at the right margin if no
+				 * tabstop found.
+				 */
+				int i, found;
+				for(found=0, i=shell->cursor_x+1;i<shell->size_x && !found;i++)
+				{
+					if(shell->tabline[i]==1)
+					{
+						shell->cursor_x=i;
+						found=1;
+					}
+				}
+				if(found==0)
+				{
+					shell->cursor_x=shell->size_x-1;
+				}
+			}
+			break;
+		case 013:
+		case 014:
+		case 012: // LF, Line Feed, 0x0a, \n
+			terminal_LF(shell);
+			break;
+		case 015: // CR, Carriage Return, 0x0d, \r
+			terminal_CR(shell);
+			break;
+		case 016: // SO, Invoke G1 character set, as designated by SCS control sequence.
+			shell->active_charset=1;
+			break;
+		case 017: // SI, Select G0 character set, as selected by ESC ( sequence.
+			shell->active_charset=0;
+			break;
+		case 030:
+		case 032: // CAN or SUB - cancel escape sequence
+			shell->in_esc_sequence=0;
+			// VIMSHELL TODO: display substitution character? 
+			ESCDEBUGPRINTF("%s: WARNING: possible source of rendering faults: "
+					"substitution characters after CAN or SUB?\n", __FUNCTION__);
+			break;
+		case 033: // ESC, Escape
+			/*
+			 * Note: This also fulfills the requirement that a ESC occuring while processing
+			 *       an escape sequence should restart the sequence.
+			 */
+			shell->in_esc_sequence=1;
+			shell->esc_sequence[0]=033;
+			break;
+		default:
+			ESCDEBUGPRINTF("%s: unimplemented control character: %u\n", __FUNCTION__, input);
+			break;
+	}
+}
+
+static void terminal_input_char(struct vim_shell_window *shell, char input)
+{
+	if(shell->in_esc_sequence==0)
+	{
+		if(input>=0 && input<=037)
+		{
+			/*
+			 * A control character, process it
+			 */
+			terminal_process_control_char(shell, input);
+		}
+		else
+		{
+			// all normal characters are processed here
+			terminal_normal_char(shell, input);
+		}
+	}
+	else
+	{
+		if(input>=0 && input<=037)
+		{
+			/*
+			 * That's right, control characters can appear even in
+			 * the middle of escape sequences.
+			 */
+			terminal_process_control_char(shell, input);
+			return;
+		}
+		
+		/*
+		 * Aha, we are right in the middle of an escape sequence.
+		 * Add this character and attempt to parse the sequence.
+		 */
+		shell->esc_sequence[shell->in_esc_sequence]=input;
+		shell->in_esc_sequence++;
+
+		if(shell->in_esc_sequence>=sizeof(shell->esc_sequence))
+		{
+			/*
+			 * about to overrun esc sequence buffer ...
+			 * Should never happen, but still: kill the sequence, or we'd loop
+			 * forever.
+			 */
+
+			shell->in_esc_sequence=0;
+			terminal_flush_output(shell);
+			return;
+		}
+
+		terminal_parse_esc_sequence(shell);
+	}
+}
+
+/*
+ * If we are ready, flush the outbuf into the shell.
+ * CHECK: should always be called when shell->in_esc_sequence goes back to zero,
+ *        so characters that are waiting for a sequence to become complete can be
+ *        flushed out.
+ */
+static int terminal_flush_output(struct vim_shell_window *shell)
+{
+	if(/*shell->in_esc_sequence==0 && */ shell->outbuf_pos>0)
+	{
+		int len;
+#ifdef ESCDEBUG
+		ESCDEBUGPRINTF( "%s: sending:\n",__FUNCTION__);
+		hexdump(vimshell_debug_fp, shell->outbuf, shell->outbuf_pos); 
+#endif
+		len=write(shell->fd_master, shell->outbuf, shell->outbuf_pos);
+		if(len<0)
+		{
+			ESCDEBUGPRINTF( "%s: ERROR: write failed: %s\n",
+					__FUNCTION__,strerror(errno));
+			shell->outbuf_pos=0;
+			return -1;
+		}
+
+		if(shell->outbuf_pos!=len)
+			memmove(shell->outbuf, shell->outbuf+len, len);
+		shell->outbuf_pos-=len;
+
+		return len;
+	}
+	return 0;
+}
+
+/*
+ * Main Terminal processing method (VIM <- Shell).
+ * Gets a buffer with input data from the shell, interprets it and updates
+ * the shell window's windowbuffer accordingly.
+ */
+void vim_shell_terminal_input(struct vim_shell_window *shell, char *input, int len)
+{
+	int i;
+	for(i=0;i<len;i++)
+	{
+		terminal_input_char(shell, input[i]);
+	}
+}
+
+/*
+ * Main Terminal output method (VIM -> Shell).
+ * Translates the character 'c' into an appropriate escape sequence (if necessary)
+ * and puts it into the out buffer.
+ */
+int vim_shell_terminal_output(struct vim_shell_window *shell, int c)
+{
+	char outbuf[50];
+	size_t written;
+
+	outbuf[1]=0;
+
+	switch(c)
+	{
+		case VIMSHELL_KEY_BACKSPACE:
+			sprintf(outbuf, "\177");
+			ESCDEBUGPRINTF( "%s: key is backspace\n", __FUNCTION__);
+			break;
+		case VIMSHELL_KEY_UP:
+			sprintf(outbuf, "\033%cA", shell->application_cursor_mode ? 'O' : '[');
+			ESCDEBUGPRINTF( "%s: key is cursor up\n", __FUNCTION__);
+			break;
+		case VIMSHELL_KEY_DOWN:
+			sprintf(outbuf, "\033%cB", shell->application_cursor_mode ? 'O' : '[');
+			ESCDEBUGPRINTF( "%s: key is cursor down\n", __FUNCTION__);
+			break;
+		case VIMSHELL_KEY_LEFT:
+			sprintf(outbuf, "\033%cD", shell->application_cursor_mode ? 'O' : '[');
+			ESCDEBUGPRINTF( "%s: key is cursor left\n", __FUNCTION__);
+			break;
+		case VIMSHELL_KEY_RIGHT:
+			sprintf(outbuf, "\033%cC", shell->application_cursor_mode ? 'O' : '[');
+			ESCDEBUGPRINTF( "%s: key is cursor right\n", __FUNCTION__);
+			break;
+		case VIMSHELL_KEY_HOME:
+			sprintf(outbuf, "\033[1~");
+			ESCDEBUGPRINTF( "%s: key is home\n", __FUNCTION__);
+			break;
+		case VIMSHELL_KEY_F1:
+			sprintf(outbuf, "\033OP");
+			ESCDEBUGPRINTF( "%s: key is F1\n", __FUNCTION__);
+			break;
+		case VIMSHELL_KEY_F2:
+			sprintf(outbuf, "\033OQ");
+			ESCDEBUGPRINTF( "%s: key is F2\n", __FUNCTION__);
+			break;
+		case VIMSHELL_KEY_F3:
+			sprintf(outbuf, "\033OR");
+			ESCDEBUGPRINTF( "%s: key is F3\n", __FUNCTION__);
+			break;
+		case VIMSHELL_KEY_F4:
+			sprintf(outbuf, "\033OS");
+			ESCDEBUGPRINTF( "%s: key is F4\n", __FUNCTION__);
+			break;
+		case VIMSHELL_KEY_F5:
+			sprintf(outbuf, "\033[15~");
+			ESCDEBUGPRINTF( "%s: key is F5\n", __FUNCTION__);
+			break;
+		case VIMSHELL_KEY_F6:
+			sprintf(outbuf, "\033[17~");
+			ESCDEBUGPRINTF( "%s: key is F6\n", __FUNCTION__);
+			break;
+		case VIMSHELL_KEY_F7:
+			sprintf(outbuf, "\033[18~");
+			ESCDEBUGPRINTF( "%s: key is F7\n", __FUNCTION__);
+			break;
+		case VIMSHELL_KEY_F8:
+			sprintf(outbuf, "\033[19~");
+			ESCDEBUGPRINTF( "%s: key is F8\n", __FUNCTION__);
+			break;
+		case VIMSHELL_KEY_F9:
+			sprintf(outbuf, "\033[20~");
+			ESCDEBUGPRINTF( "%s: key is F9\n", __FUNCTION__);
+			break;
+		case VIMSHELL_KEY_F10:
+			sprintf(outbuf, "\033[21~");
+			ESCDEBUGPRINTF( "%s: key is F10\n", __FUNCTION__);
+			break;
+		case VIMSHELL_KEY_F11:
+			sprintf(outbuf, "\033[23~");
+			ESCDEBUGPRINTF( "%s: key is F11\n", __FUNCTION__);
+			break;
+		case VIMSHELL_KEY_F12:
+			sprintf(outbuf, "\033[24~");
+			ESCDEBUGPRINTF( "%s: key is F12\n", __FUNCTION__);
+			break;
+		case VIMSHELL_KEY_DC:
+			sprintf(outbuf, "\033[3~");
+			ESCDEBUGPRINTF( "%s: key is delete character\n", __FUNCTION__);
+			break;
+		case VIMSHELL_KEY_END:
+			sprintf(outbuf, "\033[4~");
+			ESCDEBUGPRINTF( "%s: key is end\n", __FUNCTION__);
+			break;
+		case VIMSHELL_KEY_IC:
+			sprintf(outbuf, "\033[2~");
+			ESCDEBUGPRINTF( "%s: key is insert character\n", __FUNCTION__);
+			break;
+		case VIMSHELL_KEY_NPAGE:
+			sprintf(outbuf, "\033[6~");
+			ESCDEBUGPRINTF( "%s: key is page down\n", __FUNCTION__);
+			break;
+		case VIMSHELL_KEY_PPAGE:
+			sprintf(outbuf, "\033[5~");
+			ESCDEBUGPRINTF( "%s: key is page up\n", __FUNCTION__);
+			break;
+		case VIMSHELL_KEY_K0:
+			sprintf(outbuf, "%s", shell->application_keypad_mode ? "\033Op" : "0");
+			ESCDEBUGPRINTF( "%s: key is keypad 0\n", __FUNCTION__);
+			break;
+		case VIMSHELL_KEY_K1:
+			sprintf(outbuf, "%s", shell->application_keypad_mode ? "\033Oq" : "1");
+			ESCDEBUGPRINTF( "%s: key is keypad 1\n", __FUNCTION__);
+			break;
+		case VIMSHELL_KEY_K2:
+			sprintf(outbuf, "%s", shell->application_keypad_mode ? "\033Or" : "2");
+			ESCDEBUGPRINTF( "%s: key is keypad 2\n", __FUNCTION__);
+			break;
+		case VIMSHELL_KEY_K3:
+			sprintf(outbuf, "%s", shell->application_keypad_mode ? "\033Os" : "3");
+			ESCDEBUGPRINTF( "%s: key is keypad 3\n", __FUNCTION__);
+			break;
+		case VIMSHELL_KEY_K4:
+			sprintf(outbuf, "%s", shell->application_keypad_mode ? "\033Ot" : "4");
+			ESCDEBUGPRINTF( "%s: key is keypad 4\n", __FUNCTION__);
+			break;
+		case VIMSHELL_KEY_K5:
+			sprintf(outbuf, "%s", shell->application_keypad_mode ? "\033Ou" : "5");
+			ESCDEBUGPRINTF( "%s: key is keypad 5\n", __FUNCTION__);
+			break;
+		case VIMSHELL_KEY_K6:
+			sprintf(outbuf, "%s", shell->application_keypad_mode ? "\033Ov" : "6");
+			ESCDEBUGPRINTF( "%s: key is keypad 6\n", __FUNCTION__);
+			break;
+		case VIMSHELL_KEY_K7:
+			sprintf(outbuf, "%s", shell->application_keypad_mode ? "\033Ow" : "7");
+			ESCDEBUGPRINTF( "%s: key is keypad 7\n", __FUNCTION__);
+			break;
+		case VIMSHELL_KEY_K8:
+			sprintf(outbuf, "%s", shell->application_keypad_mode ? "\033Ox" : "8");
+			ESCDEBUGPRINTF( "%s: key is keypad 8\n", __FUNCTION__);
+			break;
+		case VIMSHELL_KEY_K9:
+			sprintf(outbuf, "%s", shell->application_keypad_mode ? "\033Oy" : "9");
+			ESCDEBUGPRINTF( "%s: key is keypad 9\n", __FUNCTION__);
+			break;
+		case VIMSHELL_KEY_KPLUS:
+			sprintf(outbuf, "%s", shell->application_keypad_mode ? "\033Ok" : "+");
+			ESCDEBUGPRINTF( "%s: key is keypad plus\n", __FUNCTION__);
+			break;
+		case VIMSHELL_KEY_KMINUS:
+			sprintf(outbuf, "%s", shell->application_keypad_mode ? "\033Om" : "-");
+			ESCDEBUGPRINTF( "%s: key is keypad minus\n", __FUNCTION__);
+			break;
+		case VIMSHELL_KEY_KDIVIDE:
+			sprintf(outbuf, "%s", shell->application_keypad_mode ? "\033Oo" : "/");
+			ESCDEBUGPRINTF( "%s: key is keypad divide\n", __FUNCTION__);
+			break;
+		case VIMSHELL_KEY_KMULTIPLY:
+			sprintf(outbuf, "%s", shell->application_keypad_mode ? "\033Oj" : "*");
+			ESCDEBUGPRINTF( "%s: key is keypad multiply\n", __FUNCTION__);
+			break;
+		case VIMSHELL_KEY_KENTER:
+			sprintf(outbuf, "%s", shell->application_keypad_mode ? "\033OM" : "\015");
+			ESCDEBUGPRINTF( "%s: key is keypad enter\n", __FUNCTION__);
+			break;
+		case VIMSHELL_KEY_KPOINT:
+			sprintf(outbuf, "%s", shell->application_keypad_mode ? "\033On" : ".");
+			ESCDEBUGPRINTF( "%s: key is keypad point\n", __FUNCTION__);
+			break;
+		default:
+			outbuf[0]=(char)c;
+	}
+
+	if(shell->outbuf_pos+strlen(outbuf)>=sizeof(shell->outbuf))
+	{
+		written=sizeof(shell->outbuf)-shell->outbuf_pos;
+		ESCDEBUGPRINTF( "%s: WARNING: prevented from overflowing the outbuf, help!\n",
+				__FUNCTION__);
+	}
+	else
+		written=strlen(outbuf);
+
+	memcpy(shell->outbuf+shell->outbuf_pos, outbuf, written);
+	shell->outbuf_pos+=written;
+
+	if(terminal_flush_output(shell)<0)
+		return -1;
+	
+	return written;
+}

Property changes on: src/terminal.c
___________________________________________________________________
Name: svn:keywords
   + author date id revision
Name: svn:eol-style
   + native

Index: src/config.h.in
===================================================================
--- src/config.h.in	(.../branches/V7_0)	(revision 120)
+++ src/config.h.in	(.../trunk)	(revision 120)
@@ -371,3 +371,8 @@
 
 /* Define if you want XSMP interaction as well as vanilla swapfile safety */
 #undef USE_XSMP_INTERACT
+
+/* VIMSHELL stuff */
+#undef HAVE_PTY_H
+#undef HAVE_LIBUTIL_H
+#undef HAVE_STDINT_H
Index: src/gui_gtk_x11.c
===================================================================
--- src/gui_gtk_x11.c	(.../branches/V7_0)	(revision 120)
+++ src/gui_gtk_x11.c	(.../trunk)	(revision 120)
@@ -6392,7 +6392,66 @@
 }
 #endif
 
+#ifdef FEAT_VIMSHELL
 /*
+ * VIM-Shell callback, called when a shell file descriptor has data
+ * available.
+ */
+    static void
+vimshell_request_cb(
+    gpointer	data,
+    gint	source_fd,
+    GdkInputCondition condition)
+{
+    buf_T *buf;
+    int did_redraw=0;
+
+    /*
+     * Search the right buffer.
+     */
+    for(buf=firstbuf;buf!=NULL;buf=buf->b_next)
+    {
+	if(buf->is_shell!=0 && buf->shell && buf->shell->fd_master==source_fd)
+	{
+	    int r;
+
+	    r=vim_shell_do_read_lowlevel(buf);
+	    if(r>did_redraw)
+		did_redraw=r;
+
+	    if(r==1 && updating_screen==FALSE)
+		redraw_buf_later(buf, VALID);
+	    else if(r==2)
+	    {
+		/* 
+		 * Shell died, so remove the GTK-input
+		 * VIMSHELL TODO: this should really be happening inside vim_shell_delete
+		 */
+		gdk_input_remove(buf->gtk_input_id);
+		buf->gtk_input_id=0;
+		if(updating_screen==FALSE)
+		    redraw_buf_later(buf, CLEAR);
+	    }
+	}
+    }
+
+    if(updating_screen==FALSE)
+    {
+	if(did_redraw==1)
+	    update_screen(VALID);
+	else if(did_redraw==2)
+	{
+	    update_screen(CLEAR);
+	    out_flush();
+	}
+    }
+    
+    if (gtk_main_level() > 0)
+	gtk_main_quit();
+}
+#endif
+
+/*
  * GUI input routine called by gui_wait_for_chars().  Waits for a character
  * from the keyboard.
  *  wtime == -1     Wait forever.
@@ -6428,6 +6487,23 @@
     }
 #endif
 
+#ifdef FEAT_VIMSHELL
+    /*
+     * Go through all buffers, see if we have to add not yet added inputs
+     */
+    {
+	buf_T *buf;
+	for(buf=firstbuf;buf!=NULL;buf=buf->b_next)
+	{
+	    if(buf->is_shell!=0 && buf->shell && buf->gtk_input_id==0)
+	    {
+		buf->gtk_input_id=gdk_input_add(buf->shell->fd_master,
+			GDK_INPUT_READ, vimshell_request_cb, NULL);
+	    }
+	}
+    }
+#endif
+
     timed_out = FALSE;
 
     /* this timeout makes sure that we will return if no characters arrived in
Index: src/os_unix.c
===================================================================
--- src/os_unix.c	(.../branches/V7_0)	(revision 120)
+++ src/os_unix.c	(.../trunk)	(revision 120)
@@ -4539,7 +4539,7 @@
 # endif
 #endif
 #ifndef HAVE_SELECT
-	struct pollfd   fds[5];
+	struct pollfd   fds[50];
 	int		nfd;
 # ifdef FEAT_XCLIPBOARD
 	int		xterm_idx = -1;
@@ -4550,6 +4550,15 @@
 # ifdef USE_XSMP
 	int		xsmp_idx = -1;
 # endif
+# ifdef FEAT_VIMSHELL
+	struct 
+	{ 
+	    int idx; 
+	    struct vim_shell_window *shell; 
+	    buf_T *buffer;
+	}		vimshell_idxs[50];
+	int		vimshell_idx_cnt;
+# endif
 	int		towait = (int)msec;
 
 # ifdef FEAT_MZSCHEME
@@ -4600,7 +4609,50 @@
 	    nfd++;
 	}
 # endif
+# ifdef FEAT_VIMSHELL
+	{
+	    /*
+	     * Loop through all windows and see if they contain vimshells.
+	     * If yes, add the master-fd to the list of polled fds.
+	     */
+	    memset(vimshell_idxs, 0, sizeof(vimshell_idxs));
+	    vimshell_idx_cnt=0;
+	    for(buf=firstbuf; buf!=NULL; buf=buf->b_next)
+	    {
+		buf_T *buf;
+		if(buf->is_shell!=0)
+		{
+		    vimshell_idxs[vimshell_idx_count].idx=nfd;
+		    vimshell_idxs[vimshell_idx_count].buffer=buf;
+		    vimshell_idxs[vimshell_idx_count].shell=buf->shell;
 
+		    /*
+		     * We will first run out of fds before we run out of
+		     * vimshell_idxs-slots, so no check here.
+		     */
+		    vimshell_idx_count++;
+
+		    if(buf->shell==NULL)
+		    {
+			// VIMSHELL TODO: error message here
+			continue;
+		    }
+		    fds[nfd].fd = buf->shell->fd_master;
+		    fds[nfd].events = POLLIN;
+		    nfd++;
+		    if(nfd>=sizeof(fds)/sizeof(fds[0]))
+		    {
+			/*
+			 * no more fds-slots left! aieeee
+			 */
+			// VIMSHELL TODO: issue a warning here or something
+			break;
+		    }
+		}
+	    }
+	}
+# endif
+
 	ret = poll(fds, nfd, towait);
 # ifdef FEAT_MZSCHEME
 	if (ret == 0 && mzquantum_used)
@@ -4653,8 +4705,40 @@
 		finished = FALSE;	/* Try again */
 	}
 # endif
+# ifdef FEAT_VIMSHELL
+#error "VIMSHELL: probably doesn't work with poll(), never tested, sorry (use select)"
+	{
+	    /*
+	     * See if any of the shell's fds have a read request ready
+	     * If yes, call the shell's read handler.
+	     */
+	    int i;
+	    int did_redraw=0;
+	    for(i=0;i<vimshell_idx_cnt;i++)
+	    {
+		if(fds[vimshell_idxs[i].idx].revents & POLLIN)
+		{
+		    if(vim_shell_read(vimshell_idxs[i].shell)<0)
+		    {
+			// VIMSHELL TODO: handle error here
+			continue;
+		    }
 
+		    redraw_buf_later(vimshell_idxs[i].buffer, NOT_VALID);
 
+		    did_redraw=1;
+		}
+		// VIMSHELL TODO: handle POLLHUP here too (shell terminated)
+	    }
+	    if(did_redraw==1)
+	    {
+		update_screen(NOT_VALID);
+		out_flush();
+	    }
+	}
+# endif
+
+
 #else /* HAVE_SELECT */
 
 	struct timeval  tv;
@@ -4734,6 +4818,25 @@
 		maxfd = xsmp_icefd;
 	}
 # endif
+# ifdef FEAT_VIMSHELL
+	{
+	    /*
+	     * Loop through all windows and see if they contain vimshells.
+	     * If yes, add the master-fd to the list of fds
+	     */
+	    win_T *win;
+	    FOR_ALL_WINDOWS(win)
+	    {
+		buf_T *buf=win->w_buffer;
+		if(buf->is_shell!=0)
+		{
+		    FD_SET(buf->shell->fd_master, &rfds);
+		    if (maxfd < buf->shell->fd_master)
+			maxfd = buf->shell->fd_master;
+		}
+	    }
+	}
+# endif
 
 # ifdef OLD_VMS
 	/* Old VMS as v6.2 and older have broken select(). It waits more than
@@ -4803,6 +4906,16 @@
 	    }
 	}
 # endif
+# ifdef FEAT_VIMSHELL
+	if((maxfd=vim_shell_do_read_select(rfds))!=0)
+	{
+	    ret-=maxfd;
+#  ifdef MAY_LOOP
+	    if (ret == 0)
+		finished = FALSE;   /* keep going if event was only one */
+#  endif
+	}
+# endif
 
 #endif /* HAVE_SELECT */
 
Index: src/version.c
===================================================================
--- src/version.c	(.../branches/V7_0)	(revision 120)
+++ src/version.c	(.../trunk)	(revision 120)
@@ -571,6 +571,11 @@
 #else
 	"-vertsplit",
 #endif
+#ifdef FEAT_VIMSHELL
+	"+vimshell",
+#else
+	"-vimshell",
+#endif
 #ifdef FEAT_VIRTUALEDIT
 	"+virtualedit",
 #else
Index: src/screen.c
===================================================================
--- src/screen.c	(.../branches/V7_0)	(revision 120)
+++ src/screen.c	(.../trunk)	(revision 120)
@@ -91,13 +91,21 @@
 /*
  * The attributes that are actually active for writing to the screen.
  */
+#ifdef FEAT_VIMSHELL
+int		screen_attr = 0;
+#else
 static int	screen_attr = 0;
+#endif
 
 /*
  * Positioning the cursor is reduced by remembering the last position.
  * Mostly used by windgoto() and screen_char().
  */
+#ifdef FEAT_VIMSHELL
+int		screen_cur_row, screen_cur_col;	/* last known cursor position */
+#else
 static int	screen_cur_row, screen_cur_col;	/* last known cursor position */
+#endif
 
 #ifdef FEAT_SEARCH_EXTRA
 /*
@@ -160,7 +168,11 @@
 static void prepare_search_hl __ARGS((win_T *wp, linenr_T lnum));
 static void next_search_hl __ARGS((win_T *win, match_T *shl, linenr_T lnum, colnr_T mincol));
 #endif
+#ifdef FEAT_VIMSHELL
+void screen_start_highlight __ARGS((int attr));
+#else
 static void screen_start_highlight __ARGS((int attr));
+#endif
 static void screen_char __ARGS((unsigned off, int row, int col));
 #ifdef FEAT_MBYTE
 static void screen_char_2 __ARGS((unsigned off, int row, int col));
@@ -845,6 +857,7 @@
 	return;
     }
 #endif
+    
 
 #ifdef FEAT_SEARCH_EXTRA
     /* Setup for ":match" and 'hlsearch' highlighting.  Disable any previous
@@ -1452,6 +1465,7 @@
     win_foldinfo.fi_level = 0;
 #endif
 
+
     /*
      * Update all the window rows.
      */
@@ -1878,9 +1892,19 @@
 	else if (dollar_vcol == 0)
 	    wp->w_botline = lnum;
 
+#ifdef FEAT_VIMSHELL
+	/*
+	 * We don't want '~' to appear right in the middle of our shells ...
+	 */
+	if(wp->w_buffer->is_shell==0)
+	{
+#endif
 	/* make sure the rest of the screen is blank */
 	/* put '~'s on rows that aren't part of the file. */
 	win_draw_end(wp, '~', ' ', row, wp->w_height, HLF_AT);
+#ifdef FEAT_VIMSHELL
+	}
+#endif
     }
 
     /* Reset the type of redrawing required, the window has been updated. */
@@ -1928,6 +1952,18 @@
     if (!got_int)
 	got_int = save_got_int;
 #endif
+    
+#ifdef FEAT_VIMSHELL
+    /*
+     * If this window contains a shell, redraw the shell.
+     */
+    if(wp->w_buffer->is_shell != 0)
+    {
+	wp->w_buffer->shell->force_redraw=(type>=NOT_VALID ? 1 : 0);
+	vim_shell_redraw(wp->w_buffer->shell, wp);
+	return;
+    }
+#endif
 }
 
 #ifdef FEAT_SIGNS
@@ -6472,7 +6508,11 @@
 }
 #endif
 
+#ifdef FEAT_VIMSHELL
+      void
+#else
       static void
+#endif
 screen_start_highlight(attr)
       int	attr;
 {
@@ -6672,7 +6712,11 @@
  * Put character ScreenLines["off"] on the screen at position "row" and "col",
  * using the attributes from ScreenAttrs["off"].
  */
+#ifdef FEAT_VIMSHELL
+    void
+#else
     static void
+#endif
 screen_char(off, row, col)
     unsigned	off;
     int		row;
Index: src/auto/configure
===================================================================
--- src/auto/configure	(.../branches/V7_0)	(revision 120)
+++ src/auto/configure	(.../trunk)	(revision 120)
@@ -1,325 +1,120 @@
 #! /bin/sh
+
 # Guess values for system-dependent variables and create Makefiles.
-# Generated by GNU Autoconf 2.59.
+# Generated automatically using autoconf version 2.13 
+# Copyright (C) 1992, 93, 94, 95, 96 Free Software Foundation, Inc.
 #
-# Copyright (C) 2003 Free Software Foundation, Inc.
 # This configure script is free software; the Free Software Foundation
 # gives unlimited permission to copy, distribute and modify it.
-## --------------------- ##
-## M4sh Initialization.  ##
-## --------------------- ##
 
-# Be Bourne compatible
-if test -n "${ZSH_VERSION+set}" && (emulate sh) >/dev/null 2>&1; then
-  emulate sh
-  NULLCMD=:
-  # Zsh 3.x and 4.x performs word splitting on ${1+"$@"}, which
-  # is contrary to our usage.  Disable this feature.
-  alias -g '${1+"$@"}'='"$@"'
-elif test -n "${BASH_VERSION+set}" && (set -o posix) >/dev/null 2>&1; then
-  set -o posix
-fi
-DUALCASE=1; export DUALCASE # for MKS sh
-
-# Support unset when possible.
-if ( (MAIL=60; unset MAIL) || exit) >/dev/null 2>&1; then
-  as_unset=unset
-else
-  as_unset=false
-fi
-
-
-# Work around bugs in pre-3.0 UWIN ksh.
-$as_unset ENV MAIL MAILPATH
-PS1='$ '
-PS2='> '
-PS4='+ '
-
-# NLS nuisances.
-for as_var in \
-  LANG LANGUAGE LC_ADDRESS LC_ALL LC_COLLATE LC_CTYPE LC_IDENTIFICATION \
-  LC_MEASUREMENT LC_MESSAGES LC_MONETARY LC_NAME LC_NUMERIC LC_PAPER \
-  LC_TELEPHONE LC_TIME
-do
-  if (set +x; test -z "`(eval $as_var=C; export $as_var) 2>&1`"); then
-    eval $as_var=C; export $as_var
-  else
-    $as_unset $as_var
-  fi
-done
-
-# Required to use basename.
-if expr a : '\(a\)' >/dev/null 2>&1; then
-  as_expr=expr
-else
-  as_expr=false
-fi
-
-if (basename /) >/dev/null 2>&1 && test "X`basename / 2>&1`" = "X/"; then
-  as_basename=basename
-else
-  as_basename=false
-fi
-
-
-# Name of the executable.
-as_me=`$as_basename "$0" ||
-$as_expr X/"$0" : '.*/\([^/][^/]*\)/*$' \| \
-	 X"$0" : 'X\(//\)$' \| \
-	 X"$0" : 'X\(/\)$' \| \
-	 .     : '\(.\)' 2>/dev/null ||
-echo X/"$0" |
-    sed '/^.*\/\([^/][^/]*\)\/*$/{ s//\1/; q; }
-  	  /^X\/\(\/\/\)$/{ s//\1/; q; }
-  	  /^X\/\(\/\).*/{ s//\1/; q; }
-  	  s/.*/./; q'`
-
-
-# PATH needs CR, and LINENO needs CR and PATH.
-# Avoid depending upon Character Ranges.
-as_cr_letters='abcdefghijklmnopqrstuvwxyz'
-as_cr_LETTERS='ABCDEFGHIJKLMNOPQRSTUVWXYZ'
-as_cr_Letters=$as_cr_letters$as_cr_LETTERS
-as_cr_digits='0123456789'
-as_cr_alnum=$as_cr_Letters$as_cr_digits
-
-# The user is always right.
-if test "${PATH_SEPARATOR+set}" != set; then
-  echo "#! /bin/sh" >conf$$.sh
-  echo  "exit 0"   >>conf$$.sh
-  chmod +x conf$$.sh
-  if (PATH="/nonexistent;."; conf$$.sh) >/dev/null 2>&1; then
-    PATH_SEPARATOR=';'
-  else
-    PATH_SEPARATOR=:
-  fi
-  rm -f conf$$.sh
-fi
-
-
-  as_lineno_1=$LINENO
-  as_lineno_2=$LINENO
-  as_lineno_3=`(expr $as_lineno_1 + 1) 2>/dev/null`
-  test "x$as_lineno_1" != "x$as_lineno_2" &&
-  test "x$as_lineno_3"  = "x$as_lineno_2"  || {
-  # Find who we are.  Look in the path if we contain no path at all
-  # relative or not.
-  case $0 in
-    *[\\/]* ) as_myself=$0 ;;
-    *) as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  test -r "$as_dir/$0" && as_myself=$as_dir/$0 && break
-done
-
-       ;;
-  esac
-  # We did not find ourselves, most probably we were run as `sh COMMAND'
-  # in which case we are not to be found in the path.
-  if test "x$as_myself" = x; then
-    as_myself=$0
-  fi
-  if test ! -f "$as_myself"; then
-    { echo "$as_me: error: cannot find myself; rerun with an absolute path" >&2
-   { (exit 1); exit 1; }; }
-  fi
-  case $CONFIG_SHELL in
-  '')
-    as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in /bin$PATH_SEPARATOR/usr/bin$PATH_SEPARATOR$PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for as_base in sh bash ksh sh5; do
-	 case $as_dir in
-	 /*)
-	   if ("$as_dir/$as_base" -c '
-  as_lineno_1=$LINENO
-  as_lineno_2=$LINENO
-  as_lineno_3=`(expr $as_lineno_1 + 1) 2>/dev/null`
-  test "x$as_lineno_1" != "x$as_lineno_2" &&
-  test "x$as_lineno_3"  = "x$as_lineno_2" ') 2>/dev/null; then
-	     $as_unset BASH_ENV || test "${BASH_ENV+set}" != set || { BASH_ENV=; export BASH_ENV; }
-	     $as_unset ENV || test "${ENV+set}" != set || { ENV=; export ENV; }
-	     CONFIG_SHELL=$as_dir/$as_base
-	     export CONFIG_SHELL
-	     exec "$CONFIG_SHELL" "$0" ${1+"$@"}
-	   fi;;
-	 esac
-       done
-done
-;;
-  esac
-
-  # Create $as_me.lineno as a copy of $as_myself, but with $LINENO
-  # uniformly replaced by the line number.  The first 'sed' inserts a
-  # line-number line before each line; the second 'sed' does the real
-  # work.  The second script uses 'N' to pair each line-number line
-  # with the numbered line, and appends trailing '-' during
-  # substitution so that $LINENO is not a special case at line end.
-  # (Raja R Harinath suggested sed '=', and Paul Eggert wrote the
-  # second 'sed' script.  Blame Lee E. McMahon for sed's syntax.  :-)
-  sed '=' <$as_myself |
-    sed '
-      N
-      s,$,-,
-      : loop
-      s,^\(['$as_cr_digits']*\)\(.*\)[$]LINENO\([^'$as_cr_alnum'_]\),\1\2\1\3,
-      t loop
-      s,-$,,
-      s,^['$as_cr_digits']*\n,,
-    ' >$as_me.lineno &&
-  chmod +x $as_me.lineno ||
-    { echo "$as_me: error: cannot create $as_me.lineno; rerun with a POSIX shell" >&2
-   { (exit 1); exit 1; }; }
-
-  # Don't try to exec as it changes $[0], causing all sort of problems
-  # (the dirname of $[0] is not the place where we might find the
-  # original and so on.  Autoconf is especially sensible to this).
-  . ./$as_me.lineno
-  # Exit status is that of the last command.
-  exit
-}
-
-
-case `echo "testing\c"; echo 1,2,3`,`echo -n testing; echo 1,2,3` in
-  *c*,-n*) ECHO_N= ECHO_C='
-' ECHO_T='	' ;;
-  *c*,*  ) ECHO_N=-n ECHO_C= ECHO_T= ;;
-  *)       ECHO_N= ECHO_C='\c' ECHO_T= ;;
-esac
-
-if expr a : '\(a\)' >/dev/null 2>&1; then
-  as_expr=expr
-else
-  as_expr=false
-fi
-
-rm -f conf$$ conf$$.exe conf$$.file
-echo >conf$$.file
-if ln -s conf$$.file conf$$ 2>/dev/null; then
-  # We could just check for DJGPP; but this test a) works b) is more generic
-  # and c) will remain valid once DJGPP supports symlinks (DJGPP 2.04).
-  if test -f conf$$.exe; then
-    # Don't use ln at all; we don't have any links
-    as_ln_s='cp -p'
-  else
-    as_ln_s='ln -s'
-  fi
-elif ln conf$$.file conf$$ 2>/dev/null; then
-  as_ln_s=ln
-else
-  as_ln_s='cp -p'
-fi
-rm -f conf$$ conf$$.exe conf$$.file
-
-if mkdir -p . 2>/dev/null; then
-  as_mkdir_p=:
-else
-  test -d ./-p && rmdir ./-p
-  as_mkdir_p=false
-fi
-
-as_executable_p="test -f"
-
-# Sed expression to map a string onto a valid CPP name.
-as_tr_cpp="eval sed 'y%*$as_cr_letters%P$as_cr_LETTERS%;s%[^_$as_cr_alnum]%_%g'"
-
-# Sed expression to map a string onto a valid variable name.
-as_tr_sh="eval sed 'y%*+%pp%;s%[^_$as_cr_alnum]%_%g'"
-
-
-# IFS
-# We need space, tab and new line, in precisely that order.
-as_nl='
-'
-IFS=" 	$as_nl"
-
-# CDPATH.
-$as_unset CDPATH
-
-
-# Name of the host.
-# hostname on some systems (SVR3.2, Linux) returns a bogus exit status,
-# so uname gets run too.
-ac_hostname=`(hostname || uname -n) 2>/dev/null | sed 1q`
-
-exec 6>&1
-
-#
-# Initializations.
-#
+# Defaults:
+ac_help=
 ac_default_prefix=/usr/local
-ac_config_libobj_dir=.
-cross_compiling=no
-subdirs=
-MFLAGS=
-MAKEFLAGS=
-SHELL=${CONFIG_SHELL-/bin/sh}
+# Any additions from configure.in:
+ac_help="$ac_help
+  --disable-darwin        Disable Darwin (Mac OS X) support."
+ac_help="$ac_help
+  --with-mac-arch=ARCH    current, intel, ppc or both"
+ac_help="$ac_help
+  --with-vim-name=NAME    what to call the Vim executable"
+ac_help="$ac_help
+  --with-ex-name=NAME     what to call the Ex executable"
+ac_help="$ac_help
+  --with-view-name=NAME   what to call the View executable"
+ac_help="$ac_help
+  --with-global-runtime=DIR    global runtime directory in 'runtimepath'"
+ac_help="$ac_help
+  --with-modified-by=NAME       name of who modified a release version"
+ac_help="$ac_help
+  --with-features=TYPE    tiny, small, normal, big or huge (default: normal)"
+ac_help="$ac_help
+  --with-compiledby=NAME  name to show in :version message"
+ac_help="$ac_help
+  --disable-xsmp          Disable XSMP session management"
+ac_help="$ac_help
+  --disable-xsmp-interact Disable XSMP interaction"
+ac_help="$ac_help
+  --enable-mzschemeinterp   Include MzScheme interpreter."
+ac_help="$ac_help
+  --with-plthome=PLTHOME   Use PLTHOME."
+ac_help="$ac_help
+  --enable-perlinterp     Include Perl interpreter."
+ac_help="$ac_help
+  --enable-pythoninterp   Include Python interpreter."
+ac_help="$ac_help
+  --with-python-config-dir=PATH  Python's config directory"
+ac_help="$ac_help
+  --enable-tclinterp      Include Tcl interpreter."
+ac_help="$ac_help
+  --with-tclsh=PATH       which tclsh to use (default: tclsh8.0)"
+ac_help="$ac_help
+  --enable-rubyinterp     Include Ruby interpreter."
+ac_help="$ac_help
+  --enable-cscope         Include cscope interface."
+ac_help="$ac_help
+  --enable-workshop       Include Sun Visual Workshop support."
+ac_help="$ac_help
+  --disable-netbeans      Disable NetBeans integration support."
+ac_help="$ac_help
+  --enable-sniff          Include Sniff interface."
+ac_help="$ac_help
+  --enable-multibyte      Include multibyte editing support."
+ac_help="$ac_help
+  --enable-hangulinput    Include Hangul input support."
+ac_help="$ac_help
+  --enable-xim            Include XIM input support."
+ac_help="$ac_help
+  --enable-fontset        Include X fontset output support."
+ac_help="$ac_help
+  --with-x                use the X Window System"
+ac_help="$ac_help
+  --enable-gui[=OPTS]     X11 GUI [default=auto] [OPTS=auto/no/gtk/gtk2/gnome/gnome2/motif/athena/neXtaw/photon/carbon]"
+ac_help="$ac_help
+  --enable-gtk-check      If auto-select GUI, check for GTK [default=yes]"
+ac_help="$ac_help
+  --enable-gtk2-check     If GTK GUI, check for GTK+ 2 [default=yes]"
+ac_help="$ac_help
+  --enable-gnome-check    If GTK GUI, check for GNOME [default=no]"
+ac_help="$ac_help
+  --enable-motif-check    If auto-select GUI, check for Motif [default=yes]"
+ac_help="$ac_help
+  --enable-athena-check   If auto-select GUI, check for Athena [default=yes]"
+ac_help="$ac_help
+  --enable-nextaw-check   If auto-select GUI, check for neXtaw [default=yes]"
+ac_help="$ac_help
+  --enable-carbon-check   If auto-select GUI, check for Carbon [default=yes]"
+ac_help="$ac_help
+  --with-gtk-prefix=PFX   Prefix where GTK is installed (optional)"
+ac_help="$ac_help
+  --with-gtk-exec-prefix=PFX Exec prefix where GTK is installed (optional)"
+ac_help="$ac_help
+  --disable-gtktest       Do not try to compile and run a test GTK program"
+ac_help="$ac_help
+  --with-gnome-includes=DIR Specify location of GNOME headers"
+ac_help="$ac_help
+  --with-gnome-libs=DIR   Specify location of GNOME libs"
+ac_help="$ac_help
+  --with-gnome            Specify prefix for GNOME files"
+ac_help="$ac_help
+  --with-motif-lib=STRING   Library for Motif "
+ac_help="$ac_help
+  --with-tlib=library     terminal library to be used "
+ac_help="$ac_help
+  --disable-acl           Don't check for ACL support."
+ac_help="$ac_help
+  --disable-gpm           Don't use gpm (Linux mouse daemon)."
+ac_help="$ac_help
+  --disable-nls           Don't support NLS (gettext())."
 
-# Maximum number of lines to put in a shell here document.
-# This variable seems obsolete.  It should probably be removed, and
-# only ac_max_sed_lines should be used.
-: ${ac_max_here_lines=38}
-
-# Identity of this package.
-PACKAGE_NAME=
-PACKAGE_TARNAME=
-PACKAGE_VERSION=
-PACKAGE_STRING=
-PACKAGE_BUGREPORT=
-
-ac_unique_file="vim.h"
-# Factoring default headers for most tests.
-ac_includes_default="\
-#include <stdio.h>
-#if HAVE_SYS_TYPES_H
-# include <sys/types.h>
-#endif
-#if HAVE_SYS_STAT_H
-# include <sys/stat.h>
-#endif
-#if STDC_HEADERS
-# include <stdlib.h>
-# include <stddef.h>
-#else
-# if HAVE_STDLIB_H
-#  include <stdlib.h>
-# endif
-#endif
-#if HAVE_STRING_H
-# if !STDC_HEADERS && HAVE_MEMORY_H
-#  include <memory.h>
-# endif
-# include <string.h>
-#endif
-#if HAVE_STRINGS_H
-# include <strings.h>
-#endif
-#if HAVE_INTTYPES_H
-# include <inttypes.h>
-#else
-# if HAVE_STDINT_H
-#  include <stdint.h>
-# endif
-#endif
-#if HAVE_UNISTD_H
-# include <unistd.h>
-#endif"
-
-ac_subst_vars='SHELL PATH_SEPARATOR PACKAGE_NAME PACKAGE_TARNAME PACKAGE_VERSION PACKAGE_STRING PACKAGE_BUGREPORT exec_prefix prefix program_transform_name bindir sbindir libexecdir datadir sysconfdir sharedstatedir localstatedir libdir includedir oldincludedir infodir mandir build_alias host_alias target_alias DEFS ECHO_C ECHO_N ECHO_T LIBS SET_MAKE CC CFLAGS LDFLAGS CPPFLAGS ac_ct_CC EXEEXT OBJEXT CPP EGREP AWK STRIP CPP_MM OS_EXTRA_SRC OS_EXTRA_OBJ VIMNAME EXNAME VIEWNAME line_break dovimdiff dogvimdiff compiledby vi_cv_path_mzscheme MZSCHEME_SRC MZSCHEME_OBJ MZSCHEME_PRO MZSCHEME_LIBS MZSCHEME_CFLAGS vi_cv_path_perl vi_cv_perllib shrpenv PERL_SRC PERL_OBJ PERL_PRO PERL_CFLAGS PERL_LIBS vi_cv_path_python PYTHON_CONFDIR PYTHON_LIBS PYTHON_GETPATH_CFLAGS PYTHON_CFLAGS PYTHON_SRC PYTHON_OBJ vi_cv_path_tcl TCL_SRC TCL_OBJ TCL_PRO TCL_CFLAGS TCL_LIBS vi_cv_path_ruby RUBY_SRC RUBY_OBJ RUBY_PRO RUBY_CFLAGS RUBY_LIBS WORKSHOP_SRC WORKSHOP_OBJ NETBEANS_SRC NETBEANS_OBJ SNIFF_SRC SNIFF_OBJ xmkmfpath X_CFLAGS X_PRE_LIBS X_LIBS X_EXTRA_LIBS X_LIB GTK_CONFIG GTK12_CONFIG PKG_CONFIG GTK_CFLAGS GTK_LIBS GTK_LIBNAME GNOME_LIBS GNOME_LIBDIR GNOME_INCLUDEDIR GNOME_CONFIG MOTIF_LIBNAME NARROW_PROTO GUI_INC_LOC GUI_LIB_LOC GUITYPE GUI_X_LIBS HANGULIN_SRC HANGULIN_OBJ TAGPRG INSTALL_LANGS INSTALL_TOOL_LANGS MSGFMT MAKEMO DEPEND_CFLAGS_FILTER LIBOBJS LTLIBOBJS'
-ac_subst_files=''
-
 # Initialize some variables set by options.
-ac_init_help=
-ac_init_version=false
 # The variables have the same names as the options, with
 # dashes changed to underlines.
-cache_file=/dev/null
+build=NONE
+cache_file=./config.cache
 exec_prefix=NONE
+host=NONE
 no_create=
+nonopt=NONE
 no_recursion=
 prefix=NONE
 program_prefix=NONE
@@ -328,15 +123,10 @@
 silent=
 site=
 srcdir=
+target=NONE
 verbose=
 x_includes=NONE
 x_libraries=NONE
-
-# Installation directory options.
-# These are left unexpanded so users can "make install exec_prefix=/foo"
-# and all the variables that are supposed to be based on exec_prefix
-# by default will actually change.
-# Use braces instead of parens because sh, perl, etc. also accept them.
 bindir='${exec_prefix}/bin'
 sbindir='${exec_prefix}/sbin'
 libexecdir='${exec_prefix}/libexec'
@@ -350,9 +140,17 @@
 infodir='${prefix}/info'
 mandir='${prefix}/man'
 
+# Initialize some other variables.
+subdirs=
+MFLAGS= MAKEFLAGS=
+SHELL=${CONFIG_SHELL-/bin/sh}
+# Maximum number of lines to put in a shell here document.
+ac_max_here_lines=12
+
 ac_prev=
 for ac_option
 do
+
   # If the previous option needs an argument, assign it.
   if test -n "$ac_prev"; then
     eval "$ac_prev=\$ac_option"
@@ -360,59 +158,59 @@
     continue
   fi
 
-  ac_optarg=`expr "x$ac_option" : 'x[^=]*=\(.*\)'`
+  case "$ac_option" in
+  -*=*) ac_optarg=`echo "$ac_option" | sed 's/[-_a-zA-Z0-9]*=//'` ;;
+  *) ac_optarg= ;;
+  esac
 
   # Accept the important Cygnus configure options, so we can diagnose typos.
 
-  case $ac_option in
+  case "$ac_option" in
 
   -bindir | --bindir | --bindi | --bind | --bin | --bi)
     ac_prev=bindir ;;
   -bindir=* | --bindir=* | --bindi=* | --bind=* | --bin=* | --bi=*)
-    bindir=$ac_optarg ;;
+    bindir="$ac_optarg" ;;
 
   -build | --build | --buil | --bui | --bu)
-    ac_prev=build_alias ;;
+    ac_prev=build ;;
   -build=* | --build=* | --buil=* | --bui=* | --bu=*)
-    build_alias=$ac_optarg ;;
+    build="$ac_optarg" ;;
 
   -cache-file | --cache-file | --cache-fil | --cache-fi \
   | --cache-f | --cache- | --cache | --cach | --cac | --ca | --c)
     ac_prev=cache_file ;;
   -cache-file=* | --cache-file=* | --cache-fil=* | --cache-fi=* \
   | --cache-f=* | --cache-=* | --cache=* | --cach=* | --cac=* | --ca=* | --c=*)
-    cache_file=$ac_optarg ;;
+    cache_file="$ac_optarg" ;;
 
-  --config-cache | -C)
-    cache_file=config.cache ;;
-
   -datadir | --datadir | --datadi | --datad | --data | --dat | --da)
     ac_prev=datadir ;;
   -datadir=* | --datadir=* | --datadi=* | --datad=* | --data=* | --dat=* \
   | --da=*)
-    datadir=$ac_optarg ;;
+    datadir="$ac_optarg" ;;
 
   -disable-* | --disable-*)
-    ac_feature=`expr "x$ac_option" : 'x-*disable-\(.*\)'`
+    ac_feature=`echo $ac_option|sed -e 's/-*disable-//'`
     # Reject names that are not valid shell variable names.
-    expr "x$ac_feature" : ".*[^-_$as_cr_alnum]" >/dev/null &&
-      { echo "$as_me: error: invalid feature name: $ac_feature" >&2
-   { (exit 1); exit 1; }; }
-    ac_feature=`echo $ac_feature | sed 's/-/_/g'`
-    eval "enable_$ac_feature=no" ;;
+    if test -n "`echo $ac_feature| sed 's/[-a-zA-Z0-9_]//g'`"; then
+      { echo "configure: error: $ac_feature: invalid feature name" 1>&2; exit 1; }
+    fi
+    ac_feature=`echo $ac_feature| sed 's/-/_/g'`
+    eval "enable_${ac_feature}=no" ;;
 
   -enable-* | --enable-*)
-    ac_feature=`expr "x$ac_option" : 'x-*enable-\([^=]*\)'`
+    ac_feature=`echo $ac_option|sed -e 's/-*enable-//' -e 's/=.*//'`
     # Reject names that are not valid shell variable names.
-    expr "x$ac_feature" : ".*[^-_$as_cr_alnum]" >/dev/null &&
-      { echo "$as_me: error: invalid feature name: $ac_feature" >&2
-   { (exit 1); exit 1; }; }
-    ac_feature=`echo $ac_feature | sed 's/-/_/g'`
-    case $ac_option in
-      *=*) ac_optarg=`echo "$ac_optarg" | sed "s/'/'\\\\\\\\''/g"`;;
+    if test -n "`echo $ac_feature| sed 's/[-_a-zA-Z0-9]//g'`"; then
+      { echo "configure: error: $ac_feature: invalid feature name" 1>&2; exit 1; }
+    fi
+    ac_feature=`echo $ac_feature| sed 's/-/_/g'`
+    case "$ac_option" in
+      *=*) ;;
       *) ac_optarg=yes ;;
     esac
-    eval "enable_$ac_feature='$ac_optarg'" ;;
+    eval "enable_${ac_feature}='$ac_optarg'" ;;
 
   -exec-prefix | --exec_prefix | --exec-prefix | --exec-prefi \
   | --exec-pref | --exec-pre | --exec-pr | --exec-p | --exec- \
@@ -421,47 +219,95 @@
   -exec-prefix=* | --exec_prefix=* | --exec-prefix=* | --exec-prefi=* \
   | --exec-pref=* | --exec-pre=* | --exec-pr=* | --exec-p=* | --exec-=* \
   | --exec=* | --exe=* | --ex=*)
-    exec_prefix=$ac_optarg ;;
+    exec_prefix="$ac_optarg" ;;
 
   -gas | --gas | --ga | --g)
     # Obsolete; use --with-gas.
     with_gas=yes ;;
 
-  -help | --help | --hel | --he | -h)
-    ac_init_help=long ;;
-  -help=r* | --help=r* | --hel=r* | --he=r* | -hr*)
-    ac_init_help=recursive ;;
-  -help=s* | --help=s* | --hel=s* | --he=s* | -hs*)
-    ac_init_help=short ;;
+  -help | --help | --hel | --he)
+    # Omit some internal or obsolete options to make the list less imposing.
+    # This message is too long to be a string in the A/UX 3.1 sh.
+    cat << EOF
+Usage: configure [options] [host]
+Options: [defaults in brackets after descriptions]
+Configuration:
+  --cache-file=FILE       cache test results in FILE
+  --help                  print this message
+  --no-create             do not create output files
+  --quiet, --silent       do not print \`checking...' messages
+  --version               print the version of autoconf that created configure
+Directory and file names:
+  --prefix=PREFIX         install architecture-independent files in PREFIX
+                          [$ac_default_prefix]
+  --exec-prefix=EPREFIX   install architecture-dependent files in EPREFIX
+                          [same as prefix]
+  --bindir=DIR            user executables in DIR [EPREFIX/bin]
+  --sbindir=DIR           system admin executables in DIR [EPREFIX/sbin]
+  --libexecdir=DIR        program executables in DIR [EPREFIX/libexec]
+  --datadir=DIR           read-only architecture-independent data in DIR
+                          [PREFIX/share]
+  --sysconfdir=DIR        read-only single-machine data in DIR [PREFIX/etc]
+  --sharedstatedir=DIR    modifiable architecture-independent data in DIR
+                          [PREFIX/com]
+  --localstatedir=DIR     modifiable single-machine data in DIR [PREFIX/var]
+  --libdir=DIR            object code libraries in DIR [EPREFIX/lib]
+  --includedir=DIR        C header files in DIR [PREFIX/include]
+  --oldincludedir=DIR     C header files for non-gcc in DIR [/usr/include]
+  --infodir=DIR           info documentation in DIR [PREFIX/info]
+  --mandir=DIR            man documentation in DIR [PREFIX/man]
+  --srcdir=DIR            find the sources in DIR [configure dir or ..]
+  --program-prefix=PREFIX prepend PREFIX to installed program names
+  --program-suffix=SUFFIX append SUFFIX to installed program names
+  --program-transform-name=PROGRAM
+                          run sed PROGRAM on installed program names
+EOF
+    cat << EOF
+Host type:
+  --build=BUILD           configure for building on BUILD [BUILD=HOST]
+  --host=HOST             configure for HOST [guessed]
+  --target=TARGET         configure for TARGET [TARGET=HOST]
+Features and packages:
+  --disable-FEATURE       do not include FEATURE (same as --enable-FEATURE=no)
+  --enable-FEATURE[=ARG]  include FEATURE [ARG=yes]
+  --with-PACKAGE[=ARG]    use PACKAGE [ARG=yes]
+  --without-PACKAGE       do not use PACKAGE (same as --with-PACKAGE=no)
+  --x-includes=DIR        X include files are in DIR
+  --x-libraries=DIR       X library files are in DIR
+EOF
+    if test -n "$ac_help"; then
+      echo "--enable and --with options recognized:$ac_help"
+    fi
+    exit 0 ;;
 
   -host | --host | --hos | --ho)
-    ac_prev=host_alias ;;
+    ac_prev=host ;;
   -host=* | --host=* | --hos=* | --ho=*)
-    host_alias=$ac_optarg ;;
+    host="$ac_optarg" ;;
 
   -includedir | --includedir | --includedi | --included | --include \
   | --includ | --inclu | --incl | --inc)
     ac_prev=includedir ;;
   -includedir=* | --includedir=* | --includedi=* | --included=* | --include=* \
   | --includ=* | --inclu=* | --incl=* | --inc=*)
-    includedir=$ac_optarg ;;
+    includedir="$ac_optarg" ;;
 
   -infodir | --infodir | --infodi | --infod | --info | --inf)
     ac_prev=infodir ;;
   -infodir=* | --infodir=* | --infodi=* | --infod=* | --info=* | --inf=*)
-    infodir=$ac_optarg ;;
+    infodir="$ac_optarg" ;;
 
   -libdir | --libdir | --libdi | --libd)
     ac_prev=libdir ;;
   -libdir=* | --libdir=* | --libdi=* | --libd=*)
-    libdir=$ac_optarg ;;
+    libdir="$ac_optarg" ;;
 
   -libexecdir | --libexecdir | --libexecdi | --libexecd | --libexec \
   | --libexe | --libex | --libe)
     ac_prev=libexecdir ;;
   -libexecdir=* | --libexecdir=* | --libexecdi=* | --libexecd=* | --libexec=* \
   | --libexe=* | --libex=* | --libe=*)
-    libexecdir=$ac_optarg ;;
+    libexecdir="$ac_optarg" ;;
 
   -localstatedir | --localstatedir | --localstatedi | --localstated \
   | --localstate | --localstat | --localsta | --localst \
@@ -470,19 +316,19 @@
   -localstatedir=* | --localstatedir=* | --localstatedi=* | --localstated=* \
   | --localstate=* | --localstat=* | --localsta=* | --localst=* \
   | --locals=* | --local=* | --loca=* | --loc=* | --lo=*)
-    localstatedir=$ac_optarg ;;
+    localstatedir="$ac_optarg" ;;
 
   -mandir | --mandir | --mandi | --mand | --man | --ma | --m)
     ac_prev=mandir ;;
   -mandir=* | --mandir=* | --mandi=* | --mand=* | --man=* | --ma=* | --m=*)
-    mandir=$ac_optarg ;;
+    mandir="$ac_optarg" ;;
 
   -nfp | --nfp | --nf)
     # Obsolete; use --without-fp.
     with_fp=no ;;
 
   -no-create | --no-create | --no-creat | --no-crea | --no-cre \
-  | --no-cr | --no-c | -n)
+  | --no-cr | --no-c)
     no_create=yes ;;
 
   -no-recursion | --no-recursion | --no-recursio | --no-recursi \
@@ -496,26 +342,26 @@
   -oldincludedir=* | --oldincludedir=* | --oldincludedi=* | --oldincluded=* \
   | --oldinclude=* | --oldinclud=* | --oldinclu=* | --oldincl=* | --oldinc=* \
   | --oldin=* | --oldi=* | --old=* | --ol=* | --o=*)
-    oldincludedir=$ac_optarg ;;
+    oldincludedir="$ac_optarg" ;;
 
   -prefix | --prefix | --prefi | --pref | --pre | --pr | --p)
     ac_prev=prefix ;;
   -prefix=* | --prefix=* | --prefi=* | --pref=* | --pre=* | --pr=* | --p=*)
-    prefix=$ac_optarg ;;
+    prefix="$ac_optarg" ;;
 
   -program-prefix | --program-prefix | --program-prefi | --program-pref \
   | --program-pre | --program-pr | --program-p)
     ac_prev=program_prefix ;;
   -program-prefix=* | --program-prefix=* | --program-prefi=* \
   | --program-pref=* | --program-pre=* | --program-pr=* | --program-p=*)
-    program_prefix=$ac_optarg ;;
+    program_prefix="$ac_optarg" ;;
 
   -program-suffix | --program-suffix | --program-suffi | --program-suff \
   | --program-suf | --program-su | --program-s)
     ac_prev=program_suffix ;;
   -program-suffix=* | --program-suffix=* | --program-suffi=* \
   | --program-suff=* | --program-suf=* | --program-su=* | --program-s=*)
-    program_suffix=$ac_optarg ;;
+    program_suffix="$ac_optarg" ;;
 
   -program-transform-name | --program-transform-name \
   | --program-transform-nam | --program-transform-na \
@@ -532,7 +378,7 @@
   | --program-transfo=* | --program-transf=* \
   | --program-trans=* | --program-tran=* \
   | --progr-tra=* | --program-tr=* | --program-t=*)
-    program_transform_name=$ac_optarg ;;
+    program_transform_name="$ac_optarg" ;;
 
   -q | -quiet | --quiet | --quie | --qui | --qu | --q \
   | -silent | --silent | --silen | --sile | --sil)
@@ -542,7 +388,7 @@
     ac_prev=sbindir ;;
   -sbindir=* | --sbindir=* | --sbindi=* | --sbind=* | --sbin=* \
   | --sbi=* | --sb=*)
-    sbindir=$ac_optarg ;;
+    sbindir="$ac_optarg" ;;
 
   -sharedstatedir | --sharedstatedir | --sharedstatedi \
   | --sharedstated | --sharedstate | --sharedstat | --sharedsta \
@@ -553,57 +399,58 @@
   | --sharedstated=* | --sharedstate=* | --sharedstat=* | --sharedsta=* \
   | --sharedst=* | --shareds=* | --shared=* | --share=* | --shar=* \
   | --sha=* | --sh=*)
-    sharedstatedir=$ac_optarg ;;
+    sharedstatedir="$ac_optarg" ;;
 
   -site | --site | --sit)
     ac_prev=site ;;
   -site=* | --site=* | --sit=*)
-    site=$ac_optarg ;;
+    site="$ac_optarg" ;;
 
   -srcdir | --srcdir | --srcdi | --srcd | --src | --sr)
     ac_prev=srcdir ;;
   -srcdir=* | --srcdir=* | --srcdi=* | --srcd=* | --src=* | --sr=*)
-    srcdir=$ac_optarg ;;
+    srcdir="$ac_optarg" ;;
 
   -sysconfdir | --sysconfdir | --sysconfdi | --sysconfd | --sysconf \
   | --syscon | --sysco | --sysc | --sys | --sy)
     ac_prev=sysconfdir ;;
   -sysconfdir=* | --sysconfdir=* | --sysconfdi=* | --sysconfd=* | --sysconf=* \
   | --syscon=* | --sysco=* | --sysc=* | --sys=* | --sy=*)
-    sysconfdir=$ac_optarg ;;
+    sysconfdir="$ac_optarg" ;;
 
   -target | --target | --targe | --targ | --tar | --ta | --t)
-    ac_prev=target_alias ;;
+    ac_prev=target ;;
   -target=* | --target=* | --targe=* | --targ=* | --tar=* | --ta=* | --t=*)
-    target_alias=$ac_optarg ;;
+    target="$ac_optarg" ;;
 
   -v | -verbose | --verbose | --verbos | --verbo | --verb)
     verbose=yes ;;
 
-  -version | --version | --versio | --versi | --vers | -V)
-    ac_init_version=: ;;
+  -version | --version | --versio | --versi | --vers)
+    echo "configure generated by autoconf version 2.13"
+    exit 0 ;;
 
   -with-* | --with-*)
-    ac_package=`expr "x$ac_option" : 'x-*with-\([^=]*\)'`
+    ac_package=`echo $ac_option|sed -e 's/-*with-//' -e 's/=.*//'`
     # Reject names that are not valid shell variable names.
-    expr "x$ac_package" : ".*[^-_$as_cr_alnum]" >/dev/null &&
-      { echo "$as_me: error: invalid package name: $ac_package" >&2
-   { (exit 1); exit 1; }; }
+    if test -n "`echo $ac_package| sed 's/[-_a-zA-Z0-9]//g'`"; then
+      { echo "configure: error: $ac_package: invalid package name" 1>&2; exit 1; }
+    fi
     ac_package=`echo $ac_package| sed 's/-/_/g'`
-    case $ac_option in
-      *=*) ac_optarg=`echo "$ac_optarg" | sed "s/'/'\\\\\\\\''/g"`;;
+    case "$ac_option" in
+      *=*) ;;
       *) ac_optarg=yes ;;
     esac
-    eval "with_$ac_package='$ac_optarg'" ;;
+    eval "with_${ac_package}='$ac_optarg'" ;;
 
   -without-* | --without-*)
-    ac_package=`expr "x$ac_option" : 'x-*without-\(.*\)'`
+    ac_package=`echo $ac_option|sed -e 's/-*without-//'`
     # Reject names that are not valid shell variable names.
-    expr "x$ac_package" : ".*[^-_$as_cr_alnum]" >/dev/null &&
-      { echo "$as_me: error: invalid package name: $ac_package" >&2
-   { (exit 1); exit 1; }; }
-    ac_package=`echo $ac_package | sed 's/-/_/g'`
-    eval "with_$ac_package=no" ;;
+    if test -n "`echo $ac_package| sed 's/[-a-zA-Z0-9_]//g'`"; then
+      { echo "configure: error: $ac_package: invalid package name" 1>&2; exit 1; }
+    fi
+    ac_package=`echo $ac_package| sed 's/-/_/g'`
+    eval "with_${ac_package}=no" ;;
 
   --x)
     # Obsolete; use --with-x.
@@ -614,110 +461,99 @@
     ac_prev=x_includes ;;
   -x-includes=* | --x-includes=* | --x-include=* | --x-includ=* | --x-inclu=* \
   | --x-incl=* | --x-inc=* | --x-in=* | --x-i=*)
-    x_includes=$ac_optarg ;;
+    x_includes="$ac_optarg" ;;
 
   -x-libraries | --x-libraries | --x-librarie | --x-librari \
   | --x-librar | --x-libra | --x-libr | --x-lib | --x-li | --x-l)
     ac_prev=x_libraries ;;
   -x-libraries=* | --x-libraries=* | --x-librarie=* | --x-librari=* \
   | --x-librar=* | --x-libra=* | --x-libr=* | --x-lib=* | --x-li=* | --x-l=*)
-    x_libraries=$ac_optarg ;;
+    x_libraries="$ac_optarg" ;;
 
-  -*) { echo "$as_me: error: unrecognized option: $ac_option
-Try \`$0 --help' for more information." >&2
-   { (exit 1); exit 1; }; }
+  -*) { echo "configure: error: $ac_option: invalid option; use --help to show usage" 1>&2; exit 1; }
     ;;
 
-  *=*)
-    ac_envvar=`expr "x$ac_option" : 'x\([^=]*\)='`
-    # Reject names that are not valid shell variable names.
-    expr "x$ac_envvar" : ".*[^_$as_cr_alnum]" >/dev/null &&
-      { echo "$as_me: error: invalid variable name: $ac_envvar" >&2
-   { (exit 1); exit 1; }; }
-    ac_optarg=`echo "$ac_optarg" | sed "s/'/'\\\\\\\\''/g"`
-    eval "$ac_envvar='$ac_optarg'"
-    export $ac_envvar ;;
-
   *)
-    # FIXME: should be removed in autoconf 3.0.
-    echo "$as_me: WARNING: you should use --build, --host, --target" >&2
-    expr "x$ac_option" : ".*[^-._$as_cr_alnum]" >/dev/null &&
-      echo "$as_me: WARNING: invalid host type: $ac_option" >&2
-    : ${build_alias=$ac_option} ${host_alias=$ac_option} ${target_alias=$ac_option}
+    if test -n "`echo $ac_option| sed 's/[-a-z0-9.]//g'`"; then
+      echo "configure: warning: $ac_option: invalid host type" 1>&2
+    fi
+    if test "x$nonopt" != xNONE; then
+      { echo "configure: error: can only configure for one host and one target at a time" 1>&2; exit 1; }
+    fi
+    nonopt="$ac_option"
     ;;
 
   esac
 done
 
 if test -n "$ac_prev"; then
-  ac_option=--`echo $ac_prev | sed 's/_/-/g'`
-  { echo "$as_me: error: missing argument to $ac_option" >&2
-   { (exit 1); exit 1; }; }
+  { echo "configure: error: missing argument to --`echo $ac_prev | sed 's/_/-/g'`" 1>&2; exit 1; }
 fi
 
-# Be sure to have absolute paths.
-for ac_var in exec_prefix prefix
-do
-  eval ac_val=$`echo $ac_var`
-  case $ac_val in
-    [\\/$]* | ?:[\\/]* | NONE | '' ) ;;
-    *)  { echo "$as_me: error: expected an absolute directory name for --$ac_var: $ac_val" >&2
-   { (exit 1); exit 1; }; };;
-  esac
-done
+trap 'rm -fr conftest* confdefs* core core.* *.core $ac_clean_files; exit 1' 1 2 15
 
-# Be sure to have absolute paths.
-for ac_var in bindir sbindir libexecdir datadir sysconfdir sharedstatedir \
-	      localstatedir libdir includedir oldincludedir infodir mandir
+# File descriptor usage:
+# 0 standard input
+# 1 file creation
+# 2 errors and warnings
+# 3 some systems may open it to /dev/tty
+# 4 used on the Kubota Titan
+# 6 checking for... messages and results
+# 5 compiler messages saved in config.log
+if test "$silent" = yes; then
+  exec 6>/dev/null
+else
+  exec 6>&1
+fi
+exec 5>auto/config.log
+
+echo "\
+This file contains any messages produced by compilers while
+running configure, to aid debugging if configure makes a mistake.
+" 1>&5
+
+# Strip out --no-create and --no-recursion so they do not pile up.
+# Also quote any args containing shell metacharacters.
+ac_configure_args=
+for ac_arg
 do
-  eval ac_val=$`echo $ac_var`
-  case $ac_val in
-    [\\/$]* | ?:[\\/]* ) ;;
-    *)  { echo "$as_me: error: expected an absolute directory name for --$ac_var: $ac_val" >&2
-   { (exit 1); exit 1; }; };;
+  case "$ac_arg" in
+  -no-create | --no-create | --no-creat | --no-crea | --no-cre \
+  | --no-cr | --no-c) ;;
+  -no-recursion | --no-recursion | --no-recursio | --no-recursi \
+  | --no-recurs | --no-recur | --no-recu | --no-rec | --no-re | --no-r) ;;
+  *" "*|*"	"*|*[\[\]\~\#\$\^\&\*\(\)\{\}\\\|\;\<\>\?]*)
+  ac_configure_args="$ac_configure_args '$ac_arg'" ;;
+  *) ac_configure_args="$ac_configure_args $ac_arg" ;;
   esac
 done
 
-# There might be people who depend on the old broken behavior: `$host'
-# used to hold the argument of --host etc.
-# FIXME: To remove some day.
-build=$build_alias
-host=$host_alias
-target=$target_alias
+# NLS nuisances.
+# Only set these to C if already set.  These must not be set unconditionally
+# because not all systems understand e.g. LANG=C (notably SCO).
+# Fixing LC_MESSAGES prevents Solaris sh from translating var values in `set'!
+# Non-C LC_CTYPE values break the ctype check.
+if test "${LANG+set}"   = set; then LANG=C;   export LANG;   fi
+if test "${LC_ALL+set}" = set; then LC_ALL=C; export LC_ALL; fi
+if test "${LC_MESSAGES+set}" = set; then LC_MESSAGES=C; export LC_MESSAGES; fi
+if test "${LC_CTYPE+set}"    = set; then LC_CTYPE=C;    export LC_CTYPE;    fi
 
-# FIXME: To remove some day.
-if test "x$host_alias" != x; then
-  if test "x$build_alias" = x; then
-    cross_compiling=maybe
-    echo "$as_me: WARNING: If you wanted to set the --build type, don't use --host.
-    If a cross compiler is detected then cross compile mode will be used." >&2
-  elif test "x$build_alias" != "x$host_alias"; then
-    cross_compiling=yes
-  fi
-fi
+# confdefs.h avoids OS command line length limits that DEFS can exceed.
+rm -rf conftest* confdefs.h
+# AIX cpp loses on an empty file, so make sure it contains at least a newline.
+echo > confdefs.h
 
-ac_tool_prefix=
-test -n "$host_alias" && ac_tool_prefix=$host_alias-
+# A filename unique to this package, relative to the directory that
+# configure is in, which we can look for to find out if srcdir is correct.
+ac_unique_file=vim.h
 
-test "$silent" = yes && exec 6>/dev/null
-
-
 # Find the source files, if location was not specified.
 if test -z "$srcdir"; then
   ac_srcdir_defaulted=yes
   # Try the directory containing this script, then its parent.
-  ac_confdir=`(dirname "$0") 2>/dev/null ||
-$as_expr X"$0" : 'X\(.*[^/]\)//*[^/][^/]*/*$' \| \
-	 X"$0" : 'X\(//\)[^/]' \| \
-	 X"$0" : 'X\(//\)$' \| \
-	 X"$0" : 'X\(/\)' \| \
-	 .     : '\(.\)' 2>/dev/null ||
-echo X"$0" |
-    sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{ s//\1/; q; }
-  	  /^X\(\/\/\)[^/].*/{ s//\1/; q; }
-  	  /^X\(\/\/\)$/{ s//\1/; q; }
-  	  /^X\(\/\).*/{ s//\1/; q; }
-  	  s/.*/./; q'`
+  ac_prog=$0
+  ac_confdir=`echo $ac_prog|sed 's%/[^/][^/]*$%%'`
+  test "x$ac_confdir" = "x$ac_prog" && ac_confdir=.
   srcdir=$ac_confdir
   if test ! -r $srcdir/$ac_unique_file; then
     srcdir=..
@@ -727,513 +563,13 @@
 fi
 if test ! -r $srcdir/$ac_unique_file; then
   if test "$ac_srcdir_defaulted" = yes; then
-    { echo "$as_me: error: cannot find sources ($ac_unique_file) in $ac_confdir or .." >&2
-   { (exit 1); exit 1; }; }
+    { echo "configure: error: can not find sources in $ac_confdir or .." 1>&2; exit 1; }
   else
-    { echo "$as_me: error: cannot find sources ($ac_unique_file) in $srcdir" >&2
-   { (exit 1); exit 1; }; }
+    { echo "configure: error: can not find sources in $srcdir" 1>&2; exit 1; }
   fi
 fi
-(cd $srcdir && test -r ./$ac_unique_file) 2>/dev/null ||
-  { echo "$as_me: error: sources are in $srcdir, but \`cd $srcdir' does not work" >&2
-   { (exit 1); exit 1; }; }
-srcdir=`echo "$srcdir" | sed 's%\([^\\/]\)[\\/]*$%\1%'`
-ac_env_build_alias_set=${build_alias+set}
-ac_env_build_alias_value=$build_alias
-ac_cv_env_build_alias_set=${build_alias+set}
-ac_cv_env_build_alias_value=$build_alias
-ac_env_host_alias_set=${host_alias+set}
-ac_env_host_alias_value=$host_alias
-ac_cv_env_host_alias_set=${host_alias+set}
-ac_cv_env_host_alias_value=$host_alias
-ac_env_target_alias_set=${target_alias+set}
-ac_env_target_alias_value=$target_alias
-ac_cv_env_target_alias_set=${target_alias+set}
-ac_cv_env_target_alias_value=$target_alias
-ac_env_CC_set=${CC+set}
-ac_env_CC_value=$CC
-ac_cv_env_CC_set=${CC+set}
-ac_cv_env_CC_value=$CC
-ac_env_CFLAGS_set=${CFLAGS+set}
-ac_env_CFLAGS_value=$CFLAGS
-ac_cv_env_CFLAGS_set=${CFLAGS+set}
-ac_cv_env_CFLAGS_value=$CFLAGS
-ac_env_LDFLAGS_set=${LDFLAGS+set}
-ac_env_LDFLAGS_value=$LDFLAGS
-ac_cv_env_LDFLAGS_set=${LDFLAGS+set}
-ac_cv_env_LDFLAGS_value=$LDFLAGS
-ac_env_CPPFLAGS_set=${CPPFLAGS+set}
-ac_env_CPPFLAGS_value=$CPPFLAGS
-ac_cv_env_CPPFLAGS_set=${CPPFLAGS+set}
-ac_cv_env_CPPFLAGS_value=$CPPFLAGS
-ac_env_CPP_set=${CPP+set}
-ac_env_CPP_value=$CPP
-ac_cv_env_CPP_set=${CPP+set}
-ac_cv_env_CPP_value=$CPP
+srcdir=`echo "${srcdir}" | sed 's%\([^/]\)/*$%\1%'`
 
-#
-# Report the --help message.
-#
-if test "$ac_init_help" = "long"; then
-  # Omit some internal or obsolete options to make the list less imposing.
-  # This message is too long to be a string in the A/UX 3.1 sh.
-  cat <<_ACEOF
-\`configure' configures this package to adapt to many kinds of systems.
-
-Usage: $0 [OPTION]... [VAR=VALUE]...
-
-To assign environment variables (e.g., CC, CFLAGS...), specify them as
-VAR=VALUE.  See below for descriptions of some of the useful variables.
-
-Defaults for the options are specified in brackets.
-
-Configuration:
-  -h, --help              display this help and exit
-      --help=short        display options specific to this package
-      --help=recursive    display the short help of all the included packages
-  -V, --version           display version information and exit
-  -q, --quiet, --silent   do not print \`checking...' messages
-      --cache-file=FILE   cache test results in FILE [disabled]
-  -C, --config-cache      alias for \`--cache-file=config.cache'
-  -n, --no-create         do not create output files
-      --srcdir=DIR        find the sources in DIR [configure dir or \`..']
-
-_ACEOF
-
-  cat <<_ACEOF
-Installation directories:
-  --prefix=PREFIX         install architecture-independent files in PREFIX
-			  [$ac_default_prefix]
-  --exec-prefix=EPREFIX   install architecture-dependent files in EPREFIX
-			  [PREFIX]
-
-By default, \`make install' will install all the files in
-\`$ac_default_prefix/bin', \`$ac_default_prefix/lib' etc.  You can specify
-an installation prefix other than \`$ac_default_prefix' using \`--prefix',
-for instance \`--prefix=\$HOME'.
-
-For better control, use the options below.
-
-Fine tuning of the installation directories:
-  --bindir=DIR           user executables [EPREFIX/bin]
-  --sbindir=DIR          system admin executables [EPREFIX/sbin]
-  --libexecdir=DIR       program executables [EPREFIX/libexec]
-  --datadir=DIR          read-only architecture-independent data [PREFIX/share]
-  --sysconfdir=DIR       read-only single-machine data [PREFIX/etc]
-  --sharedstatedir=DIR   modifiable architecture-independent data [PREFIX/com]
-  --localstatedir=DIR    modifiable single-machine data [PREFIX/var]
-  --libdir=DIR           object code libraries [EPREFIX/lib]
-  --includedir=DIR       C header files [PREFIX/include]
-  --oldincludedir=DIR    C header files for non-gcc [/usr/include]
-  --infodir=DIR          info documentation [PREFIX/info]
-  --mandir=DIR           man documentation [PREFIX/man]
-_ACEOF
-
-  cat <<\_ACEOF
-
-X features:
-  --x-includes=DIR    X include files are in DIR
-  --x-libraries=DIR   X library files are in DIR
-_ACEOF
-fi
-
-if test -n "$ac_init_help"; then
-
-  cat <<\_ACEOF
-
-Optional Features:
-  --disable-FEATURE       do not include FEATURE (same as --enable-FEATURE=no)
-  --enable-FEATURE[=ARG]  include FEATURE [ARG=yes]
-  --disable-darwin        Disable Darwin (Mac OS X) support.
-  --disable-xsmp          Disable XSMP session management
-  --disable-xsmp-interact Disable XSMP interaction
-  --enable-mzschemeinterp   Include MzScheme interpreter.
-  --enable-perlinterp     Include Perl interpreter.
-  --enable-pythoninterp   Include Python interpreter.
-  --enable-tclinterp      Include Tcl interpreter.
-  --enable-rubyinterp     Include Ruby interpreter.
-  --enable-cscope         Include cscope interface.
-  --enable-workshop       Include Sun Visual Workshop support.
-  --disable-netbeans      Disable NetBeans integration support.
-  --enable-sniff          Include Sniff interface.
-  --enable-multibyte      Include multibyte editing support.
-  --enable-hangulinput    Include Hangul input support.
-  --enable-xim            Include XIM input support.
-  --enable-fontset        Include X fontset output support.
-  --enable-gui=OPTS     X11 GUI default=auto OPTS=auto/no/gtk/gtk2/gnome/gnome2/motif/athena/neXtaw/photon/carbon
-  --enable-gtk-check      If auto-select GUI, check for GTK default=yes
-  --enable-gtk2-check     If GTK GUI, check for GTK+ 2 default=yes
-  --enable-gnome-check    If GTK GUI, check for GNOME default=no
-  --enable-motif-check    If auto-select GUI, check for Motif default=yes
-  --enable-athena-check   If auto-select GUI, check for Athena default=yes
-  --enable-nextaw-check   If auto-select GUI, check for neXtaw default=yes
-  --enable-carbon-check   If auto-select GUI, check for Carbon default=yes
-  --disable-gtktest       Do not try to compile and run a test GTK program
-  --disable-acl           Don't check for ACL support.
-  --disable-gpm           Don't use gpm (Linux mouse daemon).
-  --disable-nls           Don't support NLS (gettext()).
-
-Optional Packages:
-  --with-PACKAGE[=ARG]    use PACKAGE [ARG=yes]
-  --without-PACKAGE       do not use PACKAGE (same as --with-PACKAGE=no)
-  --with-mac-arch=ARCH    current, intel, ppc or both
-  --with-vim-name=NAME    what to call the Vim executable
-  --with-ex-name=NAME     what to call the Ex executable
-  --with-view-name=NAME   what to call the View executable
-  --with-global-runtime=DIR    global runtime directory in 'runtimepath'
-  --with-modified-by=NAME       name of who modified a release version
-  --with-features=TYPE    tiny, small, normal, big or huge (default: normal)
-  --with-compiledby=NAME  name to show in :version message
-  --with-plthome=PLTHOME   Use PLTHOME.
-  --with-python-config-dir=PATH  Python's config directory
-  --with-tclsh=PATH       which tclsh to use (default: tclsh8.0)
-  --with-x                use the X Window System
-  --with-gtk-prefix=PFX   Prefix where GTK is installed (optional)
-  --with-gtk-exec-prefix=PFX Exec prefix where GTK is installed (optional)
-  --with-gnome-includes=DIR Specify location of GNOME headers
-  --with-gnome-libs=DIR   Specify location of GNOME libs
-  --with-gnome            Specify prefix for GNOME files
-  --with-motif-lib=STRING   Library for Motif
-  --with-tlib=library     terminal library to be used
-
-Some influential environment variables:
-  CC          C compiler command
-  CFLAGS      C compiler flags
-  LDFLAGS     linker flags, e.g. -L<lib dir> if you have libraries in a
-              nonstandard directory <lib dir>
-  CPPFLAGS    C/C++ preprocessor flags, e.g. -I<include dir> if you have
-              headers in a nonstandard directory <include dir>
-  CPP         C preprocessor
-
-Use these variables to override the choices made by `configure' or to help
-it to find libraries and programs with nonstandard names/locations.
-
-_ACEOF
-fi
-
-if test "$ac_init_help" = "recursive"; then
-  # If there are subdirs, report their specific --help.
-  ac_popdir=`pwd`
-  for ac_dir in : $ac_subdirs_all; do test "x$ac_dir" = x: && continue
-    test -d $ac_dir || continue
-    ac_builddir=.
-
-if test "$ac_dir" != .; then
-  ac_dir_suffix=/`echo "$ac_dir" | sed 's,^\.[\\/],,'`
-  # A "../" for each directory in $ac_dir_suffix.
-  ac_top_builddir=`echo "$ac_dir_suffix" | sed 's,/[^\\/]*,../,g'`
-else
-  ac_dir_suffix= ac_top_builddir=
-fi
-
-case $srcdir in
-  .)  # No --srcdir option.  We are building in place.
-    ac_srcdir=.
-    if test -z "$ac_top_builddir"; then
-       ac_top_srcdir=.
-    else
-       ac_top_srcdir=`echo $ac_top_builddir | sed 's,/$,,'`
-    fi ;;
-  [\\/]* | ?:[\\/]* )  # Absolute path.
-    ac_srcdir=$srcdir$ac_dir_suffix;
-    ac_top_srcdir=$srcdir ;;
-  *) # Relative path.
-    ac_srcdir=$ac_top_builddir$srcdir$ac_dir_suffix
-    ac_top_srcdir=$ac_top_builddir$srcdir ;;
-esac
-
-# Do not use `cd foo && pwd` to compute absolute paths, because
-# the directories may not exist.
-case `pwd` in
-.) ac_abs_builddir="$ac_dir";;
-*)
-  case "$ac_dir" in
-  .) ac_abs_builddir=`pwd`;;
-  [\\/]* | ?:[\\/]* ) ac_abs_builddir="$ac_dir";;
-  *) ac_abs_builddir=`pwd`/"$ac_dir";;
-  esac;;
-esac
-case $ac_abs_builddir in
-.) ac_abs_top_builddir=${ac_top_builddir}.;;
-*)
-  case ${ac_top_builddir}. in
-  .) ac_abs_top_builddir=$ac_abs_builddir;;
-  [\\/]* | ?:[\\/]* ) ac_abs_top_builddir=${ac_top_builddir}.;;
-  *) ac_abs_top_builddir=$ac_abs_builddir/${ac_top_builddir}.;;
-  esac;;
-esac
-case $ac_abs_builddir in
-.) ac_abs_srcdir=$ac_srcdir;;
-*)
-  case $ac_srcdir in
-  .) ac_abs_srcdir=$ac_abs_builddir;;
-  [\\/]* | ?:[\\/]* ) ac_abs_srcdir=$ac_srcdir;;
-  *) ac_abs_srcdir=$ac_abs_builddir/$ac_srcdir;;
-  esac;;
-esac
-case $ac_abs_builddir in
-.) ac_abs_top_srcdir=$ac_top_srcdir;;
-*)
-  case $ac_top_srcdir in
-  .) ac_abs_top_srcdir=$ac_abs_builddir;;
-  [\\/]* | ?:[\\/]* ) ac_abs_top_srcdir=$ac_top_srcdir;;
-  *) ac_abs_top_srcdir=$ac_abs_builddir/$ac_top_srcdir;;
-  esac;;
-esac
-
-    cd $ac_dir
-    # Check for guested configure; otherwise get Cygnus style configure.
-    if test -f $ac_srcdir/configure.gnu; then
-      echo
-      $SHELL $ac_srcdir/configure.gnu  --help=recursive
-    elif test -f $ac_srcdir/configure; then
-      echo
-      $SHELL $ac_srcdir/configure  --help=recursive
-    elif test -f $ac_srcdir/configure.ac ||
-	   test -f $ac_srcdir/configure.in; then
-      echo
-      $ac_configure --help
-    else
-      echo "$as_me: WARNING: no configuration information is in $ac_dir" >&2
-    fi
-    cd $ac_popdir
-  done
-fi
-
-test -n "$ac_init_help" && exit 0
-if $ac_init_version; then
-  cat <<\_ACEOF
-
-Copyright (C) 2003 Free Software Foundation, Inc.
-This configure script is free software; the Free Software Foundation
-gives unlimited permission to copy, distribute and modify it.
-_ACEOF
-  exit 0
-fi
-exec 5>auto/config.log
-cat >&5 <<_ACEOF
-This file contains any messages produced by compilers while
-running configure, to aid debugging if configure makes a mistake.
-
-It was created by $as_me, which was
-generated by GNU Autoconf 2.59.  Invocation command line was
-
-  $ $0 $@
-
-_ACEOF
-{
-cat <<_ASUNAME
-## --------- ##
-## Platform. ##
-## --------- ##
-
-hostname = `(hostname || uname -n) 2>/dev/null | sed 1q`
-uname -m = `(uname -m) 2>/dev/null || echo unknown`
-uname -r = `(uname -r) 2>/dev/null || echo unknown`
-uname -s = `(uname -s) 2>/dev/null || echo unknown`
-uname -v = `(uname -v) 2>/dev/null || echo unknown`
-
-/usr/bin/uname -p = `(/usr/bin/uname -p) 2>/dev/null || echo unknown`
-/bin/uname -X     = `(/bin/uname -X) 2>/dev/null     || echo unknown`
-
-/bin/arch              = `(/bin/arch) 2>/dev/null              || echo unknown`
-/usr/bin/arch -k       = `(/usr/bin/arch -k) 2>/dev/null       || echo unknown`
-/usr/convex/getsysinfo = `(/usr/convex/getsysinfo) 2>/dev/null || echo unknown`
-hostinfo               = `(hostinfo) 2>/dev/null               || echo unknown`
-/bin/machine           = `(/bin/machine) 2>/dev/null           || echo unknown`
-/usr/bin/oslevel       = `(/usr/bin/oslevel) 2>/dev/null       || echo unknown`
-/bin/universe          = `(/bin/universe) 2>/dev/null          || echo unknown`
-
-_ASUNAME
-
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  echo "PATH: $as_dir"
-done
-
-} >&5
-
-cat >&5 <<_ACEOF
-
-
-## ----------- ##
-## Core tests. ##
-## ----------- ##
-
-_ACEOF
-
-
-# Keep a trace of the command line.
-# Strip out --no-create and --no-recursion so they do not pile up.
-# Strip out --silent because we don't want to record it for future runs.
-# Also quote any args containing shell meta-characters.
-# Make two passes to allow for proper duplicate-argument suppression.
-ac_configure_args=
-ac_configure_args0=
-ac_configure_args1=
-ac_sep=
-ac_must_keep_next=false
-for ac_pass in 1 2
-do
-  for ac_arg
-  do
-    case $ac_arg in
-    -no-create | --no-c* | -n | -no-recursion | --no-r*) continue ;;
-    -q | -quiet | --quiet | --quie | --qui | --qu | --q \
-    | -silent | --silent | --silen | --sile | --sil)
-      continue ;;
-    *" "*|*"	"*|*[\[\]\~\#\$\^\&\*\(\)\{\}\\\|\;\<\>\?\"\']*)
-      ac_arg=`echo "$ac_arg" | sed "s/'/'\\\\\\\\''/g"` ;;
-    esac
-    case $ac_pass in
-    1) ac_configure_args0="$ac_configure_args0 '$ac_arg'" ;;
-    2)
-      ac_configure_args1="$ac_configure_args1 '$ac_arg'"
-      if test $ac_must_keep_next = true; then
-	ac_must_keep_next=false # Got value, back to normal.
-      else
-	case $ac_arg in
-	  *=* | --config-cache | -C | -disable-* | --disable-* \
-	  | -enable-* | --enable-* | -gas | --g* | -nfp | --nf* \
-	  | -q | -quiet | --q* | -silent | --sil* | -v | -verb* \
-	  | -with-* | --with-* | -without-* | --without-* | --x)
-	    case "$ac_configure_args0 " in
-	      "$ac_configure_args1"*" '$ac_arg' "* ) continue ;;
-	    esac
-	    ;;
-	  -* ) ac_must_keep_next=true ;;
-	esac
-      fi
-      ac_configure_args="$ac_configure_args$ac_sep'$ac_arg'"
-      # Get rid of the leading space.
-      ac_sep=" "
-      ;;
-    esac
-  done
-done
-$as_unset ac_configure_args0 || test "${ac_configure_args0+set}" != set || { ac_configure_args0=; export ac_configure_args0; }
-$as_unset ac_configure_args1 || test "${ac_configure_args1+set}" != set || { ac_configure_args1=; export ac_configure_args1; }
-
-# When interrupted or exit'd, cleanup temporary files, and complete
-# config.log.  We remove comments because anyway the quotes in there
-# would cause problems or look ugly.
-# WARNING: Be sure not to use single quotes in there, as some shells,
-# such as our DU 5.0 friend, will then `close' the trap.
-trap 'exit_status=$?
-  # Save into config.log some information that might help in debugging.
-  {
-    echo
-
-    cat <<\_ASBOX
-## ---------------- ##
-## Cache variables. ##
-## ---------------- ##
-_ASBOX
-    echo
-    # The following way of writing the cache mishandles newlines in values,
-{
-  (set) 2>&1 |
-    case `(ac_space='"'"' '"'"'; set | grep ac_space) 2>&1` in
-    *ac_space=\ *)
-      sed -n \
-	"s/'"'"'/'"'"'\\\\'"'"''"'"'/g;
-	  s/^\\([_$as_cr_alnum]*_cv_[_$as_cr_alnum]*\\)=\\(.*\\)/\\1='"'"'\\2'"'"'/p"
-      ;;
-    *)
-      sed -n \
-	"s/^\\([_$as_cr_alnum]*_cv_[_$as_cr_alnum]*\\)=\\(.*\\)/\\1=\\2/p"
-      ;;
-    esac;
-}
-    echo
-
-    cat <<\_ASBOX
-## ----------------- ##
-## Output variables. ##
-## ----------------- ##
-_ASBOX
-    echo
-    for ac_var in $ac_subst_vars
-    do
-      eval ac_val=$`echo $ac_var`
-      echo "$ac_var='"'"'$ac_val'"'"'"
-    done | sort
-    echo
-
-    if test -n "$ac_subst_files"; then
-      cat <<\_ASBOX
-## ------------- ##
-## Output files. ##
-## ------------- ##
-_ASBOX
-      echo
-      for ac_var in $ac_subst_files
-      do
-	eval ac_val=$`echo $ac_var`
-	echo "$ac_var='"'"'$ac_val'"'"'"
-      done | sort
-      echo
-    fi
-
-    if test -s confdefs.h; then
-      cat <<\_ASBOX
-## ----------- ##
-## confdefs.h. ##
-## ----------- ##
-_ASBOX
-      echo
-      sed "/^$/d" confdefs.h | sort
-      echo
-    fi
-    test "$ac_signal" != 0 &&
-      echo "$as_me: caught signal $ac_signal"
-    echo "$as_me: exit $exit_status"
-  } >&5
-  rm -f core *.core &&
-  rm -rf conftest* confdefs* conf$$* $ac_clean_files &&
-    exit $exit_status
-     ' 0
-for ac_signal in 1 2 13 15; do
-  trap 'ac_signal='$ac_signal'; { (exit 1); exit 1; }' $ac_signal
-done
-ac_signal=0
-
-# confdefs.h avoids OS command line length limits that DEFS can exceed.
-rm -rf conftest* confdefs.h
-# AIX cpp loses on an empty file, so make sure it contains at least a newline.
-echo >confdefs.h
-
-# Predefined preprocessor variables.
-
-cat >>confdefs.h <<_ACEOF
-#define PACKAGE_NAME "$PACKAGE_NAME"
-_ACEOF
-
-
-cat >>confdefs.h <<_ACEOF
-#define PACKAGE_TARNAME "$PACKAGE_TARNAME"
-_ACEOF
-
-
-cat >>confdefs.h <<_ACEOF
-#define PACKAGE_VERSION "$PACKAGE_VERSION"
-_ACEOF
-
-
-cat >>confdefs.h <<_ACEOF
-#define PACKAGE_STRING "$PACKAGE_STRING"
-_ACEOF
-
-
-cat >>confdefs.h <<_ACEOF
-#define PACKAGE_BUGREPORT "$PACKAGE_BUGREPORT"
-_ACEOF
-
-
-# Let the site file select an alternate cache file if it wants to.
 # Prefer explicitly selected file to automatically selected ones.
 if test -z "$CONFIG_SITE"; then
   if test "x$prefix" != xNONE; then
@@ -1244,795 +580,283 @@
 fi
 for ac_site_file in $CONFIG_SITE; do
   if test -r "$ac_site_file"; then
-    { echo "$as_me:$LINENO: loading site script $ac_site_file" >&5
-echo "$as_me: loading site script $ac_site_file" >&6;}
-    sed 's/^/| /' "$ac_site_file" >&5
+    echo "loading site script $ac_site_file"
     . "$ac_site_file"
   fi
 done
 
 if test -r "$cache_file"; then
-  # Some versions of bash will fail to source /dev/null (special
-  # files actually), so we avoid doing that.
-  if test -f "$cache_file"; then
-    { echo "$as_me:$LINENO: loading cache $cache_file" >&5
-echo "$as_me: loading cache $cache_file" >&6;}
-    case $cache_file in
-      [\\/]* | ?:[\\/]* ) . $cache_file;;
-      *)                      . ./$cache_file;;
-    esac
-  fi
+  echo "loading cache $cache_file"
+  . $cache_file
 else
-  { echo "$as_me:$LINENO: creating cache $cache_file" >&5
-echo "$as_me: creating cache $cache_file" >&6;}
-  >$cache_file
+  echo "creating cache $cache_file"
+  > $cache_file
 fi
 
-# Check that the precious variables saved in the cache have kept the same
-# value.
-ac_cache_corrupted=false
-for ac_var in `(set) 2>&1 |
-	       sed -n 's/^ac_env_\([a-zA-Z_0-9]*\)_set=.*/\1/p'`; do
-  eval ac_old_set=\$ac_cv_env_${ac_var}_set
-  eval ac_new_set=\$ac_env_${ac_var}_set
-  eval ac_old_val="\$ac_cv_env_${ac_var}_value"
-  eval ac_new_val="\$ac_env_${ac_var}_value"
-  case $ac_old_set,$ac_new_set in
-    set,)
-      { echo "$as_me:$LINENO: error: \`$ac_var' was set to \`$ac_old_val' in the previous run" >&5
-echo "$as_me: error: \`$ac_var' was set to \`$ac_old_val' in the previous run" >&2;}
-      ac_cache_corrupted=: ;;
-    ,set)
-      { echo "$as_me:$LINENO: error: \`$ac_var' was not set in the previous run" >&5
-echo "$as_me: error: \`$ac_var' was not set in the previous run" >&2;}
-      ac_cache_corrupted=: ;;
-    ,);;
-    *)
-      if test "x$ac_old_val" != "x$ac_new_val"; then
-	{ echo "$as_me:$LINENO: error: \`$ac_var' has changed since the previous run:" >&5
-echo "$as_me: error: \`$ac_var' has changed since the previous run:" >&2;}
-	{ echo "$as_me:$LINENO:   former value:  $ac_old_val" >&5
-echo "$as_me:   former value:  $ac_old_val" >&2;}
-	{ echo "$as_me:$LINENO:   current value: $ac_new_val" >&5
-echo "$as_me:   current value: $ac_new_val" >&2;}
-	ac_cache_corrupted=:
-      fi;;
-  esac
-  # Pass precious variables to config.status.
-  if test "$ac_new_set" = set; then
-    case $ac_new_val in
-    *" "*|*"	"*|*[\[\]\~\#\$\^\&\*\(\)\{\}\\\|\;\<\>\?\"\']*)
-      ac_arg=$ac_var=`echo "$ac_new_val" | sed "s/'/'\\\\\\\\''/g"` ;;
-    *) ac_arg=$ac_var=$ac_new_val ;;
-    esac
-    case " $ac_configure_args " in
-      *" '$ac_arg' "*) ;; # Avoid dups.  Use of quotes ensures accuracy.
-      *) ac_configure_args="$ac_configure_args '$ac_arg'" ;;
-    esac
-  fi
-done
-if $ac_cache_corrupted; then
-  { echo "$as_me:$LINENO: error: changes in the environment can compromise the build" >&5
-echo "$as_me: error: changes in the environment can compromise the build" >&2;}
-  { { echo "$as_me:$LINENO: error: run \`make distclean' and/or \`rm $cache_file' and start over" >&5
-echo "$as_me: error: run \`make distclean' and/or \`rm $cache_file' and start over" >&2;}
-   { (exit 1); exit 1; }; }
-fi
-
 ac_ext=c
+# CFLAGS is not in ac_cpp because -g, -O, etc. are not valid cpp options.
 ac_cpp='$CPP $CPPFLAGS'
-ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_c_compiler_gnu
+ac_compile='${CC-cc} -c $CFLAGS $CPPFLAGS conftest.$ac_ext 1>&5'
+ac_link='${CC-cc} -o conftest${ac_exeext} $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS 1>&5'
+cross_compiling=$ac_cv_prog_cc_cross
 
+ac_exeext=
+ac_objext=o
+if (echo "testing\c"; echo 1,2,3) | grep c >/dev/null; then
+  # Stardent Vistra SVR4 grep lacks -e, says ghazi@caip.rutgers.edu.
+  if (echo -n testing; echo 1,2,3) | sed s/-n/xn/ | grep xn >/dev/null; then
+    ac_n= ac_c='
+' ac_t='	'
+  else
+    ac_n=-n ac_c= ac_t=
+  fi
+else
+  ac_n= ac_c='\c' ac_t=
+fi
 
 
 
 
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-          ac_config_headers="$ac_config_headers auto/config.h:config.h.in"
-
-
-cat >>confdefs.h <<\_ACEOF
+cat >> confdefs.h <<\EOF
 #define UNIX 1
-_ACEOF
+EOF
 
-echo "$as_me:$LINENO: checking whether ${MAKE-make} sets \$(MAKE)" >&5
-echo $ECHO_N "checking whether ${MAKE-make} sets \$(MAKE)... $ECHO_C" >&6
-set dummy ${MAKE-make}; ac_make=`echo "$2" | sed 'y,:./+-,___p_,'`
-if eval "test \"\${ac_cv_prog_make_${ac_make}_set+set}\" = set"; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+echo $ac_n "checking whether ${MAKE-make} sets \${MAKE}""... $ac_c" 1>&6
+echo "configure:626: checking whether ${MAKE-make} sets \${MAKE}" >&5
+set dummy ${MAKE-make}; ac_make=`echo "$2" | sed 'y%./+-%__p_%'`
+if eval "test \"`echo '$''{'ac_cv_prog_make_${ac_make}_set'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-  cat >conftest.make <<\_ACEOF
+  cat > conftestmake <<\EOF
 all:
-	@echo 'ac_maketemp="$(MAKE)"'
-_ACEOF
+	@echo 'ac_maketemp="${MAKE}"'
+EOF
 # GNU make sometimes prints "make[1]: Entering...", which would confuse us.
-eval `${MAKE-make} -f conftest.make 2>/dev/null | grep temp=`
+eval `${MAKE-make} -f conftestmake 2>/dev/null | grep temp=`
 if test -n "$ac_maketemp"; then
   eval ac_cv_prog_make_${ac_make}_set=yes
 else
   eval ac_cv_prog_make_${ac_make}_set=no
 fi
-rm -f conftest.make
+rm -f conftestmake
 fi
 if eval "test \"`echo '$ac_cv_prog_make_'${ac_make}_set`\" = yes"; then
-  echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6
+  echo "$ac_t""yes" 1>&6
   SET_MAKE=
 else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
+  echo "$ac_t""no" 1>&6
   SET_MAKE="MAKE=${MAKE-make}"
 fi
 
 
-ac_ext=c
-ac_cpp='$CPP $CPPFLAGS'
-ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_c_compiler_gnu
-if test -n "$ac_tool_prefix"; then
-  # Extract the first word of "${ac_tool_prefix}gcc", so it can be a program name with args.
-set dummy ${ac_tool_prefix}gcc; ac_word=$2
-echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
-if test "${ac_cv_prog_CC+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  if test -n "$CC"; then
-  ac_cv_prog_CC="$CC" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
-    ac_cv_prog_CC="${ac_tool_prefix}gcc"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-
-fi
-fi
-CC=$ac_cv_prog_CC
-if test -n "$CC"; then
-  echo "$as_me:$LINENO: result: $CC" >&5
-echo "${ECHO_T}$CC" >&6
-else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
-fi
-
-fi
-if test -z "$ac_cv_prog_CC"; then
-  ac_ct_CC=$CC
-  # Extract the first word of "gcc", so it can be a program name with args.
+# Extract the first word of "gcc", so it can be a program name with args.
 set dummy gcc; ac_word=$2
-echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
-if test "${ac_cv_prog_ac_ct_CC+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
+echo "configure:656: checking for $ac_word" >&5
+if eval "test \"`echo '$''{'ac_cv_prog_CC'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-  if test -n "$ac_ct_CC"; then
-  ac_cv_prog_ac_ct_CC="$ac_ct_CC" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
-    ac_cv_prog_ac_ct_CC="gcc"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-
-fi
-fi
-ac_ct_CC=$ac_cv_prog_ac_ct_CC
-if test -n "$ac_ct_CC"; then
-  echo "$as_me:$LINENO: result: $ac_ct_CC" >&5
-echo "${ECHO_T}$ac_ct_CC" >&6
-else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
-fi
-
-  CC=$ac_ct_CC
-else
-  CC="$ac_cv_prog_CC"
-fi
-
-if test -z "$CC"; then
-  if test -n "$ac_tool_prefix"; then
-  # Extract the first word of "${ac_tool_prefix}cc", so it can be a program name with args.
-set dummy ${ac_tool_prefix}cc; ac_word=$2
-echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
-if test "${ac_cv_prog_CC+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
   if test -n "$CC"; then
   ac_cv_prog_CC="$CC" # Let the user override the test.
 else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
-    ac_cv_prog_CC="${ac_tool_prefix}cc"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-
+  IFS="${IFS= 	}"; ac_save_ifs="$IFS"; IFS=":"
+  ac_dummy="$PATH"
+  for ac_dir in $ac_dummy; do
+    test -z "$ac_dir" && ac_dir=.
+    if test -f $ac_dir/$ac_word; then
+      ac_cv_prog_CC="gcc"
+      break
+    fi
+  done
+  IFS="$ac_save_ifs"
 fi
 fi
-CC=$ac_cv_prog_CC
+CC="$ac_cv_prog_CC"
 if test -n "$CC"; then
-  echo "$as_me:$LINENO: result: $CC" >&5
-echo "${ECHO_T}$CC" >&6
+  echo "$ac_t""$CC" 1>&6
 else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
+  echo "$ac_t""no" 1>&6
 fi
 
-fi
-if test -z "$ac_cv_prog_CC"; then
-  ac_ct_CC=$CC
-  # Extract the first word of "cc", so it can be a program name with args.
-set dummy cc; ac_word=$2
-echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
-if test "${ac_cv_prog_ac_ct_CC+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  if test -n "$ac_ct_CC"; then
-  ac_cv_prog_ac_ct_CC="$ac_ct_CC" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
-    ac_cv_prog_ac_ct_CC="cc"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-
-fi
-fi
-ac_ct_CC=$ac_cv_prog_ac_ct_CC
-if test -n "$ac_ct_CC"; then
-  echo "$as_me:$LINENO: result: $ac_ct_CC" >&5
-echo "${ECHO_T}$ac_ct_CC" >&6
-else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
-fi
-
-  CC=$ac_ct_CC
-else
-  CC="$ac_cv_prog_CC"
-fi
-
-fi
 if test -z "$CC"; then
   # Extract the first word of "cc", so it can be a program name with args.
 set dummy cc; ac_word=$2
-echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
-if test "${ac_cv_prog_CC+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
+echo "configure:686: checking for $ac_word" >&5
+if eval "test \"`echo '$''{'ac_cv_prog_CC'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
   if test -n "$CC"; then
   ac_cv_prog_CC="$CC" # Let the user override the test.
 else
+  IFS="${IFS= 	}"; ac_save_ifs="$IFS"; IFS=":"
   ac_prog_rejected=no
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
-    if test "$as_dir/$ac_word$ac_exec_ext" = "/usr/ucb/cc"; then
-       ac_prog_rejected=yes
-       continue
-     fi
-    ac_cv_prog_CC="cc"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-
+  ac_dummy="$PATH"
+  for ac_dir in $ac_dummy; do
+    test -z "$ac_dir" && ac_dir=.
+    if test -f $ac_dir/$ac_word; then
+      if test "$ac_dir/$ac_word" = "/usr/ucb/cc"; then
+        ac_prog_rejected=yes
+	continue
+      fi
+      ac_cv_prog_CC="cc"
+      break
+    fi
+  done
+  IFS="$ac_save_ifs"
 if test $ac_prog_rejected = yes; then
   # We found a bogon in the path, so make sure we never use it.
   set dummy $ac_cv_prog_CC
   shift
-  if test $# != 0; then
+  if test $# -gt 0; then
     # We chose a different compiler from the bogus one.
     # However, it has the same basename, so the bogon will be chosen
     # first if we set CC to just the basename; use the full file name.
     shift
-    ac_cv_prog_CC="$as_dir/$ac_word${1+' '}$@"
+    set dummy "$ac_dir/$ac_word" "$@"
+    shift
+    ac_cv_prog_CC="$@"
   fi
 fi
 fi
 fi
-CC=$ac_cv_prog_CC
+CC="$ac_cv_prog_CC"
 if test -n "$CC"; then
-  echo "$as_me:$LINENO: result: $CC" >&5
-echo "${ECHO_T}$CC" >&6
+  echo "$ac_t""$CC" 1>&6
 else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
+  echo "$ac_t""no" 1>&6
 fi
 
-fi
-if test -z "$CC"; then
-  if test -n "$ac_tool_prefix"; then
-  for ac_prog in cl
-  do
-    # Extract the first word of "$ac_tool_prefix$ac_prog", so it can be a program name with args.
-set dummy $ac_tool_prefix$ac_prog; ac_word=$2
-echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
-if test "${ac_cv_prog_CC+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+  if test -z "$CC"; then
+    case "`uname -s`" in
+    *win32* | *WIN32*)
+      # Extract the first word of "cl", so it can be a program name with args.
+set dummy cl; ac_word=$2
+echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
+echo "configure:737: checking for $ac_word" >&5
+if eval "test \"`echo '$''{'ac_cv_prog_CC'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
   if test -n "$CC"; then
   ac_cv_prog_CC="$CC" # Let the user override the test.
 else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
-    ac_cv_prog_CC="$ac_tool_prefix$ac_prog"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-
+  IFS="${IFS= 	}"; ac_save_ifs="$IFS"; IFS=":"
+  ac_dummy="$PATH"
+  for ac_dir in $ac_dummy; do
+    test -z "$ac_dir" && ac_dir=.
+    if test -f $ac_dir/$ac_word; then
+      ac_cv_prog_CC="cl"
+      break
+    fi
+  done
+  IFS="$ac_save_ifs"
 fi
 fi
-CC=$ac_cv_prog_CC
+CC="$ac_cv_prog_CC"
 if test -n "$CC"; then
-  echo "$as_me:$LINENO: result: $CC" >&5
-echo "${ECHO_T}$CC" >&6
+  echo "$ac_t""$CC" 1>&6
 else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
+  echo "$ac_t""no" 1>&6
 fi
-
-    test -n "$CC" && break
-  done
-fi
-if test -z "$CC"; then
-  ac_ct_CC=$CC
-  for ac_prog in cl
-do
-  # Extract the first word of "$ac_prog", so it can be a program name with args.
-set dummy $ac_prog; ac_word=$2
-echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
-if test "${ac_cv_prog_ac_ct_CC+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  if test -n "$ac_ct_CC"; then
-  ac_cv_prog_ac_ct_CC="$ac_ct_CC" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
-    ac_cv_prog_ac_ct_CC="$ac_prog"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
+ ;;
+    esac
   fi
-done
-done
-
+  test -z "$CC" && { echo "configure: error: no acceptable cc found in \$PATH" 1>&2; exit 1; }
 fi
-fi
-ac_ct_CC=$ac_cv_prog_ac_ct_CC
-if test -n "$ac_ct_CC"; then
-  echo "$as_me:$LINENO: result: $ac_ct_CC" >&5
-echo "${ECHO_T}$ac_ct_CC" >&6
-else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
-fi
 
-  test -n "$ac_ct_CC" && break
-done
+echo $ac_n "checking whether the C compiler ($CC $CFLAGS $LDFLAGS) works""... $ac_c" 1>&6
+echo "configure:769: checking whether the C compiler ($CC $CFLAGS $LDFLAGS) works" >&5
 
-  CC=$ac_ct_CC
-fi
+ac_ext=c
+# CFLAGS is not in ac_cpp because -g, -O, etc. are not valid cpp options.
+ac_cpp='$CPP $CPPFLAGS'
+ac_compile='${CC-cc} -c $CFLAGS $CPPFLAGS conftest.$ac_ext 1>&5'
+ac_link='${CC-cc} -o conftest${ac_exeext} $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS 1>&5'
+cross_compiling=$ac_cv_prog_cc_cross
 
-fi
+cat > conftest.$ac_ext << EOF
 
+#line 780 "configure"
+#include "confdefs.h"
 
-test -z "$CC" && { { echo "$as_me:$LINENO: error: no acceptable C compiler found in \$PATH
-See \`config.log' for more details." >&5
-echo "$as_me: error: no acceptable C compiler found in \$PATH
-See \`config.log' for more details." >&2;}
-   { (exit 1); exit 1; }; }
-
-# Provide some information about the compiler.
-echo "$as_me:$LINENO:" \
-     "checking for C compiler version" >&5
-ac_compiler=`set X $ac_compile; echo $2`
-{ (eval echo "$as_me:$LINENO: \"$ac_compiler --version </dev/null >&5\"") >&5
-  (eval $ac_compiler --version </dev/null >&5) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }
-{ (eval echo "$as_me:$LINENO: \"$ac_compiler -v </dev/null >&5\"") >&5
-  (eval $ac_compiler -v </dev/null >&5) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }
-{ (eval echo "$as_me:$LINENO: \"$ac_compiler -V </dev/null >&5\"") >&5
-  (eval $ac_compiler -V </dev/null >&5) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }
-
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-ac_clean_files_save=$ac_clean_files
-ac_clean_files="$ac_clean_files a.out a.exe b.out"
-# Try to create an executable without -o first, disregard a.out.
-# It will help us diagnose broken compilers, and finding out an intuition
-# of exeext.
-echo "$as_me:$LINENO: checking for C compiler default output file name" >&5
-echo $ECHO_N "checking for C compiler default output file name... $ECHO_C" >&6
-ac_link_default=`echo "$ac_link" | sed 's/ -o *conftest[^ ]*//'`
-if { (eval echo "$as_me:$LINENO: \"$ac_link_default\"") >&5
-  (eval $ac_link_default) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; then
-  # Find the output, starting from the most likely.  This scheme is
-# not robust to junk in `.', hence go to wildcards (a.*) only as a last
-# resort.
-
-# Be careful to initialize this variable, since it used to be cached.
-# Otherwise an old cache value of `no' led to `EXEEXT = no' in a Makefile.
-ac_cv_exeext=
-# b.out is created by i960 compilers.
-for ac_file in a_out.exe a.exe conftest.exe a.out conftest a.* conftest.* b.out
-do
-  test -f "$ac_file" || continue
-  case $ac_file in
-    *.$ac_ext | *.xcoff | *.tds | *.d | *.pdb | *.xSYM | *.bb | *.bbg | *.o | *.obj )
-	;;
-    conftest.$ac_ext )
-	# This is the source file.
-	;;
-    [ab].out )
-	# We found the default executable, but exeext='' is most
-	# certainly right.
-	break;;
-    *.* )
-	ac_cv_exeext=`expr "$ac_file" : '[^.]*\(\..*\)'`
-	# FIXME: I believe we export ac_cv_exeext for Libtool,
-	# but it would be cool to find out if it's true.  Does anybody
-	# maintain Libtool? --akim.
-	export ac_cv_exeext
-	break;;
-    * )
-	break;;
-  esac
-done
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-{ { echo "$as_me:$LINENO: error: C compiler cannot create executables
-See \`config.log' for more details." >&5
-echo "$as_me: error: C compiler cannot create executables
-See \`config.log' for more details." >&2;}
-   { (exit 77); exit 77; }; }
-fi
-
-ac_exeext=$ac_cv_exeext
-echo "$as_me:$LINENO: result: $ac_file" >&5
-echo "${ECHO_T}$ac_file" >&6
-
-# Check the compiler produces executables we can run.  If not, either
-# the compiler is broken, or we cross compile.
-echo "$as_me:$LINENO: checking whether the C compiler works" >&5
-echo $ECHO_N "checking whether the C compiler works... $ECHO_C" >&6
-# FIXME: These cross compiler hacks should be removed for Autoconf 3.0
-# If not cross compiling, check that we can run a simple program.
-if test "$cross_compiling" != yes; then
-  if { ac_try='./$ac_file'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-    cross_compiling=no
+main(){return(0);}
+EOF
+if { (eval echo configure:785: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  ac_cv_prog_cc_works=yes
+  # If we can't run a trivial program, we are probably using a cross compiler.
+  if (./conftest; exit) 2>/dev/null; then
+    ac_cv_prog_cc_cross=no
   else
-    if test "$cross_compiling" = maybe; then
-	cross_compiling=yes
-    else
-	{ { echo "$as_me:$LINENO: error: cannot run C compiled programs.
-If you meant to cross compile, use \`--host'.
-See \`config.log' for more details." >&5
-echo "$as_me: error: cannot run C compiled programs.
-If you meant to cross compile, use \`--host'.
-See \`config.log' for more details." >&2;}
-   { (exit 1); exit 1; }; }
-    fi
+    ac_cv_prog_cc_cross=yes
   fi
+else
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  ac_cv_prog_cc_works=no
 fi
-echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6
+rm -fr conftest*
+ac_ext=c
+# CFLAGS is not in ac_cpp because -g, -O, etc. are not valid cpp options.
+ac_cpp='$CPP $CPPFLAGS'
+ac_compile='${CC-cc} -c $CFLAGS $CPPFLAGS conftest.$ac_ext 1>&5'
+ac_link='${CC-cc} -o conftest${ac_exeext} $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS 1>&5'
+cross_compiling=$ac_cv_prog_cc_cross
 
-rm -f a.out a.exe conftest$ac_cv_exeext b.out
-ac_clean_files=$ac_clean_files_save
-# Check the compiler produces executables we can run.  If not, either
-# the compiler is broken, or we cross compile.
-echo "$as_me:$LINENO: checking whether we are cross compiling" >&5
-echo $ECHO_N "checking whether we are cross compiling... $ECHO_C" >&6
-echo "$as_me:$LINENO: result: $cross_compiling" >&5
-echo "${ECHO_T}$cross_compiling" >&6
-
-echo "$as_me:$LINENO: checking for suffix of executables" >&5
-echo $ECHO_N "checking for suffix of executables... $ECHO_C" >&6
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; then
-  # If both `conftest.exe' and `conftest' are `present' (well, observable)
-# catch `conftest.exe'.  For instance with Cygwin, `ls conftest' will
-# work properly (i.e., refer to `conftest.exe'), while it won't with
-# `rm'.
-for ac_file in conftest.exe conftest conftest.*; do
-  test -f "$ac_file" || continue
-  case $ac_file in
-    *.$ac_ext | *.xcoff | *.tds | *.d | *.pdb | *.xSYM | *.bb | *.bbg | *.o | *.obj ) ;;
-    *.* ) ac_cv_exeext=`expr "$ac_file" : '[^.]*\(\..*\)'`
-	  export ac_cv_exeext
-	  break;;
-    * ) break;;
-  esac
-done
-else
-  { { echo "$as_me:$LINENO: error: cannot compute suffix of executables: cannot compile and link
-See \`config.log' for more details." >&5
-echo "$as_me: error: cannot compute suffix of executables: cannot compile and link
-See \`config.log' for more details." >&2;}
-   { (exit 1); exit 1; }; }
+echo "$ac_t""$ac_cv_prog_cc_works" 1>&6
+if test $ac_cv_prog_cc_works = no; then
+  { echo "configure: error: installation or configuration problem: C compiler cannot create executables." 1>&2; exit 1; }
 fi
+echo $ac_n "checking whether the C compiler ($CC $CFLAGS $LDFLAGS) is a cross-compiler""... $ac_c" 1>&6
+echo "configure:811: checking whether the C compiler ($CC $CFLAGS $LDFLAGS) is a cross-compiler" >&5
+echo "$ac_t""$ac_cv_prog_cc_cross" 1>&6
+cross_compiling=$ac_cv_prog_cc_cross
 
-rm -f conftest$ac_cv_exeext
-echo "$as_me:$LINENO: result: $ac_cv_exeext" >&5
-echo "${ECHO_T}$ac_cv_exeext" >&6
-
-rm -f conftest.$ac_ext
-EXEEXT=$ac_cv_exeext
-ac_exeext=$EXEEXT
-echo "$as_me:$LINENO: checking for suffix of object files" >&5
-echo $ECHO_N "checking for suffix of object files... $ECHO_C" >&6
-if test "${ac_cv_objext+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+echo $ac_n "checking whether we are using GNU C""... $ac_c" 1>&6
+echo "configure:816: checking whether we are using GNU C" >&5
+if eval "test \"`echo '$''{'ac_cv_prog_gcc'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.o conftest.obj
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; then
-  for ac_file in `(ls conftest.o conftest.obj; ls conftest.*) 2>/dev/null`; do
-  case $ac_file in
-    *.$ac_ext | *.xcoff | *.tds | *.d | *.pdb | *.xSYM | *.bb | *.bbg ) ;;
-    *) ac_cv_objext=`expr "$ac_file" : '.*\.\(.*\)'`
-       break;;
-  esac
-done
+  cat > conftest.c <<EOF
+#ifdef __GNUC__
+  yes;
+#endif
+EOF
+if { ac_try='${CC-cc} -E conftest.c'; { (eval echo configure:825: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }; } | egrep yes >/dev/null 2>&1; then
+  ac_cv_prog_gcc=yes
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-{ { echo "$as_me:$LINENO: error: cannot compute suffix of object files: cannot compile
-See \`config.log' for more details." >&5
-echo "$as_me: error: cannot compute suffix of object files: cannot compile
-See \`config.log' for more details." >&2;}
-   { (exit 1); exit 1; }; }
+  ac_cv_prog_gcc=no
 fi
-
-rm -f conftest.$ac_cv_objext conftest.$ac_ext
 fi
-echo "$as_me:$LINENO: result: $ac_cv_objext" >&5
-echo "${ECHO_T}$ac_cv_objext" >&6
-OBJEXT=$ac_cv_objext
-ac_objext=$OBJEXT
-echo "$as_me:$LINENO: checking whether we are using the GNU C compiler" >&5
-echo $ECHO_N "checking whether we are using the GNU C compiler... $ECHO_C" >&6
-if test "${ac_cv_c_compiler_gnu+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
 
-int
-main ()
-{
-#ifndef __GNUC__
-       choke me
-#endif
+echo "$ac_t""$ac_cv_prog_gcc" 1>&6
 
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_compiler_gnu=yes
+if test $ac_cv_prog_gcc = yes; then
+  GCC=yes
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-ac_compiler_gnu=no
+  GCC=
 fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
-ac_cv_c_compiler_gnu=$ac_compiler_gnu
 
-fi
-echo "$as_me:$LINENO: result: $ac_cv_c_compiler_gnu" >&5
-echo "${ECHO_T}$ac_cv_c_compiler_gnu" >&6
-GCC=`test $ac_compiler_gnu = yes && echo yes`
-ac_test_CFLAGS=${CFLAGS+set}
-ac_save_CFLAGS=$CFLAGS
-CFLAGS="-g"
-echo "$as_me:$LINENO: checking whether $CC accepts -g" >&5
-echo $ECHO_N "checking whether $CC accepts -g... $ECHO_C" >&6
-if test "${ac_cv_prog_cc_g+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+ac_test_CFLAGS="${CFLAGS+set}"
+ac_save_CFLAGS="$CFLAGS"
+CFLAGS=
+echo $ac_n "checking whether ${CC-cc} accepts -g""... $ac_c" 1>&6
+echo "configure:844: checking whether ${CC-cc} accepts -g" >&5
+if eval "test \"`echo '$''{'ac_cv_prog_cc_g'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
+  echo 'void f(){}' > conftest.c
+if test -z "`${CC-cc} -g -c conftest.c 2>&1`"; then
   ac_cv_prog_cc_g=yes
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
+  ac_cv_prog_cc_g=no
+fi
+rm -f conftest*
 
-ac_cv_prog_cc_g=no
 fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
-fi
-echo "$as_me:$LINENO: result: $ac_cv_prog_cc_g" >&5
-echo "${ECHO_T}$ac_cv_prog_cc_g" >&6
+
+echo "$ac_t""$ac_cv_prog_cc_g" 1>&6
 if test "$ac_test_CFLAGS" = set; then
-  CFLAGS=$ac_save_CFLAGS
+  CFLAGS="$ac_save_CFLAGS"
 elif test $ac_cv_prog_cc_g = yes; then
   if test "$GCC" = yes; then
     CFLAGS="-g -O2"
@@ -2046,736 +870,276 @@
     CFLAGS=
   fi
 fi
-echo "$as_me:$LINENO: checking for $CC option to accept ANSI C" >&5
-echo $ECHO_N "checking for $CC option to accept ANSI C... $ECHO_C" >&6
-if test "${ac_cv_prog_cc_stdc+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  ac_cv_prog_cc_stdc=no
-ac_save_CC=$CC
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-#include <stdarg.h>
-#include <stdio.h>
-#include <sys/types.h>
-#include <sys/stat.h>
-/* Most of the following tests are stolen from RCS 5.7's src/conf.sh.  */
-struct buf { int x; };
-FILE * (*rcsopen) (struct buf *, struct stat *, int);
-static char *e (p, i)
-     char **p;
-     int i;
-{
-  return p[i];
-}
-static char *f (char * (*g) (char **, int), char **p, ...)
-{
-  char *s;
-  va_list v;
-  va_start (v,p);
-  s = g (p, va_arg (v,int));
-  va_end (v);
-  return s;
-}
-
-/* OSF 4.0 Compaq cc is some sort of almost-ANSI by default.  It has
-   function prototypes and stuff, but not '\xHH' hex character constants.
-   These don't provoke an error unfortunately, instead are silently treated
-   as 'x'.  The following induces an error, until -std1 is added to get
-   proper ANSI mode.  Curiously '\x00'!='x' always comes out true, for an
-   array size at least.  It's necessary to write '\x00'==0 to get something
-   that's true only with -std1.  */
-int osf4_cc_array ['\x00' == 0 ? 1 : -1];
-
-int test (int i, double x);
-struct s1 {int (*f) (int a);};
-struct s2 {int (*f) (double a);};
-int pairnames (int, char **, FILE *(*)(struct buf *, struct stat *, int), int, int);
-int argc;
-char **argv;
-int
-main ()
-{
-return f (e, argv, 0) != argv[0]  ||  f (e, argv, 1) != argv[1];
-  ;
-  return 0;
-}
-_ACEOF
-# Don't try gcc -ansi; that turns off useful extensions and
-# breaks some systems' header files.
-# AIX			-qlanglvl=ansi
-# Ultrix and OSF/1	-std1
-# HP-UX 10.20 and later	-Ae
-# HP-UX older versions	-Aa -D_HPUX_SOURCE
-# SVR4			-Xc -D__EXTENSIONS__
-for ac_arg in "" -qlanglvl=ansi -std1 -Ae "-Aa -D_HPUX_SOURCE" "-Xc -D__EXTENSIONS__"
-do
-  CC="$ac_save_CC $ac_arg"
-  rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_cv_prog_cc_stdc=$ac_arg
-break
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-fi
-rm -f conftest.err conftest.$ac_objext
-done
-rm -f conftest.$ac_ext conftest.$ac_objext
-CC=$ac_save_CC
-
-fi
-
-case "x$ac_cv_prog_cc_stdc" in
-  x|xno)
-    echo "$as_me:$LINENO: result: none needed" >&5
-echo "${ECHO_T}none needed" >&6 ;;
-  *)
-    echo "$as_me:$LINENO: result: $ac_cv_prog_cc_stdc" >&5
-echo "${ECHO_T}$ac_cv_prog_cc_stdc" >&6
-    CC="$CC $ac_cv_prog_cc_stdc" ;;
-esac
-
-# Some people use a C++ compiler to compile C.  Since we use `exit',
-# in C++ we need to declare it.  In case someone uses the same compiler
-# for both compiling C and C++ we need to have the C++ compiler decide
-# the declaration of exit, since it's the most demanding environment.
-cat >conftest.$ac_ext <<_ACEOF
-#ifndef __cplusplus
-  choke me
-#endif
-_ACEOF
-rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  for ac_declaration in \
-   '' \
-   'extern "C" void std::exit (int) throw (); using std::exit;' \
-   'extern "C" void std::exit (int); using std::exit;' \
-   'extern "C" void exit (int) throw ();' \
-   'extern "C" void exit (int);' \
-   'void exit (int);'
-do
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-$ac_declaration
-#include <stdlib.h>
-int
-main ()
-{
-exit (42);
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  :
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-continue
-fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-$ac_declaration
-int
-main ()
-{
-exit (42);
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  break
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
-done
-rm -f conftest*
-if test -n "$ac_declaration"; then
-  echo '#ifdef __cplusplus' >>confdefs.h
-  echo $ac_declaration      >>confdefs.h
-  echo '#endif'             >>confdefs.h
-fi
-
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
-ac_ext=c
-ac_cpp='$CPP $CPPFLAGS'
-ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_c_compiler_gnu
-	ac_ext=c
-ac_cpp='$CPP $CPPFLAGS'
-ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_c_compiler_gnu
-echo "$as_me:$LINENO: checking how to run the C preprocessor" >&5
-echo $ECHO_N "checking how to run the C preprocessor... $ECHO_C" >&6
+	echo $ac_n "checking how to run the C preprocessor""... $ac_c" 1>&6
+echo "configure:875: checking how to run the C preprocessor" >&5
 # On Suns, sometimes $CPP names a directory.
 if test -n "$CPP" && test -d "$CPP"; then
   CPP=
 fi
 if test -z "$CPP"; then
-  if test "${ac_cv_prog_CPP+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+if eval "test \"`echo '$''{'ac_cv_prog_CPP'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-      # Double quotes because CPP needs to be expanded
-    for CPP in "$CC -E" "$CC -E -traditional-cpp" "/lib/cpp"
-    do
-      ac_preproc_ok=false
-for ac_c_preproc_warn_flag in '' yes
-do
-  # Use a header file that comes with gcc, so configuring glibc
-  # with a fresh cross-compiler works.
-  # Prefer <limits.h> to <assert.h> if __STDC__ is defined, since
-  # <limits.h> exists even on freestanding compilers.
+    # This must be in double quotes, not single quotes, because CPP may get
+  # substituted into the Makefile and "${CC-cc}" will confuse make.
+  CPP="${CC-cc} -E"
   # On the NeXT, cc -E runs the code through the compiler's parser,
-  # not just through cpp. "Syntax error" is here to catch this case.
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-#ifdef __STDC__
-# include <limits.h>
-#else
-# include <assert.h>
-#endif
-		     Syntax error
-_ACEOF
-if { (eval echo "$as_me:$LINENO: \"$ac_cpp conftest.$ac_ext\"") >&5
-  (eval $ac_cpp conftest.$ac_ext) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } >/dev/null; then
-  if test -s conftest.err; then
-    ac_cpp_err=$ac_c_preproc_warn_flag
-    ac_cpp_err=$ac_cpp_err$ac_c_werror_flag
-  else
-    ac_cpp_err=
-  fi
+  # not just through cpp.
+  cat > conftest.$ac_ext <<EOF
+#line 890 "configure"
+#include "confdefs.h"
+#include <assert.h>
+Syntax Error
+EOF
+ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
+{ (eval echo configure:896: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
+ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
+if test -z "$ac_err"; then
+  :
 else
-  ac_cpp_err=yes
-fi
-if test -z "$ac_cpp_err"; then
+  echo "$ac_err" >&5
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  CPP="${CC-cc} -E -traditional-cpp"
+  cat > conftest.$ac_ext <<EOF
+#line 907 "configure"
+#include "confdefs.h"
+#include <assert.h>
+Syntax Error
+EOF
+ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
+{ (eval echo configure:913: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
+ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
+if test -z "$ac_err"; then
   :
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-  # Broken: fails on valid input.
-continue
-fi
-rm -f conftest.err conftest.$ac_ext
-
-  # OK, works on sane cases.  Now check whether non-existent headers
-  # can be detected and how.
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-#include <ac_nonexistent.h>
-_ACEOF
-if { (eval echo "$as_me:$LINENO: \"$ac_cpp conftest.$ac_ext\"") >&5
-  (eval $ac_cpp conftest.$ac_ext) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } >/dev/null; then
-  if test -s conftest.err; then
-    ac_cpp_err=$ac_c_preproc_warn_flag
-    ac_cpp_err=$ac_cpp_err$ac_c_werror_flag
-  else
-    ac_cpp_err=
-  fi
+  echo "$ac_err" >&5
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  CPP="${CC-cc} -nologo -E"
+  cat > conftest.$ac_ext <<EOF
+#line 924 "configure"
+#include "confdefs.h"
+#include <assert.h>
+Syntax Error
+EOF
+ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
+{ (eval echo configure:930: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
+ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
+if test -z "$ac_err"; then
+  :
 else
-  ac_cpp_err=yes
+  echo "$ac_err" >&5
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  CPP=/lib/cpp
 fi
-if test -z "$ac_cpp_err"; then
-  # Broken: success on invalid input.
-continue
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-  # Passes both tests.
-ac_preproc_ok=:
-break
+rm -f conftest*
 fi
-rm -f conftest.err conftest.$ac_ext
-
-done
-# Because of `break', _AC_PREPROC_IFELSE's cleaning code was skipped.
-rm -f conftest.err conftest.$ac_ext
-if $ac_preproc_ok; then
-  break
+rm -f conftest*
 fi
-
-    done
-    ac_cv_prog_CPP=$CPP
-
+rm -f conftest*
+  ac_cv_prog_CPP="$CPP"
 fi
-  CPP=$ac_cv_prog_CPP
+  CPP="$ac_cv_prog_CPP"
 else
-  ac_cv_prog_CPP=$CPP
+  ac_cv_prog_CPP="$CPP"
 fi
-echo "$as_me:$LINENO: result: $CPP" >&5
-echo "${ECHO_T}$CPP" >&6
-ac_preproc_ok=false
-for ac_c_preproc_warn_flag in '' yes
-do
-  # Use a header file that comes with gcc, so configuring glibc
-  # with a fresh cross-compiler works.
-  # Prefer <limits.h> to <assert.h> if __STDC__ is defined, since
-  # <limits.h> exists even on freestanding compilers.
-  # On the NeXT, cc -E runs the code through the compiler's parser,
-  # not just through cpp. "Syntax error" is here to catch this case.
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-#ifdef __STDC__
-# include <limits.h>
-#else
-# include <assert.h>
-#endif
-		     Syntax error
-_ACEOF
-if { (eval echo "$as_me:$LINENO: \"$ac_cpp conftest.$ac_ext\"") >&5
-  (eval $ac_cpp conftest.$ac_ext) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } >/dev/null; then
-  if test -s conftest.err; then
-    ac_cpp_err=$ac_c_preproc_warn_flag
-    ac_cpp_err=$ac_cpp_err$ac_c_werror_flag
-  else
-    ac_cpp_err=
-  fi
-else
-  ac_cpp_err=yes
-fi
-if test -z "$ac_cpp_err"; then
-  :
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
+echo "$ac_t""$CPP" 1>&6
+	cat > conftest.$ac_ext <<EOF
+#line 954 "configure"
+#include "confdefs.h"
 
-  # Broken: fails on valid input.
-continue
+EOF
+if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+  egrep "" >/dev/null 2>&1; then
+  :
 fi
-rm -f conftest.err conftest.$ac_ext
+rm -f conftest*
+ echo $ac_n "checking for POSIXized ISC""... $ac_c" 1>&6
+echo "configure:964: checking for POSIXized ISC" >&5
+if test -d /etc/conf/kconfig.d &&
+  grep _POSIX_VERSION /usr/include/sys/unistd.h >/dev/null 2>&1
+then
+  echo "$ac_t""yes" 1>&6
+  ISC=yes # If later tests want to check for ISC.
+  cat >> confdefs.h <<\EOF
+#define _POSIX_SOURCE 1
+EOF
 
-  # OK, works on sane cases.  Now check whether non-existent headers
-  # can be detected and how.
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-#include <ac_nonexistent.h>
-_ACEOF
-if { (eval echo "$as_me:$LINENO: \"$ac_cpp conftest.$ac_ext\"") >&5
-  (eval $ac_cpp conftest.$ac_ext) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } >/dev/null; then
-  if test -s conftest.err; then
-    ac_cpp_err=$ac_c_preproc_warn_flag
-    ac_cpp_err=$ac_cpp_err$ac_c_werror_flag
+  if test "$GCC" = yes; then
+    CC="$CC -posix"
   else
-    ac_cpp_err=
+    CC="$CC -Xp"
   fi
 else
-  ac_cpp_err=yes
+  echo "$ac_t""no" 1>&6
+  ISC=
 fi
-if test -z "$ac_cpp_err"; then
-  # Broken: success on invalid input.
-continue
+	for ac_prog in mawk gawk nawk awk
+do
+# Extract the first word of "$ac_prog", so it can be a program name with args.
+set dummy $ac_prog; ac_word=$2
+echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
+echo "configure:988: checking for $ac_word" >&5
+if eval "test \"`echo '$''{'ac_cv_prog_AWK'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-  # Passes both tests.
-ac_preproc_ok=:
-break
+  if test -n "$AWK"; then
+  ac_cv_prog_AWK="$AWK" # Let the user override the test.
+else
+  IFS="${IFS= 	}"; ac_save_ifs="$IFS"; IFS=":"
+  ac_dummy="$PATH"
+  for ac_dir in $ac_dummy; do
+    test -z "$ac_dir" && ac_dir=.
+    if test -f $ac_dir/$ac_word; then
+      ac_cv_prog_AWK="$ac_prog"
+      break
+    fi
+  done
+  IFS="$ac_save_ifs"
 fi
-rm -f conftest.err conftest.$ac_ext
-
-done
-# Because of `break', _AC_PREPROC_IFELSE's cleaning code was skipped.
-rm -f conftest.err conftest.$ac_ext
-if $ac_preproc_ok; then
-  :
+fi
+AWK="$ac_cv_prog_AWK"
+if test -n "$AWK"; then
+  echo "$ac_t""$AWK" 1>&6
 else
-  { { echo "$as_me:$LINENO: error: C preprocessor \"$CPP\" fails sanity check
-See \`config.log' for more details." >&5
-echo "$as_me: error: C preprocessor \"$CPP\" fails sanity check
-See \`config.log' for more details." >&2;}
-   { (exit 1); exit 1; }; }
+  echo "$ac_t""no" 1>&6
 fi
 
-ac_ext=c
-ac_cpp='$CPP $CPPFLAGS'
-ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_c_compiler_gnu
-
-
-echo "$as_me:$LINENO: checking for egrep" >&5
-echo $ECHO_N "checking for egrep... $ECHO_C" >&6
-if test "${ac_cv_prog_egrep+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+test -n "$AWK" && break
+done
+	
+# Extract the first word of "strip", so it can be a program name with args.
+set dummy strip; ac_word=$2
+echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
+echo "configure:1020: checking for $ac_word" >&5
+if eval "test \"`echo '$''{'ac_cv_prog_STRIP'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-  if echo a | (grep -E '(a|b)') >/dev/null 2>&1
-    then ac_cv_prog_egrep='grep -E'
-    else ac_cv_prog_egrep='egrep'
+  if test -n "$STRIP"; then
+  ac_cv_prog_STRIP="$STRIP" # Let the user override the test.
+else
+  IFS="${IFS= 	}"; ac_save_ifs="$IFS"; IFS=":"
+  ac_dummy="$PATH"
+  for ac_dir in $ac_dummy; do
+    test -z "$ac_dir" && ac_dir=.
+    if test -f $ac_dir/$ac_word; then
+      ac_cv_prog_STRIP="strip"
+      break
     fi
+  done
+  IFS="$ac_save_ifs"
+  test -z "$ac_cv_prog_STRIP" && ac_cv_prog_STRIP=":"
 fi
-echo "$as_me:$LINENO: result: $ac_cv_prog_egrep" >&5
-echo "${ECHO_T}$ac_cv_prog_egrep" >&6
- EGREP=$ac_cv_prog_egrep
-
-
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-_ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
-  $EGREP "" >/dev/null 2>&1; then
-  :
 fi
-rm -f conftest*
- echo "$as_me:$LINENO: checking for library containing strerror" >&5
-echo $ECHO_N "checking for library containing strerror... $ECHO_C" >&6
-if test "${ac_cv_search_strerror+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+STRIP="$ac_cv_prog_STRIP"
+if test -n "$STRIP"; then
+  echo "$ac_t""$STRIP" 1>&6
 else
-  ac_func_search_save_LIBS=$LIBS
-ac_cv_search_strerror=no
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+  echo "$ac_t""no" 1>&6
+fi
 
-/* Override any gcc2 internal prototype to avoid an error.  */
-#ifdef __cplusplus
-extern "C"
-#endif
-/* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
-char strerror ();
-int
-main ()
-{
-strerror ();
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_cv_search_strerror="none required"
+
+echo $ac_n "checking for Cygwin environment""... $ac_c" 1>&6
+echo "configure:1049: checking for Cygwin environment" >&5
+if eval "test \"`echo '$''{'ac_cv_cygwin'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
+  cat > conftest.$ac_ext <<EOF
+#line 1054 "configure"
+#include "confdefs.h"
 
-fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
-if test "$ac_cv_search_strerror" = no; then
-  for ac_lib in cposix; do
-    LIBS="-l$ac_lib  $ac_func_search_save_LIBS"
-    cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+int main() {
 
-/* Override any gcc2 internal prototype to avoid an error.  */
-#ifdef __cplusplus
-extern "C"
+#ifndef __CYGWIN__
+#define __CYGWIN__ __CYGWIN32__
 #endif
-/* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
-char strerror ();
-int
-main ()
-{
-strerror ();
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_cv_search_strerror="-l$ac_lib"
-break
+return __CYGWIN__;
+; return 0; }
+EOF
+if { (eval echo configure:1065: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+  rm -rf conftest*
+  ac_cv_cygwin=yes
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  ac_cv_cygwin=no
 fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
-  done
+rm -f conftest*
+rm -f conftest*
 fi
-LIBS=$ac_func_search_save_LIBS
-fi
-echo "$as_me:$LINENO: result: $ac_cv_search_strerror" >&5
-echo "${ECHO_T}$ac_cv_search_strerror" >&6
-if test "$ac_cv_search_strerror" != no; then
-  test "$ac_cv_search_strerror" = "none required" || LIBS="$ac_cv_search_strerror $LIBS"
 
-fi
-	for ac_prog in gawk mawk nawk awk
-do
-  # Extract the first word of "$ac_prog", so it can be a program name with args.
-set dummy $ac_prog; ac_word=$2
-echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
-if test "${ac_cv_prog_AWK+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+echo "$ac_t""$ac_cv_cygwin" 1>&6
+CYGWIN=
+test "$ac_cv_cygwin" = yes && CYGWIN=yes
+echo $ac_n "checking for mingw32 environment""... $ac_c" 1>&6
+echo "configure:1082: checking for mingw32 environment" >&5
+if eval "test \"`echo '$''{'ac_cv_mingw32'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-  if test -n "$AWK"; then
-  ac_cv_prog_AWK="$AWK" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
-    ac_cv_prog_AWK="$ac_prog"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
+  cat > conftest.$ac_ext <<EOF
+#line 1087 "configure"
+#include "confdefs.h"
 
-fi
-fi
-AWK=$ac_cv_prog_AWK
-if test -n "$AWK"; then
-  echo "$as_me:$LINENO: result: $AWK" >&5
-echo "${ECHO_T}$AWK" >&6
+int main() {
+return __MINGW32__;
+; return 0; }
+EOF
+if { (eval echo configure:1094: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+  rm -rf conftest*
+  ac_cv_mingw32=yes
 else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  ac_cv_mingw32=no
 fi
+rm -f conftest*
+rm -f conftest*
+fi
 
-  test -n "$AWK" && break
-done
+echo "$ac_t""$ac_cv_mingw32" 1>&6
+MINGW32=
+test "$ac_cv_mingw32" = yes && MINGW32=yes
 
-# Extract the first word of "strip", so it can be a program name with args.
-set dummy strip; ac_word=$2
-echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
-if test "${ac_cv_prog_STRIP+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+
+echo $ac_n "checking for executable suffix""... $ac_c" 1>&6
+echo "configure:1113: checking for executable suffix" >&5
+if eval "test \"`echo '$''{'ac_cv_exeext'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-  if test -n "$STRIP"; then
-  ac_cv_prog_STRIP="$STRIP" # Let the user override the test.
+  if test "$CYGWIN" = yes || test "$MINGW32" = yes; then
+  ac_cv_exeext=.exe
 else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
-    ac_cv_prog_STRIP="strip"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
+  rm -f conftest*
+  echo 'int main () { return 0; }' > conftest.$ac_ext
+  ac_cv_exeext=
+  if { (eval echo configure:1123: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; }; then
+    for file in conftest.*; do
+      case $file in
+      *.$ac_ext | *.c | *.o | *.obj) ;;
+      *) ac_cv_exeext=`echo $file | sed -e s/conftest//` ;;
+      esac
+    done
+  else
+    { echo "configure: error: installation or configuration problem: compiler cannot create executables." 1>&2; exit 1; }
   fi
-done
-done
-
-  test -z "$ac_cv_prog_STRIP" && ac_cv_prog_STRIP=":"
+  rm -f conftest*
+  test x"${ac_cv_exeext}" = x && ac_cv_exeext=no
 fi
 fi
-STRIP=$ac_cv_prog_STRIP
-if test -n "$STRIP"; then
-  echo "$as_me:$LINENO: result: $STRIP" >&5
-echo "${ECHO_T}$STRIP" >&6
-else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
-fi
 
+EXEEXT=""
+test x"${ac_cv_exeext}" != xno && EXEEXT=${ac_cv_exeext}
+echo "$ac_t""${ac_cv_exeext}" 1>&6
+ac_exeext=$EXEEXT
 
 
-
 if test -z "$CFLAGS"; then
   CFLAGS="-O"
   test "$GCC" = yes && CFLAGS="-O2 -fno-strength-reduce -Wall"
@@ -2797,201 +1161,128 @@
 fi
 
 if test "$cross_compiling" = yes; then
-  { { echo "$as_me:$LINENO: error: cannot compile a simple program, check CC and CFLAGS
-  (cross compiling doesn't work)" >&5
-echo "$as_me: error: cannot compile a simple program, check CC and CFLAGS
-  (cross compiling doesn't work)" >&2;}
-   { (exit 1); exit 1; }; }
+  { echo "configure: error: cannot compile a simple program, check CC and CFLAGS
+  (cross compiling doesn't work)" 1>&2; exit 1; }
 fi
 
-test "$GCC" = yes && CPP_MM=M;
+test "$GCC" = yes && CPP_MM=M; 
 
 if test -f ./toolcheck; then
-  { echo "$as_me:$LINENO: checking for buggy tools..." >&5
-echo "$as_me: checking for buggy tools..." >&6;}
+  echo "checking for buggy tools" 1>&6
+echo "configure:1173: checking for buggy tools" >&5
   sh ./toolcheck 1>&6
 fi
 
 OS_EXTRA_SRC=""; OS_EXTRA_OBJ=""
 
-echo "$as_me:$LINENO: checking for BeOS" >&5
-echo $ECHO_N "checking for BeOS... $ECHO_C" >&6
+echo $ac_n "checking for BeOS""... $ac_c" 1>&6
+echo "configure:1180: checking for BeOS" >&5
 case `uname` in
     BeOS)	OS_EXTRA_SRC=os_beos.c; OS_EXTRA_OBJ=objects/os_beos.o
-		BEOS=yes; echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6;;
-    *)		BEOS=no; echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6;;
+		BEOS=yes; echo "$ac_t""yes" 1>&6;;
+    *)		BEOS=no; echo "$ac_t""no" 1>&6;;
 esac
 
-echo "$as_me:$LINENO: checking for QNX" >&5
-echo $ECHO_N "checking for QNX... $ECHO_C" >&6
+echo $ac_n "checking for QNX""... $ac_c" 1>&6
+echo "configure:1188: checking for QNX" >&5
 case `uname` in
     QNX)	OS_EXTRA_SRC=os_qnx.c; OS_EXTRA_OBJ=objects/os_qnx.o
 		test -z "$with_x" && with_x=no
-		QNX=yes; echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6;;
-    *)		QNX=no; echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6;;
+		QNX=yes; echo "$ac_t""yes" 1>&6;;
+    *)		QNX=no; echo "$ac_t""no" 1>&6;;
 esac
 
-echo "$as_me:$LINENO: checking for Darwin (Mac OS X)" >&5
-echo $ECHO_N "checking for Darwin (Mac OS X)... $ECHO_C" >&6
+echo $ac_n "checking for Darwin (Mac OS X)""... $ac_c" 1>&6
+echo "configure:1197: checking for Darwin (Mac OS X)" >&5
 if test "`(uname) 2>/dev/null`" = Darwin; then
-  echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6
+  echo "$ac_t""yes" 1>&6
 
-  echo "$as_me:$LINENO: checking --disable-darwin argument" >&5
-echo $ECHO_N "checking --disable-darwin argument... $ECHO_C" >&6
+  echo $ac_n "checking --disable-darwin argument""... $ac_c" 1>&6
+echo "configure:1202: checking --disable-darwin argument" >&5
   # Check whether --enable-darwin or --disable-darwin was given.
 if test "${enable_darwin+set}" = set; then
   enableval="$enable_darwin"
-
+  :
 else
   enable_darwin="yes"
-fi;
+fi
+
   if test "$enable_darwin" = "yes"; then
-    echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
-    echo "$as_me:$LINENO: checking if Darwin files are there" >&5
-echo $ECHO_N "checking if Darwin files are there... $ECHO_C" >&6
+    echo "$ac_t""no" 1>&6
+    echo $ac_n "checking if Darwin files are there""... $ac_c" 1>&6
+echo "configure:1214: checking if Darwin files are there" >&5
     if test -f os_macosx.c; then
-      echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6
+      echo "$ac_t""yes" 1>&6
     else
-      echo "$as_me:$LINENO: result: no, Darwin support disabled" >&5
-echo "${ECHO_T}no, Darwin support disabled" >&6
+      echo "$ac_t""no, Darwin support disabled" 1>&6
       enable_darwin=no
     fi
   else
-    echo "$as_me:$LINENO: result: yes, Darwin support excluded" >&5
-echo "${ECHO_T}yes, Darwin support excluded" >&6
+    echo "$ac_t""yes, Darwin support excluded" 1>&6
   fi
 
-  echo "$as_me:$LINENO: checking --with-mac-arch argument" >&5
-echo $ECHO_N "checking --with-mac-arch argument... $ECHO_C" >&6
-
-# Check whether --with-mac-arch or --without-mac-arch was given.
+  echo $ac_n "checking --with-mac-arch argument""... $ac_c" 1>&6
+echo "configure:1226: checking --with-mac-arch argument" >&5
+  # Check whether --with-mac-arch or --without-mac-arch was given.
 if test "${with_mac_arch+set}" = set; then
   withval="$with_mac_arch"
-  MACARCH="$withval"; echo "$as_me:$LINENO: result: $MACARCH" >&5
-echo "${ECHO_T}$MACARCH" >&6
+  MACARCH="$withval"; echo "$ac_t""$MACARCH" 1>&6
 else
-  MACARCH="current"; echo "$as_me:$LINENO: result: defaulting to $MACARCH" >&5
-echo "${ECHO_T}defaulting to $MACARCH" >&6
-fi;
+  MACARCH="current"; echo "$ac_t""defaulting to $MACARCH" 1>&6
+fi
 
+
   if test "x$MACARCH" = "xboth"; then
-    echo "$as_me:$LINENO: checking for 10.4 universal SDK" >&5
-echo $ECHO_N "checking for 10.4 universal SDK... $ECHO_C" >&6
+    echo $ac_n "checking for 10.4 universal SDK""... $ac_c" 1>&6
+echo "configure:1238: checking for 10.4 universal SDK" >&5
                             save_cppflags="$CPPFLAGS"
     save_cflags="$CFLAGS"
     save_ldflags="$LDFLAGS"
     CFLAGS="$CFLAGS -isysroot /Developer/SDKs/MacOSX10.4u.sdk -arch i386 -arch ppc"
-    cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  echo "$as_me:$LINENO: result: found" >&5
-echo "${ECHO_T}found" >&6
+    cat > conftest.$ac_ext <<EOF
+#line 1244 "configure"
+#include "confdefs.h"
+ 
+int main() {
+ 
+; return 0; }
+EOF
+if { (eval echo configure:1251: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  echo "$ac_t""found" 1>&6
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-echo "$as_me:$LINENO: result: not found" >&5
-echo "${ECHO_T}not found" >&6
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  echo "$ac_t""not found" 1>&6
 	CFLAGS="$save_cflags"
-	echo "$as_me:$LINENO: checking if Intel architecture is supported" >&5
-echo $ECHO_N "checking if Intel architecture is supported... $ECHO_C" >&6
+	echo $ac_n "checking if Intel architecture is supported""... $ac_c" 1>&6
+echo "configure:1261: checking if Intel architecture is supported" >&5
 	CPPFLAGS="$CPPFLAGS -arch i386"
 	LDFLAGS="$save_ldflags -arch i386"
-	cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6; MACARCH="intel"
+	cat > conftest.$ac_ext <<EOF
+#line 1265 "configure"
+#include "confdefs.h"
+ 
+int main() {
+ 
+; return 0; }
+EOF
+if { (eval echo configure:1272: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  echo "$ac_t""yes" 1>&6; MACARCH="intel"
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  echo "$ac_t""no" 1>&6
 		MACARCH="ppc"
 		CPPFLAGS="$save_cppflags -arch ppc"
 		LDFLAGS="$save_ldflags -arch ppc"
 fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
+rm -f conftest*
 fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
+rm -f conftest*
   elif test "x$MACARCH" = "xintel"; then
     CPPFLAGS="$CPPFLAGS -arch intel"
     LDFLAGS="$LDFLAGS -arch intel"
@@ -3011,386 +1302,39 @@
       CPPFLAGS="$CPPFLAGS -I/Developer/Headers/FlatCarbon"
     fi
 
-                echo "$as_me:$LINENO: checking for ANSI C header files" >&5
-echo $ECHO_N "checking for ANSI C header files... $ECHO_C" >&6
-if test "${ac_cv_header_stdc+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+                ac_safe=`echo "Carbon/Carbon.h" | sed 'y%./+-%__p_%'`
+echo $ac_n "checking for Carbon/Carbon.h""... $ac_c" 1>&6
+echo "configure:1308: checking for Carbon/Carbon.h" >&5
+if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-#include <stdlib.h>
-#include <stdarg.h>
-#include <string.h>
-#include <float.h>
-
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_cv_header_stdc=yes
+  cat > conftest.$ac_ext <<EOF
+#line 1313 "configure"
+#include "confdefs.h"
+#include <Carbon/Carbon.h>
+EOF
+ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
+{ (eval echo configure:1318: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
+ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
+if test -z "$ac_err"; then
+  rm -rf conftest*
+  eval "ac_cv_header_$ac_safe=yes"
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-ac_cv_header_stdc=no
+  echo "$ac_err" >&5
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_header_$ac_safe=no"
 fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
-
-if test $ac_cv_header_stdc = yes; then
-  # SunOS 4.x string.h does not declare mem*, contrary to ANSI.
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-#include <string.h>
-
-_ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
-  $EGREP "memchr" >/dev/null 2>&1; then
-  :
-else
-  ac_cv_header_stdc=no
-fi
 rm -f conftest*
-
 fi
-
-if test $ac_cv_header_stdc = yes; then
-  # ISC 2.0.2 stdlib.h does not declare free, contrary to ANSI.
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-#include <stdlib.h>
-
-_ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
-  $EGREP "free" >/dev/null 2>&1; then
-  :
+if eval "test \"`echo '$ac_cv_header_'$ac_safe`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
+  CARBON=yes
 else
-  ac_cv_header_stdc=no
+  echo "$ac_t""no" 1>&6
 fi
-rm -f conftest*
 
-fi
-
-if test $ac_cv_header_stdc = yes; then
-  # /bin/cc in Irix-4.0.5 gets non-ANSI ctype macros unless using -ansi.
-  if test "$cross_compiling" = yes; then
-  :
-else
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-#include <ctype.h>
-#if ((' ' & 0x0FF) == 0x020)
-# define ISLOWER(c) ('a' <= (c) && (c) <= 'z')
-# define TOUPPER(c) (ISLOWER(c) ? 'A' + ((c) - 'a') : (c))
-#else
-# define ISLOWER(c) \
-		   (('a' <= (c) && (c) <= 'i') \
-		     || ('j' <= (c) && (c) <= 'r') \
-		     || ('s' <= (c) && (c) <= 'z'))
-# define TOUPPER(c) (ISLOWER(c) ? ((c) | 0x40) : (c))
-#endif
-
-#define XOR(e, f) (((e) && !(f)) || (!(e) && (f)))
-int
-main ()
-{
-  int i;
-  for (i = 0; i < 256; i++)
-    if (XOR (islower (i), ISLOWER (i))
-	|| toupper (i) != TOUPPER (i))
-      exit(2);
-  exit (0);
-}
-_ACEOF
-rm -f conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && { ac_try='./conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  :
-else
-  echo "$as_me: program exited with status $ac_status" >&5
-echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-( exit $ac_status )
-ac_cv_header_stdc=no
-fi
-rm -f core *.core gmon.out bb.out conftest$ac_exeext conftest.$ac_objext conftest.$ac_ext
-fi
-fi
-fi
-echo "$as_me:$LINENO: result: $ac_cv_header_stdc" >&5
-echo "${ECHO_T}$ac_cv_header_stdc" >&6
-if test $ac_cv_header_stdc = yes; then
-
-cat >>confdefs.h <<\_ACEOF
-#define STDC_HEADERS 1
-_ACEOF
-
-fi
-
-# On IRIX 5.3, sys/types and inttypes.h are conflicting.
-
-
-
-
-
-
-
-
-
-for ac_header in sys/types.h sys/stat.h stdlib.h string.h memory.h strings.h \
-		  inttypes.h stdint.h unistd.h
-do
-as_ac_Header=`echo "ac_cv_header_$ac_header" | $as_tr_sh`
-echo "$as_me:$LINENO: checking for $ac_header" >&5
-echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6
-if eval "test \"\${$as_ac_Header+set}\" = set"; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-$ac_includes_default
-
-#include <$ac_header>
-_ACEOF
-rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  eval "$as_ac_Header=yes"
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-eval "$as_ac_Header=no"
-fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
-fi
-echo "$as_me:$LINENO: result: `eval echo '${'$as_ac_Header'}'`" >&5
-echo "${ECHO_T}`eval echo '${'$as_ac_Header'}'`" >&6
-if test `eval echo '${'$as_ac_Header'}'` = yes; then
-  cat >>confdefs.h <<_ACEOF
-#define `echo "HAVE_$ac_header" | $as_tr_cpp` 1
-_ACEOF
-
-fi
-
-done
-
-
-if test "${ac_cv_header_Carbon_Carbon_h+set}" = set; then
-  echo "$as_me:$LINENO: checking for Carbon/Carbon.h" >&5
-echo $ECHO_N "checking for Carbon/Carbon.h... $ECHO_C" >&6
-if test "${ac_cv_header_Carbon_Carbon_h+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-fi
-echo "$as_me:$LINENO: result: $ac_cv_header_Carbon_Carbon_h" >&5
-echo "${ECHO_T}$ac_cv_header_Carbon_Carbon_h" >&6
-else
-  # Is the header compilable?
-echo "$as_me:$LINENO: checking Carbon/Carbon.h usability" >&5
-echo $ECHO_N "checking Carbon/Carbon.h usability... $ECHO_C" >&6
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-$ac_includes_default
-#include <Carbon/Carbon.h>
-_ACEOF
-rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_header_compiler=yes
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-ac_header_compiler=no
-fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
-echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
-echo "${ECHO_T}$ac_header_compiler" >&6
-
-# Is the header present?
-echo "$as_me:$LINENO: checking Carbon/Carbon.h presence" >&5
-echo $ECHO_N "checking Carbon/Carbon.h presence... $ECHO_C" >&6
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-#include <Carbon/Carbon.h>
-_ACEOF
-if { (eval echo "$as_me:$LINENO: \"$ac_cpp conftest.$ac_ext\"") >&5
-  (eval $ac_cpp conftest.$ac_ext) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } >/dev/null; then
-  if test -s conftest.err; then
-    ac_cpp_err=$ac_c_preproc_warn_flag
-    ac_cpp_err=$ac_cpp_err$ac_c_werror_flag
-  else
-    ac_cpp_err=
-  fi
-else
-  ac_cpp_err=yes
-fi
-if test -z "$ac_cpp_err"; then
-  ac_header_preproc=yes
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-  ac_header_preproc=no
-fi
-rm -f conftest.err conftest.$ac_ext
-echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
-echo "${ECHO_T}$ac_header_preproc" >&6
-
-# So?  What about this header?
-case $ac_header_compiler:$ac_header_preproc:$ac_c_preproc_warn_flag in
-  yes:no: )
-    { echo "$as_me:$LINENO: WARNING: Carbon/Carbon.h: accepted by the compiler, rejected by the preprocessor!" >&5
-echo "$as_me: WARNING: Carbon/Carbon.h: accepted by the compiler, rejected by the preprocessor!" >&2;}
-    { echo "$as_me:$LINENO: WARNING: Carbon/Carbon.h: proceeding with the compiler's result" >&5
-echo "$as_me: WARNING: Carbon/Carbon.h: proceeding with the compiler's result" >&2;}
-    ac_header_preproc=yes
-    ;;
-  no:yes:* )
-    { echo "$as_me:$LINENO: WARNING: Carbon/Carbon.h: present but cannot be compiled" >&5
-echo "$as_me: WARNING: Carbon/Carbon.h: present but cannot be compiled" >&2;}
-    { echo "$as_me:$LINENO: WARNING: Carbon/Carbon.h:     check for missing prerequisite headers?" >&5
-echo "$as_me: WARNING: Carbon/Carbon.h:     check for missing prerequisite headers?" >&2;}
-    { echo "$as_me:$LINENO: WARNING: Carbon/Carbon.h: see the Autoconf documentation" >&5
-echo "$as_me: WARNING: Carbon/Carbon.h: see the Autoconf documentation" >&2;}
-    { echo "$as_me:$LINENO: WARNING: Carbon/Carbon.h:     section \"Present But Cannot Be Compiled\"" >&5
-echo "$as_me: WARNING: Carbon/Carbon.h:     section \"Present But Cannot Be Compiled\"" >&2;}
-    { echo "$as_me:$LINENO: WARNING: Carbon/Carbon.h: proceeding with the preprocessor's result" >&5
-echo "$as_me: WARNING: Carbon/Carbon.h: proceeding with the preprocessor's result" >&2;}
-    { echo "$as_me:$LINENO: WARNING: Carbon/Carbon.h: in the future, the compiler will take precedence" >&5
-echo "$as_me: WARNING: Carbon/Carbon.h: in the future, the compiler will take precedence" >&2;}
-    (
-      cat <<\_ASBOX
-## ------------------------------------------ ##
-## Report this to the AC_PACKAGE_NAME lists.  ##
-## ------------------------------------------ ##
-_ASBOX
-    ) |
-      sed "s/^/$as_me: WARNING:     /" >&2
-    ;;
-esac
-echo "$as_me:$LINENO: checking for Carbon/Carbon.h" >&5
-echo $ECHO_N "checking for Carbon/Carbon.h... $ECHO_C" >&6
-if test "${ac_cv_header_Carbon_Carbon_h+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  ac_cv_header_Carbon_Carbon_h=$ac_header_preproc
-fi
-echo "$as_me:$LINENO: result: $ac_cv_header_Carbon_Carbon_h" >&5
-echo "${ECHO_T}$ac_cv_header_Carbon_Carbon_h" >&6
-
-fi
-if test $ac_cv_header_Carbon_Carbon_h = yes; then
-  CARBON=yes
-fi
-
-
     if test "x$CARBON" = "xyes"; then
       if test -z "$with_x" -a "X$enable_gui" != Xmotif -a "X$enable_gui" != Xathena -a "X$enable_gui" != Xgtk -a "X$enable_gui" != Xgtk2; then
 	with_x=no
@@ -3403,8 +1347,7 @@
   fi
 
 else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
+  echo "$ac_t""no" 1>&6
 fi
 
 
@@ -3431,141 +1374,103 @@
   fi
 fi
 
-echo "$as_me:$LINENO: checking --with-vim-name argument" >&5
-echo $ECHO_N "checking --with-vim-name argument... $ECHO_C" >&6
-
+echo $ac_n "checking --with-vim-name argument""... $ac_c" 1>&6
+echo "configure:1379: checking --with-vim-name argument" >&5
 # Check whether --with-vim-name or --without-vim-name was given.
 if test "${with_vim_name+set}" = set; then
   withval="$with_vim_name"
-  VIMNAME="$withval"; echo "$as_me:$LINENO: result: $VIMNAME" >&5
-echo "${ECHO_T}$VIMNAME" >&6
+  VIMNAME="$withval"; echo "$ac_t""$VIMNAME" 1>&6
 else
-  VIMNAME="vim"; echo "$as_me:$LINENO: result: Defaulting to $VIMNAME" >&5
-echo "${ECHO_T}Defaulting to $VIMNAME" >&6
-fi;
+  VIMNAME="vim"; echo "$ac_t""Defaulting to $VIMNAME" 1>&6
+fi
 
-echo "$as_me:$LINENO: checking --with-ex-name argument" >&5
-echo $ECHO_N "checking --with-ex-name argument... $ECHO_C" >&6
 
+echo $ac_n "checking --with-ex-name argument""... $ac_c" 1>&6
+echo "configure:1390: checking --with-ex-name argument" >&5
 # Check whether --with-ex-name or --without-ex-name was given.
 if test "${with_ex_name+set}" = set; then
   withval="$with_ex_name"
-  EXNAME="$withval"; echo "$as_me:$LINENO: result: $EXNAME" >&5
-echo "${ECHO_T}$EXNAME" >&6
+  EXNAME="$withval"; echo "$ac_t""$EXNAME" 1>&6
 else
-  EXNAME="ex"; echo "$as_me:$LINENO: result: Defaulting to ex" >&5
-echo "${ECHO_T}Defaulting to ex" >&6
-fi;
+  EXNAME="ex"; echo "$ac_t""Defaulting to ex" 1>&6
+fi
 
-echo "$as_me:$LINENO: checking --with-view-name argument" >&5
-echo $ECHO_N "checking --with-view-name argument... $ECHO_C" >&6
 
+echo $ac_n "checking --with-view-name argument""... $ac_c" 1>&6
+echo "configure:1401: checking --with-view-name argument" >&5
 # Check whether --with-view-name or --without-view-name was given.
 if test "${with_view_name+set}" = set; then
   withval="$with_view_name"
-  VIEWNAME="$withval"; echo "$as_me:$LINENO: result: $VIEWNAME" >&5
-echo "${ECHO_T}$VIEWNAME" >&6
+  VIEWNAME="$withval"; echo "$ac_t""$VIEWNAME" 1>&6
 else
-  VIEWNAME="view"; echo "$as_me:$LINENO: result: Defaulting to view" >&5
-echo "${ECHO_T}Defaulting to view" >&6
-fi;
+  VIEWNAME="view"; echo "$ac_t""Defaulting to view" 1>&6
+fi
 
 
-echo "$as_me:$LINENO: checking --with-global-runtime argument" >&5
-echo $ECHO_N "checking --with-global-runtime argument... $ECHO_C" >&6
 
+echo $ac_n "checking --with-global-runtime argument""... $ac_c" 1>&6
+echo "configure:1413: checking --with-global-runtime argument" >&5
 # Check whether --with-global-runtime or --without-global-runtime was given.
 if test "${with_global_runtime+set}" = set; then
   withval="$with_global_runtime"
-  echo "$as_me:$LINENO: result: $withval" >&5
-echo "${ECHO_T}$withval" >&6; cat >>confdefs.h <<_ACEOF
+  echo "$ac_t""$withval" 1>&6; cat >> confdefs.h <<EOF
 #define RUNTIME_GLOBAL "$withval"
-_ACEOF
+EOF
 
 else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
-fi;
+  echo "$ac_t""no" 1>&6
+fi
 
-echo "$as_me:$LINENO: checking --with-modified-by argument" >&5
-echo $ECHO_N "checking --with-modified-by argument... $ECHO_C" >&6
 
+echo $ac_n "checking --with-modified-by argument""... $ac_c" 1>&6
+echo "configure:1427: checking --with-modified-by argument" >&5
 # Check whether --with-modified-by or --without-modified-by was given.
 if test "${with_modified_by+set}" = set; then
   withval="$with_modified_by"
-  echo "$as_me:$LINENO: result: $withval" >&5
-echo "${ECHO_T}$withval" >&6; cat >>confdefs.h <<_ACEOF
+  echo "$ac_t""$withval" 1>&6; cat >> confdefs.h <<EOF
 #define MODIFIED_BY "$withval"
-_ACEOF
+EOF
 
 else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
-fi;
+  echo "$ac_t""no" 1>&6
+fi
 
-echo "$as_me:$LINENO: checking if character set is EBCDIC" >&5
-echo $ECHO_N "checking if character set is EBCDIC... $ECHO_C" >&6
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
 
-int
-main ()
-{
+echo $ac_n "checking if character set is EBCDIC""... $ac_c" 1>&6
+echo "configure:1441: checking if character set is EBCDIC" >&5
+cat > conftest.$ac_ext <<EOF
+#line 1443 "configure"
+#include "confdefs.h"
+ 
+int main() {
  /* TryCompile function for CharSet.
    Treat any failure as ASCII for compatibility with existing art.
    Use compile-time rather than run-time tests for cross-compiler
    tolerance.  */
 #if '0'!=240
 make an error "Character set is not EBCDIC"
-#endif
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
+#endif 
+; return 0; }
+EOF
+if { (eval echo configure:1456: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+  rm -rf conftest*
    # TryCompile action if true
-cf_cv_ebcdic=yes
+cf_cv_ebcdic=yes 
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
- # TryCompile action if false
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+   # TryCompile action if false
 cf_cv_ebcdic=no
 fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
+rm -f conftest*
 # end of TryCompile ])
 # end of CacheVal CvEbcdic
-echo "$as_me:$LINENO: result: $cf_cv_ebcdic" >&5
-echo "${ECHO_T}$cf_cv_ebcdic" >&6
+echo "$ac_t""$cf_cv_ebcdic" 1>&6
 case "$cf_cv_ebcdic" in  #(vi
-    yes)	cat >>confdefs.h <<\_ACEOF
+    yes)	cat >> confdefs.h <<\EOF
 #define EBCDIC 1
-_ACEOF
+EOF
 
 		line_break='"\\n"'
 		;;
@@ -3574,8 +1479,8 @@
 
 
 if test "$cf_cv_ebcdic" = "yes"; then
-echo "$as_me:$LINENO: checking for OS/390 Unix" >&5
-echo $ECHO_N "checking for OS/390 Unix... $ECHO_C" >&6
+echo $ac_n "checking for OS/390 Unix""... $ac_c" 1>&6
+echo "configure:1484: checking for OS/390 Unix" >&5
 case `uname` in
     OS/390)	OS390Unix="yes";
 										if test "$CC" = "cc"; then
@@ -3601,193 +1506,176 @@
 		  exit 1
 		fi
 		CFLAGS="$CFLAGS -D_ALL_SOURCE"; LDFLAGS="$LDFLAGS -Wl,EDIT=NO"
-		echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6
+		echo "$ac_t""yes" 1>&6
 		;;
     *)		OS390Unix="no";
-		echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
+		echo "$ac_t""no" 1>&6
 		;;
 esac
 fi
 
 
 
-echo "$as_me:$LINENO: checking --with-features argument" >&5
-echo $ECHO_N "checking --with-features argument... $ECHO_C" >&6
-
+echo $ac_n "checking --with-features argument""... $ac_c" 1>&6
+echo "configure:1521: checking --with-features argument" >&5
 # Check whether --with-features or --without-features was given.
 if test "${with_features+set}" = set; then
   withval="$with_features"
-  features="$withval"; echo "$as_me:$LINENO: result: $features" >&5
-echo "${ECHO_T}$features" >&6
+  features="$withval"; echo "$ac_t""$features" 1>&6
 else
-  features="normal"; echo "$as_me:$LINENO: result: Defaulting to normal" >&5
-echo "${ECHO_T}Defaulting to normal" >&6
-fi;
+  features="normal"; echo "$ac_t""Defaulting to normal" 1>&6
+fi
 
+
 dovimdiff=""
 dogvimdiff=""
 case "$features" in
-  tiny)		cat >>confdefs.h <<\_ACEOF
+  tiny)		cat >> confdefs.h <<\EOF
 #define FEAT_TINY 1
-_ACEOF
+EOF
  ;;
-  small)	cat >>confdefs.h <<\_ACEOF
+  small)	cat >> confdefs.h <<\EOF
 #define FEAT_SMALL 1
-_ACEOF
+EOF
  ;;
-  normal)	cat >>confdefs.h <<\_ACEOF
+  normal)	cat >> confdefs.h <<\EOF
 #define FEAT_NORMAL 1
-_ACEOF
+EOF
  dovimdiff="installvimdiff";
 			dogvimdiff="installgvimdiff" ;;
-  big)		cat >>confdefs.h <<\_ACEOF
+  big)		cat >> confdefs.h <<\EOF
 #define FEAT_BIG 1
-_ACEOF
+EOF
  dovimdiff="installvimdiff";
 			dogvimdiff="installgvimdiff" ;;
-  huge)		cat >>confdefs.h <<\_ACEOF
+  huge)		cat >> confdefs.h <<\EOF
 #define FEAT_HUGE 1
-_ACEOF
+EOF
  dovimdiff="installvimdiff";
 			dogvimdiff="installgvimdiff" ;;
-  *)		echo "$as_me:$LINENO: result: Sorry, $features is not supported" >&5
-echo "${ECHO_T}Sorry, $features is not supported" >&6 ;;
+  *)		echo "$ac_t""Sorry, $features is not supported" 1>&6 ;;
 esac
 
 
 
 
-echo "$as_me:$LINENO: checking --with-compiledby argument" >&5
-echo $ECHO_N "checking --with-compiledby argument... $ECHO_C" >&6
-
+echo $ac_n "checking --with-compiledby argument""... $ac_c" 1>&6
+echo "configure:1564: checking --with-compiledby argument" >&5
 # Check whether --with-compiledby or --without-compiledby was given.
 if test "${with_compiledby+set}" = set; then
   withval="$with_compiledby"
-  compiledby="$withval"; echo "$as_me:$LINENO: result: $withval" >&5
-echo "${ECHO_T}$withval" >&6
+  compiledby="$withval"; echo "$ac_t""$withval" 1>&6
 else
-  compiledby=""; echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
-fi;
+  compiledby=""; echo "$ac_t""no" 1>&6
+fi
 
 
-echo "$as_me:$LINENO: checking --disable-xsmp argument" >&5
-echo $ECHO_N "checking --disable-xsmp argument... $ECHO_C" >&6
+
+echo $ac_n "checking --disable-xsmp argument""... $ac_c" 1>&6
+echo "configure:1576: checking --disable-xsmp argument" >&5
 # Check whether --enable-xsmp or --disable-xsmp was given.
 if test "${enable_xsmp+set}" = set; then
   enableval="$enable_xsmp"
-
+  :
 else
   enable_xsmp="yes"
-fi;
+fi
 
+
 if test "$enable_xsmp" = "yes"; then
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
-  echo "$as_me:$LINENO: checking --disable-xsmp-interact argument" >&5
-echo $ECHO_N "checking --disable-xsmp-interact argument... $ECHO_C" >&6
+  echo "$ac_t""no" 1>&6
+  echo $ac_n "checking --disable-xsmp-interact argument""... $ac_c" 1>&6
+echo "configure:1589: checking --disable-xsmp-interact argument" >&5
   # Check whether --enable-xsmp-interact or --disable-xsmp-interact was given.
 if test "${enable_xsmp_interact+set}" = set; then
   enableval="$enable_xsmp_interact"
-
+  :
 else
   enable_xsmp_interact="yes"
-fi;
+fi
+
   if test "$enable_xsmp_interact" = "yes"; then
-    echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
-    cat >>confdefs.h <<\_ACEOF
+    echo "$ac_t""no" 1>&6
+    cat >> confdefs.h <<\EOF
 #define USE_XSMP_INTERACT 1
-_ACEOF
+EOF
 
   else
-    echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6
+    echo "$ac_t""yes" 1>&6
   fi
 else
-  echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6
+  echo "$ac_t""yes" 1>&6
 fi
 
-echo "$as_me:$LINENO: checking --enable-mzschemeinterp argument" >&5
-echo $ECHO_N "checking --enable-mzschemeinterp argument... $ECHO_C" >&6
+echo $ac_n "checking --enable-mzschemeinterp argument""... $ac_c" 1>&6
+echo "configure:1612: checking --enable-mzschemeinterp argument" >&5
 # Check whether --enable-mzschemeinterp or --disable-mzschemeinterp was given.
 if test "${enable_mzschemeinterp+set}" = set; then
   enableval="$enable_mzschemeinterp"
-
+  :
 else
   enable_mzschemeinterp="no"
-fi;
-echo "$as_me:$LINENO: result: $enable_mzschemeinterp" >&5
-echo "${ECHO_T}$enable_mzschemeinterp" >&6
+fi
 
+echo "$ac_t""$enable_mzschemeinterp" 1>&6
+
 if test "$enable_mzschemeinterp" = "yes"; then
+    
 
-
-  echo "$as_me:$LINENO: checking --with-plthome argument" >&5
-echo $ECHO_N "checking --with-plthome argument... $ECHO_C" >&6
-
-# Check whether --with-plthome or --without-plthome was given.
+  echo $ac_n "checking --with-plthome argument""... $ac_c" 1>&6
+echo "configure:1627: checking --with-plthome argument" >&5
+  # Check whether --with-plthome or --without-plthome was given.
 if test "${with_plthome+set}" = set; then
   withval="$with_plthome"
-  with_plthome="$withval"; echo "$as_me:$LINENO: result: $with_plthome" >&5
-echo "${ECHO_T}$with_plthome" >&6
+  with_plthome="$withval"; echo "$ac_t""$with_plthome" 1>&6
 else
-  with_plthome="";echo "$as_me:$LINENO: result: \"no\"" >&5
-echo "${ECHO_T}\"no\"" >&6
-fi;
+  with_plthome="";echo "$ac_t"""no"" 1>&6
+fi
 
+
   if test "X$with_plthome" != "X"; then
        vi_cv_path_mzscheme_pfx="$with_plthome"
   else
-    echo "$as_me:$LINENO: checking PLTHOME environment var" >&5
-echo $ECHO_N "checking PLTHOME environment var... $ECHO_C" >&6
+    echo $ac_n "checking PLTHOME environment var""... $ac_c" 1>&6
+echo "configure:1641: checking PLTHOME environment var" >&5
     if test "X$PLTHOME" != "X"; then
-	echo "$as_me:$LINENO: result: \"$PLTHOME\"" >&5
-echo "${ECHO_T}\"$PLTHOME\"" >&6
+	echo "$ac_t"""$PLTHOME"" 1>&6
 	vi_cv_path_mzscheme_pfx="$PLTHOME"
     else
-	echo "$as_me:$LINENO: result: \"not set\"" >&5
-echo "${ECHO_T}\"not set\"" >&6
+	echo "$ac_t"""not set"" 1>&6
 		# Extract the first word of "mzscheme", so it can be a program name with args.
 set dummy mzscheme; ac_word=$2
-echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
-if test "${ac_cv_path_vi_cv_path_mzscheme+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
+echo "configure:1650: checking for $ac_word" >&5
+if eval "test \"`echo '$''{'ac_cv_path_vi_cv_path_mzscheme'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-  case $vi_cv_path_mzscheme in
-  [\\/]* | ?:[\\/]*)
+  case "$vi_cv_path_mzscheme" in
+  /*)
   ac_cv_path_vi_cv_path_mzscheme="$vi_cv_path_mzscheme" # Let the user override the test with a path.
   ;;
+  ?:/*)			 
+  ac_cv_path_vi_cv_path_mzscheme="$vi_cv_path_mzscheme" # Let the user override the test with a dos path.
+  ;;
   *)
-  as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
-    ac_cv_path_vi_cv_path_mzscheme="$as_dir/$ac_word$ac_exec_ext"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-
+  IFS="${IFS= 	}"; ac_save_ifs="$IFS"; IFS=":"
+  ac_dummy="$PATH"
+  for ac_dir in $ac_dummy; do 
+    test -z "$ac_dir" && ac_dir=.
+    if test -f $ac_dir/$ac_word; then
+      ac_cv_path_vi_cv_path_mzscheme="$ac_dir/$ac_word"
+      break
+    fi
+  done
+  IFS="$ac_save_ifs"
   ;;
 esac
 fi
-vi_cv_path_mzscheme=$ac_cv_path_vi_cv_path_mzscheme
-
+vi_cv_path_mzscheme="$ac_cv_path_vi_cv_path_mzscheme"
 if test -n "$vi_cv_path_mzscheme"; then
-  echo "$as_me:$LINENO: result: $vi_cv_path_mzscheme" >&5
-echo "${ECHO_T}$vi_cv_path_mzscheme" >&6
+  echo "$ac_t""$vi_cv_path_mzscheme" 1>&6
 else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
+  echo "$ac_t""no" 1>&6
 fi
 
 
@@ -3799,34 +1687,32 @@
 	fi
 
 	if test "X$vi_cv_path_mzscheme" != "X"; then
-	    	    echo "$as_me:$LINENO: checking MzScheme install prefix" >&5
-echo $ECHO_N "checking MzScheme install prefix... $ECHO_C" >&6
-if test "${vi_cv_path_mzscheme_pfx+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+	    	    echo $ac_n "checking MzScheme install prefix""... $ac_c" 1>&6
+echo "configure:1692: checking MzScheme install prefix" >&5
+if eval "test \"`echo '$''{'vi_cv_path_mzscheme_pfx'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
    vi_cv_path_mzscheme_pfx=`
 	    ${vi_cv_path_mzscheme} -evm \
 	    "(display (simplify-path		\
 	       (build-path (call-with-values	\
 		(lambda () (split-path (find-system-path (quote exec-file)))) \
-		(lambda (base name must-be-dir?) base)) (quote up))))"`
+		(lambda (base name must-be-dir?) base)) (quote up))))"` 
 fi
-echo "$as_me:$LINENO: result: $vi_cv_path_mzscheme_pfx" >&5
-echo "${ECHO_T}$vi_cv_path_mzscheme_pfx" >&6
+
+echo "$ac_t""$vi_cv_path_mzscheme_pfx" 1>&6
 	    	    vi_cv_path_mzscheme_pfx=`echo "$vi_cv_path_mzscheme_pfx" | sed 's+/$++'`
 	fi
     fi
   fi
 
   if test "X$vi_cv_path_mzscheme_pfx" != "X"; then
-    echo "$as_me:$LINENO: checking if scheme.h can be found in $vi_cv_path_mzscheme_pfx/include" >&5
-echo $ECHO_N "checking if scheme.h can be found in $vi_cv_path_mzscheme_pfx/include... $ECHO_C" >&6
+    echo $ac_n "checking if scheme.h can be found in $vi_cv_path_mzscheme_pfx/include""... $ac_c" 1>&6
+echo "configure:1712: checking if scheme.h can be found in $vi_cv_path_mzscheme_pfx/include" >&5
     if test -f $vi_cv_path_mzscheme_pfx/include/scheme.h; then
-      echo "$as_me:$LINENO: result: \"yes\"" >&5
-echo "${ECHO_T}\"yes\"" >&6
+      echo "$ac_t"""yes"" 1>&6
     else
-      echo "$as_me:$LINENO: result: \"no\"" >&5
-echo "${ECHO_T}\"no\"" >&6
+      echo "$ac_t"""no"" 1>&6
       vi_cv_path_mzscheme_pfx=
     fi
   fi
@@ -3848,74 +1734,70 @@
     MZSCHEME_SRC="if_mzsch.c"
     MZSCHEME_OBJ="objects/if_mzsch.o"
     MZSCHEME_PRO="if_mzsch.pro"
-    cat >>confdefs.h <<\_ACEOF
+    cat >> confdefs.h <<\EOF
 #define FEAT_MZSCHEME 1
-_ACEOF
+EOF
 
   fi
-
-
-
-
-
+  
+  
+  
+  
+  
 fi
 
 
-echo "$as_me:$LINENO: checking --enable-perlinterp argument" >&5
-echo $ECHO_N "checking --enable-perlinterp argument... $ECHO_C" >&6
+echo $ac_n "checking --enable-perlinterp argument""... $ac_c" 1>&6
+echo "configure:1752: checking --enable-perlinterp argument" >&5
 # Check whether --enable-perlinterp or --disable-perlinterp was given.
 if test "${enable_perlinterp+set}" = set; then
   enableval="$enable_perlinterp"
-
+  :
 else
   enable_perlinterp="no"
-fi;
-echo "$as_me:$LINENO: result: $enable_perlinterp" >&5
-echo "${ECHO_T}$enable_perlinterp" >&6
-if test "$enable_perlinterp" = "yes"; then
+fi
 
+echo "$ac_t""$enable_perlinterp" 1>&6
+if test "$enable_perlinterp" = "yes"; then
+  
   # Extract the first word of "perl", so it can be a program name with args.
 set dummy perl; ac_word=$2
-echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
-if test "${ac_cv_path_vi_cv_path_perl+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
+echo "configure:1767: checking for $ac_word" >&5
+if eval "test \"`echo '$''{'ac_cv_path_vi_cv_path_perl'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-  case $vi_cv_path_perl in
-  [\\/]* | ?:[\\/]*)
+  case "$vi_cv_path_perl" in
+  /*)
   ac_cv_path_vi_cv_path_perl="$vi_cv_path_perl" # Let the user override the test with a path.
   ;;
+  ?:/*)			 
+  ac_cv_path_vi_cv_path_perl="$vi_cv_path_perl" # Let the user override the test with a dos path.
+  ;;
   *)
-  as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
-    ac_cv_path_vi_cv_path_perl="$as_dir/$ac_word$ac_exec_ext"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-
+  IFS="${IFS= 	}"; ac_save_ifs="$IFS"; IFS=":"
+  ac_dummy="$PATH"
+  for ac_dir in $ac_dummy; do 
+    test -z "$ac_dir" && ac_dir=.
+    if test -f $ac_dir/$ac_word; then
+      ac_cv_path_vi_cv_path_perl="$ac_dir/$ac_word"
+      break
+    fi
+  done
+  IFS="$ac_save_ifs"
   ;;
 esac
 fi
-vi_cv_path_perl=$ac_cv_path_vi_cv_path_perl
-
+vi_cv_path_perl="$ac_cv_path_vi_cv_path_perl"
 if test -n "$vi_cv_path_perl"; then
-  echo "$as_me:$LINENO: result: $vi_cv_path_perl" >&5
-echo "${ECHO_T}$vi_cv_path_perl" >&6
+  echo "$ac_t""$vi_cv_path_perl" 1>&6
 else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
+  echo "$ac_t""no" 1>&6
 fi
 
   if test "X$vi_cv_path_perl" != "X"; then
-    echo "$as_me:$LINENO: checking Perl version" >&5
-echo $ECHO_N "checking Perl version... $ECHO_C" >&6
+    echo $ac_n "checking Perl version""... $ac_c" 1>&6
+echo "configure:1801: checking Perl version" >&5
     if $vi_cv_path_perl -e 'require 5.003_01' >/dev/null 2>/dev/null; then
      eval `$vi_cv_path_perl -V:usethreads`
      if test "X$usethreads" = "XUNKNOWN" -o "X$usethreads" = "Xundef"; then
@@ -3927,24 +1809,21 @@
 	   badthreads=no
 	 else
 	   badthreads=yes
-	   echo "$as_me:$LINENO: result: >>> Perl > 5.6 with 5.5 threads cannot be used <<<" >&5
-echo "${ECHO_T}>>> Perl > 5.6 with 5.5 threads cannot be used <<<" >&6
+	   echo "$ac_t"">>> Perl > 5.6 with 5.5 threads cannot be used <<<" 1>&6
 	 fi
        else
 	 badthreads=yes
-	 echo "$as_me:$LINENO: result: >>> Perl 5.5 with threads cannot be used <<<" >&5
-echo "${ECHO_T}>>> Perl 5.5 with threads cannot be used <<<" >&6
+	 echo "$ac_t"">>> Perl 5.5 with threads cannot be used <<<" 1>&6
        fi
      fi
      if test $badthreads = no; then
-      echo "$as_me:$LINENO: result: OK" >&5
-echo "${ECHO_T}OK" >&6
+      echo "$ac_t""OK" 1>&6
       eval `$vi_cv_path_perl -V:shrpenv`
       if test "X$shrpenv" = "XUNKNOWN"; then # pre 5.003_04
 	shrpenv=""
       fi
       vi_cv_perllib=`$vi_cv_path_perl -MConfig -e 'print $Config{privlibexp}'`
-
+      
             perlcppflags=`$vi_cv_path_perl -Mlib=$srcdir -MExtUtils::Embed \
 	      -e 'ccflags;perl_inc;print"\n"' | sed -e 's/-fno[^ ]*//'`
             perllibs=`cd $srcdir; $vi_cv_path_perl -MExtUtils::Embed -e 'ldopts' | \
@@ -3953,62 +1832,32 @@
                   perlldflags=`cd $srcdir; $vi_cv_path_perl -MExtUtils::Embed \
 		-e 'ccdlflags' | sed -e 's/-bE:perl.exp//'`
 
-                  echo "$as_me:$LINENO: checking if compile and link flags for Perl are sane" >&5
-echo $ECHO_N "checking if compile and link flags for Perl are sane... $ECHO_C" >&6
+                  echo $ac_n "checking if compile and link flags for Perl are sane""... $ac_c" 1>&6
+echo "configure:1837: checking if compile and link flags for Perl are sane" >&5
       cflags_save=$CFLAGS
       libs_save=$LIBS
       ldflags_save=$LDFLAGS
       CFLAGS="$CFLAGS $perlcppflags"
       LIBS="$LIBS $perllibs"
       LDFLAGS="$perlldflags $LDFLAGS"
-      cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+      cat > conftest.$ac_ext <<EOF
+#line 1845 "configure"
+#include "confdefs.h"
 
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6; perl_ok=yes
+int main() {
+ 
+; return 0; }
+EOF
+if { (eval echo configure:1852: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  echo "$ac_t""yes" 1>&6; perl_ok=yes
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-echo "$as_me:$LINENO: result: no: PERL DISABLED" >&5
-echo "${ECHO_T}no: PERL DISABLED" >&6; perl_ok=no
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  echo "$ac_t""no: PERL DISABLED" 1>&6; perl_ok=no
 fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
+rm -f conftest*
       CFLAGS=$cflags_save
       LIBS=$libs_save
       LDFLAGS=$ldflags_save
@@ -4023,15 +1872,14 @@
 	PERL_SRC="auto/if_perl.c if_perlsfio.c"
 	PERL_OBJ="objects/if_perl.o objects/if_perlsfio.o"
 	PERL_PRO="if_perl.pro if_perlsfio.pro"
-	cat >>confdefs.h <<\_ACEOF
+	cat >> confdefs.h <<\EOF
 #define FEAT_PERL 1
-_ACEOF
+EOF
 
       fi
      fi
     else
-      echo "$as_me:$LINENO: result: >>> too old; need Perl version 5.003_01 or later <<<" >&5
-echo "${ECHO_T}>>> too old; need Perl version 5.003_01 or later <<<" >&6
+      echo "$ac_t"">>> too old; need Perl version 5.003_01 or later <<<" 1>&6
     fi
   fi
 
@@ -4062,128 +1910,123 @@
 
 
 
-echo "$as_me:$LINENO: checking --enable-pythoninterp argument" >&5
-echo $ECHO_N "checking --enable-pythoninterp argument... $ECHO_C" >&6
+echo $ac_n "checking --enable-pythoninterp argument""... $ac_c" 1>&6
+echo "configure:1915: checking --enable-pythoninterp argument" >&5
 # Check whether --enable-pythoninterp or --disable-pythoninterp was given.
 if test "${enable_pythoninterp+set}" = set; then
   enableval="$enable_pythoninterp"
-
+  :
 else
   enable_pythoninterp="no"
-fi;
-echo "$as_me:$LINENO: result: $enable_pythoninterp" >&5
-echo "${ECHO_T}$enable_pythoninterp" >&6
+fi
+
+echo "$ac_t""$enable_pythoninterp" 1>&6
 if test "$enable_pythoninterp" = "yes"; then
     # Extract the first word of "python", so it can be a program name with args.
 set dummy python; ac_word=$2
-echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
-if test "${ac_cv_path_vi_cv_path_python+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
+echo "configure:1929: checking for $ac_word" >&5
+if eval "test \"`echo '$''{'ac_cv_path_vi_cv_path_python'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-  case $vi_cv_path_python in
-  [\\/]* | ?:[\\/]*)
+  case "$vi_cv_path_python" in
+  /*)
   ac_cv_path_vi_cv_path_python="$vi_cv_path_python" # Let the user override the test with a path.
   ;;
+  ?:/*)			 
+  ac_cv_path_vi_cv_path_python="$vi_cv_path_python" # Let the user override the test with a dos path.
+  ;;
   *)
-  as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
-    ac_cv_path_vi_cv_path_python="$as_dir/$ac_word$ac_exec_ext"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-
+  IFS="${IFS= 	}"; ac_save_ifs="$IFS"; IFS=":"
+  ac_dummy="$PATH"
+  for ac_dir in $ac_dummy; do 
+    test -z "$ac_dir" && ac_dir=.
+    if test -f $ac_dir/$ac_word; then
+      ac_cv_path_vi_cv_path_python="$ac_dir/$ac_word"
+      break
+    fi
+  done
+  IFS="$ac_save_ifs"
   ;;
 esac
 fi
-vi_cv_path_python=$ac_cv_path_vi_cv_path_python
-
+vi_cv_path_python="$ac_cv_path_vi_cv_path_python"
 if test -n "$vi_cv_path_python"; then
-  echo "$as_me:$LINENO: result: $vi_cv_path_python" >&5
-echo "${ECHO_T}$vi_cv_path_python" >&6
+  echo "$ac_t""$vi_cv_path_python" 1>&6
 else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
+  echo "$ac_t""no" 1>&6
 fi
 
   if test "X$vi_cv_path_python" != "X"; then
 
-        echo "$as_me:$LINENO: checking Python version" >&5
-echo $ECHO_N "checking Python version... $ECHO_C" >&6
-if test "${vi_cv_var_python_version+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+        echo $ac_n "checking Python version""... $ac_c" 1>&6
+echo "configure:1964: checking Python version" >&5
+if eval "test \"`echo '$''{'vi_cv_var_python_version'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
   vi_cv_var_python_version=`
 	    ${vi_cv_path_python} -c 'import sys; print sys.version[:3]'`
-
+    
 fi
-echo "$as_me:$LINENO: result: $vi_cv_var_python_version" >&5
-echo "${ECHO_T}$vi_cv_var_python_version" >&6
 
-        echo "$as_me:$LINENO: checking Python is 1.4 or better" >&5
-echo $ECHO_N "checking Python is 1.4 or better... $ECHO_C" >&6
+echo "$ac_t""$vi_cv_var_python_version" 1>&6
+
+        echo $ac_n "checking Python is 1.4 or better""... $ac_c" 1>&6
+echo "configure:1976: checking Python is 1.4 or better" >&5
     if ${vi_cv_path_python} -c \
 	"import sys; sys.exit(${vi_cv_var_python_version} < 1.4)"
     then
-      echo "$as_me:$LINENO: result: yep" >&5
-echo "${ECHO_T}yep" >&6
+      echo "$ac_t""yep" 1>&6
 
-            echo "$as_me:$LINENO: checking Python's install prefix" >&5
-echo $ECHO_N "checking Python's install prefix... $ECHO_C" >&6
-if test "${vi_cv_path_python_pfx+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+            echo $ac_n "checking Python's install prefix""... $ac_c" 1>&6
+echo "configure:1983: checking Python's install prefix" >&5
+if eval "test \"`echo '$''{'vi_cv_path_python_pfx'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
    vi_cv_path_python_pfx=`
 	    ${vi_cv_path_python} -c \
-		"import sys; print sys.prefix"`
+		"import sys; print sys.prefix"` 
 fi
-echo "$as_me:$LINENO: result: $vi_cv_path_python_pfx" >&5
-echo "${ECHO_T}$vi_cv_path_python_pfx" >&6
 
-            echo "$as_me:$LINENO: checking Python's execution prefix" >&5
-echo $ECHO_N "checking Python's execution prefix... $ECHO_C" >&6
-if test "${vi_cv_path_python_epfx+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+echo "$ac_t""$vi_cv_path_python_pfx" 1>&6
+
+            echo $ac_n "checking Python's execution prefix""... $ac_c" 1>&6
+echo "configure:1995: checking Python's execution prefix" >&5
+if eval "test \"`echo '$''{'vi_cv_path_python_epfx'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
    vi_cv_path_python_epfx=`
 	    ${vi_cv_path_python} -c \
-		"import sys; print sys.exec_prefix"`
+		"import sys; print sys.exec_prefix"` 
 fi
-echo "$as_me:$LINENO: result: $vi_cv_path_python_epfx" >&5
-echo "${ECHO_T}$vi_cv_path_python_epfx" >&6
 
+echo "$ac_t""$vi_cv_path_python_epfx" 1>&6
 
-      if test "${vi_cv_path_pythonpath+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+      
+      if eval "test \"`echo '$''{'vi_cv_path_pythonpath'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
    vi_cv_path_pythonpath=`
 	    unset PYTHONPATH;
 	    ${vi_cv_path_python} -c \
-		"import sys, string; print string.join(sys.path,':')"`
+		"import sys, string; print string.join(sys.path,':')"` 
 fi
 
 
-
-
-# Check whether --with-python-config-dir or --without-python-config-dir was given.
+      
+      # Check whether --with-python-config-dir or --without-python-config-dir was given.
 if test "${with_python_config_dir+set}" = set; then
   withval="$with_python_config_dir"
-   vi_cv_path_python_conf="${withval}"
-fi;
+   vi_cv_path_python_conf="${withval}"  
+fi
 
-      echo "$as_me:$LINENO: checking Python's configuration directory" >&5
-echo $ECHO_N "checking Python's configuration directory... $ECHO_C" >&6
-if test "${vi_cv_path_python_conf+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
 
+      echo $ac_n "checking Python's configuration directory""... $ac_c" 1>&6
+echo "configure:2026: checking Python's configuration directory" >&5
+if eval "test \"`echo '$''{'vi_cv_path_python_conf'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
+else
+  
 	vi_cv_path_python_conf=
 	for path in "${vi_cv_path_python_pfx}" "${vi_cv_path_python_epfx}"; do
 	  for subdir in lib share; do
@@ -4193,22 +2036,21 @@
 	    fi
 	  done
 	done
-
+      
 fi
-echo "$as_me:$LINENO: result: $vi_cv_path_python_conf" >&5
-echo "${ECHO_T}$vi_cv_path_python_conf" >&6
 
+echo "$ac_t""$vi_cv_path_python_conf" 1>&6
+
       PYTHON_CONFDIR="${vi_cv_path_python_conf}"
 
       if test "X$PYTHON_CONFDIR" = "X"; then
-	echo "$as_me:$LINENO: result: can't find it!" >&5
-echo "${ECHO_T}can't find it!" >&6
+	echo "$ac_t""can't find it!" 1>&6
       else
 
-			if test "${vi_cv_path_python_plibs+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+			if eval "test \"`echo '$''{'vi_cv_path_python_plibs'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-
+  
 	    tmp_mkf="/tmp/Makefile-conf$$"
 	    cat ${PYTHON_CONFDIR}/Makefile - <<'eof' >${tmp_mkf}
 __:
@@ -4231,7 +2073,7 @@
 	      vi_cv_path_python_plibs="${vi_cv_path_python_plibs} ${python_MODLIBS} ${python_LIBS} ${python_SYSLIBS} ${python_LINKFORSHARED}"
 	      	      vi_cv_path_python_plibs=`echo $vi_cv_path_python_plibs | sed s/-ltermcap//`
 	    fi
-
+	
 fi
 
 
@@ -4252,8 +2094,8 @@
 	fi
 	PYTHON_GETPATH_CFLAGS="-DPYTHONPATH='\"${vi_cv_path_pythonpath}\"' -DPREFIX='\"${vi_cv_path_python_pfx}\"' -DEXEC_PREFIX='\"${vi_cv_path_python_epfx}\"'"
 
-								echo "$as_me:$LINENO: checking if -pthread should be used" >&5
-echo $ECHO_N "checking if -pthread should be used... $ECHO_C" >&6
+								echo $ac_n "checking if -pthread should be used""... $ac_c" 1>&6
+echo "configure:2099: checking if -pthread should be used" >&5
 	threadsafe_flag=
 	thread_lib=
 	if test "x$MACOSX" != "xyes"; then
@@ -4268,121 +2110,60 @@
 	  cflags_save=$CFLAGS
 	  CFLAGS="$CFLAGS $threadsafe_flag"
 	  LIBS="$LIBS $thread_lib"
-	  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+	  cat > conftest.$ac_ext <<EOF
+#line 2115 "configure"
+#include "confdefs.h"
 
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6; PYTHON_CFLAGS="$PYTHON_CFLAGS $threadsafe_flag"
+int main() {
+ 
+; return 0; }
+EOF
+if { (eval echo configure:2122: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  echo "$ac_t""yes" 1>&6; PYTHON_CFLAGS="$PYTHON_CFLAGS $threadsafe_flag"
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; LIBS=$libs_save_old
-
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  echo "$ac_t""no" 1>&6; LIBS=$libs_save_old
+	     
 fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
+rm -f conftest*
 	  CFLAGS=$cflags_save
 	else
-	  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
+	  echo "$ac_t""no" 1>&6
 	fi
 
-			echo "$as_me:$LINENO: checking if compile and link flags for Python are sane" >&5
-echo $ECHO_N "checking if compile and link flags for Python are sane... $ECHO_C" >&6
+			echo $ac_n "checking if compile and link flags for Python are sane""... $ac_c" 1>&6
+echo "configure:2139: checking if compile and link flags for Python are sane" >&5
 	cflags_save=$CFLAGS
 	libs_save=$LIBS
 	CFLAGS="$CFLAGS $PYTHON_CFLAGS"
 	LIBS="$LIBS $PYTHON_LIBS"
-	cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+	cat > conftest.$ac_ext <<EOF
+#line 2145 "configure"
+#include "confdefs.h"
 
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6; python_ok=yes
+int main() {
+ 
+; return 0; }
+EOF
+if { (eval echo configure:2152: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  echo "$ac_t""yes" 1>&6; python_ok=yes
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-echo "$as_me:$LINENO: result: no: PYTHON DISABLED" >&5
-echo "${ECHO_T}no: PYTHON DISABLED" >&6; python_ok=no
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  echo "$ac_t""no: PYTHON DISABLED" 1>&6; python_ok=no
 fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
+rm -f conftest*
 	CFLAGS=$cflags_save
 	LIBS=$libs_save
 	if test $python_ok = yes; then
-	  cat >>confdefs.h <<\_ACEOF
+	  cat >> confdefs.h <<\EOF
 #define FEAT_PYTHON 1
-_ACEOF
+EOF
 
 	else
 	  LIBS=$libs_save_old
@@ -4394,8 +2175,7 @@
 
       fi
     else
-      echo "$as_me:$LINENO: result: too old" >&5
-echo "${ECHO_T}too old" >&6
+      echo "$ac_t""too old" 1>&6
     fi
   fi
 fi
@@ -4406,112 +2186,102 @@
 
 
 
-echo "$as_me:$LINENO: checking --enable-tclinterp argument" >&5
-echo $ECHO_N "checking --enable-tclinterp argument... $ECHO_C" >&6
+echo $ac_n "checking --enable-tclinterp argument""... $ac_c" 1>&6
+echo "configure:2191: checking --enable-tclinterp argument" >&5
 # Check whether --enable-tclinterp or --disable-tclinterp was given.
 if test "${enable_tclinterp+set}" = set; then
   enableval="$enable_tclinterp"
-
+  :
 else
   enable_tclinterp="no"
-fi;
-echo "$as_me:$LINENO: result: $enable_tclinterp" >&5
-echo "${ECHO_T}$enable_tclinterp" >&6
+fi
 
+echo "$ac_t""$enable_tclinterp" 1>&6
+
 if test "$enable_tclinterp" = "yes"; then
 
-    echo "$as_me:$LINENO: checking --with-tclsh argument" >&5
-echo $ECHO_N "checking --with-tclsh argument... $ECHO_C" >&6
-
-# Check whether --with-tclsh or --without-tclsh was given.
+    echo $ac_n "checking --with-tclsh argument""... $ac_c" 1>&6
+echo "configure:2205: checking --with-tclsh argument" >&5
+  # Check whether --with-tclsh or --without-tclsh was given.
 if test "${with_tclsh+set}" = set; then
   withval="$with_tclsh"
-  tclsh_name="$withval"; echo "$as_me:$LINENO: result: $tclsh_name" >&5
-echo "${ECHO_T}$tclsh_name" >&6
+  tclsh_name="$withval"; echo "$ac_t""$tclsh_name" 1>&6
 else
-  tclsh_name="tclsh8.4"; echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
-fi;
+  tclsh_name="tclsh8.4"; echo "$ac_t""no" 1>&6
+fi
+
   # Extract the first word of "$tclsh_name", so it can be a program name with args.
 set dummy $tclsh_name; ac_word=$2
-echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
-if test "${ac_cv_path_vi_cv_path_tcl+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
+echo "configure:2217: checking for $ac_word" >&5
+if eval "test \"`echo '$''{'ac_cv_path_vi_cv_path_tcl'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-  case $vi_cv_path_tcl in
-  [\\/]* | ?:[\\/]*)
+  case "$vi_cv_path_tcl" in
+  /*)
   ac_cv_path_vi_cv_path_tcl="$vi_cv_path_tcl" # Let the user override the test with a path.
   ;;
+  ?:/*)			 
+  ac_cv_path_vi_cv_path_tcl="$vi_cv_path_tcl" # Let the user override the test with a dos path.
+  ;;
   *)
-  as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
-    ac_cv_path_vi_cv_path_tcl="$as_dir/$ac_word$ac_exec_ext"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-
+  IFS="${IFS= 	}"; ac_save_ifs="$IFS"; IFS=":"
+  ac_dummy="$PATH"
+  for ac_dir in $ac_dummy; do 
+    test -z "$ac_dir" && ac_dir=.
+    if test -f $ac_dir/$ac_word; then
+      ac_cv_path_vi_cv_path_tcl="$ac_dir/$ac_word"
+      break
+    fi
+  done
+  IFS="$ac_save_ifs"
   ;;
 esac
 fi
-vi_cv_path_tcl=$ac_cv_path_vi_cv_path_tcl
-
+vi_cv_path_tcl="$ac_cv_path_vi_cv_path_tcl"
 if test -n "$vi_cv_path_tcl"; then
-  echo "$as_me:$LINENO: result: $vi_cv_path_tcl" >&5
-echo "${ECHO_T}$vi_cv_path_tcl" >&6
+  echo "$ac_t""$vi_cv_path_tcl" 1>&6
 else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
+  echo "$ac_t""no" 1>&6
 fi
 
+  
 
-
     if test "X$vi_cv_path_tcl" = "X" -a $tclsh_name = "tclsh8.4"; then
     tclsh_name="tclsh8.2"
     # Extract the first word of "$tclsh_name", so it can be a program name with args.
 set dummy $tclsh_name; ac_word=$2
-echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
-if test "${ac_cv_path_vi_cv_path_tcl+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
+echo "configure:2256: checking for $ac_word" >&5
+if eval "test \"`echo '$''{'ac_cv_path_vi_cv_path_tcl'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-  case $vi_cv_path_tcl in
-  [\\/]* | ?:[\\/]*)
+  case "$vi_cv_path_tcl" in
+  /*)
   ac_cv_path_vi_cv_path_tcl="$vi_cv_path_tcl" # Let the user override the test with a path.
   ;;
+  ?:/*)			 
+  ac_cv_path_vi_cv_path_tcl="$vi_cv_path_tcl" # Let the user override the test with a dos path.
+  ;;
   *)
-  as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
-    ac_cv_path_vi_cv_path_tcl="$as_dir/$ac_word$ac_exec_ext"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-
+  IFS="${IFS= 	}"; ac_save_ifs="$IFS"; IFS=":"
+  ac_dummy="$PATH"
+  for ac_dir in $ac_dummy; do 
+    test -z "$ac_dir" && ac_dir=.
+    if test -f $ac_dir/$ac_word; then
+      ac_cv_path_vi_cv_path_tcl="$ac_dir/$ac_word"
+      break
+    fi
+  done
+  IFS="$ac_save_ifs"
   ;;
 esac
 fi
-vi_cv_path_tcl=$ac_cv_path_vi_cv_path_tcl
-
+vi_cv_path_tcl="$ac_cv_path_vi_cv_path_tcl"
 if test -n "$vi_cv_path_tcl"; then
-  echo "$as_me:$LINENO: result: $vi_cv_path_tcl" >&5
-echo "${ECHO_T}$vi_cv_path_tcl" >&6
+  echo "$ac_t""$vi_cv_path_tcl" 1>&6
 else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
+  echo "$ac_t""no" 1>&6
 fi
 
   fi
@@ -4519,41 +2289,37 @@
     tclsh_name="tclsh8.0"
     # Extract the first word of "$tclsh_name", so it can be a program name with args.
 set dummy $tclsh_name; ac_word=$2
-echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
-if test "${ac_cv_path_vi_cv_path_tcl+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
+echo "configure:2294: checking for $ac_word" >&5
+if eval "test \"`echo '$''{'ac_cv_path_vi_cv_path_tcl'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-  case $vi_cv_path_tcl in
-  [\\/]* | ?:[\\/]*)
+  case "$vi_cv_path_tcl" in
+  /*)
   ac_cv_path_vi_cv_path_tcl="$vi_cv_path_tcl" # Let the user override the test with a path.
   ;;
+  ?:/*)			 
+  ac_cv_path_vi_cv_path_tcl="$vi_cv_path_tcl" # Let the user override the test with a dos path.
+  ;;
   *)
-  as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
-    ac_cv_path_vi_cv_path_tcl="$as_dir/$ac_word$ac_exec_ext"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-
+  IFS="${IFS= 	}"; ac_save_ifs="$IFS"; IFS=":"
+  ac_dummy="$PATH"
+  for ac_dir in $ac_dummy; do 
+    test -z "$ac_dir" && ac_dir=.
+    if test -f $ac_dir/$ac_word; then
+      ac_cv_path_vi_cv_path_tcl="$ac_dir/$ac_word"
+      break
+    fi
+  done
+  IFS="$ac_save_ifs"
   ;;
 esac
 fi
-vi_cv_path_tcl=$ac_cv_path_vi_cv_path_tcl
-
+vi_cv_path_tcl="$ac_cv_path_vi_cv_path_tcl"
 if test -n "$vi_cv_path_tcl"; then
-  echo "$as_me:$LINENO: result: $vi_cv_path_tcl" >&5
-echo "${ECHO_T}$vi_cv_path_tcl" >&6
+  echo "$ac_t""$vi_cv_path_tcl" 1>&6
 else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
+  echo "$ac_t""no" 1>&6
 fi
 
   fi
@@ -4561,55 +2327,50 @@
     tclsh_name="tclsh"
     # Extract the first word of "$tclsh_name", so it can be a program name with args.
 set dummy $tclsh_name; ac_word=$2
-echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
-if test "${ac_cv_path_vi_cv_path_tcl+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
+echo "configure:2332: checking for $ac_word" >&5
+if eval "test \"`echo '$''{'ac_cv_path_vi_cv_path_tcl'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-  case $vi_cv_path_tcl in
-  [\\/]* | ?:[\\/]*)
+  case "$vi_cv_path_tcl" in
+  /*)
   ac_cv_path_vi_cv_path_tcl="$vi_cv_path_tcl" # Let the user override the test with a path.
   ;;
+  ?:/*)			 
+  ac_cv_path_vi_cv_path_tcl="$vi_cv_path_tcl" # Let the user override the test with a dos path.
+  ;;
   *)
-  as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
-    ac_cv_path_vi_cv_path_tcl="$as_dir/$ac_word$ac_exec_ext"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-
+  IFS="${IFS= 	}"; ac_save_ifs="$IFS"; IFS=":"
+  ac_dummy="$PATH"
+  for ac_dir in $ac_dummy; do 
+    test -z "$ac_dir" && ac_dir=.
+    if test -f $ac_dir/$ac_word; then
+      ac_cv_path_vi_cv_path_tcl="$ac_dir/$ac_word"
+      break
+    fi
+  done
+  IFS="$ac_save_ifs"
   ;;
 esac
 fi
-vi_cv_path_tcl=$ac_cv_path_vi_cv_path_tcl
-
+vi_cv_path_tcl="$ac_cv_path_vi_cv_path_tcl"
 if test -n "$vi_cv_path_tcl"; then
-  echo "$as_me:$LINENO: result: $vi_cv_path_tcl" >&5
-echo "${ECHO_T}$vi_cv_path_tcl" >&6
+  echo "$ac_t""$vi_cv_path_tcl" 1>&6
 else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
+  echo "$ac_t""no" 1>&6
 fi
 
   fi
   if test "X$vi_cv_path_tcl" != "X"; then
-    echo "$as_me:$LINENO: checking Tcl version" >&5
-echo $ECHO_N "checking Tcl version... $ECHO_C" >&6
+    echo $ac_n "checking Tcl version""... $ac_c" 1>&6
+echo "configure:2367: checking Tcl version" >&5
     if echo 'exit [expr [info tclversion] < 8.0]' | $vi_cv_path_tcl - ; then
       tclver=`echo 'puts [info tclversion]' | $vi_cv_path_tcl -`
-      echo "$as_me:$LINENO: result: $tclver - OK" >&5
-echo "${ECHO_T}$tclver - OK" >&6;
+      echo "$ac_t""$tclver - OK" 1>&6;
       tclloc=`echo 'set l [info library];set i [string last lib $l];incr i -2;puts [string range $l 0 $i]' | $vi_cv_path_tcl -`
 
-      echo "$as_me:$LINENO: checking for location of Tcl include" >&5
-echo $ECHO_N "checking for location of Tcl include... $ECHO_C" >&6
+      echo $ac_n "checking for location of Tcl include""... $ac_c" 1>&6
+echo "configure:2374: checking for location of Tcl include" >&5
       if test "x$MACOSX" != "xyes"; then
 	tclinc="$tclloc/include $tclloc/include/tcl $tclloc/include/tcl$tclver /usr/local/include /usr/include"
       else
@@ -4617,20 +2378,18 @@
       fi
       for try in $tclinc; do
 	if test -f "$try/tcl.h"; then
-	  echo "$as_me:$LINENO: result: $try/tcl.h" >&5
-echo "${ECHO_T}$try/tcl.h" >&6
+	  echo "$ac_t""$try/tcl.h" 1>&6
 	  TCL_INC=$try
 	  break
 	fi
       done
       if test -z "$TCL_INC"; then
-	echo "$as_me:$LINENO: result: <not found>" >&5
-echo "${ECHO_T}<not found>" >&6
+	echo "$ac_t""<not found>" 1>&6
 	SKIP_TCL=YES
       fi
       if test -z "$SKIP_TCL"; then
-	echo "$as_me:$LINENO: checking for location of tclConfig.sh script" >&5
-echo $ECHO_N "checking for location of tclConfig.sh script... $ECHO_C" >&6
+	echo $ac_n "checking for location of tclConfig.sh script""... $ac_c" 1>&6
+echo "configure:2393: checking for location of tclConfig.sh script" >&5
 	if test "x$MACOSX" != "xyes"; then
 	  tclcnf=`echo $tclinc | sed s/include/lib/g`
 	else
@@ -4638,8 +2397,7 @@
 	fi
 	for try in $tclcnf; do
 	  if test -f $try/tclConfig.sh; then
-	    echo "$as_me:$LINENO: result: $try/tclConfig.sh" >&5
-echo "${ECHO_T}$try/tclConfig.sh" >&6
+	    echo "$ac_t""$try/tclConfig.sh" 1>&6
 	    . $try/tclConfig.sh
 	    	    TCL_LIBS=`eval echo "$TCL_LIB_SPEC $TCL_LIBS"`
 	    	    	    TCL_DEFS=`echo $TCL_DEFS | sed -e 's/\\\\ /\\\\X/g' | tr ' ' '\012' | sed -e '/^-[^D]/d' -e '/-D[^_]/d' -e 's/-D_/ -D_/' | tr '\012' ' ' | sed -e 's/\\\\X/\\\\ /g'`
@@ -4647,18 +2405,16 @@
 	  fi
 	done
 	if test -z "$TCL_LIBS"; then
-	  echo "$as_me:$LINENO: result: <not found>" >&5
-echo "${ECHO_T}<not found>" >&6
-	  echo "$as_me:$LINENO: checking for Tcl library by myself" >&5
-echo $ECHO_N "checking for Tcl library by myself... $ECHO_C" >&6
+	  echo "$ac_t""<not found>" 1>&6
+	  echo $ac_n "checking for Tcl library by myself""... $ac_c" 1>&6
+echo "configure:2411: checking for Tcl library by myself" >&5
 	  tcllib=`echo $tclinc | sed s/include/lib/g`
 	  for ext in .so .a ; do
 	    for ver in "" $tclver ; do
 	      for try in $tcllib ; do
 		trylib=tcl$ver$ext
 		if test -f $try/lib$trylib ; then
-		  echo "$as_me:$LINENO: result: $try/lib$trylib" >&5
-echo "${ECHO_T}$try/lib$trylib" >&6
+		  echo "$ac_t""$try/lib$trylib" 1>&6
 		  TCL_LIBS="-L$try -ltcl$ver -ldl -lm"
 		  if test "`(uname) 2>/dev/null`" = SunOS &&
 					 uname -r | grep '^5' >/dev/null; then
@@ -4670,15 +2426,14 @@
 	    done
 	  done
 	  if test -z "$TCL_LIBS"; then
-	    echo "$as_me:$LINENO: result: <not found>" >&5
-echo "${ECHO_T}<not found>" >&6
+	    echo "$ac_t""<not found>" 1>&6
 	    SKIP_TCL=YES
 	  fi
 	fi
 	if test -z "$SKIP_TCL"; then
-	  cat >>confdefs.h <<\_ACEOF
+	  cat >> confdefs.h <<\EOF
 #define FEAT_TCL 1
-_ACEOF
+EOF
 
 	  TCL_SRC=if_tcl.c
 	  TCL_OBJ=objects/if_tcl.o
@@ -4687,8 +2442,7 @@
 	fi
       fi
     else
-      echo "$as_me:$LINENO: result: too old; need Tcl version 8.0 or later" >&5
-echo "${ECHO_T}too old; need Tcl version 8.0 or later" >&6
+      echo "$ac_t""too old; need Tcl version 8.0 or later" 1>&6
     fi
   fi
 fi
@@ -4698,70 +2452,64 @@
 
 
 
-echo "$as_me:$LINENO: checking --enable-rubyinterp argument" >&5
-echo $ECHO_N "checking --enable-rubyinterp argument... $ECHO_C" >&6
+echo $ac_n "checking --enable-rubyinterp argument""... $ac_c" 1>&6
+echo "configure:2457: checking --enable-rubyinterp argument" >&5
 # Check whether --enable-rubyinterp or --disable-rubyinterp was given.
 if test "${enable_rubyinterp+set}" = set; then
   enableval="$enable_rubyinterp"
-
+  :
 else
   enable_rubyinterp="no"
-fi;
-echo "$as_me:$LINENO: result: $enable_rubyinterp" >&5
-echo "${ECHO_T}$enable_rubyinterp" >&6
-if test "$enable_rubyinterp" = "yes"; then
+fi
 
+echo "$ac_t""$enable_rubyinterp" 1>&6
+if test "$enable_rubyinterp" = "yes"; then
+  
   # Extract the first word of "ruby", so it can be a program name with args.
 set dummy ruby; ac_word=$2
-echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
-if test "${ac_cv_path_vi_cv_path_ruby+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
+echo "configure:2472: checking for $ac_word" >&5
+if eval "test \"`echo '$''{'ac_cv_path_vi_cv_path_ruby'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-  case $vi_cv_path_ruby in
-  [\\/]* | ?:[\\/]*)
+  case "$vi_cv_path_ruby" in
+  /*)
   ac_cv_path_vi_cv_path_ruby="$vi_cv_path_ruby" # Let the user override the test with a path.
   ;;
+  ?:/*)			 
+  ac_cv_path_vi_cv_path_ruby="$vi_cv_path_ruby" # Let the user override the test with a dos path.
+  ;;
   *)
-  as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
-    ac_cv_path_vi_cv_path_ruby="$as_dir/$ac_word$ac_exec_ext"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-
+  IFS="${IFS= 	}"; ac_save_ifs="$IFS"; IFS=":"
+  ac_dummy="$PATH"
+  for ac_dir in $ac_dummy; do 
+    test -z "$ac_dir" && ac_dir=.
+    if test -f $ac_dir/$ac_word; then
+      ac_cv_path_vi_cv_path_ruby="$ac_dir/$ac_word"
+      break
+    fi
+  done
+  IFS="$ac_save_ifs"
   ;;
 esac
 fi
-vi_cv_path_ruby=$ac_cv_path_vi_cv_path_ruby
-
+vi_cv_path_ruby="$ac_cv_path_vi_cv_path_ruby"
 if test -n "$vi_cv_path_ruby"; then
-  echo "$as_me:$LINENO: result: $vi_cv_path_ruby" >&5
-echo "${ECHO_T}$vi_cv_path_ruby" >&6
+  echo "$ac_t""$vi_cv_path_ruby" 1>&6
 else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
+  echo "$ac_t""no" 1>&6
 fi
 
   if test "X$vi_cv_path_ruby" != "X"; then
-    echo "$as_me:$LINENO: checking Ruby version" >&5
-echo $ECHO_N "checking Ruby version... $ECHO_C" >&6
+    echo $ac_n "checking Ruby version""... $ac_c" 1>&6
+echo "configure:2506: checking Ruby version" >&5
     if $vi_cv_path_ruby -e '(VERSION rescue RUBY_VERSION) >= "1.6.0" or exit 1' >/dev/null 2>/dev/null; then
-      echo "$as_me:$LINENO: result: OK" >&5
-echo "${ECHO_T}OK" >&6
-      echo "$as_me:$LINENO: checking Ruby header files" >&5
-echo $ECHO_N "checking Ruby header files... $ECHO_C" >&6
+      echo "$ac_t""OK" 1>&6
+      echo $ac_n "checking Ruby header files""... $ac_c" 1>&6
+echo "configure:2510: checking Ruby header files" >&5
       rubyhdrdir=`$vi_cv_path_ruby -r mkmf -e 'print Config::CONFIG["archdir"] || $hdrdir' 2>/dev/null`
       if test "X$rubyhdrdir" != "X"; then
-	echo "$as_me:$LINENO: result: $rubyhdrdir" >&5
-echo "${ECHO_T}$rubyhdrdir" >&6
+	echo "$ac_t""$rubyhdrdir" 1>&6
 	RUBY_CFLAGS="-I$rubyhdrdir"
 	rubylibs=`$vi_cv_path_ruby -r rbconfig -e 'print Config::CONFIG["LIBS"]'`
 	if test "X$rubylibs" != "X"; then
@@ -4791,17 +2539,15 @@
 	RUBY_SRC="if_ruby.c"
 	RUBY_OBJ="objects/if_ruby.o"
 	RUBY_PRO="if_ruby.pro"
-	cat >>confdefs.h <<\_ACEOF
+	cat >> confdefs.h <<\EOF
 #define FEAT_RUBY 1
-_ACEOF
+EOF
 
       else
-	echo "$as_me:$LINENO: result: not found" >&5
-echo "${ECHO_T}not found" >&6
+	echo "$ac_t""not found" 1>&6
       fi
     else
-      echo "$as_me:$LINENO: result: too old; need Ruby version 1.6.0 or later" >&5
-echo "${ECHO_T}too old; need Ruby version 1.6.0 or later" >&6
+      echo "$ac_t""too old; need Ruby version 1.6.0 or later" 1>&6
     fi
   fi
 fi
@@ -4811,217 +2557,160 @@
 
 
 
-echo "$as_me:$LINENO: checking --enable-cscope argument" >&5
-echo $ECHO_N "checking --enable-cscope argument... $ECHO_C" >&6
+echo $ac_n "checking --enable-cscope argument""... $ac_c" 1>&6
+echo "configure:2562: checking --enable-cscope argument" >&5
 # Check whether --enable-cscope or --disable-cscope was given.
 if test "${enable_cscope+set}" = set; then
   enableval="$enable_cscope"
-
+  :
 else
   enable_cscope="no"
-fi;
-echo "$as_me:$LINENO: result: $enable_cscope" >&5
-echo "${ECHO_T}$enable_cscope" >&6
+fi
+
+echo "$ac_t""$enable_cscope" 1>&6
 if test "$enable_cscope" = "yes"; then
-  cat >>confdefs.h <<\_ACEOF
+  cat >> confdefs.h <<\EOF
 #define FEAT_CSCOPE 1
-_ACEOF
+EOF
 
 fi
 
-echo "$as_me:$LINENO: checking --enable-workshop argument" >&5
-echo $ECHO_N "checking --enable-workshop argument... $ECHO_C" >&6
+echo $ac_n "checking --enable-workshop argument""... $ac_c" 1>&6
+echo "configure:2580: checking --enable-workshop argument" >&5
 # Check whether --enable-workshop or --disable-workshop was given.
 if test "${enable_workshop+set}" = set; then
   enableval="$enable_workshop"
-
+  :
 else
   enable_workshop="no"
-fi;
-echo "$as_me:$LINENO: result: $enable_workshop" >&5
-echo "${ECHO_T}$enable_workshop" >&6
+fi
+
+echo "$ac_t""$enable_workshop" 1>&6
 if test "$enable_workshop" = "yes"; then
-  cat >>confdefs.h <<\_ACEOF
+  cat >> confdefs.h <<\EOF
 #define FEAT_SUN_WORKSHOP 1
-_ACEOF
+EOF
 
   WORKSHOP_SRC="workshop.c integration.c"
-
+  
   WORKSHOP_OBJ="objects/workshop.o objects/integration.o"
-
+  
   if test "${enable_gui-xxx}" = xxx; then
     enable_gui=motif
   fi
 fi
 
-echo "$as_me:$LINENO: checking --disable-netbeans argument" >&5
-echo $ECHO_N "checking --disable-netbeans argument... $ECHO_C" >&6
+echo $ac_n "checking --disable-netbeans argument""... $ac_c" 1>&6
+echo "configure:2605: checking --disable-netbeans argument" >&5
 # Check whether --enable-netbeans or --disable-netbeans was given.
 if test "${enable_netbeans+set}" = set; then
   enableval="$enable_netbeans"
-
+  :
 else
   enable_netbeans="yes"
-fi;
-if test "$enable_netbeans" = "yes"; then
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
+fi
 
-echo "$as_me:$LINENO: checking for socket in -lsocket" >&5
-echo $ECHO_N "checking for socket in -lsocket... $ECHO_C" >&6
-if test "${ac_cv_lib_socket_socket+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+if test "$enable_netbeans" = "yes"; then
+  echo "$ac_t""no" 1>&6
+    echo $ac_n "checking for socket in -lsocket""... $ac_c" 1>&6
+echo "configure:2617: checking for socket in -lsocket" >&5
+ac_lib_var=`echo socket'_'socket | sed 'y%./+-%__p_%'`
+if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-  ac_check_lib_save_LIBS=$LIBS
+  ac_save_LIBS="$LIBS"
 LIBS="-lsocket  $LIBS"
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
+cat > conftest.$ac_ext <<EOF
+#line 2625 "configure"
+#include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
-#ifdef __cplusplus
-extern "C"
-#endif
 /* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
-char socket ();
-int
-main ()
-{
-socket ();
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_cv_lib_socket_socket=yes
+    builtin and then its argument prototype would still apply.  */
+char socket();
+
+int main() {
+socket()
+; return 0; }
+EOF
+if { (eval echo configure:2636: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=yes"
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=no"
+fi
+rm -f conftest*
+LIBS="$ac_save_LIBS"
 
-ac_cv_lib_socket_socket=no
 fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
-fi
-echo "$as_me:$LINENO: result: $ac_cv_lib_socket_socket" >&5
-echo "${ECHO_T}$ac_cv_lib_socket_socket" >&6
-if test $ac_cv_lib_socket_socket = yes; then
-  cat >>confdefs.h <<_ACEOF
-#define HAVE_LIBSOCKET 1
-_ACEOF
+if eval "test \"`echo '$ac_cv_lib_'$ac_lib_var`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
+    ac_tr_lib=HAVE_LIB`echo socket | sed -e 's/[^a-zA-Z0-9_]/_/g' \
+    -e 'y/abcdefghijklmnopqrstuvwxyz/ABCDEFGHIJKLMNOPQRSTUVWXYZ/'`
+  cat >> confdefs.h <<EOF
+#define $ac_tr_lib 1
+EOF
 
   LIBS="-lsocket $LIBS"
 
+else
+  echo "$ac_t""no" 1>&6
 fi
 
-
-echo "$as_me:$LINENO: checking for gethostbyname in -lnsl" >&5
-echo $ECHO_N "checking for gethostbyname in -lnsl... $ECHO_C" >&6
-if test "${ac_cv_lib_nsl_gethostbyname+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+  echo $ac_n "checking for gethostbyname in -lnsl""... $ac_c" 1>&6
+echo "configure:2664: checking for gethostbyname in -lnsl" >&5
+ac_lib_var=`echo nsl'_'gethostbyname | sed 'y%./+-%__p_%'`
+if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-  ac_check_lib_save_LIBS=$LIBS
+  ac_save_LIBS="$LIBS"
 LIBS="-lnsl  $LIBS"
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
+cat > conftest.$ac_ext <<EOF
+#line 2672 "configure"
+#include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
-#ifdef __cplusplus
-extern "C"
-#endif
 /* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
-char gethostbyname ();
-int
-main ()
-{
-gethostbyname ();
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_cv_lib_nsl_gethostbyname=yes
+    builtin and then its argument prototype would still apply.  */
+char gethostbyname();
+
+int main() {
+gethostbyname()
+; return 0; }
+EOF
+if { (eval echo configure:2683: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=yes"
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=no"
+fi
+rm -f conftest*
+LIBS="$ac_save_LIBS"
 
-ac_cv_lib_nsl_gethostbyname=no
 fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
-fi
-echo "$as_me:$LINENO: result: $ac_cv_lib_nsl_gethostbyname" >&5
-echo "${ECHO_T}$ac_cv_lib_nsl_gethostbyname" >&6
-if test $ac_cv_lib_nsl_gethostbyname = yes; then
-  cat >>confdefs.h <<_ACEOF
-#define HAVE_LIBNSL 1
-_ACEOF
+if eval "test \"`echo '$ac_cv_lib_'$ac_lib_var`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
+    ac_tr_lib=HAVE_LIB`echo nsl | sed -e 's/[^a-zA-Z0-9_]/_/g' \
+    -e 'y/abcdefghijklmnopqrstuvwxyz/ABCDEFGHIJKLMNOPQRSTUVWXYZ/'`
+  cat >> confdefs.h <<EOF
+#define $ac_tr_lib 1
+EOF
 
   LIBS="-lnsl $LIBS"
 
+else
+  echo "$ac_t""no" 1>&6
 fi
 
-  echo "$as_me:$LINENO: checking whether compiling netbeans integration is possible" >&5
-echo $ECHO_N "checking whether compiling netbeans integration is possible... $ECHO_C" >&6
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+  echo $ac_n "checking whether compiling netbeans integration is possible""... $ac_c" 1>&6
+echo "configure:2711: checking whether compiling netbeans integration is possible" >&5
+  cat > conftest.$ac_ext <<EOF
+#line 2713 "configure"
+#include "confdefs.h"
 
 #include <stdio.h>
 #include <stdlib.h>
@@ -5037,11 +2726,9 @@
 	unsigned int  initDone:1;
 	ushort signmaplen;
 	};
+	    
+int main() {
 
-int
-main ()
-{
-
 		/* Check creating a socket. */
 		struct sockaddr_in server;
 		(void)socket(AF_INET, SOCK_STREAM, 0);
@@ -5049,191 +2736,163 @@
 		(void)gethostbyname("microsoft.com");
 		if (errno == ECONNREFUSED)
 		  (void)connect(1, (struct sockaddr *)&server, sizeof(server));
-
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6
+	    
+; return 0; }
+EOF
+if { (eval echo configure:2743: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  echo "$ac_t""yes" 1>&6
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; enable_netbeans="no"
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  echo "$ac_t""no" 1>&6; enable_netbeans="no"
 fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
+rm -f conftest*
 else
-  echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6
+  echo "$ac_t""yes" 1>&6
 fi
 if test "$enable_netbeans" = "yes"; then
-  cat >>confdefs.h <<\_ACEOF
+  cat >> confdefs.h <<\EOF
 #define FEAT_NETBEANS_INTG 1
-_ACEOF
+EOF
 
   NETBEANS_SRC="netbeans.c"
-
+  
   NETBEANS_OBJ="objects/netbeans.o"
-
+  
 fi
 
-echo "$as_me:$LINENO: checking --enable-sniff argument" >&5
-echo $ECHO_N "checking --enable-sniff argument... $ECHO_C" >&6
+echo $ac_n "checking --enable-sniff argument""... $ac_c" 1>&6
+echo "configure:2768: checking --enable-sniff argument" >&5
 # Check whether --enable-sniff or --disable-sniff was given.
 if test "${enable_sniff+set}" = set; then
   enableval="$enable_sniff"
-
+  :
 else
   enable_sniff="no"
-fi;
-echo "$as_me:$LINENO: result: $enable_sniff" >&5
-echo "${ECHO_T}$enable_sniff" >&6
+fi
+
+echo "$ac_t""$enable_sniff" 1>&6
 if test "$enable_sniff" = "yes"; then
-  cat >>confdefs.h <<\_ACEOF
+  cat >> confdefs.h <<\EOF
 #define FEAT_SNIFF 1
-_ACEOF
+EOF
 
   SNIFF_SRC="if_sniff.c"
-
+  
   SNIFF_OBJ="objects/if_sniff.o"
-
+  
 fi
 
-echo "$as_me:$LINENO: checking --enable-multibyte argument" >&5
-echo $ECHO_N "checking --enable-multibyte argument... $ECHO_C" >&6
+echo $ac_n "checking --enable-multibyte argument""... $ac_c" 1>&6
+echo "configure:2790: checking --enable-multibyte argument" >&5
 # Check whether --enable-multibyte or --disable-multibyte was given.
 if test "${enable_multibyte+set}" = set; then
   enableval="$enable_multibyte"
-
+  :
 else
   enable_multibyte="no"
-fi;
-echo "$as_me:$LINENO: result: $enable_multibyte" >&5
-echo "${ECHO_T}$enable_multibyte" >&6
+fi
+
+echo "$ac_t""$enable_multibyte" 1>&6
 if test "$enable_multibyte" = "yes"; then
-  cat >>confdefs.h <<\_ACEOF
+  cat >> confdefs.h <<\EOF
 #define FEAT_MBYTE 1
-_ACEOF
+EOF
 
 fi
 
-echo "$as_me:$LINENO: checking --enable-hangulinput argument" >&5
-echo $ECHO_N "checking --enable-hangulinput argument... $ECHO_C" >&6
+echo $ac_n "checking --enable-hangulinput argument""... $ac_c" 1>&6
+echo "configure:2808: checking --enable-hangulinput argument" >&5
 # Check whether --enable-hangulinput or --disable-hangulinput was given.
 if test "${enable_hangulinput+set}" = set; then
   enableval="$enable_hangulinput"
-
+  :
 else
   enable_hangulinput="no"
-fi;
-echo "$as_me:$LINENO: result: $enable_hangulinput" >&5
-echo "${ECHO_T}$enable_hangulinput" >&6
+fi
 
-echo "$as_me:$LINENO: checking --enable-xim argument" >&5
-echo $ECHO_N "checking --enable-xim argument... $ECHO_C" >&6
+echo "$ac_t""$enable_hangulinput" 1>&6
+
+echo $ac_n "checking --enable-xim argument""... $ac_c" 1>&6
+echo "configure:2820: checking --enable-xim argument" >&5
 # Check whether --enable-xim or --disable-xim was given.
 if test "${enable_xim+set}" = set; then
   enableval="$enable_xim"
-  echo "$as_me:$LINENO: result: $enable_xim" >&5
-echo "${ECHO_T}$enable_xim" >&6
+  echo "$ac_t""$enable_xim" 1>&6
 else
-  enable_xim="auto"; echo "$as_me:$LINENO: result: defaulting to auto" >&5
-echo "${ECHO_T}defaulting to auto" >&6
-fi;
+  enable_xim="auto"; echo "$ac_t""defaulting to auto" 1>&6
+fi
 
-echo "$as_me:$LINENO: checking --enable-fontset argument" >&5
-echo $ECHO_N "checking --enable-fontset argument... $ECHO_C" >&6
+
+echo $ac_n "checking --enable-fontset argument""... $ac_c" 1>&6
+echo "configure:2831: checking --enable-fontset argument" >&5
 # Check whether --enable-fontset or --disable-fontset was given.
 if test "${enable_fontset+set}" = set; then
   enableval="$enable_fontset"
-
+  :
 else
   enable_fontset="no"
-fi;
-echo "$as_me:$LINENO: result: $enable_fontset" >&5
-echo "${ECHO_T}$enable_fontset" >&6
+fi
 
+echo "$ac_t""$enable_fontset" 1>&6
+
 test -z "$with_x" && with_x=yes
 test "${enable_gui-yes}" != no -a "x$MACOSX" != "xyes" -a "x$QNX" != "xyes" && with_x=yes
 if test "$with_x" = no; then
-  echo "$as_me:$LINENO: result: defaulting to: don't HAVE_X11" >&5
-echo "${ECHO_T}defaulting to: don't HAVE_X11" >&6
+  echo "$ac_t""defaulting to: don't HAVE_X11" 1>&6
 else
-
+  
   # Extract the first word of "xmkmf", so it can be a program name with args.
 set dummy xmkmf; ac_word=$2
-echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
-if test "${ac_cv_path_xmkmfpath+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
+echo "configure:2851: checking for $ac_word" >&5
+if eval "test \"`echo '$''{'ac_cv_path_xmkmfpath'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-  case $xmkmfpath in
-  [\\/]* | ?:[\\/]*)
+  case "$xmkmfpath" in
+  /*)
   ac_cv_path_xmkmfpath="$xmkmfpath" # Let the user override the test with a path.
   ;;
+  ?:/*)			 
+  ac_cv_path_xmkmfpath="$xmkmfpath" # Let the user override the test with a dos path.
+  ;;
   *)
-  as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
-    ac_cv_path_xmkmfpath="$as_dir/$ac_word$ac_exec_ext"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-
+  IFS="${IFS= 	}"; ac_save_ifs="$IFS"; IFS=":"
+  ac_dummy="$PATH"
+  for ac_dir in $ac_dummy; do 
+    test -z "$ac_dir" && ac_dir=.
+    if test -f $ac_dir/$ac_word; then
+      ac_cv_path_xmkmfpath="$ac_dir/$ac_word"
+      break
+    fi
+  done
+  IFS="$ac_save_ifs"
   ;;
 esac
 fi
-xmkmfpath=$ac_cv_path_xmkmfpath
-
+xmkmfpath="$ac_cv_path_xmkmfpath"
 if test -n "$xmkmfpath"; then
-  echo "$as_me:$LINENO: result: $xmkmfpath" >&5
-echo "${ECHO_T}$xmkmfpath" >&6
+  echo "$ac_t""$xmkmfpath" 1>&6
 else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
+  echo "$ac_t""no" 1>&6
 fi
 
 
-  echo "$as_me:$LINENO: checking for X" >&5
-echo $ECHO_N "checking for X... $ECHO_C" >&6
+  # If we find X, set shell vars x_includes and x_libraries to the
+# paths, otherwise set no_x=yes.
+# Uses ac_ vars as temps to allow command line to override cache and checks.
+# --without-x overrides everything else, but does not touch the cache.
+echo $ac_n "checking for X""... $ac_c" 1>&6
+echo "configure:2889: checking for X" >&5
 
-
 # Check whether --with-x or --without-x was given.
 if test "${with_x+set}" = set; then
   withval="$with_x"
+  :
+fi
 
-fi;
 # $have_x is `yes', `no', `disabled', or empty when we do not yet know.
 if test "x$with_x" = xno; then
   # The user explicitly disabled X.
@@ -5243,210 +2902,207 @@
     # Both variables are already set.
     have_x=yes
   else
-    if test "${ac_cv_have_x+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+if eval "test \"`echo '$''{'ac_cv_have_x'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
   # One or both of the vars are not set, and there is no cached value.
-ac_x_includes=no ac_x_libraries=no
-rm -fr conftest.dir
-if mkdir conftest.dir; then
-  cd conftest.dir
+ac_x_includes=NO ac_x_libraries=NO
+rm -fr conftestdir
+if mkdir conftestdir; then
+  cd conftestdir
   # Make sure to not put "make" in the Imakefile rules, since we grep it out.
-  cat >Imakefile <<'_ACEOF'
+  cat > Imakefile <<'EOF'
 acfindx:
 	@echo 'ac_im_incroot="${INCROOT}"; ac_im_usrlibdir="${USRLIBDIR}"; ac_im_libdir="${LIBDIR}"'
-_ACEOF
+EOF
   if (xmkmf) >/dev/null 2>/dev/null && test -f Makefile; then
     # GNU make sometimes prints "make[1]: Entering...", which would confuse us.
     eval `${MAKE-make} acfindx 2>/dev/null | grep -v make`
     # Open Windows xmkmf reportedly sets LIBDIR instead of USRLIBDIR.
     for ac_extension in a so sl; do
       if test ! -f $ac_im_usrlibdir/libX11.$ac_extension &&
-	 test -f $ac_im_libdir/libX11.$ac_extension; then
-	ac_im_usrlibdir=$ac_im_libdir; break
+        test -f $ac_im_libdir/libX11.$ac_extension; then
+        ac_im_usrlibdir=$ac_im_libdir; break
       fi
     done
     # Screen out bogus values from the imake configuration.  They are
     # bogus both because they are the default anyway, and because
     # using them would break gcc on systems where it needs fixed includes.
-    case $ac_im_incroot in
+    case "$ac_im_incroot" in
 	/usr/include) ;;
-	*) test -f "$ac_im_incroot/X11/Xos.h" && ac_x_includes=$ac_im_incroot;;
+	*) test -f "$ac_im_incroot/X11/Xos.h" && ac_x_includes="$ac_im_incroot" ;;
     esac
-    case $ac_im_usrlibdir in
+    case "$ac_im_usrlibdir" in
 	/usr/lib | /lib) ;;
-	*) test -d "$ac_im_usrlibdir" && ac_x_libraries=$ac_im_usrlibdir ;;
+	*) test -d "$ac_im_usrlibdir" && ac_x_libraries="$ac_im_usrlibdir" ;;
     esac
   fi
   cd ..
-  rm -fr conftest.dir
+  rm -fr conftestdir
 fi
 
-# Standard set of common directories for X headers.
-# Check X11 before X11Rn because it is often a symlink to the current release.
-ac_x_header_dirs='
-/usr/X11/include
-/usr/X11R6/include
-/usr/X11R5/include
-/usr/X11R4/include
+if test "$ac_x_includes" = NO; then
+  # Guess where to find include files, by looking for this one X11 .h file.
+  test -z "$x_direct_test_include" && x_direct_test_include=X11/Intrinsic.h
 
-/usr/include/X11
-/usr/include/X11R6
-/usr/include/X11R5
-/usr/include/X11R4
-
-/usr/local/X11/include
-/usr/local/X11R6/include
-/usr/local/X11R5/include
-/usr/local/X11R4/include
-
-/usr/local/include/X11
-/usr/local/include/X11R6
-/usr/local/include/X11R5
-/usr/local/include/X11R4
-
-/usr/X386/include
-/usr/x386/include
-/usr/XFree86/include/X11
-
-/usr/include
-/usr/local/include
-/usr/unsupported/include
-/usr/athena/include
-/usr/local/x11r5/include
-/usr/lpp/Xamples/include
-
-/usr/openwin/include
-/usr/openwin/share/include'
-
-if test "$ac_x_includes" = no; then
-  # Guess where to find include files, by looking for Intrinsic.h.
   # First, try using that file with no special directory specified.
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-#include <X11/Intrinsic.h>
-_ACEOF
-if { (eval echo "$as_me:$LINENO: \"$ac_cpp conftest.$ac_ext\"") >&5
-  (eval $ac_cpp conftest.$ac_ext) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } >/dev/null; then
-  if test -s conftest.err; then
-    ac_cpp_err=$ac_c_preproc_warn_flag
-    ac_cpp_err=$ac_cpp_err$ac_c_werror_flag
-  else
-    ac_cpp_err=
-  fi
-else
-  ac_cpp_err=yes
-fi
-if test -z "$ac_cpp_err"; then
+cat > conftest.$ac_ext <<EOF
+#line 2951 "configure"
+#include "confdefs.h"
+#include <$x_direct_test_include>
+EOF
+ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
+{ (eval echo configure:2956: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
+ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
+if test -z "$ac_err"; then
+  rm -rf conftest*
   # We can compile using X headers with no special include directory.
 ac_x_includes=
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-  for ac_dir in $ac_x_header_dirs; do
-  if test -r "$ac_dir/X11/Intrinsic.h"; then
-    ac_x_includes=$ac_dir
-    break
-  fi
-done
+  echo "$ac_err" >&5
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  # Look for the header file in a standard set of common directories.
+# Check X11 before X11Rn because it is often a symlink to the current release.
+  for ac_dir in               \
+    /usr/X11/include          \
+    /usr/X11R6/include        \
+    /usr/X11R5/include        \
+    /usr/X11R4/include        \
+                              \
+    /usr/include/X11          \
+    /usr/include/X11R6        \
+    /usr/include/X11R5        \
+    /usr/include/X11R4        \
+                              \
+    /usr/local/X11/include    \
+    /usr/local/X11R6/include  \
+    /usr/local/X11R5/include  \
+    /usr/local/X11R4/include  \
+                              \
+    /usr/local/include/X11    \
+    /usr/local/include/X11R6  \
+    /usr/local/include/X11R5  \
+    /usr/local/include/X11R4  \
+                              \
+    /usr/X386/include         \
+    /usr/x386/include         \
+    /usr/XFree86/include/X11  \
+                              \
+    /usr/include              \
+    /usr/local/include        \
+    /usr/unsupported/include  \
+    /usr/athena/include       \
+    /usr/local/x11r5/include  \
+    /usr/lpp/Xamples/include  \
+                              \
+    /usr/openwin/include      \
+    /usr/openwin/share/include \
+    ; \
+  do
+    if test -r "$ac_dir/$x_direct_test_include"; then
+      ac_x_includes=$ac_dir
+      break
+    fi
+  done
 fi
-rm -f conftest.err conftest.$ac_ext
-fi # $ac_x_includes = no
+rm -f conftest*
+fi # $ac_x_includes = NO
 
-if test "$ac_x_libraries" = no; then
+if test "$ac_x_libraries" = NO; then
   # Check for the libraries.
+
+  test -z "$x_direct_test_library" && x_direct_test_library=Xt
+  test -z "$x_direct_test_function" && x_direct_test_function=XtMalloc
+
   # See if we find them without any special options.
   # Don't add to $LIBS permanently.
-  ac_save_LIBS=$LIBS
-  LIBS="-lXt $LIBS"
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-#include <X11/Intrinsic.h>
-int
-main ()
-{
-XtMalloc (0)
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  LIBS=$ac_save_LIBS
+  ac_save_LIBS="$LIBS"
+  LIBS="-l$x_direct_test_library $LIBS"
+cat > conftest.$ac_ext <<EOF
+#line 3025 "configure"
+#include "confdefs.h"
+
+int main() {
+${x_direct_test_function}()
+; return 0; }
+EOF
+if { (eval echo configure:3032: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  LIBS="$ac_save_LIBS"
 # We can link X programs with no special library path.
 ac_x_libraries=
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-LIBS=$ac_save_LIBS
-for ac_dir in `echo "$ac_x_includes $ac_x_header_dirs" | sed s/include/lib/g`
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  LIBS="$ac_save_LIBS"
+# First see if replacing the include by lib works.
+# Check X11 before X11Rn because it is often a symlink to the current release.
+for ac_dir in `echo "$ac_x_includes" | sed s/include/lib/` \
+    /usr/X11/lib          \
+    /usr/X11R6/lib        \
+    /usr/X11R5/lib        \
+    /usr/X11R4/lib        \
+                          \
+    /usr/lib/X11          \
+    /usr/lib/X11R6        \
+    /usr/lib/X11R5        \
+    /usr/lib/X11R4        \
+                          \
+    /usr/local/X11/lib    \
+    /usr/local/X11R6/lib  \
+    /usr/local/X11R5/lib  \
+    /usr/local/X11R4/lib  \
+                          \
+    /usr/local/lib/X11    \
+    /usr/local/lib/X11R6  \
+    /usr/local/lib/X11R5  \
+    /usr/local/lib/X11R4  \
+                          \
+    /usr/X386/lib         \
+    /usr/x386/lib         \
+    /usr/XFree86/lib/X11  \
+                          \
+    /usr/lib              \
+    /usr/local/lib        \
+    /usr/unsupported/lib  \
+    /usr/athena/lib       \
+    /usr/local/x11r5/lib  \
+    /usr/lpp/Xamples/lib  \
+    /lib/usr/lib/X11	  \
+                          \
+    /usr/openwin/lib      \
+    /usr/openwin/share/lib \
+    ; \
 do
-  # Don't even attempt the hair of trying to link an X program!
   for ac_extension in a so sl; do
-    if test -r $ac_dir/libXt.$ac_extension; then
+    if test -r $ac_dir/lib${x_direct_test_library}.$ac_extension; then
       ac_x_libraries=$ac_dir
       break 2
     fi
   done
 done
 fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
-fi # $ac_x_libraries = no
+rm -f conftest*
+fi # $ac_x_libraries = NO
 
-if test "$ac_x_includes" = no || test "$ac_x_libraries" = no; then
+if test "$ac_x_includes" = NO || test "$ac_x_libraries" = NO; then
   # Didn't find X anywhere.  Cache the known absence of X.
   ac_cv_have_x="have_x=no"
 else
   # Record where we found X for the cache.
   ac_cv_have_x="have_x=yes \
-		ac_x_includes=$ac_x_includes ac_x_libraries=$ac_x_libraries"
+	        ac_x_includes=$ac_x_includes ac_x_libraries=$ac_x_libraries"
 fi
 fi
-
   fi
   eval "$ac_cv_have_x"
 fi # $with_x != no
 
 if test "$have_x" != yes; then
-  echo "$as_me:$LINENO: result: $have_x" >&5
-echo "${ECHO_T}$have_x" >&6
+  echo "$ac_t""$have_x" 1>&6
   no_x=yes
 else
   # If each of the values was on the command line, it overrides each guess.
@@ -5455,16 +3111,14 @@
   # Update the cache value to reflect the command line values.
   ac_cv_have_x="have_x=yes \
 		ac_x_includes=$x_includes ac_x_libraries=$x_libraries"
-  echo "$as_me:$LINENO: result: libraries $x_libraries, headers $x_includes" >&5
-echo "${ECHO_T}libraries $x_libraries, headers $x_includes" >&6
+  echo "$ac_t""libraries $x_libraries, headers $x_includes" 1>&6
 fi
 
 if test "$no_x" = yes; then
   # Not all programs may use this symbol, but it does not hurt to define it.
-
-cat >>confdefs.h <<\_ACEOF
+  cat >> confdefs.h <<\EOF
 #define X_DISPLAY_MISSING 1
-_ACEOF
+EOF
 
   X_CFLAGS= X_PRE_LIBS= X_LIBS= X_EXTRA_LIBS=
 else
@@ -5477,119 +3131,60 @@
     X_LIBS="$X_LIBS -L$x_libraries"
     # For Solaris; some versions of Sun CC require a space after -R and
     # others require no space.  Words are not sufficient . . . .
-    case `(uname -sr) 2>/dev/null` in
+    case "`(uname -sr) 2>/dev/null`" in
     "SunOS 5"*)
-      echo "$as_me:$LINENO: checking whether -R must be followed by a space" >&5
-echo $ECHO_N "checking whether -R must be followed by a space... $ECHO_C" >&6
-      ac_xsave_LIBS=$LIBS; LIBS="$LIBS -R$x_libraries"
-      cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+      echo $ac_n "checking whether -R must be followed by a space""... $ac_c" 1>&6
+echo "configure:3138: checking whether -R must be followed by a space" >&5
+      ac_xsave_LIBS="$LIBS"; LIBS="$LIBS -R$x_libraries"
+      cat > conftest.$ac_ext <<EOF
+#line 3141 "configure"
+#include "confdefs.h"
 
-int
-main ()
-{
+int main() {
 
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
+; return 0; }
+EOF
+if { (eval echo configure:3148: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
   ac_R_nospace=yes
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-ac_R_nospace=no
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  ac_R_nospace=no
 fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
+rm -f conftest*
       if test $ac_R_nospace = yes; then
-	echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
+	echo "$ac_t""no" 1>&6
 	X_LIBS="$X_LIBS -R$x_libraries"
       else
 	LIBS="$ac_xsave_LIBS -R $x_libraries"
-	cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+	cat > conftest.$ac_ext <<EOF
+#line 3164 "configure"
+#include "confdefs.h"
 
-int
-main ()
-{
+int main() {
 
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
+; return 0; }
+EOF
+if { (eval echo configure:3171: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
   ac_R_space=yes
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-ac_R_space=no
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  ac_R_space=no
 fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
+rm -f conftest*
 	if test $ac_R_space = yes; then
-	  echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6
+	  echo "$ac_t""yes" 1>&6
 	  X_LIBS="$X_LIBS -R $x_libraries"
 	else
-	  echo "$as_me:$LINENO: result: neither works" >&5
-echo "${ECHO_T}neither works" >&6
+	  echo "$ac_t""neither works" 1>&6
 	fi
       fi
-      LIBS=$ac_xsave_LIBS
+      LIBS="$ac_xsave_LIBS"
     esac
   fi
 
@@ -5600,1016 +3195,522 @@
   if test "$ISC" = yes; then
     X_EXTRA_LIBS="$X_EXTRA_LIBS -lnsl_s -linet"
   else
-    # Martyn Johnson says this is needed for Ultrix, if the X
-    # libraries were built with DECnet support.  And Karl Berry says
+    # Martyn.Johnson@cl.cam.ac.uk says this is needed for Ultrix, if the X
+    # libraries were built with DECnet support.  And karl@cs.umb.edu says
     # the Alpha needs dnet_stub (dnet does not exist).
-    ac_xsave_LIBS="$LIBS"; LIBS="$LIBS $X_LIBS -lX11"
-    cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-/* Override any gcc2 internal prototype to avoid an error.  */
-#ifdef __cplusplus
-extern "C"
-#endif
-/* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
-char XOpenDisplay ();
-int
-main ()
-{
-XOpenDisplay ();
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  :
+    echo $ac_n "checking for dnet_ntoa in -ldnet""... $ac_c" 1>&6
+echo "configure:3203: checking for dnet_ntoa in -ldnet" >&5
+ac_lib_var=`echo dnet'_'dnet_ntoa | sed 'y%./+-%__p_%'`
+if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-echo "$as_me:$LINENO: checking for dnet_ntoa in -ldnet" >&5
-echo $ECHO_N "checking for dnet_ntoa in -ldnet... $ECHO_C" >&6
-if test "${ac_cv_lib_dnet_dnet_ntoa+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  ac_check_lib_save_LIBS=$LIBS
+  ac_save_LIBS="$LIBS"
 LIBS="-ldnet  $LIBS"
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
+cat > conftest.$ac_ext <<EOF
+#line 3211 "configure"
+#include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
-#ifdef __cplusplus
-extern "C"
-#endif
 /* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
-char dnet_ntoa ();
-int
-main ()
-{
-dnet_ntoa ();
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_cv_lib_dnet_dnet_ntoa=yes
+    builtin and then its argument prototype would still apply.  */
+char dnet_ntoa();
+
+int main() {
+dnet_ntoa()
+; return 0; }
+EOF
+if { (eval echo configure:3222: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=yes"
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=no"
+fi
+rm -f conftest*
+LIBS="$ac_save_LIBS"
 
-ac_cv_lib_dnet_dnet_ntoa=no
 fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
-fi
-echo "$as_me:$LINENO: result: $ac_cv_lib_dnet_dnet_ntoa" >&5
-echo "${ECHO_T}$ac_cv_lib_dnet_dnet_ntoa" >&6
-if test $ac_cv_lib_dnet_dnet_ntoa = yes; then
+if eval "test \"`echo '$ac_cv_lib_'$ac_lib_var`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
   X_EXTRA_LIBS="$X_EXTRA_LIBS -ldnet"
+else
+  echo "$ac_t""no" 1>&6
 fi
 
     if test $ac_cv_lib_dnet_dnet_ntoa = no; then
-      echo "$as_me:$LINENO: checking for dnet_ntoa in -ldnet_stub" >&5
-echo $ECHO_N "checking for dnet_ntoa in -ldnet_stub... $ECHO_C" >&6
-if test "${ac_cv_lib_dnet_stub_dnet_ntoa+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+      echo $ac_n "checking for dnet_ntoa in -ldnet_stub""... $ac_c" 1>&6
+echo "configure:3244: checking for dnet_ntoa in -ldnet_stub" >&5
+ac_lib_var=`echo dnet_stub'_'dnet_ntoa | sed 'y%./+-%__p_%'`
+if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-  ac_check_lib_save_LIBS=$LIBS
+  ac_save_LIBS="$LIBS"
 LIBS="-ldnet_stub  $LIBS"
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
+cat > conftest.$ac_ext <<EOF
+#line 3252 "configure"
+#include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
-#ifdef __cplusplus
-extern "C"
-#endif
 /* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
-char dnet_ntoa ();
-int
-main ()
-{
-dnet_ntoa ();
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_cv_lib_dnet_stub_dnet_ntoa=yes
+    builtin and then its argument prototype would still apply.  */
+char dnet_ntoa();
+
+int main() {
+dnet_ntoa()
+; return 0; }
+EOF
+if { (eval echo configure:3263: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=yes"
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=no"
+fi
+rm -f conftest*
+LIBS="$ac_save_LIBS"
 
-ac_cv_lib_dnet_stub_dnet_ntoa=no
 fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
-fi
-echo "$as_me:$LINENO: result: $ac_cv_lib_dnet_stub_dnet_ntoa" >&5
-echo "${ECHO_T}$ac_cv_lib_dnet_stub_dnet_ntoa" >&6
-if test $ac_cv_lib_dnet_stub_dnet_ntoa = yes; then
+if eval "test \"`echo '$ac_cv_lib_'$ac_lib_var`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
   X_EXTRA_LIBS="$X_EXTRA_LIBS -ldnet_stub"
+else
+  echo "$ac_t""no" 1>&6
 fi
 
     fi
-fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
-    LIBS="$ac_xsave_LIBS"
 
     # msh@cis.ufl.edu says -lnsl (and -lsocket) are needed for his 386/AT,
     # to get the SysV transport functions.
-    # Chad R. Larson says the Pyramis MIS-ES running DC/OSx (SVR4)
+    # chad@anasazi.com says the Pyramis MIS-ES running DC/OSx (SVR4)
     # needs -lnsl.
     # The nsl library prevents programs from opening the X display
-    # on Irix 5.2, according to T.E. Dickey.
-    # The functions gethostbyname, getservbyname, and inet_addr are
-    # in -lbsd on LynxOS 3.0.1/i386, according to Lars Hecking.
-    echo "$as_me:$LINENO: checking for gethostbyname" >&5
-echo $ECHO_N "checking for gethostbyname... $ECHO_C" >&6
-if test "${ac_cv_func_gethostbyname+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+    # on Irix 5.2, according to dickey@clark.net.
+    echo $ac_n "checking for gethostbyname""... $ac_c" 1>&6
+echo "configure:3292: checking for gethostbyname" >&5
+if eval "test \"`echo '$''{'ac_cv_func_gethostbyname'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-/* Define gethostbyname to an innocuous variant, in case <limits.h> declares gethostbyname.
-   For example, HP-UX 11i <limits.h> declares gettimeofday.  */
-#define gethostbyname innocuous_gethostbyname
-
+  cat > conftest.$ac_ext <<EOF
+#line 3297 "configure"
+#include "confdefs.h"
 /* System header to define __stub macros and hopefully few prototypes,
-    which can conflict with char gethostbyname (); below.
-    Prefer <limits.h> to <assert.h> if __STDC__ is defined, since
-    <limits.h> exists even on freestanding compilers.  */
-
-#ifdef __STDC__
-# include <limits.h>
-#else
-# include <assert.h>
-#endif
-
-#undef gethostbyname
-
+    which can conflict with char gethostbyname(); below.  */
+#include <assert.h>
 /* Override any gcc2 internal prototype to avoid an error.  */
-#ifdef __cplusplus
-extern "C"
-{
-#endif
 /* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
-char gethostbyname ();
+    builtin and then its argument prototype would still apply.  */
+char gethostbyname();
+
+int main() {
+
 /* The GNU C library defines this for functions which it implements
     to always fail with ENOSYS.  Some functions are actually named
     something starting with __ and the normal name is an alias.  */
 #if defined (__stub_gethostbyname) || defined (__stub___gethostbyname)
 choke me
 #else
-char (*f) () = gethostbyname;
+gethostbyname();
 #endif
-#ifdef __cplusplus
-}
-#endif
 
-int
-main ()
-{
-return f != gethostbyname;
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_cv_func_gethostbyname=yes
+; return 0; }
+EOF
+if { (eval echo configure:3320: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  eval "ac_cv_func_gethostbyname=yes"
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-ac_cv_func_gethostbyname=no
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_func_gethostbyname=no"
 fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
+rm -f conftest*
 fi
-echo "$as_me:$LINENO: result: $ac_cv_func_gethostbyname" >&5
-echo "${ECHO_T}$ac_cv_func_gethostbyname" >&6
 
+if eval "test \"`echo '$ac_cv_func_'gethostbyname`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
+  :
+else
+  echo "$ac_t""no" 1>&6
+fi
+
     if test $ac_cv_func_gethostbyname = no; then
-      echo "$as_me:$LINENO: checking for gethostbyname in -lnsl" >&5
-echo $ECHO_N "checking for gethostbyname in -lnsl... $ECHO_C" >&6
-if test "${ac_cv_lib_nsl_gethostbyname+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+      echo $ac_n "checking for gethostbyname in -lnsl""... $ac_c" 1>&6
+echo "configure:3341: checking for gethostbyname in -lnsl" >&5
+ac_lib_var=`echo nsl'_'gethostbyname | sed 'y%./+-%__p_%'`
+if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-  ac_check_lib_save_LIBS=$LIBS
+  ac_save_LIBS="$LIBS"
 LIBS="-lnsl  $LIBS"
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
+cat > conftest.$ac_ext <<EOF
+#line 3349 "configure"
+#include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
-#ifdef __cplusplus
-extern "C"
-#endif
 /* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
-char gethostbyname ();
-int
-main ()
-{
-gethostbyname ();
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_cv_lib_nsl_gethostbyname=yes
+    builtin and then its argument prototype would still apply.  */
+char gethostbyname();
+
+int main() {
+gethostbyname()
+; return 0; }
+EOF
+if { (eval echo configure:3360: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=yes"
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=no"
+fi
+rm -f conftest*
+LIBS="$ac_save_LIBS"
 
-ac_cv_lib_nsl_gethostbyname=no
 fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
-fi
-echo "$as_me:$LINENO: result: $ac_cv_lib_nsl_gethostbyname" >&5
-echo "${ECHO_T}$ac_cv_lib_nsl_gethostbyname" >&6
-if test $ac_cv_lib_nsl_gethostbyname = yes; then
+if eval "test \"`echo '$ac_cv_lib_'$ac_lib_var`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
   X_EXTRA_LIBS="$X_EXTRA_LIBS -lnsl"
-fi
-
-      if test $ac_cv_lib_nsl_gethostbyname = no; then
-	echo "$as_me:$LINENO: checking for gethostbyname in -lbsd" >&5
-echo $ECHO_N "checking for gethostbyname in -lbsd... $ECHO_C" >&6
-if test "${ac_cv_lib_bsd_gethostbyname+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
 else
-  ac_check_lib_save_LIBS=$LIBS
-LIBS="-lbsd  $LIBS"
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-/* Override any gcc2 internal prototype to avoid an error.  */
-#ifdef __cplusplus
-extern "C"
-#endif
-/* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
-char gethostbyname ();
-int
-main ()
-{
-gethostbyname ();
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_cv_lib_bsd_gethostbyname=yes
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-ac_cv_lib_bsd_gethostbyname=no
+  echo "$ac_t""no" 1>&6
 fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
-fi
-echo "$as_me:$LINENO: result: $ac_cv_lib_bsd_gethostbyname" >&5
-echo "${ECHO_T}$ac_cv_lib_bsd_gethostbyname" >&6
-if test $ac_cv_lib_bsd_gethostbyname = yes; then
-  X_EXTRA_LIBS="$X_EXTRA_LIBS -lbsd"
-fi
 
-      fi
     fi
 
     # lieder@skyler.mavd.honeywell.com says without -lsocket,
     # socket/setsockopt and other routines are undefined under SCO ODT
     # 2.0.  But -lsocket is broken on IRIX 5.2 (and is not necessary
-    # on later versions), says Simon Leinen: it contains gethostby*
-    # variants that don't use the name server (or something).  -lsocket
-    # must be given before -lnsl if both are needed.  We assume that
-    # if connect needs -lnsl, so does gethostbyname.
-    echo "$as_me:$LINENO: checking for connect" >&5
-echo $ECHO_N "checking for connect... $ECHO_C" >&6
-if test "${ac_cv_func_connect+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+    # on later versions), says simon@lia.di.epfl.ch: it contains
+    # gethostby* variants that don't use the nameserver (or something).
+    # -lsocket must be given before -lnsl if both are needed.
+    # We assume that if connect needs -lnsl, so does gethostbyname.
+    echo $ac_n "checking for connect""... $ac_c" 1>&6
+echo "configure:3390: checking for connect" >&5
+if eval "test \"`echo '$''{'ac_cv_func_connect'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-/* Define connect to an innocuous variant, in case <limits.h> declares connect.
-   For example, HP-UX 11i <limits.h> declares gettimeofday.  */
-#define connect innocuous_connect
-
+  cat > conftest.$ac_ext <<EOF
+#line 3395 "configure"
+#include "confdefs.h"
 /* System header to define __stub macros and hopefully few prototypes,
-    which can conflict with char connect (); below.
-    Prefer <limits.h> to <assert.h> if __STDC__ is defined, since
-    <limits.h> exists even on freestanding compilers.  */
-
-#ifdef __STDC__
-# include <limits.h>
-#else
-# include <assert.h>
-#endif
-
-#undef connect
-
+    which can conflict with char connect(); below.  */
+#include <assert.h>
 /* Override any gcc2 internal prototype to avoid an error.  */
-#ifdef __cplusplus
-extern "C"
-{
-#endif
 /* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
-char connect ();
+    builtin and then its argument prototype would still apply.  */
+char connect();
+
+int main() {
+
 /* The GNU C library defines this for functions which it implements
     to always fail with ENOSYS.  Some functions are actually named
     something starting with __ and the normal name is an alias.  */
 #if defined (__stub_connect) || defined (__stub___connect)
 choke me
 #else
-char (*f) () = connect;
+connect();
 #endif
-#ifdef __cplusplus
-}
-#endif
 
-int
-main ()
-{
-return f != connect;
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_cv_func_connect=yes
+; return 0; }
+EOF
+if { (eval echo configure:3418: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  eval "ac_cv_func_connect=yes"
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-ac_cv_func_connect=no
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_func_connect=no"
 fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
+rm -f conftest*
 fi
-echo "$as_me:$LINENO: result: $ac_cv_func_connect" >&5
-echo "${ECHO_T}$ac_cv_func_connect" >&6
 
+if eval "test \"`echo '$ac_cv_func_'connect`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
+  :
+else
+  echo "$ac_t""no" 1>&6
+fi
+
     if test $ac_cv_func_connect = no; then
-      echo "$as_me:$LINENO: checking for connect in -lsocket" >&5
-echo $ECHO_N "checking for connect in -lsocket... $ECHO_C" >&6
-if test "${ac_cv_lib_socket_connect+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+      echo $ac_n "checking for connect in -lsocket""... $ac_c" 1>&6
+echo "configure:3439: checking for connect in -lsocket" >&5
+ac_lib_var=`echo socket'_'connect | sed 'y%./+-%__p_%'`
+if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-  ac_check_lib_save_LIBS=$LIBS
+  ac_save_LIBS="$LIBS"
 LIBS="-lsocket $X_EXTRA_LIBS $LIBS"
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
+cat > conftest.$ac_ext <<EOF
+#line 3447 "configure"
+#include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
-#ifdef __cplusplus
-extern "C"
-#endif
 /* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
-char connect ();
-int
-main ()
-{
-connect ();
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_cv_lib_socket_connect=yes
+    builtin and then its argument prototype would still apply.  */
+char connect();
+
+int main() {
+connect()
+; return 0; }
+EOF
+if { (eval echo configure:3458: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=yes"
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=no"
+fi
+rm -f conftest*
+LIBS="$ac_save_LIBS"
 
-ac_cv_lib_socket_connect=no
 fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
-fi
-echo "$as_me:$LINENO: result: $ac_cv_lib_socket_connect" >&5
-echo "${ECHO_T}$ac_cv_lib_socket_connect" >&6
-if test $ac_cv_lib_socket_connect = yes; then
+if eval "test \"`echo '$ac_cv_lib_'$ac_lib_var`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
   X_EXTRA_LIBS="-lsocket $X_EXTRA_LIBS"
+else
+  echo "$ac_t""no" 1>&6
 fi
 
     fi
 
-    # Guillermo Gomez says -lposix is necessary on A/UX.
-    echo "$as_me:$LINENO: checking for remove" >&5
-echo $ECHO_N "checking for remove... $ECHO_C" >&6
-if test "${ac_cv_func_remove+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+    # gomez@mi.uni-erlangen.de says -lposix is necessary on A/UX.
+    echo $ac_n "checking for remove""... $ac_c" 1>&6
+echo "configure:3482: checking for remove" >&5
+if eval "test \"`echo '$''{'ac_cv_func_remove'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-/* Define remove to an innocuous variant, in case <limits.h> declares remove.
-   For example, HP-UX 11i <limits.h> declares gettimeofday.  */
-#define remove innocuous_remove
-
+  cat > conftest.$ac_ext <<EOF
+#line 3487 "configure"
+#include "confdefs.h"
 /* System header to define __stub macros and hopefully few prototypes,
-    which can conflict with char remove (); below.
-    Prefer <limits.h> to <assert.h> if __STDC__ is defined, since
-    <limits.h> exists even on freestanding compilers.  */
-
-#ifdef __STDC__
-# include <limits.h>
-#else
-# include <assert.h>
-#endif
-
-#undef remove
-
+    which can conflict with char remove(); below.  */
+#include <assert.h>
 /* Override any gcc2 internal prototype to avoid an error.  */
-#ifdef __cplusplus
-extern "C"
-{
-#endif
 /* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
-char remove ();
+    builtin and then its argument prototype would still apply.  */
+char remove();
+
+int main() {
+
 /* The GNU C library defines this for functions which it implements
     to always fail with ENOSYS.  Some functions are actually named
     something starting with __ and the normal name is an alias.  */
 #if defined (__stub_remove) || defined (__stub___remove)
 choke me
 #else
-char (*f) () = remove;
+remove();
 #endif
-#ifdef __cplusplus
-}
-#endif
 
-int
-main ()
-{
-return f != remove;
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_cv_func_remove=yes
+; return 0; }
+EOF
+if { (eval echo configure:3510: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  eval "ac_cv_func_remove=yes"
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-ac_cv_func_remove=no
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_func_remove=no"
 fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
+rm -f conftest*
 fi
-echo "$as_me:$LINENO: result: $ac_cv_func_remove" >&5
-echo "${ECHO_T}$ac_cv_func_remove" >&6
 
+if eval "test \"`echo '$ac_cv_func_'remove`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
+  :
+else
+  echo "$ac_t""no" 1>&6
+fi
+
     if test $ac_cv_func_remove = no; then
-      echo "$as_me:$LINENO: checking for remove in -lposix" >&5
-echo $ECHO_N "checking for remove in -lposix... $ECHO_C" >&6
-if test "${ac_cv_lib_posix_remove+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+      echo $ac_n "checking for remove in -lposix""... $ac_c" 1>&6
+echo "configure:3531: checking for remove in -lposix" >&5
+ac_lib_var=`echo posix'_'remove | sed 'y%./+-%__p_%'`
+if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-  ac_check_lib_save_LIBS=$LIBS
+  ac_save_LIBS="$LIBS"
 LIBS="-lposix  $LIBS"
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
+cat > conftest.$ac_ext <<EOF
+#line 3539 "configure"
+#include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
-#ifdef __cplusplus
-extern "C"
-#endif
 /* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
-char remove ();
-int
-main ()
-{
-remove ();
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_cv_lib_posix_remove=yes
+    builtin and then its argument prototype would still apply.  */
+char remove();
+
+int main() {
+remove()
+; return 0; }
+EOF
+if { (eval echo configure:3550: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=yes"
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=no"
+fi
+rm -f conftest*
+LIBS="$ac_save_LIBS"
 
-ac_cv_lib_posix_remove=no
 fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
-fi
-echo "$as_me:$LINENO: result: $ac_cv_lib_posix_remove" >&5
-echo "${ECHO_T}$ac_cv_lib_posix_remove" >&6
-if test $ac_cv_lib_posix_remove = yes; then
+if eval "test \"`echo '$ac_cv_lib_'$ac_lib_var`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
   X_EXTRA_LIBS="$X_EXTRA_LIBS -lposix"
+else
+  echo "$ac_t""no" 1>&6
 fi
 
     fi
 
     # BSDI BSD/OS 2.1 needs -lipc for XOpenDisplay.
-    echo "$as_me:$LINENO: checking for shmat" >&5
-echo $ECHO_N "checking for shmat... $ECHO_C" >&6
-if test "${ac_cv_func_shmat+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+    echo $ac_n "checking for shmat""... $ac_c" 1>&6
+echo "configure:3574: checking for shmat" >&5
+if eval "test \"`echo '$''{'ac_cv_func_shmat'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-/* Define shmat to an innocuous variant, in case <limits.h> declares shmat.
-   For example, HP-UX 11i <limits.h> declares gettimeofday.  */
-#define shmat innocuous_shmat
-
+  cat > conftest.$ac_ext <<EOF
+#line 3579 "configure"
+#include "confdefs.h"
 /* System header to define __stub macros and hopefully few prototypes,
-    which can conflict with char shmat (); below.
-    Prefer <limits.h> to <assert.h> if __STDC__ is defined, since
-    <limits.h> exists even on freestanding compilers.  */
-
-#ifdef __STDC__
-# include <limits.h>
-#else
-# include <assert.h>
-#endif
-
-#undef shmat
-
+    which can conflict with char shmat(); below.  */
+#include <assert.h>
 /* Override any gcc2 internal prototype to avoid an error.  */
-#ifdef __cplusplus
-extern "C"
-{
-#endif
 /* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
-char shmat ();
+    builtin and then its argument prototype would still apply.  */
+char shmat();
+
+int main() {
+
 /* The GNU C library defines this for functions which it implements
     to always fail with ENOSYS.  Some functions are actually named
     something starting with __ and the normal name is an alias.  */
 #if defined (__stub_shmat) || defined (__stub___shmat)
 choke me
 #else
-char (*f) () = shmat;
+shmat();
 #endif
-#ifdef __cplusplus
-}
-#endif
 
-int
-main ()
-{
-return f != shmat;
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_cv_func_shmat=yes
+; return 0; }
+EOF
+if { (eval echo configure:3602: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  eval "ac_cv_func_shmat=yes"
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-ac_cv_func_shmat=no
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_func_shmat=no"
 fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
+rm -f conftest*
 fi
-echo "$as_me:$LINENO: result: $ac_cv_func_shmat" >&5
-echo "${ECHO_T}$ac_cv_func_shmat" >&6
 
+if eval "test \"`echo '$ac_cv_func_'shmat`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
+  :
+else
+  echo "$ac_t""no" 1>&6
+fi
+
     if test $ac_cv_func_shmat = no; then
-      echo "$as_me:$LINENO: checking for shmat in -lipc" >&5
-echo $ECHO_N "checking for shmat in -lipc... $ECHO_C" >&6
-if test "${ac_cv_lib_ipc_shmat+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+      echo $ac_n "checking for shmat in -lipc""... $ac_c" 1>&6
+echo "configure:3623: checking for shmat in -lipc" >&5
+ac_lib_var=`echo ipc'_'shmat | sed 'y%./+-%__p_%'`
+if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-  ac_check_lib_save_LIBS=$LIBS
+  ac_save_LIBS="$LIBS"
 LIBS="-lipc  $LIBS"
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
+cat > conftest.$ac_ext <<EOF
+#line 3631 "configure"
+#include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
-#ifdef __cplusplus
-extern "C"
-#endif
 /* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
-char shmat ();
-int
-main ()
-{
-shmat ();
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_cv_lib_ipc_shmat=yes
+    builtin and then its argument prototype would still apply.  */
+char shmat();
+
+int main() {
+shmat()
+; return 0; }
+EOF
+if { (eval echo configure:3642: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=yes"
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=no"
+fi
+rm -f conftest*
+LIBS="$ac_save_LIBS"
 
-ac_cv_lib_ipc_shmat=no
 fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
-fi
-echo "$as_me:$LINENO: result: $ac_cv_lib_ipc_shmat" >&5
-echo "${ECHO_T}$ac_cv_lib_ipc_shmat" >&6
-if test $ac_cv_lib_ipc_shmat = yes; then
+if eval "test \"`echo '$ac_cv_lib_'$ac_lib_var`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
   X_EXTRA_LIBS="$X_EXTRA_LIBS -lipc"
+else
+  echo "$ac_t""no" 1>&6
 fi
 
     fi
   fi
 
   # Check for libraries that X11R6 Xt/Xaw programs need.
-  ac_save_LDFLAGS=$LDFLAGS
+  ac_save_LDFLAGS="$LDFLAGS"
   test -n "$x_libraries" && LDFLAGS="$LDFLAGS -L$x_libraries"
   # SM needs ICE to (dynamically) link under SunOS 4.x (so we have to
   # check for ICE first), but we must link in the order -lSM -lICE or
   # we get undefined symbols.  So assume we have SM if we have ICE.
   # These have to be linked with before -lX11, unlike the other
   # libraries we check for below, so use a different variable.
-  # John Interrante, Karl Berry
-  echo "$as_me:$LINENO: checking for IceConnectionNumber in -lICE" >&5
-echo $ECHO_N "checking for IceConnectionNumber in -lICE... $ECHO_C" >&6
-if test "${ac_cv_lib_ICE_IceConnectionNumber+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+  #  --interran@uluru.Stanford.EDU, kb@cs.umb.edu.
+  echo $ac_n "checking for IceConnectionNumber in -lICE""... $ac_c" 1>&6
+echo "configure:3675: checking for IceConnectionNumber in -lICE" >&5
+ac_lib_var=`echo ICE'_'IceConnectionNumber | sed 'y%./+-%__p_%'`
+if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-  ac_check_lib_save_LIBS=$LIBS
+  ac_save_LIBS="$LIBS"
 LIBS="-lICE $X_EXTRA_LIBS $LIBS"
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
+cat > conftest.$ac_ext <<EOF
+#line 3683 "configure"
+#include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
-#ifdef __cplusplus
-extern "C"
-#endif
 /* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
-char IceConnectionNumber ();
-int
-main ()
-{
-IceConnectionNumber ();
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_cv_lib_ICE_IceConnectionNumber=yes
+    builtin and then its argument prototype would still apply.  */
+char IceConnectionNumber();
+
+int main() {
+IceConnectionNumber()
+; return 0; }
+EOF
+if { (eval echo configure:3694: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=yes"
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=no"
+fi
+rm -f conftest*
+LIBS="$ac_save_LIBS"
 
-ac_cv_lib_ICE_IceConnectionNumber=no
 fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
-fi
-echo "$as_me:$LINENO: result: $ac_cv_lib_ICE_IceConnectionNumber" >&5
-echo "${ECHO_T}$ac_cv_lib_ICE_IceConnectionNumber" >&6
-if test $ac_cv_lib_ICE_IceConnectionNumber = yes; then
+if eval "test \"`echo '$ac_cv_lib_'$ac_lib_var`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
   X_PRE_LIBS="$X_PRE_LIBS -lSM -lICE"
+else
+  echo "$ac_t""no" 1>&6
 fi
 
-  LDFLAGS=$ac_save_LDFLAGS
+  LDFLAGS="$ac_save_LDFLAGS"
 
 fi
 
@@ -6620,11 +3721,10 @@
     X_EXTRA_LIBS="$X_EXTRA_LIBS -lSM -lICE -lXmu"
   fi
 
-
+    
   if test -d "$x_includes" && test ! -d "$x_libraries"; then
     x_libraries=`echo "$x_includes" | sed s/include/lib/`
-    echo "$as_me:$LINENO: result: Corrected X libraries to $x_libraries" >&5
-echo "${ECHO_T}Corrected X libraries to $x_libraries" >&6
+    echo "$ac_t""Corrected X libraries to $x_libraries" 1>&6
     X_LIBS="$X_LIBS -L$x_libraries"
     if test "`(uname) 2>/dev/null`" = SunOS &&
 					 uname -r | grep '^5' >/dev/null; then
@@ -6634,8 +3734,7 @@
 
   if test -d "$x_libraries" && test ! -d "$x_includes"; then
     x_includes=`echo "$x_libraries" | sed s/lib/include/`
-    echo "$as_me:$LINENO: result: Corrected X includes to $x_includes" >&5
-echo "${ECHO_T}Corrected X includes to $x_includes" >&6
+    echo "$ac_t""Corrected X includes to $x_includes" 1>&6
     X_CFLAGS="$X_CFLAGS -I$x_includes"
   fi
 
@@ -6644,379 +3743,209 @@
     X_LIBS="`echo $X_LIBS\  | sed -e 's%-R/usr/lib %%' -e 's%-R /usr/lib %%'`"
 
 
-      echo "$as_me:$LINENO: checking if X11 header files can be found" >&5
-echo $ECHO_N "checking if X11 header files can be found... $ECHO_C" >&6
+      echo $ac_n "checking if X11 header files can be found""... $ac_c" 1>&6
+echo "configure:3748: checking if X11 header files can be found" >&5
   cflags_save=$CFLAGS
   CFLAGS="$CFLAGS $X_CFLAGS"
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+  cat > conftest.$ac_ext <<EOF
+#line 3752 "configure"
+#include "confdefs.h"
 #include <X11/Xlib.h>
-int
-main ()
-{
+int main() {
 
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6
+; return 0; }
+EOF
+if { (eval echo configure:3759: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+  rm -rf conftest*
+  echo "$ac_t""yes" 1>&6
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; no_x=yes
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  echo "$ac_t""no" 1>&6; no_x=yes
 fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
+rm -f conftest*
   CFLAGS=$cflags_save
 
   if test "${no_x-no}" = yes; then
     with_x=no
   else
-    cat >>confdefs.h <<\_ACEOF
+    cat >> confdefs.h <<\EOF
 #define HAVE_X11 1
-_ACEOF
+EOF
 
     X_LIB="-lXt -lX11";
+    
 
-
     ac_save_LDFLAGS="$LDFLAGS"
     LDFLAGS="-L$x_libraries $LDFLAGS"
 
-            echo "$as_me:$LINENO: checking for _XdmcpAuthDoIt in -lXdmcp" >&5
-echo $ECHO_N "checking for _XdmcpAuthDoIt in -lXdmcp... $ECHO_C" >&6
-if test "${ac_cv_lib_Xdmcp__XdmcpAuthDoIt+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+            echo $ac_n "checking for _XdmcpAuthDoIt in -lXdmcp""... $ac_c" 1>&6
+echo "configure:3785: checking for _XdmcpAuthDoIt in -lXdmcp" >&5
+ac_lib_var=`echo Xdmcp'_'_XdmcpAuthDoIt | sed 'y%./+-%__p_%'`
+if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-  ac_check_lib_save_LIBS=$LIBS
+  ac_save_LIBS="$LIBS"
 LIBS="-lXdmcp -lXt $X_PRE_LIBS -lX11 $X_EXTRA_LIBS -lXdmcp $LIBS"
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
+cat > conftest.$ac_ext <<EOF
+#line 3793 "configure"
+#include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
-#ifdef __cplusplus
-extern "C"
-#endif
 /* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
-char _XdmcpAuthDoIt ();
-int
-main ()
-{
-_XdmcpAuthDoIt ();
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_cv_lib_Xdmcp__XdmcpAuthDoIt=yes
+    builtin and then its argument prototype would still apply.  */
+char _XdmcpAuthDoIt();
+
+int main() {
+_XdmcpAuthDoIt()
+; return 0; }
+EOF
+if { (eval echo configure:3804: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=yes"
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=no"
+fi
+rm -f conftest*
+LIBS="$ac_save_LIBS"
 
-ac_cv_lib_Xdmcp__XdmcpAuthDoIt=no
 fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
-fi
-echo "$as_me:$LINENO: result: $ac_cv_lib_Xdmcp__XdmcpAuthDoIt" >&5
-echo "${ECHO_T}$ac_cv_lib_Xdmcp__XdmcpAuthDoIt" >&6
-if test $ac_cv_lib_Xdmcp__XdmcpAuthDoIt = yes; then
+if eval "test \"`echo '$ac_cv_lib_'$ac_lib_var`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
   X_EXTRA_LIBS="$X_EXTRA_LIBS -lXdmcp"
+else
+  echo "$ac_t""no" 1>&6
 fi
 
 
-                    echo "$as_me:$LINENO: checking for IceOpenConnection in -lICE" >&5
-echo $ECHO_N "checking for IceOpenConnection in -lICE... $ECHO_C" >&6
-if test "${ac_cv_lib_ICE_IceOpenConnection+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+                    echo $ac_n "checking for IceOpenConnection in -lICE""... $ac_c" 1>&6
+echo "configure:3826: checking for IceOpenConnection in -lICE" >&5
+ac_lib_var=`echo ICE'_'IceOpenConnection | sed 'y%./+-%__p_%'`
+if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-  ac_check_lib_save_LIBS=$LIBS
+  ac_save_LIBS="$LIBS"
 LIBS="-lICE $X_EXTRA_LIBS $LIBS"
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
+cat > conftest.$ac_ext <<EOF
+#line 3834 "configure"
+#include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
-#ifdef __cplusplus
-extern "C"
-#endif
 /* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
-char IceOpenConnection ();
-int
-main ()
-{
-IceOpenConnection ();
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_cv_lib_ICE_IceOpenConnection=yes
+    builtin and then its argument prototype would still apply.  */
+char IceOpenConnection();
+
+int main() {
+IceOpenConnection()
+; return 0; }
+EOF
+if { (eval echo configure:3845: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=yes"
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=no"
+fi
+rm -f conftest*
+LIBS="$ac_save_LIBS"
 
-ac_cv_lib_ICE_IceOpenConnection=no
 fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
-fi
-echo "$as_me:$LINENO: result: $ac_cv_lib_ICE_IceOpenConnection" >&5
-echo "${ECHO_T}$ac_cv_lib_ICE_IceOpenConnection" >&6
-if test $ac_cv_lib_ICE_IceOpenConnection = yes; then
+if eval "test \"`echo '$ac_cv_lib_'$ac_lib_var`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
   X_EXTRA_LIBS="$X_EXTRA_LIBS -lSM -lICE"
+else
+  echo "$ac_t""no" 1>&6
 fi
 
 
         LDFLAGS="$X_LIBS $ac_save_LDFLAGS"
-    echo "$as_me:$LINENO: checking for XpmCreatePixmapFromData in -lXpm" >&5
-echo $ECHO_N "checking for XpmCreatePixmapFromData in -lXpm... $ECHO_C" >&6
-if test "${ac_cv_lib_Xpm_XpmCreatePixmapFromData+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+    echo $ac_n "checking for XpmCreatePixmapFromData in -lXpm""... $ac_c" 1>&6
+echo "configure:3868: checking for XpmCreatePixmapFromData in -lXpm" >&5
+ac_lib_var=`echo Xpm'_'XpmCreatePixmapFromData | sed 'y%./+-%__p_%'`
+if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-  ac_check_lib_save_LIBS=$LIBS
+  ac_save_LIBS="$LIBS"
 LIBS="-lXpm -lXt $X_PRE_LIBS -lXpm -lX11 $X_EXTRA_LIBS $LIBS"
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
+cat > conftest.$ac_ext <<EOF
+#line 3876 "configure"
+#include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
-#ifdef __cplusplus
-extern "C"
-#endif
 /* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
-char XpmCreatePixmapFromData ();
-int
-main ()
-{
-XpmCreatePixmapFromData ();
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_cv_lib_Xpm_XpmCreatePixmapFromData=yes
+    builtin and then its argument prototype would still apply.  */
+char XpmCreatePixmapFromData();
+
+int main() {
+XpmCreatePixmapFromData()
+; return 0; }
+EOF
+if { (eval echo configure:3887: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=yes"
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=no"
+fi
+rm -f conftest*
+LIBS="$ac_save_LIBS"
 
-ac_cv_lib_Xpm_XpmCreatePixmapFromData=no
 fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
-fi
-echo "$as_me:$LINENO: result: $ac_cv_lib_Xpm_XpmCreatePixmapFromData" >&5
-echo "${ECHO_T}$ac_cv_lib_Xpm_XpmCreatePixmapFromData" >&6
-if test $ac_cv_lib_Xpm_XpmCreatePixmapFromData = yes; then
+if eval "test \"`echo '$ac_cv_lib_'$ac_lib_var`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
   X_PRE_LIBS="$X_PRE_LIBS -lXpm"
+else
+  echo "$ac_t""no" 1>&6
 fi
 
 
-        echo "$as_me:$LINENO: checking if X11 header files implicitly declare return values" >&5
-echo $ECHO_N "checking if X11 header files implicitly declare return values... $ECHO_C" >&6
+        echo $ac_n "checking if X11 header files implicitly declare return values""... $ac_c" 1>&6
+echo "configure:3909: checking if X11 header files implicitly declare return values" >&5
     cflags_save=$CFLAGS
     CFLAGS="$CFLAGS $X_CFLAGS -Werror"
-    cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+    cat > conftest.$ac_ext <<EOF
+#line 3913 "configure"
+#include "confdefs.h"
 #include <X11/Xlib.h>
-int
-main ()
-{
+int main() {
 
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
+; return 0; }
+EOF
+if { (eval echo configure:3920: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+  rm -rf conftest*
+  echo "$ac_t""no" 1>&6
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-CFLAGS="$CFLAGS -Wno-implicit-int"
-	cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  CFLAGS="$CFLAGS -Wno-implicit-int"
+	cat > conftest.$ac_ext <<EOF
+#line 3929 "configure"
+#include "confdefs.h"
 #include <X11/Xlib.h>
-int
-main ()
-{
+int main() {
 
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6; cflags_save="$cflags_save -Wno-implicit-int"
+; return 0; }
+EOF
+if { (eval echo configure:3936: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+  rm -rf conftest*
+  echo "$ac_t""yes" 1>&6; cflags_save="$cflags_save -Wno-implicit-int"
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-echo "$as_me:$LINENO: result: test failed" >&5
-echo "${ECHO_T}test failed" >&6
-
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  echo "$ac_t""test failed" 1>&6
+	
 fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
-
+rm -f conftest*
+    
 fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
+rm -f conftest*
     CFLAGS=$cflags_save
 
     LDFLAGS="$ac_save_LDFLAGS"
@@ -7026,16 +3955,17 @@
 
 test "x$with_x" = xno -a "x$MACOSX" != "xyes" -a "x$QNX" != "xyes" && enable_gui=no
 
-echo "$as_me:$LINENO: checking --enable-gui argument" >&5
-echo $ECHO_N "checking --enable-gui argument... $ECHO_C" >&6
+echo $ac_n "checking --enable-gui argument""... $ac_c" 1>&6
+echo "configure:3960: checking --enable-gui argument" >&5
 # Check whether --enable-gui or --disable-gui was given.
 if test "${enable_gui+set}" = set; then
   enableval="$enable_gui"
-
+  :
 else
   enable_gui="auto"
-fi;
+fi
 
+
 enable_gui_canon=`echo "_$enable_gui" | \
 	sed 's/[ _+-]//g;y/ABCDEFGHIJKLMNOPQRSTUVWXYZ/abcdefghijklmnopqrstuvwxyz/'`
 
@@ -7052,44 +3982,32 @@
 if test "x$QNX" = "xyes" -a "x$with_x" = "xno" ; then
   SKIP_PHOTON=
   case "$enable_gui_canon" in
-    no)		echo "$as_me:$LINENO: result: no GUI support" >&5
-echo "${ECHO_T}no GUI support" >&6
+    no)		echo "$ac_t""no GUI support" 1>&6
 		SKIP_PHOTON=YES ;;
-    yes|"")	echo "$as_me:$LINENO: result: yes - automatic GUI support" >&5
-echo "${ECHO_T}yes - automatic GUI support" >&6 ;;
-    auto)	echo "$as_me:$LINENO: result: auto - automatic GUI support" >&5
-echo "${ECHO_T}auto - automatic GUI support" >&6 ;;
-    photon)	echo "$as_me:$LINENO: result: Photon GUI support" >&5
-echo "${ECHO_T}Photon GUI support" >&6 ;;
-    *)		echo "$as_me:$LINENO: result: Sorry, $enable_gui GUI is not supported" >&5
-echo "${ECHO_T}Sorry, $enable_gui GUI is not supported" >&6
+    yes|"")	echo "$ac_t""yes - automatic GUI support" 1>&6 ;;
+    auto)	echo "$ac_t""auto - automatic GUI support" 1>&6 ;;
+    photon)	echo "$ac_t""Photon GUI support" 1>&6 ;;
+    *)		echo "$ac_t""Sorry, $enable_gui GUI is not supported" 1>&6
 		SKIP_PHOTON=YES ;;
   esac
 
 elif test "x$MACOSX" = "xyes" -a "x$with_x" = "xno" ; then
   SKIP_CARBON=
   case "$enable_gui_canon" in
-    no)		echo "$as_me:$LINENO: result: no GUI support" >&5
-echo "${ECHO_T}no GUI support" >&6
+    no)		echo "$ac_t""no GUI support" 1>&6
 		SKIP_CARBON=YES ;;
-    yes|"")	echo "$as_me:$LINENO: result: yes - automatic GUI support" >&5
-echo "${ECHO_T}yes - automatic GUI support" >&6 ;;
-    auto)	echo "$as_me:$LINENO: result: auto - automatic GUI support" >&5
-echo "${ECHO_T}auto - automatic GUI support" >&6 ;;
-    carbon)	echo "$as_me:$LINENO: result: Carbon GUI support" >&5
-echo "${ECHO_T}Carbon GUI support" >&6 ;;
-    *)		echo "$as_me:$LINENO: result: Sorry, $enable_gui GUI is not supported" >&5
-echo "${ECHO_T}Sorry, $enable_gui GUI is not supported" >&6
+    yes|"")	echo "$ac_t""yes - automatic GUI support" 1>&6 ;;
+    auto)	echo "$ac_t""auto - automatic GUI support" 1>&6 ;;
+    carbon)	echo "$ac_t""Carbon GUI support" 1>&6 ;;
+    *)		echo "$ac_t""Sorry, $enable_gui GUI is not supported" 1>&6
 		SKIP_CARBON=YES ;;
   esac
 
 else
 
   case "$enable_gui_canon" in
-    no|none)	echo "$as_me:$LINENO: result: no GUI support" >&5
-echo "${ECHO_T}no GUI support" >&6 ;;
-    yes|""|auto)	echo "$as_me:$LINENO: result: yes/auto - automatic GUI support" >&5
-echo "${ECHO_T}yes/auto - automatic GUI support" >&6
+    no|none)	echo "$ac_t""no GUI support" 1>&6 ;;
+    yes|""|auto)	echo "$ac_t""yes/auto - automatic GUI support" 1>&6
 		SKIP_GTK=
 		SKIP_GTK2=
 		SKIP_GNOME=
@@ -7097,49 +4015,41 @@
 		SKIP_ATHENA=
 		SKIP_NEXTAW=
 		SKIP_CARBON=;;
-    gtk)	echo "$as_me:$LINENO: result: GTK+ 1.x GUI support" >&5
-echo "${ECHO_T}GTK+ 1.x GUI support" >&6
+    gtk)	echo "$ac_t""GTK+ 1.x GUI support" 1>&6
 		SKIP_GTK=;;
-    gtk2)	echo "$as_me:$LINENO: result: GTK+ 2.x GUI support" >&5
-echo "${ECHO_T}GTK+ 2.x GUI support" >&6
+    gtk2)	echo "$ac_t""GTK+ 2.x GUI support" 1>&6
 		SKIP_GTK=
 		SKIP_GTK2=;;
-    gnome)	echo "$as_me:$LINENO: result: GNOME 1.x GUI support" >&5
-echo "${ECHO_T}GNOME 1.x GUI support" >&6
+    gnome)	echo "$ac_t""GNOME 1.x GUI support" 1>&6
 		SKIP_GNOME=
 		SKIP_GTK=;;
-    gnome2)	echo "$as_me:$LINENO: result: GNOME 2.x GUI support" >&5
-echo "${ECHO_T}GNOME 2.x GUI support" >&6
+    gnome2)	echo "$ac_t""GNOME 2.x GUI support" 1>&6
 		SKIP_GNOME=
 		SKIP_GTK=
 		SKIP_GTK2=;;
-    motif)	echo "$as_me:$LINENO: result: Motif GUI support" >&5
-echo "${ECHO_T}Motif GUI support" >&6
+    motif)	echo "$ac_t""Motif GUI support" 1>&6
 		SKIP_MOTIF=;;
-    athena)	echo "$as_me:$LINENO: result: Athena GUI support" >&5
-echo "${ECHO_T}Athena GUI support" >&6
+    athena)	echo "$ac_t""Athena GUI support" 1>&6
 		SKIP_ATHENA=;;
-    nextaw)	echo "$as_me:$LINENO: result: neXtaw GUI support" >&5
-echo "${ECHO_T}neXtaw GUI support" >&6
+    nextaw)	echo "$ac_t""neXtaw GUI support" 1>&6
 		SKIP_NEXTAW=;;
-    *)		echo "$as_me:$LINENO: result: Sorry, $enable_gui GUI is not supported" >&5
-echo "${ECHO_T}Sorry, $enable_gui GUI is not supported" >&6 ;;
+    *)		echo "$ac_t""Sorry, $enable_gui GUI is not supported" 1>&6 ;;
   esac
 
 fi
 
 if test "x$SKIP_GTK" != "xYES" -a "$enable_gui_canon" != "gtk" -a "$enable_gui_canon" != "gtk2"; then
-  echo "$as_me:$LINENO: checking whether or not to look for GTK" >&5
-echo $ECHO_N "checking whether or not to look for GTK... $ECHO_C" >&6
+  echo $ac_n "checking whether or not to look for GTK""... $ac_c" 1>&6
+echo "configure:4044: checking whether or not to look for GTK" >&5
   # Check whether --enable-gtk-check or --disable-gtk-check was given.
 if test "${enable_gtk_check+set}" = set; then
   enableval="$enable_gtk_check"
-
+  :
 else
   enable_gtk_check="yes"
-fi;
-  echo "$as_me:$LINENO: result: $enable_gtk_check" >&5
-echo "${ECHO_T}$enable_gtk_check" >&6
+fi
+
+  echo "$ac_t""$enable_gtk_check" 1>&6
   if test "x$enable_gtk_check" = "xno"; then
     SKIP_GTK=YES
     SKIP_GNOME=YES
@@ -7148,17 +4058,17 @@
 
 if test "x$SKIP_GTK2" != "xYES" -a "$enable_gui_canon" != "gtk2" \
 				-a "$enable_gui_canon" != "gnome2"; then
-  echo "$as_me:$LINENO: checking whether or not to look for GTK+ 2" >&5
-echo $ECHO_N "checking whether or not to look for GTK+ 2... $ECHO_C" >&6
+  echo $ac_n "checking whether or not to look for GTK+ 2""... $ac_c" 1>&6
+echo "configure:4063: checking whether or not to look for GTK+ 2" >&5
   # Check whether --enable-gtk2-check or --disable-gtk2-check was given.
 if test "${enable_gtk2_check+set}" = set; then
   enableval="$enable_gtk2_check"
-
+  :
 else
   enable_gtk2_check="yes"
-fi;
-  echo "$as_me:$LINENO: result: $enable_gtk2_check" >&5
-echo "${ECHO_T}$enable_gtk2_check" >&6
+fi
+
+  echo "$ac_t""$enable_gtk2_check" 1>&6
   if test "x$enable_gtk2_check" = "xno"; then
     SKIP_GTK2=YES
   fi
@@ -7166,85 +4076,85 @@
 
 if test "x$SKIP_GNOME" != "xYES" -a "$enable_gui_canon" != "gnome" \
 				 -a "$enable_gui_canon" != "gnome2"; then
-  echo "$as_me:$LINENO: checking whether or not to look for GNOME" >&5
-echo $ECHO_N "checking whether or not to look for GNOME... $ECHO_C" >&6
+  echo $ac_n "checking whether or not to look for GNOME""... $ac_c" 1>&6
+echo "configure:4081: checking whether or not to look for GNOME" >&5
   # Check whether --enable-gnome-check or --disable-gnome-check was given.
 if test "${enable_gnome_check+set}" = set; then
   enableval="$enable_gnome_check"
-
+  :
 else
   enable_gnome_check="no"
-fi;
-  echo "$as_me:$LINENO: result: $enable_gnome_check" >&5
-echo "${ECHO_T}$enable_gnome_check" >&6
+fi
+
+  echo "$ac_t""$enable_gnome_check" 1>&6
   if test "x$enable_gnome_check" = "xno"; then
     SKIP_GNOME=YES
   fi
 fi
 
 if test "x$SKIP_MOTIF" != "xYES" -a "$enable_gui_canon" != "motif"; then
-  echo "$as_me:$LINENO: checking whether or not to look for Motif" >&5
-echo $ECHO_N "checking whether or not to look for Motif... $ECHO_C" >&6
+  echo $ac_n "checking whether or not to look for Motif""... $ac_c" 1>&6
+echo "configure:4098: checking whether or not to look for Motif" >&5
   # Check whether --enable-motif-check or --disable-motif-check was given.
 if test "${enable_motif_check+set}" = set; then
   enableval="$enable_motif_check"
-
+  :
 else
   enable_motif_check="yes"
-fi;
-  echo "$as_me:$LINENO: result: $enable_motif_check" >&5
-echo "${ECHO_T}$enable_motif_check" >&6
+fi
+
+  echo "$ac_t""$enable_motif_check" 1>&6
   if test "x$enable_motif_check" = "xno"; then
     SKIP_MOTIF=YES
   fi
 fi
 
 if test "x$SKIP_ATHENA" != "xYES" -a "$enable_gui_canon" != "athena"; then
-  echo "$as_me:$LINENO: checking whether or not to look for Athena" >&5
-echo $ECHO_N "checking whether or not to look for Athena... $ECHO_C" >&6
+  echo $ac_n "checking whether or not to look for Athena""... $ac_c" 1>&6
+echo "configure:4115: checking whether or not to look for Athena" >&5
   # Check whether --enable-athena-check or --disable-athena-check was given.
 if test "${enable_athena_check+set}" = set; then
   enableval="$enable_athena_check"
-
+  :
 else
   enable_athena_check="yes"
-fi;
-  echo "$as_me:$LINENO: result: $enable_athena_check" >&5
-echo "${ECHO_T}$enable_athena_check" >&6
+fi
+
+  echo "$ac_t""$enable_athena_check" 1>&6
   if test "x$enable_athena_check" = "xno"; then
     SKIP_ATHENA=YES
   fi
 fi
 
 if test "x$SKIP_NEXTAW" != "xYES" -a "$enable_gui_canon" != "nextaw"; then
-  echo "$as_me:$LINENO: checking whether or not to look for neXtaw" >&5
-echo $ECHO_N "checking whether or not to look for neXtaw... $ECHO_C" >&6
+  echo $ac_n "checking whether or not to look for neXtaw""... $ac_c" 1>&6
+echo "configure:4132: checking whether or not to look for neXtaw" >&5
   # Check whether --enable-nextaw-check or --disable-nextaw-check was given.
 if test "${enable_nextaw_check+set}" = set; then
   enableval="$enable_nextaw_check"
-
+  :
 else
   enable_nextaw_check="yes"
-fi;
-  echo "$as_me:$LINENO: result: $enable_nextaw_check" >&5
-echo "${ECHO_T}$enable_nextaw_check" >&6;
+fi
+
+  echo "$ac_t""$enable_nextaw_check" 1>&6;
   if test "x$enable_nextaw_check" = "xno"; then
     SKIP_NEXTAW=YES
   fi
 fi
 
 if test "x$SKIP_CARBON" != "xYES" -a "$enable_gui_canon" != "carbon"; then
-  echo "$as_me:$LINENO: checking whether or not to look for Carbon" >&5
-echo $ECHO_N "checking whether or not to look for Carbon... $ECHO_C" >&6
+  echo $ac_n "checking whether or not to look for Carbon""... $ac_c" 1>&6
+echo "configure:4149: checking whether or not to look for Carbon" >&5
   # Check whether --enable-carbon-check or --disable-carbon-check was given.
 if test "${enable_carbon_check+set}" = set; then
   enableval="$enable_carbon_check"
-
+  :
 else
   enable_carbon_check="yes"
-fi;
-  echo "$as_me:$LINENO: result: $enable_carbon_check" >&5
-echo "${ECHO_T}$enable_carbon_check" >&6;
+fi
+
+  echo "$ac_t""$enable_carbon_check" 1>&6;
   if test "x$enable_carbon_check" = "xno"; then
     SKIP_CARBON=YES
   fi
@@ -7252,10 +4162,9 @@
 
 
 if test "x$MACOSX" = "xyes" -a -z "$SKIP_CARBON" -a "x$CARBON" = "xyes"; then
-  echo "$as_me:$LINENO: checking for Carbon GUI" >&5
-echo $ECHO_N "checking for Carbon GUI... $ECHO_C" >&6
-    echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6;
+  echo $ac_n "checking for Carbon GUI""... $ac_c" 1>&6
+echo "configure:4167: checking for Carbon GUI" >&5
+    echo "$ac_t""yes" 1>&6;
   GUITYPE=CARBONGUI
   if test "$VIMNAME" = "vim"; then
     VIMNAME=Vim
@@ -7287,47 +4196,42 @@
 
 if test -z "$SKIP_GTK"; then
 
-  echo "$as_me:$LINENO: checking --with-gtk-prefix argument" >&5
-echo $ECHO_N "checking --with-gtk-prefix argument... $ECHO_C" >&6
-
-# Check whether --with-gtk-prefix or --without-gtk-prefix was given.
+  echo $ac_n "checking --with-gtk-prefix argument""... $ac_c" 1>&6
+echo "configure:4201: checking --with-gtk-prefix argument" >&5
+  # Check whether --with-gtk-prefix or --without-gtk-prefix was given.
 if test "${with_gtk_prefix+set}" = set; then
   withval="$with_gtk_prefix"
-  gtk_config_prefix="$withval"; echo "$as_me:$LINENO: result: $gtk_config_prefix" >&5
-echo "${ECHO_T}$gtk_config_prefix" >&6
+  gtk_config_prefix="$withval"; echo "$ac_t""$gtk_config_prefix" 1>&6
 else
-  gtk_config_prefix=""; echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
-fi;
+  gtk_config_prefix=""; echo "$ac_t""no" 1>&6
+fi
 
-  echo "$as_me:$LINENO: checking --with-gtk-exec-prefix argument" >&5
-echo $ECHO_N "checking --with-gtk-exec-prefix argument... $ECHO_C" >&6
 
-# Check whether --with-gtk-exec-prefix or --without-gtk-exec-prefix was given.
+  echo $ac_n "checking --with-gtk-exec-prefix argument""... $ac_c" 1>&6
+echo "configure:4212: checking --with-gtk-exec-prefix argument" >&5
+  # Check whether --with-gtk-exec-prefix or --without-gtk-exec-prefix was given.
 if test "${with_gtk_exec_prefix+set}" = set; then
   withval="$with_gtk_exec_prefix"
-  gtk_config_exec_prefix="$withval"; echo "$as_me:$LINENO: result: $gtk_config_prefix" >&5
-echo "${ECHO_T}$gtk_config_prefix" >&6
+  gtk_config_exec_prefix="$withval"; echo "$ac_t""$gtk_config_prefix" 1>&6
 else
-  gtk_config_exec_prefix=""; echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
-fi;
+  gtk_config_exec_prefix=""; echo "$ac_t""no" 1>&6
+fi
 
-  echo "$as_me:$LINENO: checking --disable-gtktest argument" >&5
-echo $ECHO_N "checking --disable-gtktest argument... $ECHO_C" >&6
+
+  echo $ac_n "checking --disable-gtktest argument""... $ac_c" 1>&6
+echo "configure:4223: checking --disable-gtktest argument" >&5
   # Check whether --enable-gtktest or --disable-gtktest was given.
 if test "${enable_gtktest+set}" = set; then
   enableval="$enable_gtktest"
-
+  :
 else
   enable_gtktest=yes
-fi;
+fi
+
   if test "x$enable_gtktest" = "xyes" ; then
-    echo "$as_me:$LINENO: result: gtk test enabled" >&5
-echo "${ECHO_T}gtk test enabled" >&6
+    echo "$ac_t""gtk test enabled" 1>&6
   else
-    echo "$as_me:$LINENO: result: gtk test disabled" >&5
-echo "${ECHO_T}gtk test disabled" >&6
+    echo "$ac_t""gtk test disabled" 1>&6
   fi
 
   if test "x$gtk_config_prefix" != "x" ; then
@@ -7341,142 +4245,129 @@
   if test "X$GTK_CONFIG" = "X"; then
     # Extract the first word of "gtk-config", so it can be a program name with args.
 set dummy gtk-config; ac_word=$2
-echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
-if test "${ac_cv_path_GTK_CONFIG+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
+echo "configure:4250: checking for $ac_word" >&5
+if eval "test \"`echo '$''{'ac_cv_path_GTK_CONFIG'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-  case $GTK_CONFIG in
-  [\\/]* | ?:[\\/]*)
+  case "$GTK_CONFIG" in
+  /*)
   ac_cv_path_GTK_CONFIG="$GTK_CONFIG" # Let the user override the test with a path.
   ;;
+  ?:/*)			 
+  ac_cv_path_GTK_CONFIG="$GTK_CONFIG" # Let the user override the test with a dos path.
+  ;;
   *)
-  as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
-    ac_cv_path_GTK_CONFIG="$as_dir/$ac_word$ac_exec_ext"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-
+  IFS="${IFS= 	}"; ac_save_ifs="$IFS"; IFS=":"
+  ac_dummy="$PATH"
+  for ac_dir in $ac_dummy; do 
+    test -z "$ac_dir" && ac_dir=.
+    if test -f $ac_dir/$ac_word; then
+      ac_cv_path_GTK_CONFIG="$ac_dir/$ac_word"
+      break
+    fi
+  done
+  IFS="$ac_save_ifs"
   test -z "$ac_cv_path_GTK_CONFIG" && ac_cv_path_GTK_CONFIG="no"
   ;;
 esac
 fi
-GTK_CONFIG=$ac_cv_path_GTK_CONFIG
-
+GTK_CONFIG="$ac_cv_path_GTK_CONFIG"
 if test -n "$GTK_CONFIG"; then
-  echo "$as_me:$LINENO: result: $GTK_CONFIG" >&5
-echo "${ECHO_T}$GTK_CONFIG" >&6
+  echo "$ac_t""$GTK_CONFIG" 1>&6
 else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
+  echo "$ac_t""no" 1>&6
 fi
 
     if test "X$GTK_CONFIG" = "Xno"; then
             # Extract the first word of "gtk12-config", so it can be a program name with args.
 set dummy gtk12-config; ac_word=$2
-echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
-if test "${ac_cv_path_GTK12_CONFIG+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
+echo "configure:4287: checking for $ac_word" >&5
+if eval "test \"`echo '$''{'ac_cv_path_GTK12_CONFIG'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-  case $GTK12_CONFIG in
-  [\\/]* | ?:[\\/]*)
+  case "$GTK12_CONFIG" in
+  /*)
   ac_cv_path_GTK12_CONFIG="$GTK12_CONFIG" # Let the user override the test with a path.
   ;;
+  ?:/*)			 
+  ac_cv_path_GTK12_CONFIG="$GTK12_CONFIG" # Let the user override the test with a dos path.
+  ;;
   *)
-  as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
-    ac_cv_path_GTK12_CONFIG="$as_dir/$ac_word$ac_exec_ext"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-
+  IFS="${IFS= 	}"; ac_save_ifs="$IFS"; IFS=":"
+  ac_dummy="$PATH"
+  for ac_dir in $ac_dummy; do 
+    test -z "$ac_dir" && ac_dir=.
+    if test -f $ac_dir/$ac_word; then
+      ac_cv_path_GTK12_CONFIG="$ac_dir/$ac_word"
+      break
+    fi
+  done
+  IFS="$ac_save_ifs"
   test -z "$ac_cv_path_GTK12_CONFIG" && ac_cv_path_GTK12_CONFIG="no"
   ;;
 esac
 fi
-GTK12_CONFIG=$ac_cv_path_GTK12_CONFIG
-
+GTK12_CONFIG="$ac_cv_path_GTK12_CONFIG"
 if test -n "$GTK12_CONFIG"; then
-  echo "$as_me:$LINENO: result: $GTK12_CONFIG" >&5
-echo "${ECHO_T}$GTK12_CONFIG" >&6
+  echo "$ac_t""$GTK12_CONFIG" 1>&6
 else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
+  echo "$ac_t""no" 1>&6
 fi
 
       GTK_CONFIG="$GTK12_CONFIG"
     fi
   else
-    echo "$as_me:$LINENO: result: Using GTK configuration program $GTK_CONFIG" >&5
-echo "${ECHO_T}Using GTK configuration program $GTK_CONFIG" >&6
+    echo "$ac_t""Using GTK configuration program $GTK_CONFIG" 1>&6
   fi
   if test "X$PKG_CONFIG" = "X"; then
     # Extract the first word of "pkg-config", so it can be a program name with args.
 set dummy pkg-config; ac_word=$2
-echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
-if test "${ac_cv_path_PKG_CONFIG+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
+echo "configure:4329: checking for $ac_word" >&5
+if eval "test \"`echo '$''{'ac_cv_path_PKG_CONFIG'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-  case $PKG_CONFIG in
-  [\\/]* | ?:[\\/]*)
+  case "$PKG_CONFIG" in
+  /*)
   ac_cv_path_PKG_CONFIG="$PKG_CONFIG" # Let the user override the test with a path.
   ;;
+  ?:/*)			 
+  ac_cv_path_PKG_CONFIG="$PKG_CONFIG" # Let the user override the test with a dos path.
+  ;;
   *)
-  as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
-    ac_cv_path_PKG_CONFIG="$as_dir/$ac_word$ac_exec_ext"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-
+  IFS="${IFS= 	}"; ac_save_ifs="$IFS"; IFS=":"
+  ac_dummy="$PATH"
+  for ac_dir in $ac_dummy; do 
+    test -z "$ac_dir" && ac_dir=.
+    if test -f $ac_dir/$ac_word; then
+      ac_cv_path_PKG_CONFIG="$ac_dir/$ac_word"
+      break
+    fi
+  done
+  IFS="$ac_save_ifs"
   test -z "$ac_cv_path_PKG_CONFIG" && ac_cv_path_PKG_CONFIG="no"
   ;;
 esac
 fi
-PKG_CONFIG=$ac_cv_path_PKG_CONFIG
-
+PKG_CONFIG="$ac_cv_path_PKG_CONFIG"
 if test -n "$PKG_CONFIG"; then
-  echo "$as_me:$LINENO: result: $PKG_CONFIG" >&5
-echo "${ECHO_T}$PKG_CONFIG" >&6
+  echo "$ac_t""$PKG_CONFIG" 1>&6
 else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
+  echo "$ac_t""no" 1>&6
 fi
 
   fi
 
   if test "x$GTK_CONFIG:$PKG_CONFIG" != "xno:no"; then
             if test "X$SKIP_GTK2" != "XYES"; then
-
+      
   if test "X$GTK_CONFIG" != "Xno" -o "X$PKG_CONFIG" != "Xno"; then
   {
     min_gtk_version=2.2.0
-    echo "$as_me:$LINENO: checking for GTK - version >= $min_gtk_version" >&5
-echo $ECHO_N "checking for GTK - version >= $min_gtk_version... $ECHO_C" >&6
+    echo $ac_n "checking for GTK - version >= $min_gtk_version""... $ac_c" 1>&6
+echo "configure:4371: checking for GTK - version >= $min_gtk_version" >&5
     no_gtk=""
     if (test "X$SKIP_GTK2" != "XYES" -a "X$PKG_CONFIG" != "Xno") \
 	  && $PKG_CONFIG --exists gtk+-2.0; then
@@ -7518,12 +4409,9 @@
       if test "$cross_compiling" = yes; then
   echo $ac_n "cross compiling; assumed OK... $ac_c"
 else
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+  cat > conftest.$ac_ext <<EOF
+#line 4414 "configure"
+#include "confdefs.h"
 
 #include <gtk/gtk.h>
 #include <stdio.h>
@@ -7553,48 +4441,35 @@
 return 1;
 }
 
-_ACEOF
-rm -f conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && { ac_try='./conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
+EOF
+if { (eval echo configure:4446: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
+then
   :
 else
-  echo "$as_me: program exited with status $ac_status" >&5
-echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-( exit $ac_status )
-no_gtk=yes
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -fr conftest*
+  no_gtk=yes
 fi
-rm -f core *.core gmon.out bb.out conftest$ac_exeext conftest.$ac_objext conftest.$ac_ext
+rm -fr conftest*
 fi
+
       CFLAGS="$ac_save_CFLAGS"
       LIBS="$ac_save_LIBS"
     }
     fi
     if test "x$no_gtk" = x ; then
       if test "x$enable_gtktest" = "xyes"; then
-	echo "$as_me:$LINENO: result: yes; found version $gtk_major_version.$gtk_minor_version.$gtk_micro_version" >&5
-echo "${ECHO_T}yes; found version $gtk_major_version.$gtk_minor_version.$gtk_micro_version" >&6
+	echo "$ac_t""yes; found version $gtk_major_version.$gtk_minor_version.$gtk_micro_version" 1>&6
       else
-	echo "$as_me:$LINENO: result: found version $gtk_major_version.$gtk_minor_version.$gtk_micro_version" >&5
-echo "${ECHO_T}found version $gtk_major_version.$gtk_minor_version.$gtk_micro_version" >&6
+	echo "$ac_t""found version $gtk_major_version.$gtk_minor_version.$gtk_micro_version" 1>&6
       fi
       GUI_LIB_LOC="$GTK_LIBDIR"
 		   GTK_LIBNAME="$GTK_LIBS"
 		  GUI_INC_LOC="$GTK_CFLAGS"
     else
     {
-      echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
+      echo "$ac_t""no" 1>&6
       GTK_CFLAGS=""
       GTK_LIBS=""
       :
@@ -7606,8 +4481,8 @@
     GTK_LIBS=""
     :
   fi
-
-
+  
+  
   rm -f conf.gtktest
 
       if test "x$GTK_CFLAGS" != "x"; then
@@ -7615,18 +4490,18 @@
 	SKIP_NEXTAW=YES
 	SKIP_MOTIF=YES
 	GUITYPE=GTK
-
+	
       fi
     fi
 
                 if test "x$GUITYPE" != "xGTK"; then
       SKIP_GTK2=YES
-
+      
   if test "X$GTK_CONFIG" != "Xno" -o "X$PKG_CONFIG" != "Xno"; then
   {
     min_gtk_version=1.1.16
-    echo "$as_me:$LINENO: checking for GTK - version >= $min_gtk_version" >&5
-echo $ECHO_N "checking for GTK - version >= $min_gtk_version... $ECHO_C" >&6
+    echo $ac_n "checking for GTK - version >= $min_gtk_version""... $ac_c" 1>&6
+echo "configure:4505: checking for GTK - version >= $min_gtk_version" >&5
     no_gtk=""
     if (test "X$SKIP_GTK2" != "XYES" -a "X$PKG_CONFIG" != "Xno") \
 	  && $PKG_CONFIG --exists gtk+-2.0; then
@@ -7668,12 +4543,9 @@
       if test "$cross_compiling" = yes; then
   echo $ac_n "cross compiling; assumed OK... $ac_c"
 else
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+  cat > conftest.$ac_ext <<EOF
+#line 4548 "configure"
+#include "confdefs.h"
 
 #include <gtk/gtk.h>
 #include <stdio.h>
@@ -7703,47 +4575,34 @@
 return 1;
 }
 
-_ACEOF
-rm -f conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && { ac_try='./conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
+EOF
+if { (eval echo configure:4580: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
+then
   :
 else
-  echo "$as_me: program exited with status $ac_status" >&5
-echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-( exit $ac_status )
-no_gtk=yes
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -fr conftest*
+  no_gtk=yes
 fi
-rm -f core *.core gmon.out bb.out conftest$ac_exeext conftest.$ac_objext conftest.$ac_ext
+rm -fr conftest*
 fi
+
       CFLAGS="$ac_save_CFLAGS"
       LIBS="$ac_save_LIBS"
     }
     fi
     if test "x$no_gtk" = x ; then
       if test "x$enable_gtktest" = "xyes"; then
-	echo "$as_me:$LINENO: result: yes; found version $gtk_major_version.$gtk_minor_version.$gtk_micro_version" >&5
-echo "${ECHO_T}yes; found version $gtk_major_version.$gtk_minor_version.$gtk_micro_version" >&6
+	echo "$ac_t""yes; found version $gtk_major_version.$gtk_minor_version.$gtk_micro_version" 1>&6
       else
-	echo "$as_me:$LINENO: result: found version $gtk_major_version.$gtk_minor_version.$gtk_micro_version" >&5
-echo "${ECHO_T}found version $gtk_major_version.$gtk_minor_version.$gtk_micro_version" >&6
+	echo "$ac_t""found version $gtk_major_version.$gtk_minor_version.$gtk_micro_version" 1>&6
       fi
       GTK_LIBNAME="$GTK_LIBS"
 		  GUI_INC_LOC="$GTK_CFLAGS"
     else
     {
-      echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
+      echo "$ac_t""no" 1>&6
       GTK_CFLAGS=""
       GTK_LIBS=""
       :
@@ -7755,8 +4614,8 @@
     GTK_LIBS=""
     :
   fi
-
-
+  
+  
   rm -f conf.gtktest
 
       if test "x$GTK_CFLAGS" != "x"; then
@@ -7764,56 +4623,54 @@
 	SKIP_NEXTAW=YES
 	SKIP_MOTIF=YES
 	GUITYPE=GTK
-
+	
       fi
     fi
   fi
     if test "x$GUITYPE" = "xGTK"; then
     if test "$gtk_major_version" = 1 -a "0$gtk_minor_version" -lt 2 \
 	 -o "$gtk_major_version" = 1 -a "$gtk_minor_version" = 2 -a "0$gtk_micro_version" -lt 3; then
-      echo "$as_me:$LINENO: result: this GTK version is old; version 1.2.3 or later is recommended" >&5
-echo "${ECHO_T}this GTK version is old; version 1.2.3 or later is recommended" >&6
+      echo "$ac_t""this GTK version is old; version 1.2.3 or later is recommended" 1>&6
     else
     {
       if test "0$gtk_major_version" -ge 2; then
-	cat >>confdefs.h <<\_ACEOF
+	cat >> confdefs.h <<\EOF
 #define HAVE_GTK2 1
-_ACEOF
+EOF
 
 	if test "$gtk_minor_version" = 1 -a "0$gtk_micro_version" -ge 1 \
 		|| test "0$gtk_minor_version" -ge 2 \
 		|| test "0$gtk_major_version" -gt 2; then
-	  cat >>confdefs.h <<\_ACEOF
+	  cat >> confdefs.h <<\EOF
 #define HAVE_GTK_MULTIHEAD 1
-_ACEOF
+EOF
 
 	fi
       fi
                         if test -z "$SKIP_GNOME"; then
       {
+	
+  
+  
+  
 
-
-
-
-
-
-# Check whether --with-gnome-includes or --without-gnome-includes was given.
+  # Check whether --with-gnome-includes or --without-gnome-includes was given.
 if test "${with_gnome_includes+set}" = set; then
   withval="$with_gnome_includes"
   CFLAGS="$CFLAGS -I$withval"
+  
+fi
 
-fi;
 
-
-# Check whether --with-gnome-libs or --without-gnome-libs was given.
+  # Check whether --with-gnome-libs or --without-gnome-libs was given.
 if test "${with_gnome_libs+set}" = set; then
   withval="$with_gnome_libs"
   LDFLAGS="$LDFLAGS -L$withval" gnome_prefix=$withval
+  
+fi
 
-fi;
 
-
-# Check whether --with-gnome or --without-gnome was given.
+  # Check whether --with-gnome or --without-gnome was given.
 if test "${with_gnome+set}" = set; then
   withval="$with_gnome"
   if test x$withval = xyes; then
@@ -7831,38 +4688,33 @@
     fi
 else
   want_gnome=yes
-fi;
+fi
 
+
   if test "x$want_gnome" = xyes -a "0$gtk_major_version" -ge 2; then
   {
-    echo "$as_me:$LINENO: checking for libgnomeui-2.0" >&5
-echo $ECHO_N "checking for libgnomeui-2.0... $ECHO_C" >&6
+    echo $ac_n "checking for libgnomeui-2.0""... $ac_c" 1>&6
+echo "configure:4698: checking for libgnomeui-2.0" >&5
     if $PKG_CONFIG --exists libgnomeui-2.0; then
-      echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6
+      echo "$ac_t""yes" 1>&6
       GNOME_LIBS=`$PKG_CONFIG --libs-only-l libgnomeui-2.0`
       GNOME_LIBDIR=`$PKG_CONFIG --libs-only-L libgnomeui-2.0`
       GNOME_INCLUDEDIR=`$PKG_CONFIG --cflags libgnomeui-2.0`
 
-                  echo "$as_me:$LINENO: checking for FreeBSD" >&5
-echo $ECHO_N "checking for FreeBSD... $ECHO_C" >&6
+                  echo $ac_n "checking for FreeBSD""... $ac_c" 1>&6
+echo "configure:4706: checking for FreeBSD" >&5
       if test "`(uname) 2>/dev/null`" = FreeBSD; then
-	echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6
+	echo "$ac_t""yes" 1>&6
 	GNOME_INCLUDEDIR="$GNOME_INCLUDEDIR -D_THREAD_SAFE"
 	GNOME_LIBS="$GNOME_LIBS -pthread"
       else
-	echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
+	echo "$ac_t""no" 1>&6
       fi
       have_gnome=yes
     else
-      echo "$as_me:$LINENO: result: not found" >&5
-echo "${ECHO_T}not found" >&6
+      echo "$ac_t""not found" 1>&6
       if test "x" = xfail; then
-	{ { echo "$as_me:$LINENO: error: Could not find libgnomeui-2.0 via pkg-config" >&5
-echo "$as_me: error: Could not find libgnomeui-2.0 via pkg-config" >&2;}
-   { (exit 1); exit 1; }; }
+	{ echo "configure: error: Could not find libgnomeui-2.0 via pkg-config" 1>&2; exit 1; }
       fi
     fi
   }
@@ -7870,59 +4722,53 @@
   {
     # Extract the first word of "gnome-config", so it can be a program name with args.
 set dummy gnome-config; ac_word=$2
-echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
-if test "${ac_cv_path_GNOME_CONFIG+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
+echo "configure:4727: checking for $ac_word" >&5
+if eval "test \"`echo '$''{'ac_cv_path_GNOME_CONFIG'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-  case $GNOME_CONFIG in
-  [\\/]* | ?:[\\/]*)
+  case "$GNOME_CONFIG" in
+  /*)
   ac_cv_path_GNOME_CONFIG="$GNOME_CONFIG" # Let the user override the test with a path.
   ;;
+  ?:/*)			 
+  ac_cv_path_GNOME_CONFIG="$GNOME_CONFIG" # Let the user override the test with a dos path.
+  ;;
   *)
-  as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
-    ac_cv_path_GNOME_CONFIG="$as_dir/$ac_word$ac_exec_ext"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-
+  IFS="${IFS= 	}"; ac_save_ifs="$IFS"; IFS=":"
+  ac_dummy="$PATH"
+  for ac_dir in $ac_dummy; do 
+    test -z "$ac_dir" && ac_dir=.
+    if test -f $ac_dir/$ac_word; then
+      ac_cv_path_GNOME_CONFIG="$ac_dir/$ac_word"
+      break
+    fi
+  done
+  IFS="$ac_save_ifs"
   test -z "$ac_cv_path_GNOME_CONFIG" && ac_cv_path_GNOME_CONFIG="no"
   ;;
 esac
 fi
-GNOME_CONFIG=$ac_cv_path_GNOME_CONFIG
-
+GNOME_CONFIG="$ac_cv_path_GNOME_CONFIG"
 if test -n "$GNOME_CONFIG"; then
-  echo "$as_me:$LINENO: result: $GNOME_CONFIG" >&5
-echo "${ECHO_T}$GNOME_CONFIG" >&6
+  echo "$ac_t""$GNOME_CONFIG" 1>&6
 else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
+  echo "$ac_t""no" 1>&6
 fi
 
     if test "$GNOME_CONFIG" = "no"; then
       no_gnome_config="yes"
     else
-      echo "$as_me:$LINENO: checking if $GNOME_CONFIG works" >&5
-echo $ECHO_N "checking if $GNOME_CONFIG works... $ECHO_C" >&6
+      echo $ac_n "checking if $GNOME_CONFIG works""... $ac_c" 1>&6
+echo "configure:4764: checking if $GNOME_CONFIG works" >&5
       if $GNOME_CONFIG --libs-only-l gnome >/dev/null 2>&1; then
-	echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6
+	echo "$ac_t""yes" 1>&6
 	GNOME_LIBS="`$GNOME_CONFIG --libs-only-l gnome gnomeui`"
 	GNOME_LIBDIR="`$GNOME_CONFIG --libs-only-L gnorba gnomeui`"
 	GNOME_INCLUDEDIR="`$GNOME_CONFIG --cflags gnorba gnomeui`"
 	have_gnome=yes
       else
-	echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
+	echo "$ac_t""no" 1>&6
 	no_gnome_config="yes"
       fi
     fi
@@ -7938,22 +4784,18 @@
     fi
 
     if test "$no_gnome_config" = "yes"; then
-      echo "$as_me:$LINENO: checking for gnomeConf.sh file in $gnome_prefix" >&5
-echo $ECHO_N "checking for gnomeConf.sh file in $gnome_prefix... $ECHO_C" >&6
+      echo $ac_n "checking for gnomeConf.sh file in $gnome_prefix""... $ac_c" 1>&6
+echo "configure:4789: checking for gnomeConf.sh file in $gnome_prefix" >&5
       if test -f $gnome_prefix/gnomeConf.sh; then
-	echo "$as_me:$LINENO: result: found" >&5
-echo "${ECHO_T}found" >&6
+	echo "$ac_t""found" 1>&6
 	echo "loading gnome configuration from" \
 	  "$gnome_prefix/gnomeConf.sh"
 	. $gnome_prefix/gnomeConf.sh
 	have_gnome=yes
       else
-	echo "$as_me:$LINENO: result: not found" >&5
-echo "${ECHO_T}not found" >&6
+	echo "$ac_t""not found" 1>&6
 	if test x = xfail; then
-	  { { echo "$as_me:$LINENO: error: Could not find the gnomeConf.sh file that is generated by gnome-libs install" >&5
-echo "$as_me: error: Could not find the gnomeConf.sh file that is generated by gnome-libs install" >&2;}
-   { (exit 1); exit 1; }; }
+	  { echo "configure: error: Could not find the gnomeConf.sh file that is generated by gnome-libs install" 1>&2; exit 1; }
 	fi
       fi
     fi
@@ -7961,9 +4803,9 @@
   fi
 
 	if test x$have_gnome = xyes ; then
-	  cat >>confdefs.h <<\_ACEOF
+	  cat >> confdefs.h <<\EOF
 #define FEAT_GUI_GNOME 1
-_ACEOF
+EOF
 
 	  GUI_INC_LOC="$GUI_INC_LOC $GNOME_INCLUDEDIR"
 	  GTK_LIBNAME="$GTK_LIBNAME $GNOME_LIBDIR $GNOME_LIBS"
@@ -7980,8 +4822,8 @@
   gui_XXX="/usr/XXX/Motif* /usr/Motif*/XXX /usr/XXX /usr/shlib /usr/X11*/XXX /usr/XXX/X11* /usr/dt/XXX /local/Motif*/XXX /local/XXX/Motif* /usr/local/Motif*/XXX /usr/local/XXX/Motif* /usr/local/XXX /usr/local/X11*/XXX /usr/local/LessTif/Motif*/XXX $MOTIFHOME/XXX"
     GUI_INC_LOC="`echo $GUI_INC_LOC|sed 's%-I%%g'`"
 
-  echo "$as_me:$LINENO: checking for location of Motif GUI includes" >&5
-echo $ECHO_N "checking for location of Motif GUI includes... $ECHO_C" >&6
+  echo $ac_n "checking for location of Motif GUI includes""... $ac_c" 1>&6
+echo "configure:4827: checking for location of Motif GUI includes" >&5
   gui_includes="`echo $x_includes|sed 's%/^/^/*$%%'` `echo "$gui_XXX" | sed s/XXX/include/g` $GUI_INC_LOC"
   GUI_INC_LOC=
   for try in $gui_includes; do
@@ -7992,42 +4834,37 @@
   if test -n "$GUI_INC_LOC"; then
     if test "$GUI_INC_LOC" = /usr/include; then
       GUI_INC_LOC=
-      echo "$as_me:$LINENO: result: in default path" >&5
-echo "${ECHO_T}in default path" >&6
+      echo "$ac_t""in default path" 1>&6
     else
-      echo "$as_me:$LINENO: result: $GUI_INC_LOC" >&5
-echo "${ECHO_T}$GUI_INC_LOC" >&6
+      echo "$ac_t""$GUI_INC_LOC" 1>&6
     fi
   else
-    echo "$as_me:$LINENO: result: <not found>" >&5
-echo "${ECHO_T}<not found>" >&6
+    echo "$ac_t""<not found>" 1>&6
     SKIP_MOTIF=YES
   fi
 fi
 
 
 if test -z "$SKIP_MOTIF"; then
-  echo "$as_me:$LINENO: checking --with-motif-lib argument" >&5
-echo $ECHO_N "checking --with-motif-lib argument... $ECHO_C" >&6
-
-# Check whether --with-motif-lib or --without-motif-lib was given.
+  echo $ac_n "checking --with-motif-lib argument""... $ac_c" 1>&6
+echo "configure:4851: checking --with-motif-lib argument" >&5
+  # Check whether --with-motif-lib or --without-motif-lib was given.
 if test "${with_motif_lib+set}" = set; then
   withval="$with_motif_lib"
-   MOTIF_LIBNAME="${withval}"
-fi;
+   MOTIF_LIBNAME="${withval}"  
+fi
 
+
   if test -n "$MOTIF_LIBNAME"; then
-    echo "$as_me:$LINENO: result: $MOTIF_LIBNAME" >&5
-echo "${ECHO_T}$MOTIF_LIBNAME" >&6
+    echo "$ac_t""$MOTIF_LIBNAME" 1>&6
     GUI_LIB_LOC=
   else
-    echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
+    echo "$ac_t""no" 1>&6
 
         GUI_LIB_LOC="`echo $GUI_LIB_LOC|sed 's%-L%%g'`"
 
-    echo "$as_me:$LINENO: checking for location of Motif GUI libs" >&5
-echo $ECHO_N "checking for location of Motif GUI libs... $ECHO_C" >&6
+    echo $ac_n "checking for location of Motif GUI libs""... $ac_c" 1>&6
+echo "configure:4868: checking for location of Motif GUI libs" >&5
     gui_libs="`echo $x_libraries|sed 's%/^/^/*$%%'` `echo "$gui_XXX" | sed s/XXX/lib/g` `echo "$GUI_INC_LOC" | sed s/include/lib/` $GUI_LIB_LOC"
     GUI_LIB_LOC=
     for try in $gui_libs; do
@@ -8040,12 +4877,10 @@
     if test -n "$GUI_LIB_LOC"; then
             if test "$GUI_LIB_LOC" = /usr/lib; then
 	GUI_LIB_LOC=
-	echo "$as_me:$LINENO: result: in default path" >&5
-echo "${ECHO_T}in default path" >&6
+	echo "$ac_t""in default path" 1>&6
       else
 	if test -n "$GUI_LIB_LOC"; then
-	  echo "$as_me:$LINENO: result: $GUI_LIB_LOC" >&5
-echo "${ECHO_T}$GUI_LIB_LOC" >&6
+	  echo "$ac_t""$GUI_LIB_LOC" 1>&6
 	  if test "`(uname) 2>/dev/null`" = SunOS &&
 					 uname -r | grep '^5' >/dev/null; then
 	    GUI_LIB_LOC="$GUI_LIB_LOC -R $GUI_LIB_LOC"
@@ -8054,8 +4889,7 @@
       fi
       MOTIF_LIBNAME=-lXm
     else
-      echo "$as_me:$LINENO: result: <not found>" >&5
-echo "${ECHO_T}<not found>" >&6
+      echo "$ac_t""<not found>" 1>&6
       SKIP_MOTIF=YES
     fi
   fi
@@ -8065,66 +4899,37 @@
   SKIP_ATHENA=YES
   SKIP_NEXTAW=YES
   GUITYPE=MOTIF
-
+  
 fi
 
 
 GUI_X_LIBS=
 
 if test -z "$SKIP_ATHENA"; then
-  echo "$as_me:$LINENO: checking if Athena header files can be found" >&5
-echo $ECHO_N "checking if Athena header files can be found... $ECHO_C" >&6
+  echo $ac_n "checking if Athena header files can be found""... $ac_c" 1>&6
+echo "configure:4911: checking if Athena header files can be found" >&5
   cflags_save=$CFLAGS
   CFLAGS="$CFLAGS $X_CFLAGS"
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+  cat > conftest.$ac_ext <<EOF
+#line 4915 "configure"
+#include "confdefs.h"
 
 #include <X11/Intrinsic.h>
 #include <X11/Xaw/Paned.h>
-int
-main ()
-{
+int main() {
 
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6
+; return 0; }
+EOF
+if { (eval echo configure:4924: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+  rm -rf conftest*
+  echo "$ac_t""yes" 1>&6
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; SKIP_ATHENA=YES
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  echo "$ac_t""no" 1>&6; SKIP_ATHENA=YES 
 fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
+rm -f conftest*
   CFLAGS=$cflags_save
 fi
 
@@ -8133,59 +4938,30 @@
 fi
 
 if test -z "$SKIP_NEXTAW"; then
-  echo "$as_me:$LINENO: checking if neXtaw header files can be found" >&5
-echo $ECHO_N "checking if neXtaw header files can be found... $ECHO_C" >&6
+  echo $ac_n "checking if neXtaw header files can be found""... $ac_c" 1>&6
+echo "configure:4943: checking if neXtaw header files can be found" >&5
   cflags_save=$CFLAGS
   CFLAGS="$CFLAGS $X_CFLAGS"
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+  cat > conftest.$ac_ext <<EOF
+#line 4947 "configure"
+#include "confdefs.h"
 
 #include <X11/Intrinsic.h>
 #include <X11/neXtaw/Paned.h>
-int
-main ()
-{
+int main() {
 
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6
+; return 0; }
+EOF
+if { (eval echo configure:4956: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+  rm -rf conftest*
+  echo "$ac_t""yes" 1>&6
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; SKIP_NEXTAW=YES
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  echo "$ac_t""no" 1>&6; SKIP_NEXTAW=YES 
 fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
+rm -f conftest*
   CFLAGS=$cflags_save
 fi
 
@@ -8203,352 +4979,212 @@
 
     ldflags_save=$LDFLAGS
   LDFLAGS="$X_LIBS $LDFLAGS"
-  echo "$as_me:$LINENO: checking for XShapeQueryExtension in -lXext" >&5
-echo $ECHO_N "checking for XShapeQueryExtension in -lXext... $ECHO_C" >&6
-if test "${ac_cv_lib_Xext_XShapeQueryExtension+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+  echo $ac_n "checking for XShapeQueryExtension in -lXext""... $ac_c" 1>&6
+echo "configure:4984: checking for XShapeQueryExtension in -lXext" >&5
+ac_lib_var=`echo Xext'_'XShapeQueryExtension | sed 'y%./+-%__p_%'`
+if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-  ac_check_lib_save_LIBS=$LIBS
+  ac_save_LIBS="$LIBS"
 LIBS="-lXext -lXt $X_PRE_LIBS -lX11 $X_EXTRA_LIBS $LIBS"
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
+cat > conftest.$ac_ext <<EOF
+#line 4992 "configure"
+#include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
-#ifdef __cplusplus
-extern "C"
-#endif
 /* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
-char XShapeQueryExtension ();
-int
-main ()
-{
-XShapeQueryExtension ();
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_cv_lib_Xext_XShapeQueryExtension=yes
+    builtin and then its argument prototype would still apply.  */
+char XShapeQueryExtension();
+
+int main() {
+XShapeQueryExtension()
+; return 0; }
+EOF
+if { (eval echo configure:5003: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=yes"
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=no"
+fi
+rm -f conftest*
+LIBS="$ac_save_LIBS"
 
-ac_cv_lib_Xext_XShapeQueryExtension=no
 fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
-fi
-echo "$as_me:$LINENO: result: $ac_cv_lib_Xext_XShapeQueryExtension" >&5
-echo "${ECHO_T}$ac_cv_lib_Xext_XShapeQueryExtension" >&6
-if test $ac_cv_lib_Xext_XShapeQueryExtension = yes; then
+if eval "test \"`echo '$ac_cv_lib_'$ac_lib_var`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
   GUI_X_LIBS="-lXext"
+else
+  echo "$ac_t""no" 1>&6
 fi
 
-    echo "$as_me:$LINENO: checking for wslen in -lw" >&5
-echo $ECHO_N "checking for wslen in -lw... $ECHO_C" >&6
-if test "${ac_cv_lib_w_wslen+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+    echo $ac_n "checking for wslen in -lw""... $ac_c" 1>&6
+echo "configure:5024: checking for wslen in -lw" >&5
+ac_lib_var=`echo w'_'wslen | sed 'y%./+-%__p_%'`
+if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-  ac_check_lib_save_LIBS=$LIBS
+  ac_save_LIBS="$LIBS"
 LIBS="-lw $GUI_X_LIBS -lXt $X_PRE_LIBS -lX11 $X_EXTRA_LIBS $LIBS"
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
+cat > conftest.$ac_ext <<EOF
+#line 5032 "configure"
+#include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
-#ifdef __cplusplus
-extern "C"
-#endif
 /* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
-char wslen ();
-int
-main ()
-{
-wslen ();
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_cv_lib_w_wslen=yes
+    builtin and then its argument prototype would still apply.  */
+char wslen();
+
+int main() {
+wslen()
+; return 0; }
+EOF
+if { (eval echo configure:5043: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=yes"
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=no"
+fi
+rm -f conftest*
+LIBS="$ac_save_LIBS"
 
-ac_cv_lib_w_wslen=no
 fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
-fi
-echo "$as_me:$LINENO: result: $ac_cv_lib_w_wslen" >&5
-echo "${ECHO_T}$ac_cv_lib_w_wslen" >&6
-if test $ac_cv_lib_w_wslen = yes; then
+if eval "test \"`echo '$ac_cv_lib_'$ac_lib_var`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
   X_EXTRA_LIBS="$X_EXTRA_LIBS -lw"
+else
+  echo "$ac_t""no" 1>&6
 fi
 
-  echo "$as_me:$LINENO: checking for dlsym in -ldl" >&5
-echo $ECHO_N "checking for dlsym in -ldl... $ECHO_C" >&6
-if test "${ac_cv_lib_dl_dlsym+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+  echo $ac_n "checking for dlsym in -ldl""... $ac_c" 1>&6
+echo "configure:5064: checking for dlsym in -ldl" >&5
+ac_lib_var=`echo dl'_'dlsym | sed 'y%./+-%__p_%'`
+if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-  ac_check_lib_save_LIBS=$LIBS
+  ac_save_LIBS="$LIBS"
 LIBS="-ldl $GUI_X_LIBS -lXt $X_PRE_LIBS -lX11 $X_EXTRA_LIBS $LIBS"
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
+cat > conftest.$ac_ext <<EOF
+#line 5072 "configure"
+#include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
-#ifdef __cplusplus
-extern "C"
-#endif
 /* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
-char dlsym ();
-int
-main ()
-{
-dlsym ();
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_cv_lib_dl_dlsym=yes
+    builtin and then its argument prototype would still apply.  */
+char dlsym();
+
+int main() {
+dlsym()
+; return 0; }
+EOF
+if { (eval echo configure:5083: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=yes"
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=no"
+fi
+rm -f conftest*
+LIBS="$ac_save_LIBS"
 
-ac_cv_lib_dl_dlsym=no
 fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
-fi
-echo "$as_me:$LINENO: result: $ac_cv_lib_dl_dlsym" >&5
-echo "${ECHO_T}$ac_cv_lib_dl_dlsym" >&6
-if test $ac_cv_lib_dl_dlsym = yes; then
+if eval "test \"`echo '$ac_cv_lib_'$ac_lib_var`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
   X_EXTRA_LIBS="$X_EXTRA_LIBS -ldl"
+else
+  echo "$ac_t""no" 1>&6
 fi
 
-  echo "$as_me:$LINENO: checking for XmuCreateStippledPixmap in -lXmu" >&5
-echo $ECHO_N "checking for XmuCreateStippledPixmap in -lXmu... $ECHO_C" >&6
-if test "${ac_cv_lib_Xmu_XmuCreateStippledPixmap+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+  echo $ac_n "checking for XmuCreateStippledPixmap in -lXmu""... $ac_c" 1>&6
+echo "configure:5104: checking for XmuCreateStippledPixmap in -lXmu" >&5
+ac_lib_var=`echo Xmu'_'XmuCreateStippledPixmap | sed 'y%./+-%__p_%'`
+if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-  ac_check_lib_save_LIBS=$LIBS
+  ac_save_LIBS="$LIBS"
 LIBS="-lXmu $GUI_X_LIBS -lXt $X_PRE_LIBS -lX11 $X_EXTRA_LIBS $LIBS"
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
+cat > conftest.$ac_ext <<EOF
+#line 5112 "configure"
+#include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
-#ifdef __cplusplus
-extern "C"
-#endif
 /* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
-char XmuCreateStippledPixmap ();
-int
-main ()
-{
-XmuCreateStippledPixmap ();
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_cv_lib_Xmu_XmuCreateStippledPixmap=yes
+    builtin and then its argument prototype would still apply.  */
+char XmuCreateStippledPixmap();
+
+int main() {
+XmuCreateStippledPixmap()
+; return 0; }
+EOF
+if { (eval echo configure:5123: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=yes"
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=no"
+fi
+rm -f conftest*
+LIBS="$ac_save_LIBS"
 
-ac_cv_lib_Xmu_XmuCreateStippledPixmap=no
 fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
-fi
-echo "$as_me:$LINENO: result: $ac_cv_lib_Xmu_XmuCreateStippledPixmap" >&5
-echo "${ECHO_T}$ac_cv_lib_Xmu_XmuCreateStippledPixmap" >&6
-if test $ac_cv_lib_Xmu_XmuCreateStippledPixmap = yes; then
+if eval "test \"`echo '$ac_cv_lib_'$ac_lib_var`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
   GUI_X_LIBS="-lXmu $GUI_X_LIBS"
+else
+  echo "$ac_t""no" 1>&6
 fi
 
   if test -z "$SKIP_MOTIF"; then
-    echo "$as_me:$LINENO: checking for XpEndJob in -lXp" >&5
-echo $ECHO_N "checking for XpEndJob in -lXp... $ECHO_C" >&6
-if test "${ac_cv_lib_Xp_XpEndJob+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+    echo $ac_n "checking for XpEndJob in -lXp""... $ac_c" 1>&6
+echo "configure:5145: checking for XpEndJob in -lXp" >&5
+ac_lib_var=`echo Xp'_'XpEndJob | sed 'y%./+-%__p_%'`
+if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-  ac_check_lib_save_LIBS=$LIBS
+  ac_save_LIBS="$LIBS"
 LIBS="-lXp $GUI_X_LIBS -lXm -lXt $X_PRE_LIBS -lX11 $X_EXTRA_LIBS $LIBS"
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
+cat > conftest.$ac_ext <<EOF
+#line 5153 "configure"
+#include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
-#ifdef __cplusplus
-extern "C"
-#endif
 /* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
-char XpEndJob ();
-int
-main ()
-{
-XpEndJob ();
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_cv_lib_Xp_XpEndJob=yes
+    builtin and then its argument prototype would still apply.  */
+char XpEndJob();
+
+int main() {
+XpEndJob()
+; return 0; }
+EOF
+if { (eval echo configure:5164: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=yes"
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=no"
+fi
+rm -f conftest*
+LIBS="$ac_save_LIBS"
 
-ac_cv_lib_Xp_XpEndJob=no
 fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
-fi
-echo "$as_me:$LINENO: result: $ac_cv_lib_Xp_XpEndJob" >&5
-echo "${ECHO_T}$ac_cv_lib_Xp_XpEndJob" >&6
-if test $ac_cv_lib_Xp_XpEndJob = yes; then
+if eval "test \"`echo '$ac_cv_lib_'$ac_lib_var`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
   GUI_X_LIBS="-lXp $GUI_X_LIBS"
+else
+  echo "$ac_t""no" 1>&6
 fi
 
   fi
   LDFLAGS=$ldflags_save
 
-    echo "$as_me:$LINENO: checking for extra X11 defines" >&5
-echo $ECHO_N "checking for extra X11 defines... $ECHO_C" >&6
+    echo $ac_n "checking for extra X11 defines""... $ac_c" 1>&6
+echo "configure:5188: checking for extra X11 defines" >&5
   NARROW_PROTO=
   rm -fr conftestdir
   if mkdir conftestdir; then
@@ -8564,166 +5200,54 @@
     rm -fr conftestdir
   fi
   if test -z "$NARROW_PROTO"; then
-    echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
+    echo "$ac_t""no" 1>&6
   else
-    echo "$as_me:$LINENO: result: $NARROW_PROTO" >&5
-echo "${ECHO_T}$NARROW_PROTO" >&6
+    echo "$ac_t""$NARROW_PROTO" 1>&6
   fi
-
+  
 fi
 
 if test "$enable_xsmp" = "yes"; then
   cppflags_save=$CPPFLAGS
   CPPFLAGS="$CPPFLAGS $X_CFLAGS"
-
-for ac_header in X11/SM/SMlib.h
+  for ac_hdr in X11/SM/SMlib.h
 do
-as_ac_Header=`echo "ac_cv_header_$ac_header" | $as_tr_sh`
-if eval "test \"\${$as_ac_Header+set}\" = set"; then
-  echo "$as_me:$LINENO: checking for $ac_header" >&5
-echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6
-if eval "test \"\${$as_ac_Header+set}\" = set"; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-fi
-echo "$as_me:$LINENO: result: `eval echo '${'$as_ac_Header'}'`" >&5
-echo "${ECHO_T}`eval echo '${'$as_ac_Header'}'`" >&6
+ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
+echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
+echo "configure:5218: checking for $ac_hdr" >&5
+if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-  # Is the header compilable?
-echo "$as_me:$LINENO: checking $ac_header usability" >&5
-echo $ECHO_N "checking $ac_header usability... $ECHO_C" >&6
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-$ac_includes_default
-#include <$ac_header>
-_ACEOF
-rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_header_compiler=yes
+  cat > conftest.$ac_ext <<EOF
+#line 5223 "configure"
+#include "confdefs.h"
+#include <$ac_hdr>
+EOF
+ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
+{ (eval echo configure:5228: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
+ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
+if test -z "$ac_err"; then
+  rm -rf conftest*
+  eval "ac_cv_header_$ac_safe=yes"
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-ac_header_compiler=no
+  echo "$ac_err" >&5
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_header_$ac_safe=no"
 fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
-echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
-echo "${ECHO_T}$ac_header_compiler" >&6
-
-# Is the header present?
-echo "$as_me:$LINENO: checking $ac_header presence" >&5
-echo $ECHO_N "checking $ac_header presence... $ECHO_C" >&6
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-#include <$ac_header>
-_ACEOF
-if { (eval echo "$as_me:$LINENO: \"$ac_cpp conftest.$ac_ext\"") >&5
-  (eval $ac_cpp conftest.$ac_ext) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } >/dev/null; then
-  if test -s conftest.err; then
-    ac_cpp_err=$ac_c_preproc_warn_flag
-    ac_cpp_err=$ac_cpp_err$ac_c_werror_flag
-  else
-    ac_cpp_err=
-  fi
-else
-  ac_cpp_err=yes
+rm -f conftest*
 fi
-if test -z "$ac_cpp_err"; then
-  ac_header_preproc=yes
+if eval "test \"`echo '$ac_cv_header_'$ac_safe`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
+    ac_tr_hdr=HAVE_`echo $ac_hdr | sed 'y%abcdefghijklmnopqrstuvwxyz./-%ABCDEFGHIJKLMNOPQRSTUVWXYZ___%'`
+  cat >> confdefs.h <<EOF
+#define $ac_tr_hdr 1
+EOF
+ 
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-  ac_header_preproc=no
+  echo "$ac_t""no" 1>&6
 fi
-rm -f conftest.err conftest.$ac_ext
-echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
-echo "${ECHO_T}$ac_header_preproc" >&6
-
-# So?  What about this header?
-case $ac_header_compiler:$ac_header_preproc:$ac_c_preproc_warn_flag in
-  yes:no: )
-    { echo "$as_me:$LINENO: WARNING: $ac_header: accepted by the compiler, rejected by the preprocessor!" >&5
-echo "$as_me: WARNING: $ac_header: accepted by the compiler, rejected by the preprocessor!" >&2;}
-    { echo "$as_me:$LINENO: WARNING: $ac_header: proceeding with the compiler's result" >&5
-echo "$as_me: WARNING: $ac_header: proceeding with the compiler's result" >&2;}
-    ac_header_preproc=yes
-    ;;
-  no:yes:* )
-    { echo "$as_me:$LINENO: WARNING: $ac_header: present but cannot be compiled" >&5
-echo "$as_me: WARNING: $ac_header: present but cannot be compiled" >&2;}
-    { echo "$as_me:$LINENO: WARNING: $ac_header:     check for missing prerequisite headers?" >&5
-echo "$as_me: WARNING: $ac_header:     check for missing prerequisite headers?" >&2;}
-    { echo "$as_me:$LINENO: WARNING: $ac_header: see the Autoconf documentation" >&5
-echo "$as_me: WARNING: $ac_header: see the Autoconf documentation" >&2;}
-    { echo "$as_me:$LINENO: WARNING: $ac_header:     section \"Present But Cannot Be Compiled\"" >&5
-echo "$as_me: WARNING: $ac_header:     section \"Present But Cannot Be Compiled\"" >&2;}
-    { echo "$as_me:$LINENO: WARNING: $ac_header: proceeding with the preprocessor's result" >&5
-echo "$as_me: WARNING: $ac_header: proceeding with the preprocessor's result" >&2;}
-    { echo "$as_me:$LINENO: WARNING: $ac_header: in the future, the compiler will take precedence" >&5
-echo "$as_me: WARNING: $ac_header: in the future, the compiler will take precedence" >&2;}
-    (
-      cat <<\_ASBOX
-## ------------------------------------------ ##
-## Report this to the AC_PACKAGE_NAME lists.  ##
-## ------------------------------------------ ##
-_ASBOX
-    ) |
-      sed "s/^/$as_me: WARNING:     /" >&2
-    ;;
-esac
-echo "$as_me:$LINENO: checking for $ac_header" >&5
-echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6
-if eval "test \"\${$as_ac_Header+set}\" = set"; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  eval "$as_ac_Header=\$ac_header_preproc"
-fi
-echo "$as_me:$LINENO: result: `eval echo '${'$as_ac_Header'}'`" >&5
-echo "${ECHO_T}`eval echo '${'$as_ac_Header'}'`" >&6
-
-fi
-if test `eval echo '${'$as_ac_Header'}'` = yes; then
-  cat >>confdefs.h <<_ACEOF
-#define `echo "HAVE_$ac_header" | $as_tr_cpp` 1
-_ACEOF
-
-fi
-
 done
 
   CPPFLAGS=$cppflags_save
@@ -8733,176 +5257,62 @@
 if test -z "$SKIP_ATHENA" -o -z "$SKIP_NEXTAW" -o -z "$SKIP_MOTIF" -o -z "$SKIP_GTK"; then
     cppflags_save=$CPPFLAGS
   CPPFLAGS="$CPPFLAGS $X_CFLAGS"
-
-
-for ac_header in X11/xpm.h X11/Sunkeysym.h
+  for ac_hdr in X11/xpm.h X11/Sunkeysym.h
 do
-as_ac_Header=`echo "ac_cv_header_$ac_header" | $as_tr_sh`
-if eval "test \"\${$as_ac_Header+set}\" = set"; then
-  echo "$as_me:$LINENO: checking for $ac_header" >&5
-echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6
-if eval "test \"\${$as_ac_Header+set}\" = set"; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-fi
-echo "$as_me:$LINENO: result: `eval echo '${'$as_ac_Header'}'`" >&5
-echo "${ECHO_T}`eval echo '${'$as_ac_Header'}'`" >&6
+ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
+echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
+echo "configure:5265: checking for $ac_hdr" >&5
+if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-  # Is the header compilable?
-echo "$as_me:$LINENO: checking $ac_header usability" >&5
-echo $ECHO_N "checking $ac_header usability... $ECHO_C" >&6
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-$ac_includes_default
-#include <$ac_header>
-_ACEOF
-rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_header_compiler=yes
+  cat > conftest.$ac_ext <<EOF
+#line 5270 "configure"
+#include "confdefs.h"
+#include <$ac_hdr>
+EOF
+ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
+{ (eval echo configure:5275: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
+ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
+if test -z "$ac_err"; then
+  rm -rf conftest*
+  eval "ac_cv_header_$ac_safe=yes"
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-ac_header_compiler=no
+  echo "$ac_err" >&5
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_header_$ac_safe=no"
 fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
-echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
-echo "${ECHO_T}$ac_header_compiler" >&6
-
-# Is the header present?
-echo "$as_me:$LINENO: checking $ac_header presence" >&5
-echo $ECHO_N "checking $ac_header presence... $ECHO_C" >&6
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-#include <$ac_header>
-_ACEOF
-if { (eval echo "$as_me:$LINENO: \"$ac_cpp conftest.$ac_ext\"") >&5
-  (eval $ac_cpp conftest.$ac_ext) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } >/dev/null; then
-  if test -s conftest.err; then
-    ac_cpp_err=$ac_c_preproc_warn_flag
-    ac_cpp_err=$ac_cpp_err$ac_c_werror_flag
-  else
-    ac_cpp_err=
-  fi
-else
-  ac_cpp_err=yes
+rm -f conftest*
 fi
-if test -z "$ac_cpp_err"; then
-  ac_header_preproc=yes
+if eval "test \"`echo '$ac_cv_header_'$ac_safe`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
+    ac_tr_hdr=HAVE_`echo $ac_hdr | sed 'y%abcdefghijklmnopqrstuvwxyz./-%ABCDEFGHIJKLMNOPQRSTUVWXYZ___%'`
+  cat >> confdefs.h <<EOF
+#define $ac_tr_hdr 1
+EOF
+ 
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-  ac_header_preproc=no
+  echo "$ac_t""no" 1>&6
 fi
-rm -f conftest.err conftest.$ac_ext
-echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
-echo "${ECHO_T}$ac_header_preproc" >&6
-
-# So?  What about this header?
-case $ac_header_compiler:$ac_header_preproc:$ac_c_preproc_warn_flag in
-  yes:no: )
-    { echo "$as_me:$LINENO: WARNING: $ac_header: accepted by the compiler, rejected by the preprocessor!" >&5
-echo "$as_me: WARNING: $ac_header: accepted by the compiler, rejected by the preprocessor!" >&2;}
-    { echo "$as_me:$LINENO: WARNING: $ac_header: proceeding with the compiler's result" >&5
-echo "$as_me: WARNING: $ac_header: proceeding with the compiler's result" >&2;}
-    ac_header_preproc=yes
-    ;;
-  no:yes:* )
-    { echo "$as_me:$LINENO: WARNING: $ac_header: present but cannot be compiled" >&5
-echo "$as_me: WARNING: $ac_header: present but cannot be compiled" >&2;}
-    { echo "$as_me:$LINENO: WARNING: $ac_header:     check for missing prerequisite headers?" >&5
-echo "$as_me: WARNING: $ac_header:     check for missing prerequisite headers?" >&2;}
-    { echo "$as_me:$LINENO: WARNING: $ac_header: see the Autoconf documentation" >&5
-echo "$as_me: WARNING: $ac_header: see the Autoconf documentation" >&2;}
-    { echo "$as_me:$LINENO: WARNING: $ac_header:     section \"Present But Cannot Be Compiled\"" >&5
-echo "$as_me: WARNING: $ac_header:     section \"Present But Cannot Be Compiled\"" >&2;}
-    { echo "$as_me:$LINENO: WARNING: $ac_header: proceeding with the preprocessor's result" >&5
-echo "$as_me: WARNING: $ac_header: proceeding with the preprocessor's result" >&2;}
-    { echo "$as_me:$LINENO: WARNING: $ac_header: in the future, the compiler will take precedence" >&5
-echo "$as_me: WARNING: $ac_header: in the future, the compiler will take precedence" >&2;}
-    (
-      cat <<\_ASBOX
-## ------------------------------------------ ##
-## Report this to the AC_PACKAGE_NAME lists.  ##
-## ------------------------------------------ ##
-_ASBOX
-    ) |
-      sed "s/^/$as_me: WARNING:     /" >&2
-    ;;
-esac
-echo "$as_me:$LINENO: checking for $ac_header" >&5
-echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6
-if eval "test \"\${$as_ac_Header+set}\" = set"; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  eval "$as_ac_Header=\$ac_header_preproc"
-fi
-echo "$as_me:$LINENO: result: `eval echo '${'$as_ac_Header'}'`" >&5
-echo "${ECHO_T}`eval echo '${'$as_ac_Header'}'`" >&6
-
-fi
-if test `eval echo '${'$as_ac_Header'}'` = yes; then
-  cat >>confdefs.h <<_ACEOF
-#define `echo "HAVE_$ac_header" | $as_tr_cpp` 1
-_ACEOF
-
-fi
-
 done
 
 
     if test ! "$enable_xim" = "no"; then
-    echo "$as_me:$LINENO: checking for XIMText in X11/Xlib.h" >&5
-echo $ECHO_N "checking for XIMText in X11/Xlib.h... $ECHO_C" >&6
-    cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+    echo $ac_n "checking for XIMText in X11/Xlib.h""... $ac_c" 1>&6
+echo "configure:5304: checking for XIMText in X11/Xlib.h" >&5
+    cat > conftest.$ac_ext <<EOF
+#line 5306 "configure"
+#include "confdefs.h"
 #include <X11/Xlib.h>
-_ACEOF
+EOF
 if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
-  $EGREP "XIMText" >/dev/null 2>&1; then
-  echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6
+  egrep "XIMText" >/dev/null 2>&1; then
+  rm -rf conftest*
+  echo "$ac_t""yes" 1>&6
 else
-  echo "$as_me:$LINENO: result: no; xim has been disabled" >&5
-echo "${ECHO_T}no; xim has been disabled" >&6; enable_xim = "no"
+  rm -rf conftest*
+  echo "$ac_t""no; xim has been disabled" 1>&6; enable_xim = "no"
 fi
 rm -f conftest*
 
@@ -8911,8 +5321,7 @@
 
     if test "$enable_xim" = "auto" -a "$enable_hangulinput" != "yes" \
 		-a "x$GUITYPE" != "xNONE" ; then
-    echo "$as_me:$LINENO: result: X GUI selected; xim has been enabled" >&5
-echo "${ECHO_T}X GUI selected; xim has been enabled" >&6
+    echo "$ac_t""X GUI selected; xim has been enabled" 1>&6
     enable_xim="yes"
   fi
 fi
@@ -8920,304 +5329,127 @@
 if test -z "$SKIP_ATHENA" -o -z "$SKIP_NEXTAW" -o -z "$SKIP_MOTIF"; then
   cppflags_save=$CPPFLAGS
   CPPFLAGS="$CPPFLAGS $X_CFLAGS"
-  echo "$as_me:$LINENO: checking for X11/Xmu/Editres.h" >&5
-echo $ECHO_N "checking for X11/Xmu/Editres.h... $ECHO_C" >&6
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+  echo $ac_n "checking for X11/Xmu/Editres.h""... $ac_c" 1>&6
+echo "configure:5334: checking for X11/Xmu/Editres.h" >&5
+  cat > conftest.$ac_ext <<EOF
+#line 5336 "configure"
+#include "confdefs.h"
 
 #include <X11/Intrinsic.h>
 #include <X11/Xmu/Editres.h>
-int
-main ()
-{
+int main() {
 int i; i = 0;
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6
-		      cat >>confdefs.h <<\_ACEOF
+; return 0; }
+EOF
+if { (eval echo configure:5345: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+  rm -rf conftest*
+  echo "$ac_t""yes" 1>&6
+		      cat >> confdefs.h <<\EOF
 #define HAVE_X11_XMU_EDITRES_H 1
-_ACEOF
+EOF
 
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  echo "$ac_t""no" 1>&6
 fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
+rm -f conftest*
   CPPFLAGS=$cppflags_save
 fi
 
 if test -z "$SKIP_MOTIF"; then
   cppflags_save=$CPPFLAGS
   CPPFLAGS="$CPPFLAGS $X_CFLAGS"
-
-
-
-
-
-
-
-for ac_header in Xm/Xm.h Xm/XpmP.h Xm/JoinSideT.h Xm/TraitP.h Xm/Manager.h \
+  for ac_hdr in Xm/Xm.h Xm/XpmP.h Xm/JoinSideT.h Xm/TraitP.h Xm/Manager.h \
 		   Xm/UnhighlightT.h Xm/Notebook.h
 do
-as_ac_Header=`echo "ac_cv_header_$ac_header" | $as_tr_sh`
-if eval "test \"\${$as_ac_Header+set}\" = set"; then
-  echo "$as_me:$LINENO: checking for $ac_header" >&5
-echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6
-if eval "test \"\${$as_ac_Header+set}\" = set"; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-fi
-echo "$as_me:$LINENO: result: `eval echo '${'$as_ac_Header'}'`" >&5
-echo "${ECHO_T}`eval echo '${'$as_ac_Header'}'`" >&6
+ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
+echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
+echo "configure:5370: checking for $ac_hdr" >&5
+if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-  # Is the header compilable?
-echo "$as_me:$LINENO: checking $ac_header usability" >&5
-echo $ECHO_N "checking $ac_header usability... $ECHO_C" >&6
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-$ac_includes_default
-#include <$ac_header>
-_ACEOF
-rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_header_compiler=yes
+  cat > conftest.$ac_ext <<EOF
+#line 5375 "configure"
+#include "confdefs.h"
+#include <$ac_hdr>
+EOF
+ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
+{ (eval echo configure:5380: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
+ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
+if test -z "$ac_err"; then
+  rm -rf conftest*
+  eval "ac_cv_header_$ac_safe=yes"
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-ac_header_compiler=no
+  echo "$ac_err" >&5
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_header_$ac_safe=no"
 fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
-echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
-echo "${ECHO_T}$ac_header_compiler" >&6
-
-# Is the header present?
-echo "$as_me:$LINENO: checking $ac_header presence" >&5
-echo $ECHO_N "checking $ac_header presence... $ECHO_C" >&6
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-#include <$ac_header>
-_ACEOF
-if { (eval echo "$as_me:$LINENO: \"$ac_cpp conftest.$ac_ext\"") >&5
-  (eval $ac_cpp conftest.$ac_ext) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } >/dev/null; then
-  if test -s conftest.err; then
-    ac_cpp_err=$ac_c_preproc_warn_flag
-    ac_cpp_err=$ac_cpp_err$ac_c_werror_flag
-  else
-    ac_cpp_err=
-  fi
-else
-  ac_cpp_err=yes
+rm -f conftest*
 fi
-if test -z "$ac_cpp_err"; then
-  ac_header_preproc=yes
+if eval "test \"`echo '$ac_cv_header_'$ac_safe`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
+    ac_tr_hdr=HAVE_`echo $ac_hdr | sed 'y%abcdefghijklmnopqrstuvwxyz./-%ABCDEFGHIJKLMNOPQRSTUVWXYZ___%'`
+  cat >> confdefs.h <<EOF
+#define $ac_tr_hdr 1
+EOF
+ 
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-  ac_header_preproc=no
+  echo "$ac_t""no" 1>&6
 fi
-rm -f conftest.err conftest.$ac_ext
-echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
-echo "${ECHO_T}$ac_header_preproc" >&6
-
-# So?  What about this header?
-case $ac_header_compiler:$ac_header_preproc:$ac_c_preproc_warn_flag in
-  yes:no: )
-    { echo "$as_me:$LINENO: WARNING: $ac_header: accepted by the compiler, rejected by the preprocessor!" >&5
-echo "$as_me: WARNING: $ac_header: accepted by the compiler, rejected by the preprocessor!" >&2;}
-    { echo "$as_me:$LINENO: WARNING: $ac_header: proceeding with the compiler's result" >&5
-echo "$as_me: WARNING: $ac_header: proceeding with the compiler's result" >&2;}
-    ac_header_preproc=yes
-    ;;
-  no:yes:* )
-    { echo "$as_me:$LINENO: WARNING: $ac_header: present but cannot be compiled" >&5
-echo "$as_me: WARNING: $ac_header: present but cannot be compiled" >&2;}
-    { echo "$as_me:$LINENO: WARNING: $ac_header:     check for missing prerequisite headers?" >&5
-echo "$as_me: WARNING: $ac_header:     check for missing prerequisite headers?" >&2;}
-    { echo "$as_me:$LINENO: WARNING: $ac_header: see the Autoconf documentation" >&5
-echo "$as_me: WARNING: $ac_header: see the Autoconf documentation" >&2;}
-    { echo "$as_me:$LINENO: WARNING: $ac_header:     section \"Present But Cannot Be Compiled\"" >&5
-echo "$as_me: WARNING: $ac_header:     section \"Present But Cannot Be Compiled\"" >&2;}
-    { echo "$as_me:$LINENO: WARNING: $ac_header: proceeding with the preprocessor's result" >&5
-echo "$as_me: WARNING: $ac_header: proceeding with the preprocessor's result" >&2;}
-    { echo "$as_me:$LINENO: WARNING: $ac_header: in the future, the compiler will take precedence" >&5
-echo "$as_me: WARNING: $ac_header: in the future, the compiler will take precedence" >&2;}
-    (
-      cat <<\_ASBOX
-## ------------------------------------------ ##
-## Report this to the AC_PACKAGE_NAME lists.  ##
-## ------------------------------------------ ##
-_ASBOX
-    ) |
-      sed "s/^/$as_me: WARNING:     /" >&2
-    ;;
-esac
-echo "$as_me:$LINENO: checking for $ac_header" >&5
-echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6
-if eval "test \"\${$as_ac_Header+set}\" = set"; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  eval "$as_ac_Header=\$ac_header_preproc"
-fi
-echo "$as_me:$LINENO: result: `eval echo '${'$as_ac_Header'}'`" >&5
-echo "${ECHO_T}`eval echo '${'$as_ac_Header'}'`" >&6
-
-fi
-if test `eval echo '${'$as_ac_Header'}'` = yes; then
-  cat >>confdefs.h <<_ACEOF
-#define `echo "HAVE_$ac_header" | $as_tr_cpp` 1
-_ACEOF
-
-fi
-
 done
 
 
   if test $ac_cv_header_Xm_XpmP_h = yes; then
-        echo "$as_me:$LINENO: checking for XpmAttributes_21 in Xm/XpmP.h" >&5
-echo $ECHO_N "checking for XpmAttributes_21 in Xm/XpmP.h... $ECHO_C" >&6
-    cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+        echo $ac_n "checking for XpmAttributes_21 in Xm/XpmP.h""... $ac_c" 1>&6
+echo "configure:5409: checking for XpmAttributes_21 in Xm/XpmP.h" >&5
+    cat > conftest.$ac_ext <<EOF
+#line 5411 "configure"
+#include "confdefs.h"
 #include <Xm/XpmP.h>
-int
-main ()
-{
+int main() {
 XpmAttributes_21 attr;
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6; cat >>confdefs.h <<\_ACEOF
+; return 0; }
+EOF
+if { (eval echo configure:5418: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+  rm -rf conftest*
+  echo "$ac_t""yes" 1>&6; cat >> confdefs.h <<\EOF
 #define XPMATTRIBUTES_TYPE XpmAttributes_21
-_ACEOF
+EOF
 
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; cat >>confdefs.h <<\_ACEOF
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  echo "$ac_t""no" 1>&6; cat >> confdefs.h <<\EOF
 #define XPMATTRIBUTES_TYPE XpmAttributes
-_ACEOF
+EOF
 
-
+	
 fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
+rm -f conftest*
   else
-    cat >>confdefs.h <<\_ACEOF
+    cat >> confdefs.h <<\EOF
 #define XPMATTRIBUTES_TYPE XpmAttributes
-_ACEOF
+EOF
 
   fi
   CPPFLAGS=$cppflags_save
 fi
 
 if test "x$GUITYPE" = "xNONE" -a "$enable_xim" = "yes"; then
-  echo "$as_me:$LINENO: result: no GUI selected; xim has been disabled" >&5
-echo "${ECHO_T}no GUI selected; xim has been disabled" >&6
+  echo "$ac_t""no GUI selected; xim has been disabled" 1>&6
   enable_xim="no"
 fi
 if test "x$GUITYPE" = "xNONE" -a "$enable_fontset" = "yes"; then
-  echo "$as_me:$LINENO: result: no GUI selected; fontset has been disabled" >&5
-echo "${ECHO_T}no GUI selected; fontset has been disabled" >&6
+  echo "$ac_t""no GUI selected; fontset has been disabled" 1>&6
   enable_fontset="no"
 fi
 if test "x$GUITYPE:$enable_fontset" = "xGTK:yes" -a "0$gtk_major_version" -ge 2; then
-  echo "$as_me:$LINENO: result: GTK+ 2 GUI selected; fontset has been disabled" >&5
-echo "${ECHO_T}GTK+ 2 GUI selected; fontset has been disabled" >&6
+  echo "$ac_t""GTK+ 2 GUI selected; fontset has been disabled" 1>&6
   enable_fontset="no"
 fi
 
@@ -9231,21 +5463,19 @@
 
 
 if test "$enable_workshop" = "yes" -a -n "$SKIP_MOTIF"; then
-  { { echo "$as_me:$LINENO: error: cannot use workshop without Motif" >&5
-echo "$as_me: error: cannot use workshop without Motif" >&2;}
-   { (exit 1); exit 1; }; }
+  { echo "configure: error: cannot use workshop without Motif" 1>&2; exit 1; }
 fi
 
 if test "$enable_xim" = "yes"; then
-  cat >>confdefs.h <<\_ACEOF
+  cat >> confdefs.h <<\EOF
 #define FEAT_XIM 1
-_ACEOF
+EOF
 
 fi
 if test "$enable_fontset" = "yes"; then
-  cat >>confdefs.h <<\_ACEOF
+  cat >> confdefs.h <<\EOF
 #define FEAT_XFONTSET 1
-_ACEOF
+EOF
 
 fi
 
@@ -9254,733 +5484,317 @@
 
 if test "$enable_hangulinput" = "yes"; then
   if test "x$GUITYPE" = "xNONE"; then
-    echo "$as_me:$LINENO: result: no GUI selected; hangul input has been disabled" >&5
-echo "${ECHO_T}no GUI selected; hangul input has been disabled" >&6
+    echo "$ac_t""no GUI selected; hangul input has been disabled" 1>&6
     enable_hangulinput=no
   else
-    cat >>confdefs.h <<\_ACEOF
+    cat >> confdefs.h <<\EOF
 #define FEAT_HANGULIN 1
-_ACEOF
+EOF
 
     HANGULIN_SRC=hangulin.c
-
+    
     HANGULIN_OBJ=objects/hangulin.o
-
+    
   fi
 fi
 
 
-echo "$as_me:$LINENO: checking quality of toupper" >&5
-echo $ECHO_N "checking quality of toupper... $ECHO_C" >&6
+echo $ac_n "checking quality of toupper""... $ac_c" 1>&6
+echo "configure:5504: checking quality of toupper" >&5
 if test "$cross_compiling" = yes; then
-  { { echo "$as_me:$LINENO: error: failed to compile test program" >&5
-echo "$as_me: error: failed to compile test program" >&2;}
-   { (exit 1); exit 1; }; }
+  { echo "configure: error: failed to compile test program" 1>&2; exit 1; }
 else
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+  cat > conftest.$ac_ext <<EOF
+#line 5509 "configure"
+#include "confdefs.h"
 #include <ctype.h>
 main() { exit(toupper('A') == 'A' && tolower('z') == 'z'); }
-_ACEOF
-rm -f conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && { ac_try='./conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  cat >>confdefs.h <<\_ACEOF
+EOF
+if { (eval echo configure:5514: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
+then
+  cat >> confdefs.h <<\EOF
 #define BROKEN_TOUPPER 1
-_ACEOF
- echo "$as_me:$LINENO: result: bad" >&5
-echo "${ECHO_T}bad" >&6
+EOF
+ echo "$ac_t""bad" 1>&6
 else
-  echo "$as_me: program exited with status $ac_status" >&5
-echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-( exit $ac_status )
-echo "$as_me:$LINENO: result: good" >&5
-echo "${ECHO_T}good" >&6
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -fr conftest*
+  echo "$ac_t""good" 1>&6
 fi
-rm -f core *.core gmon.out bb.out conftest$ac_exeext conftest.$ac_objext conftest.$ac_ext
+rm -fr conftest*
 fi
 
-echo "$as_me:$LINENO: checking whether __DATE__ and __TIME__ work" >&5
-echo $ECHO_N "checking whether __DATE__ and __TIME__ work... $ECHO_C" >&6
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
 
-int
-main ()
-{
+echo $ac_n "checking whether __DATE__ and __TIME__ work""... $ac_c" 1>&6
+echo "configure:5531: checking whether __DATE__ and __TIME__ work" >&5
+cat > conftest.$ac_ext <<EOF
+#line 5533 "configure"
+#include "confdefs.h"
+
+int main() {
 printf("(" __DATE__ " " __TIME__ ")");
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6; cat >>confdefs.h <<\_ACEOF
+; return 0; }
+EOF
+if { (eval echo configure:5540: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+  rm -rf conftest*
+  echo "$ac_t""yes" 1>&6; cat >> confdefs.h <<\EOF
 #define HAVE_DATE_TIME 1
-_ACEOF
+EOF
 
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  echo "$ac_t""no" 1>&6
 fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
+rm -f conftest*
 
-if test "${ac_cv_header_elf_h+set}" = set; then
-  echo "$as_me:$LINENO: checking for elf.h" >&5
-echo $ECHO_N "checking for elf.h... $ECHO_C" >&6
-if test "${ac_cv_header_elf_h+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-fi
-echo "$as_me:$LINENO: result: $ac_cv_header_elf_h" >&5
-echo "${ECHO_T}$ac_cv_header_elf_h" >&6
+ac_safe=`echo "elf.h" | sed 'y%./+-%__p_%'`
+echo $ac_n "checking for elf.h""... $ac_c" 1>&6
+echo "configure:5556: checking for elf.h" >&5
+if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-  # Is the header compilable?
-echo "$as_me:$LINENO: checking elf.h usability" >&5
-echo $ECHO_N "checking elf.h usability... $ECHO_C" >&6
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-$ac_includes_default
+  cat > conftest.$ac_ext <<EOF
+#line 5561 "configure"
+#include "confdefs.h"
 #include <elf.h>
-_ACEOF
-rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_header_compiler=yes
+EOF
+ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
+{ (eval echo configure:5566: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
+ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
+if test -z "$ac_err"; then
+  rm -rf conftest*
+  eval "ac_cv_header_$ac_safe=yes"
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-ac_header_compiler=no
+  echo "$ac_err" >&5
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_header_$ac_safe=no"
 fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
-echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
-echo "${ECHO_T}$ac_header_compiler" >&6
-
-# Is the header present?
-echo "$as_me:$LINENO: checking elf.h presence" >&5
-echo $ECHO_N "checking elf.h presence... $ECHO_C" >&6
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-#include <elf.h>
-_ACEOF
-if { (eval echo "$as_me:$LINENO: \"$ac_cpp conftest.$ac_ext\"") >&5
-  (eval $ac_cpp conftest.$ac_ext) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } >/dev/null; then
-  if test -s conftest.err; then
-    ac_cpp_err=$ac_c_preproc_warn_flag
-    ac_cpp_err=$ac_cpp_err$ac_c_werror_flag
-  else
-    ac_cpp_err=
-  fi
-else
-  ac_cpp_err=yes
+rm -f conftest*
 fi
-if test -z "$ac_cpp_err"; then
-  ac_header_preproc=yes
+if eval "test \"`echo '$ac_cv_header_'$ac_safe`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
+  HAS_ELF=1
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-  ac_header_preproc=no
+  echo "$ac_t""no" 1>&6
 fi
-rm -f conftest.err conftest.$ac_ext
-echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
-echo "${ECHO_T}$ac_header_preproc" >&6
 
-# So?  What about this header?
-case $ac_header_compiler:$ac_header_preproc:$ac_c_preproc_warn_flag in
-  yes:no: )
-    { echo "$as_me:$LINENO: WARNING: elf.h: accepted by the compiler, rejected by the preprocessor!" >&5
-echo "$as_me: WARNING: elf.h: accepted by the compiler, rejected by the preprocessor!" >&2;}
-    { echo "$as_me:$LINENO: WARNING: elf.h: proceeding with the compiler's result" >&5
-echo "$as_me: WARNING: elf.h: proceeding with the compiler's result" >&2;}
-    ac_header_preproc=yes
-    ;;
-  no:yes:* )
-    { echo "$as_me:$LINENO: WARNING: elf.h: present but cannot be compiled" >&5
-echo "$as_me: WARNING: elf.h: present but cannot be compiled" >&2;}
-    { echo "$as_me:$LINENO: WARNING: elf.h:     check for missing prerequisite headers?" >&5
-echo "$as_me: WARNING: elf.h:     check for missing prerequisite headers?" >&2;}
-    { echo "$as_me:$LINENO: WARNING: elf.h: see the Autoconf documentation" >&5
-echo "$as_me: WARNING: elf.h: see the Autoconf documentation" >&2;}
-    { echo "$as_me:$LINENO: WARNING: elf.h:     section \"Present But Cannot Be Compiled\"" >&5
-echo "$as_me: WARNING: elf.h:     section \"Present But Cannot Be Compiled\"" >&2;}
-    { echo "$as_me:$LINENO: WARNING: elf.h: proceeding with the preprocessor's result" >&5
-echo "$as_me: WARNING: elf.h: proceeding with the preprocessor's result" >&2;}
-    { echo "$as_me:$LINENO: WARNING: elf.h: in the future, the compiler will take precedence" >&5
-echo "$as_me: WARNING: elf.h: in the future, the compiler will take precedence" >&2;}
-    (
-      cat <<\_ASBOX
-## ------------------------------------------ ##
-## Report this to the AC_PACKAGE_NAME lists.  ##
-## ------------------------------------------ ##
-_ASBOX
-    ) |
-      sed "s/^/$as_me: WARNING:     /" >&2
-    ;;
-esac
-echo "$as_me:$LINENO: checking for elf.h" >&5
-echo $ECHO_N "checking for elf.h... $ECHO_C" >&6
-if test "${ac_cv_header_elf_h+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  ac_cv_header_elf_h=$ac_header_preproc
-fi
-echo "$as_me:$LINENO: result: $ac_cv_header_elf_h" >&5
-echo "${ECHO_T}$ac_cv_header_elf_h" >&6
-
-fi
-if test $ac_cv_header_elf_h = yes; then
-  HAS_ELF=1
-fi
-
-
 if test "$HAS_ELF" = 1; then
-
-echo "$as_me:$LINENO: checking for main in -lelf" >&5
-echo $ECHO_N "checking for main in -lelf... $ECHO_C" >&6
-if test "${ac_cv_lib_elf_main+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+  echo $ac_n "checking for main in -lelf""... $ac_c" 1>&6
+echo "configure:5589: checking for main in -lelf" >&5
+ac_lib_var=`echo elf'_'main | sed 'y%./+-%__p_%'`
+if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-  ac_check_lib_save_LIBS=$LIBS
+  ac_save_LIBS="$LIBS"
 LIBS="-lelf  $LIBS"
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+cat > conftest.$ac_ext <<EOF
+#line 5597 "configure"
+#include "confdefs.h"
 
-
-int
-main ()
-{
-main ();
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_cv_lib_elf_main=yes
+int main() {
+main()
+; return 0; }
+EOF
+if { (eval echo configure:5604: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=yes"
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=no"
+fi
+rm -f conftest*
+LIBS="$ac_save_LIBS"
 
-ac_cv_lib_elf_main=no
 fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
-fi
-echo "$as_me:$LINENO: result: $ac_cv_lib_elf_main" >&5
-echo "${ECHO_T}$ac_cv_lib_elf_main" >&6
-if test $ac_cv_lib_elf_main = yes; then
-  cat >>confdefs.h <<_ACEOF
-#define HAVE_LIBELF 1
-_ACEOF
+if eval "test \"`echo '$ac_cv_lib_'$ac_lib_var`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
+    ac_tr_lib=HAVE_LIB`echo elf | sed -e 's/[^a-zA-Z0-9_]/_/g' \
+    -e 'y/abcdefghijklmnopqrstuvwxyz/ABCDEFGHIJKLMNOPQRSTUVWXYZ/'`
+  cat >> confdefs.h <<EOF
+#define $ac_tr_lib 1
+EOF
 
   LIBS="-lelf $LIBS"
 
+else
+  echo "$ac_t""no" 1>&6
 fi
 
 fi
 
-
-
-
-
-
 ac_header_dirent=no
-for ac_hdr in dirent.h sys/ndir.h sys/dir.h ndir.h; do
-  as_ac_Header=`echo "ac_cv_header_dirent_$ac_hdr" | $as_tr_sh`
-echo "$as_me:$LINENO: checking for $ac_hdr that defines DIR" >&5
-echo $ECHO_N "checking for $ac_hdr that defines DIR... $ECHO_C" >&6
-if eval "test \"\${$as_ac_Header+set}\" = set"; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+for ac_hdr in dirent.h sys/ndir.h sys/dir.h ndir.h
+do
+ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
+echo $ac_n "checking for $ac_hdr that defines DIR""... $ac_c" 1>&6
+echo "configure:5638: checking for $ac_hdr that defines DIR" >&5
+if eval "test \"`echo '$''{'ac_cv_header_dirent_$ac_safe'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+  cat > conftest.$ac_ext <<EOF
+#line 5643 "configure"
+#include "confdefs.h"
 #include <sys/types.h>
 #include <$ac_hdr>
-
-int
-main ()
-{
-if ((DIR *) 0)
-return 0;
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  eval "$as_ac_Header=yes"
+int main() {
+DIR *dirp = 0;
+; return 0; }
+EOF
+if { (eval echo configure:5651: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+  rm -rf conftest*
+  eval "ac_cv_header_dirent_$ac_safe=yes"
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-eval "$as_ac_Header=no"
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_header_dirent_$ac_safe=no"
 fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
+rm -f conftest*
 fi
-echo "$as_me:$LINENO: result: `eval echo '${'$as_ac_Header'}'`" >&5
-echo "${ECHO_T}`eval echo '${'$as_ac_Header'}'`" >&6
-if test `eval echo '${'$as_ac_Header'}'` = yes; then
-  cat >>confdefs.h <<_ACEOF
-#define `echo "HAVE_$ac_hdr" | $as_tr_cpp` 1
-_ACEOF
-
-ac_header_dirent=$ac_hdr; break
+if eval "test \"`echo '$ac_cv_header_dirent_'$ac_safe`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
+    ac_tr_hdr=HAVE_`echo $ac_hdr | sed 'y%abcdefghijklmnopqrstuvwxyz./-%ABCDEFGHIJKLMNOPQRSTUVWXYZ___%'`
+  cat >> confdefs.h <<EOF
+#define $ac_tr_hdr 1
+EOF
+ ac_header_dirent=$ac_hdr; break
+else
+  echo "$ac_t""no" 1>&6
 fi
-
 done
 # Two versions of opendir et al. are in -ldir and -lx on SCO Xenix.
 if test $ac_header_dirent = dirent.h; then
-  echo "$as_me:$LINENO: checking for library containing opendir" >&5
-echo $ECHO_N "checking for library containing opendir... $ECHO_C" >&6
-if test "${ac_cv_search_opendir+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+echo $ac_n "checking for opendir in -ldir""... $ac_c" 1>&6
+echo "configure:5676: checking for opendir in -ldir" >&5
+ac_lib_var=`echo dir'_'opendir | sed 'y%./+-%__p_%'`
+if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-  ac_func_search_save_LIBS=$LIBS
-ac_cv_search_opendir=no
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
+  ac_save_LIBS="$LIBS"
+LIBS="-ldir  $LIBS"
+cat > conftest.$ac_ext <<EOF
+#line 5684 "configure"
+#include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
-#ifdef __cplusplus
-extern "C"
-#endif
 /* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
-char opendir ();
-int
-main ()
-{
-opendir ();
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_cv_search_opendir="none required"
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
+    builtin and then its argument prototype would still apply.  */
+char opendir();
 
+int main() {
+opendir()
+; return 0; }
+EOF
+if { (eval echo configure:5695: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=yes"
+else
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=no"
 fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
-if test "$ac_cv_search_opendir" = no; then
-  for ac_lib in dir; do
-    LIBS="-l$ac_lib  $ac_func_search_save_LIBS"
-    cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+rm -f conftest*
+LIBS="$ac_save_LIBS"
 
-/* Override any gcc2 internal prototype to avoid an error.  */
-#ifdef __cplusplus
-extern "C"
-#endif
-/* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
-char opendir ();
-int
-main ()
-{
-opendir ();
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_cv_search_opendir="-l$ac_lib"
-break
+fi
+if eval "test \"`echo '$ac_cv_lib_'$ac_lib_var`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
+  LIBS="$LIBS -ldir"
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
+  echo "$ac_t""no" 1>&6
 fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
-  done
-fi
-LIBS=$ac_func_search_save_LIBS
-fi
-echo "$as_me:$LINENO: result: $ac_cv_search_opendir" >&5
-echo "${ECHO_T}$ac_cv_search_opendir" >&6
-if test "$ac_cv_search_opendir" != no; then
-  test "$ac_cv_search_opendir" = "none required" || LIBS="$ac_cv_search_opendir $LIBS"
 
-fi
-
 else
-  echo "$as_me:$LINENO: checking for library containing opendir" >&5
-echo $ECHO_N "checking for library containing opendir... $ECHO_C" >&6
-if test "${ac_cv_search_opendir+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+echo $ac_n "checking for opendir in -lx""... $ac_c" 1>&6
+echo "configure:5717: checking for opendir in -lx" >&5
+ac_lib_var=`echo x'_'opendir | sed 'y%./+-%__p_%'`
+if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-  ac_func_search_save_LIBS=$LIBS
-ac_cv_search_opendir=no
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
+  ac_save_LIBS="$LIBS"
+LIBS="-lx  $LIBS"
+cat > conftest.$ac_ext <<EOF
+#line 5725 "configure"
+#include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
-#ifdef __cplusplus
-extern "C"
-#endif
 /* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
-char opendir ();
-int
-main ()
-{
-opendir ();
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_cv_search_opendir="none required"
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
+    builtin and then its argument prototype would still apply.  */
+char opendir();
 
+int main() {
+opendir()
+; return 0; }
+EOF
+if { (eval echo configure:5736: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=yes"
+else
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=no"
 fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
-if test "$ac_cv_search_opendir" = no; then
-  for ac_lib in x; do
-    LIBS="-l$ac_lib  $ac_func_search_save_LIBS"
-    cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+rm -f conftest*
+LIBS="$ac_save_LIBS"
 
-/* Override any gcc2 internal prototype to avoid an error.  */
-#ifdef __cplusplus
-extern "C"
-#endif
-/* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
-char opendir ();
-int
-main ()
-{
-opendir ();
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_cv_search_opendir="-l$ac_lib"
-break
+fi
+if eval "test \"`echo '$ac_cv_lib_'$ac_lib_var`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
+  LIBS="$LIBS -lx"
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
+  echo "$ac_t""no" 1>&6
 fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
-  done
-fi
-LIBS=$ac_func_search_save_LIBS
-fi
-echo "$as_me:$LINENO: result: $ac_cv_search_opendir" >&5
-echo "${ECHO_T}$ac_cv_search_opendir" >&6
-if test "$ac_cv_search_opendir" != no; then
-  test "$ac_cv_search_opendir" = "none required" || LIBS="$ac_cv_search_opendir $LIBS"
 
 fi
 
-fi
 
-
-echo "$as_me:$LINENO: checking for ANSI C header files" >&5
-echo $ECHO_N "checking for ANSI C header files... $ECHO_C" >&6
-if test "${ac_cv_header_stdc+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+echo $ac_n "checking for ANSI C header files""... $ac_c" 1>&6
+echo "configure:5760: checking for ANSI C header files" >&5
+if eval "test \"`echo '$''{'ac_cv_header_stdc'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+  cat > conftest.$ac_ext <<EOF
+#line 5765 "configure"
+#include "confdefs.h"
 #include <stdlib.h>
 #include <stdarg.h>
 #include <string.h>
 #include <float.h>
-
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
+EOF
+ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
+{ (eval echo configure:5773: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
+ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
+if test -z "$ac_err"; then
+  rm -rf conftest*
   ac_cv_header_stdc=yes
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-ac_cv_header_stdc=no
+  echo "$ac_err" >&5
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  ac_cv_header_stdc=no
 fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
+rm -f conftest*
 
 if test $ac_cv_header_stdc = yes; then
   # SunOS 4.x string.h does not declare mem*, contrary to ANSI.
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+cat > conftest.$ac_ext <<EOF
+#line 5790 "configure"
+#include "confdefs.h"
 #include <string.h>
-
-_ACEOF
+EOF
 if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
-  $EGREP "memchr" >/dev/null 2>&1; then
+  egrep "memchr" >/dev/null 2>&1; then
   :
 else
+  rm -rf conftest*
   ac_cv_header_stdc=no
 fi
 rm -f conftest*
@@ -9989,19 +5803,16 @@
 
 if test $ac_cv_header_stdc = yes; then
   # ISC 2.0.2 stdlib.h does not declare free, contrary to ANSI.
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+cat > conftest.$ac_ext <<EOF
+#line 5808 "configure"
+#include "confdefs.h"
 #include <stdlib.h>
-
-_ACEOF
+EOF
 if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
-  $EGREP "free" >/dev/null 2>&1; then
+  egrep "free" >/dev/null 2>&1; then
   :
 else
+  rm -rf conftest*
   ac_cv_header_stdc=no
 fi
 rm -f conftest*
@@ -10010,246 +5821,119 @@
 
 if test $ac_cv_header_stdc = yes; then
   # /bin/cc in Irix-4.0.5 gets non-ANSI ctype macros unless using -ansi.
-  if test "$cross_compiling" = yes; then
+if test "$cross_compiling" = yes; then
   :
 else
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+  cat > conftest.$ac_ext <<EOF
+#line 5829 "configure"
+#include "confdefs.h"
 #include <ctype.h>
-#if ((' ' & 0x0FF) == 0x020)
-# define ISLOWER(c) ('a' <= (c) && (c) <= 'z')
-# define TOUPPER(c) (ISLOWER(c) ? 'A' + ((c) - 'a') : (c))
-#else
-# define ISLOWER(c) \
-		   (('a' <= (c) && (c) <= 'i') \
-		     || ('j' <= (c) && (c) <= 'r') \
-		     || ('s' <= (c) && (c) <= 'z'))
-# define TOUPPER(c) (ISLOWER(c) ? ((c) | 0x40) : (c))
-#endif
-
+#define ISLOWER(c) ('a' <= (c) && (c) <= 'z')
+#define TOUPPER(c) (ISLOWER(c) ? 'A' + ((c) - 'a') : (c))
 #define XOR(e, f) (((e) && !(f)) || (!(e) && (f)))
-int
-main ()
-{
-  int i;
-  for (i = 0; i < 256; i++)
-    if (XOR (islower (i), ISLOWER (i))
-	|| toupper (i) != TOUPPER (i))
-      exit(2);
-  exit (0);
-}
-_ACEOF
-rm -f conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && { ac_try='./conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
+int main () { int i; for (i = 0; i < 256; i++)
+if (XOR (islower (i), ISLOWER (i)) || toupper (i) != TOUPPER (i)) exit(2);
+exit (0); }
+
+EOF
+if { (eval echo configure:5840: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
+then
   :
 else
-  echo "$as_me: program exited with status $ac_status" >&5
-echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-( exit $ac_status )
-ac_cv_header_stdc=no
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -fr conftest*
+  ac_cv_header_stdc=no
 fi
-rm -f core *.core gmon.out bb.out conftest$ac_exeext conftest.$ac_objext conftest.$ac_ext
+rm -fr conftest*
 fi
+
 fi
 fi
-echo "$as_me:$LINENO: result: $ac_cv_header_stdc" >&5
-echo "${ECHO_T}$ac_cv_header_stdc" >&6
-if test $ac_cv_header_stdc = yes; then
 
-cat >>confdefs.h <<\_ACEOF
+echo "$ac_t""$ac_cv_header_stdc" 1>&6
+if test $ac_cv_header_stdc = yes; then
+  cat >> confdefs.h <<\EOF
 #define STDC_HEADERS 1
-_ACEOF
+EOF
 
 fi
 
-echo "$as_me:$LINENO: checking for sys/wait.h that is POSIX.1 compatible" >&5
-echo $ECHO_N "checking for sys/wait.h that is POSIX.1 compatible... $ECHO_C" >&6
-if test "${ac_cv_header_sys_wait_h+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+echo $ac_n "checking for sys/wait.h that is POSIX.1 compatible""... $ac_c" 1>&6
+echo "configure:5864: checking for sys/wait.h that is POSIX.1 compatible" >&5
+if eval "test \"`echo '$''{'ac_cv_header_sys_wait_h'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+  cat > conftest.$ac_ext <<EOF
+#line 5869 "configure"
+#include "confdefs.h"
 #include <sys/types.h>
 #include <sys/wait.h>
 #ifndef WEXITSTATUS
-# define WEXITSTATUS(stat_val) ((unsigned)(stat_val) >> 8)
+#define WEXITSTATUS(stat_val) ((unsigned)(stat_val) >> 8)
 #endif
 #ifndef WIFEXITED
-# define WIFEXITED(stat_val) (((stat_val) & 255) == 0)
+#define WIFEXITED(stat_val) (((stat_val) & 255) == 0)
 #endif
-
-int
-main ()
-{
-  int s;
-  wait (&s);
-  s = WIFEXITED (s) ? WEXITSTATUS (s) : 1;
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
+int main() {
+int s;
+wait (&s);
+s = WIFEXITED (s) ? WEXITSTATUS (s) : 1;
+; return 0; }
+EOF
+if { (eval echo configure:5885: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+  rm -rf conftest*
   ac_cv_header_sys_wait_h=yes
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-ac_cv_header_sys_wait_h=no
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  ac_cv_header_sys_wait_h=no
 fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
+rm -f conftest*
 fi
-echo "$as_me:$LINENO: result: $ac_cv_header_sys_wait_h" >&5
-echo "${ECHO_T}$ac_cv_header_sys_wait_h" >&6
-if test $ac_cv_header_sys_wait_h = yes; then
 
-cat >>confdefs.h <<\_ACEOF
+echo "$ac_t""$ac_cv_header_sys_wait_h" 1>&6
+if test $ac_cv_header_sys_wait_h = yes; then
+  cat >> confdefs.h <<\EOF
 #define HAVE_SYS_WAIT_H 1
-_ACEOF
+EOF
 
 fi
 
 
 if test $ac_cv_header_sys_wait_h = no; then
-  echo "$as_me:$LINENO: checking for sys/wait.h that defines union wait" >&5
-echo $ECHO_N "checking for sys/wait.h that defines union wait... $ECHO_C" >&6
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+  echo $ac_n "checking for sys/wait.h that defines union wait""... $ac_c" 1>&6
+echo "configure:5908: checking for sys/wait.h that defines union wait" >&5
+  cat > conftest.$ac_ext <<EOF
+#line 5910 "configure"
+#include "confdefs.h"
 #include <sys/wait.h>
-int
-main ()
-{
+int main() {
 union wait xx, yy; xx = yy
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6
-			cat >>confdefs.h <<\_ACEOF
+; return 0; }
+EOF
+if { (eval echo configure:5917: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+  rm -rf conftest*
+  echo "$ac_t""yes" 1>&6
+			cat >> confdefs.h <<\EOF
 #define HAVE_SYS_WAIT_H 1
-_ACEOF
+EOF
 
-			cat >>confdefs.h <<\_ACEOF
+			cat >> confdefs.h <<\EOF
 #define HAVE_UNION_WAIT 1
-_ACEOF
+EOF
 
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  echo "$ac_t""no" 1>&6
 fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
+rm -f conftest*
 fi
 
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-for ac_header in stdarg.h stdlib.h string.h sys/select.h sys/utsname.h \
+for ac_hdr in stdarg.h stdlib.h string.h sys/select.h sys/utsname.h \
 	termcap.h fcntl.h sgtty.h sys/ioctl.h sys/time.h termio.h \
 	iconv.h langinfo.h unistd.h stropts.h errno.h \
 	sys/resource.h sys/systeminfo.h locale.h \
@@ -10258,377 +5942,126 @@
 	libgen.h util/debug.h util/msg18n.h frame.h \
 	sys/acl.h sys/access.h sys/sysctl.h sys/sysinfo.h wchar.h wctype.h
 do
-as_ac_Header=`echo "ac_cv_header_$ac_header" | $as_tr_sh`
-if eval "test \"\${$as_ac_Header+set}\" = set"; then
-  echo "$as_me:$LINENO: checking for $ac_header" >&5
-echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6
-if eval "test \"\${$as_ac_Header+set}\" = set"; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-fi
-echo "$as_me:$LINENO: result: `eval echo '${'$as_ac_Header'}'`" >&5
-echo "${ECHO_T}`eval echo '${'$as_ac_Header'}'`" >&6
+ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
+echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
+echo "configure:5948: checking for $ac_hdr" >&5
+if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-  # Is the header compilable?
-echo "$as_me:$LINENO: checking $ac_header usability" >&5
-echo $ECHO_N "checking $ac_header usability... $ECHO_C" >&6
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-$ac_includes_default
-#include <$ac_header>
-_ACEOF
-rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_header_compiler=yes
+  cat > conftest.$ac_ext <<EOF
+#line 5953 "configure"
+#include "confdefs.h"
+#include <$ac_hdr>
+EOF
+ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
+{ (eval echo configure:5958: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
+ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
+if test -z "$ac_err"; then
+  rm -rf conftest*
+  eval "ac_cv_header_$ac_safe=yes"
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-ac_header_compiler=no
+  echo "$ac_err" >&5
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_header_$ac_safe=no"
 fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
-echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
-echo "${ECHO_T}$ac_header_compiler" >&6
-
-# Is the header present?
-echo "$as_me:$LINENO: checking $ac_header presence" >&5
-echo $ECHO_N "checking $ac_header presence... $ECHO_C" >&6
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-#include <$ac_header>
-_ACEOF
-if { (eval echo "$as_me:$LINENO: \"$ac_cpp conftest.$ac_ext\"") >&5
-  (eval $ac_cpp conftest.$ac_ext) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } >/dev/null; then
-  if test -s conftest.err; then
-    ac_cpp_err=$ac_c_preproc_warn_flag
-    ac_cpp_err=$ac_cpp_err$ac_c_werror_flag
-  else
-    ac_cpp_err=
-  fi
-else
-  ac_cpp_err=yes
+rm -f conftest*
 fi
-if test -z "$ac_cpp_err"; then
-  ac_header_preproc=yes
+if eval "test \"`echo '$ac_cv_header_'$ac_safe`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
+    ac_tr_hdr=HAVE_`echo $ac_hdr | sed 'y%abcdefghijklmnopqrstuvwxyz./-%ABCDEFGHIJKLMNOPQRSTUVWXYZ___%'`
+  cat >> confdefs.h <<EOF
+#define $ac_tr_hdr 1
+EOF
+ 
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-  ac_header_preproc=no
+  echo "$ac_t""no" 1>&6
 fi
-rm -f conftest.err conftest.$ac_ext
-echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
-echo "${ECHO_T}$ac_header_preproc" >&6
-
-# So?  What about this header?
-case $ac_header_compiler:$ac_header_preproc:$ac_c_preproc_warn_flag in
-  yes:no: )
-    { echo "$as_me:$LINENO: WARNING: $ac_header: accepted by the compiler, rejected by the preprocessor!" >&5
-echo "$as_me: WARNING: $ac_header: accepted by the compiler, rejected by the preprocessor!" >&2;}
-    { echo "$as_me:$LINENO: WARNING: $ac_header: proceeding with the compiler's result" >&5
-echo "$as_me: WARNING: $ac_header: proceeding with the compiler's result" >&2;}
-    ac_header_preproc=yes
-    ;;
-  no:yes:* )
-    { echo "$as_me:$LINENO: WARNING: $ac_header: present but cannot be compiled" >&5
-echo "$as_me: WARNING: $ac_header: present but cannot be compiled" >&2;}
-    { echo "$as_me:$LINENO: WARNING: $ac_header:     check for missing prerequisite headers?" >&5
-echo "$as_me: WARNING: $ac_header:     check for missing prerequisite headers?" >&2;}
-    { echo "$as_me:$LINENO: WARNING: $ac_header: see the Autoconf documentation" >&5
-echo "$as_me: WARNING: $ac_header: see the Autoconf documentation" >&2;}
-    { echo "$as_me:$LINENO: WARNING: $ac_header:     section \"Present But Cannot Be Compiled\"" >&5
-echo "$as_me: WARNING: $ac_header:     section \"Present But Cannot Be Compiled\"" >&2;}
-    { echo "$as_me:$LINENO: WARNING: $ac_header: proceeding with the preprocessor's result" >&5
-echo "$as_me: WARNING: $ac_header: proceeding with the preprocessor's result" >&2;}
-    { echo "$as_me:$LINENO: WARNING: $ac_header: in the future, the compiler will take precedence" >&5
-echo "$as_me: WARNING: $ac_header: in the future, the compiler will take precedence" >&2;}
-    (
-      cat <<\_ASBOX
-## ------------------------------------------ ##
-## Report this to the AC_PACKAGE_NAME lists.  ##
-## ------------------------------------------ ##
-_ASBOX
-    ) |
-      sed "s/^/$as_me: WARNING:     /" >&2
-    ;;
-esac
-echo "$as_me:$LINENO: checking for $ac_header" >&5
-echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6
-if eval "test \"\${$as_ac_Header+set}\" = set"; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  eval "$as_ac_Header=\$ac_header_preproc"
-fi
-echo "$as_me:$LINENO: result: `eval echo '${'$as_ac_Header'}'`" >&5
-echo "${ECHO_T}`eval echo '${'$as_ac_Header'}'`" >&6
-
-fi
-if test `eval echo '${'$as_ac_Header'}'` = yes; then
-  cat >>confdefs.h <<_ACEOF
-#define `echo "HAVE_$ac_header" | $as_tr_cpp` 1
-_ACEOF
-
-fi
-
 done
 
 
-echo "$as_me:$LINENO: checking for pthread_np.h" >&5
-echo $ECHO_N "checking for pthread_np.h... $ECHO_C" >&6
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+echo $ac_n "checking for pthread_np.h""... $ac_c" 1>&6
+echo "configure:5986: checking for pthread_np.h" >&5
+cat > conftest.$ac_ext <<EOF
+#line 5988 "configure"
+#include "confdefs.h"
 
 #include <pthread.h>
 #include <pthread_np.h>
-int
-main ()
-{
+int main() {
 int i; i = 0;
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6
-		      cat >>confdefs.h <<\_ACEOF
+; return 0; }
+EOF
+if { (eval echo configure:5997: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+  rm -rf conftest*
+  echo "$ac_t""yes" 1>&6
+		      cat >> confdefs.h <<\EOF
 #define HAVE_PTHREAD_NP_H 1
-_ACEOF
+EOF
 
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  echo "$ac_t""no" 1>&6
 fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
+rm -f conftest*
 
-
-for ac_header in strings.h
+for ac_hdr in strings.h
 do
-as_ac_Header=`echo "ac_cv_header_$ac_header" | $as_tr_sh`
-if eval "test \"\${$as_ac_Header+set}\" = set"; then
-  echo "$as_me:$LINENO: checking for $ac_header" >&5
-echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6
-if eval "test \"\${$as_ac_Header+set}\" = set"; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-fi
-echo "$as_me:$LINENO: result: `eval echo '${'$as_ac_Header'}'`" >&5
-echo "${ECHO_T}`eval echo '${'$as_ac_Header'}'`" >&6
+ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
+echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
+echo "configure:6016: checking for $ac_hdr" >&5
+if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-  # Is the header compilable?
-echo "$as_me:$LINENO: checking $ac_header usability" >&5
-echo $ECHO_N "checking $ac_header usability... $ECHO_C" >&6
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-$ac_includes_default
-#include <$ac_header>
-_ACEOF
-rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_header_compiler=yes
+  cat > conftest.$ac_ext <<EOF
+#line 6021 "configure"
+#include "confdefs.h"
+#include <$ac_hdr>
+EOF
+ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
+{ (eval echo configure:6026: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
+ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
+if test -z "$ac_err"; then
+  rm -rf conftest*
+  eval "ac_cv_header_$ac_safe=yes"
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-ac_header_compiler=no
+  echo "$ac_err" >&5
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_header_$ac_safe=no"
 fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
-echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
-echo "${ECHO_T}$ac_header_compiler" >&6
-
-# Is the header present?
-echo "$as_me:$LINENO: checking $ac_header presence" >&5
-echo $ECHO_N "checking $ac_header presence... $ECHO_C" >&6
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-#include <$ac_header>
-_ACEOF
-if { (eval echo "$as_me:$LINENO: \"$ac_cpp conftest.$ac_ext\"") >&5
-  (eval $ac_cpp conftest.$ac_ext) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } >/dev/null; then
-  if test -s conftest.err; then
-    ac_cpp_err=$ac_c_preproc_warn_flag
-    ac_cpp_err=$ac_cpp_err$ac_c_werror_flag
-  else
-    ac_cpp_err=
-  fi
-else
-  ac_cpp_err=yes
+rm -f conftest*
 fi
-if test -z "$ac_cpp_err"; then
-  ac_header_preproc=yes
+if eval "test \"`echo '$ac_cv_header_'$ac_safe`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
+    ac_tr_hdr=HAVE_`echo $ac_hdr | sed 'y%abcdefghijklmnopqrstuvwxyz./-%ABCDEFGHIJKLMNOPQRSTUVWXYZ___%'`
+  cat >> confdefs.h <<EOF
+#define $ac_tr_hdr 1
+EOF
+ 
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-  ac_header_preproc=no
+  echo "$ac_t""no" 1>&6
 fi
-rm -f conftest.err conftest.$ac_ext
-echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
-echo "${ECHO_T}$ac_header_preproc" >&6
-
-# So?  What about this header?
-case $ac_header_compiler:$ac_header_preproc:$ac_c_preproc_warn_flag in
-  yes:no: )
-    { echo "$as_me:$LINENO: WARNING: $ac_header: accepted by the compiler, rejected by the preprocessor!" >&5
-echo "$as_me: WARNING: $ac_header: accepted by the compiler, rejected by the preprocessor!" >&2;}
-    { echo "$as_me:$LINENO: WARNING: $ac_header: proceeding with the compiler's result" >&5
-echo "$as_me: WARNING: $ac_header: proceeding with the compiler's result" >&2;}
-    ac_header_preproc=yes
-    ;;
-  no:yes:* )
-    { echo "$as_me:$LINENO: WARNING: $ac_header: present but cannot be compiled" >&5
-echo "$as_me: WARNING: $ac_header: present but cannot be compiled" >&2;}
-    { echo "$as_me:$LINENO: WARNING: $ac_header:     check for missing prerequisite headers?" >&5
-echo "$as_me: WARNING: $ac_header:     check for missing prerequisite headers?" >&2;}
-    { echo "$as_me:$LINENO: WARNING: $ac_header: see the Autoconf documentation" >&5
-echo "$as_me: WARNING: $ac_header: see the Autoconf documentation" >&2;}
-    { echo "$as_me:$LINENO: WARNING: $ac_header:     section \"Present But Cannot Be Compiled\"" >&5
-echo "$as_me: WARNING: $ac_header:     section \"Present But Cannot Be Compiled\"" >&2;}
-    { echo "$as_me:$LINENO: WARNING: $ac_header: proceeding with the preprocessor's result" >&5
-echo "$as_me: WARNING: $ac_header: proceeding with the preprocessor's result" >&2;}
-    { echo "$as_me:$LINENO: WARNING: $ac_header: in the future, the compiler will take precedence" >&5
-echo "$as_me: WARNING: $ac_header: in the future, the compiler will take precedence" >&2;}
-    (
-      cat <<\_ASBOX
-## ------------------------------------------ ##
-## Report this to the AC_PACKAGE_NAME lists.  ##
-## ------------------------------------------ ##
-_ASBOX
-    ) |
-      sed "s/^/$as_me: WARNING:     /" >&2
-    ;;
-esac
-echo "$as_me:$LINENO: checking for $ac_header" >&5
-echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6
-if eval "test \"\${$as_ac_Header+set}\" = set"; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  eval "$as_ac_Header=\$ac_header_preproc"
-fi
-echo "$as_me:$LINENO: result: `eval echo '${'$as_ac_Header'}'`" >&5
-echo "${ECHO_T}`eval echo '${'$as_ac_Header'}'`" >&6
-
-fi
-if test `eval echo '${'$as_ac_Header'}'` = yes; then
-  cat >>confdefs.h <<_ACEOF
-#define `echo "HAVE_$ac_header" | $as_tr_cpp` 1
-_ACEOF
-
-fi
-
 done
 
 if test "x$MACOSX" = "xyes"; then
-    cat >>confdefs.h <<\_ACEOF
+    cat >> confdefs.h <<\EOF
 #define NO_STRINGS_WITH_STRING_H 1
-_ACEOF
+EOF
 
 else
 
-echo "$as_me:$LINENO: checking if strings.h can be included after string.h" >&5
-echo $ECHO_N "checking if strings.h can be included after string.h... $ECHO_C" >&6
+echo $ac_n "checking if strings.h can be included after string.h""... $ac_c" 1>&6
+echo "configure:6060: checking if strings.h can be included after string.h" >&5
 cppflags_save=$CPPFLAGS
 CPPFLAGS="$CPPFLAGS $X_CFLAGS"
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+cat > conftest.$ac_ext <<EOF
+#line 6064 "configure"
+#include "confdefs.h"
 
 #if defined(_AIX) && !defined(_AIX51) && !defined(_NO_PROTO)
 # define _NO_PROTO	/* like in os_unix.h, causes conflict for AIX (Winn) */
@@ -10643,723 +6076,426 @@
 #if defined(HAVE_STRINGS_H)
 # include <strings.h>
 #endif
-
-int
-main ()
-{
+		
+int main() {
 int i; i = 0;
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6
+; return 0; }
+EOF
+if { (eval echo configure:6085: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+  rm -rf conftest*
+  echo "$ac_t""yes" 1>&6
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-cat >>confdefs.h <<\_ACEOF
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  cat >> confdefs.h <<\EOF
 #define NO_STRINGS_WITH_STRING_H 1
-_ACEOF
+EOF
 
-		echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
+		echo "$ac_t""no" 1>&6
 fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
+rm -f conftest*
 CPPFLAGS=$cppflags_save
 fi
 
-if test $ac_cv_c_compiler_gnu = yes; then
-    echo "$as_me:$LINENO: checking whether $CC needs -traditional" >&5
-echo $ECHO_N "checking whether $CC needs -traditional... $ECHO_C" >&6
-if test "${ac_cv_prog_gcc_traditional+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+if test $ac_cv_prog_gcc = yes; then
+    echo $ac_n "checking whether ${CC-cc} needs -traditional""... $ac_c" 1>&6
+echo "configure:6104: checking whether ${CC-cc} needs -traditional" >&5
+if eval "test \"`echo '$''{'ac_cv_prog_gcc_traditional'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
     ac_pattern="Autoconf.*'x'"
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+  cat > conftest.$ac_ext <<EOF
+#line 6110 "configure"
+#include "confdefs.h"
 #include <sgtty.h>
 Autoconf TIOCGETP
-_ACEOF
+EOF
 if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
-  $EGREP "$ac_pattern" >/dev/null 2>&1; then
+  egrep "$ac_pattern" >/dev/null 2>&1; then
+  rm -rf conftest*
   ac_cv_prog_gcc_traditional=yes
 else
+  rm -rf conftest*
   ac_cv_prog_gcc_traditional=no
 fi
 rm -f conftest*
 
 
   if test $ac_cv_prog_gcc_traditional = no; then
-    cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+    cat > conftest.$ac_ext <<EOF
+#line 6128 "configure"
+#include "confdefs.h"
 #include <termio.h>
 Autoconf TCGETA
-_ACEOF
+EOF
 if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
-  $EGREP "$ac_pattern" >/dev/null 2>&1; then
+  egrep "$ac_pattern" >/dev/null 2>&1; then
+  rm -rf conftest*
   ac_cv_prog_gcc_traditional=yes
 fi
 rm -f conftest*
 
   fi
 fi
-echo "$as_me:$LINENO: result: $ac_cv_prog_gcc_traditional" >&5
-echo "${ECHO_T}$ac_cv_prog_gcc_traditional" >&6
+
+echo "$ac_t""$ac_cv_prog_gcc_traditional" 1>&6
   if test $ac_cv_prog_gcc_traditional = yes; then
     CC="$CC -traditional"
   fi
 fi
 
-echo "$as_me:$LINENO: checking for an ANSI C-conforming const" >&5
-echo $ECHO_N "checking for an ANSI C-conforming const... $ECHO_C" >&6
-if test "${ac_cv_c_const+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+echo $ac_n "checking for working const""... $ac_c" 1>&6
+echo "configure:6150: checking for working const" >&5
+if eval "test \"`echo '$''{'ac_cv_c_const'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+  cat > conftest.$ac_ext <<EOF
+#line 6155 "configure"
+#include "confdefs.h"
 
-int
-main ()
-{
-/* FIXME: Include the comments suggested by Paul. */
-#ifndef __cplusplus
-  /* Ultrix mips cc rejects this.  */
-  typedef int charset[2];
-  const charset x;
-  /* SunOS 4.1.1 cc rejects this.  */
-  char const *const *ccp;
-  char **p;
-  /* NEC SVR4.0.2 mips cc rejects this.  */
-  struct point {int x, y;};
-  static struct point const zero = {0,0};
-  /* AIX XL C 1.02.0.0 rejects this.
-     It does not let you subtract one const X* pointer from another in
-     an arm of an if-expression whose if-part is not a constant
-     expression */
-  const char *g = "string";
-  ccp = &g + (g ? g-g : 0);
-  /* HPUX 7.0 cc rejects these. */
-  ++ccp;
-  p = (char**) ccp;
-  ccp = (char const *const *) p;
-  { /* SCO 3.2v4 cc rejects this.  */
-    char *t;
-    char const *s = 0 ? (char *) 0 : (char const *) 0;
+int main() {
 
-    *t++ = 0;
-  }
-  { /* Someone thinks the Sun supposedly-ANSI compiler will reject this.  */
-    int x[] = {25, 17};
-    const int *foo = &x[0];
-    ++foo;
-  }
-  { /* Sun SC1.0 ANSI compiler rejects this -- but not the above. */
-    typedef const int *iptr;
-    iptr p = 0;
-    ++p;
-  }
-  { /* AIX XL C 1.02.0.0 rejects this saying
-       "k.c", line 2.27: 1506-025 (S) Operand must be a modifiable lvalue. */
-    struct s { int j; const int *ap[3]; };
-    struct s *b; b->j = 5;
-  }
-  { /* ULTRIX-32 V3.1 (Rev 9) vcc rejects this */
-    const int foo = 10;
-  }
-#endif
+/* Ultrix mips cc rejects this.  */
+typedef int charset[2]; const charset x;
+/* SunOS 4.1.1 cc rejects this.  */
+char const *const *ccp;
+char **p;
+/* NEC SVR4.0.2 mips cc rejects this.  */
+struct point {int x, y;};
+static struct point const zero = {0,0};
+/* AIX XL C 1.02.0.0 rejects this.
+   It does not let you subtract one const X* pointer from another in an arm
+   of an if-expression whose if-part is not a constant expression */
+const char *g = "string";
+ccp = &g + (g ? g-g : 0);
+/* HPUX 7.0 cc rejects these. */
+++ccp;
+p = (char**) ccp;
+ccp = (char const *const *) p;
+{ /* SCO 3.2v4 cc rejects this.  */
+  char *t;
+  char const *s = 0 ? (char *) 0 : (char const *) 0;
 
-  ;
-  return 0;
+  *t++ = 0;
 }
-_ACEOF
-rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
+{ /* Someone thinks the Sun supposedly-ANSI compiler will reject this.  */
+  int x[] = {25, 17};
+  const int *foo = &x[0];
+  ++foo;
+}
+{ /* Sun SC1.0 ANSI compiler rejects this -- but not the above. */
+  typedef const int *iptr;
+  iptr p = 0;
+  ++p;
+}
+{ /* AIX XL C 1.02.0.0 rejects this saying
+     "k.c", line 2.27: 1506-025 (S) Operand must be a modifiable lvalue. */
+  struct s { int j; const int *ap[3]; };
+  struct s *b; b->j = 5;
+}
+{ /* ULTRIX-32 V3.1 (Rev 9) vcc rejects this */
+  const int foo = 10;
+}
+
+; return 0; }
+EOF
+if { (eval echo configure:6204: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+  rm -rf conftest*
   ac_cv_c_const=yes
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-ac_cv_c_const=no
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  ac_cv_c_const=no
 fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
+rm -f conftest*
 fi
-echo "$as_me:$LINENO: result: $ac_cv_c_const" >&5
-echo "${ECHO_T}$ac_cv_c_const" >&6
+
+echo "$ac_t""$ac_cv_c_const" 1>&6
 if test $ac_cv_c_const = no; then
+  cat >> confdefs.h <<\EOF
+#define const 
+EOF
 
-cat >>confdefs.h <<\_ACEOF
-#define const
-_ACEOF
-
 fi
 
-echo "$as_me:$LINENO: checking for mode_t" >&5
-echo $ECHO_N "checking for mode_t... $ECHO_C" >&6
-if test "${ac_cv_type_mode_t+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+echo $ac_n "checking for mode_t""... $ac_c" 1>&6
+echo "configure:6225: checking for mode_t" >&5
+if eval "test \"`echo '$''{'ac_cv_type_mode_t'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-$ac_includes_default
-int
-main ()
-{
-if ((mode_t *) 0)
-  return 0;
-if (sizeof (mode_t))
-  return 0;
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
+  cat > conftest.$ac_ext <<EOF
+#line 6230 "configure"
+#include "confdefs.h"
+#include <sys/types.h>
+#if STDC_HEADERS
+#include <stdlib.h>
+#include <stddef.h>
+#endif
+EOF
+if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+  egrep "(^|[^a-zA-Z_0-9])mode_t[^a-zA-Z_0-9]" >/dev/null 2>&1; then
+  rm -rf conftest*
   ac_cv_type_mode_t=yes
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-ac_cv_type_mode_t=no
+  rm -rf conftest*
+  ac_cv_type_mode_t=no
 fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
-fi
-echo "$as_me:$LINENO: result: $ac_cv_type_mode_t" >&5
-echo "${ECHO_T}$ac_cv_type_mode_t" >&6
-if test $ac_cv_type_mode_t = yes; then
-  :
-else
+rm -f conftest*
 
-cat >>confdefs.h <<_ACEOF
+fi
+echo "$ac_t""$ac_cv_type_mode_t" 1>&6
+if test $ac_cv_type_mode_t = no; then
+  cat >> confdefs.h <<\EOF
 #define mode_t int
-_ACEOF
+EOF
 
 fi
 
-echo "$as_me:$LINENO: checking for off_t" >&5
-echo $ECHO_N "checking for off_t... $ECHO_C" >&6
-if test "${ac_cv_type_off_t+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+echo $ac_n "checking for off_t""... $ac_c" 1>&6
+echo "configure:6258: checking for off_t" >&5
+if eval "test \"`echo '$''{'ac_cv_type_off_t'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-$ac_includes_default
-int
-main ()
-{
-if ((off_t *) 0)
-  return 0;
-if (sizeof (off_t))
-  return 0;
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
+  cat > conftest.$ac_ext <<EOF
+#line 6263 "configure"
+#include "confdefs.h"
+#include <sys/types.h>
+#if STDC_HEADERS
+#include <stdlib.h>
+#include <stddef.h>
+#endif
+EOF
+if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+  egrep "(^|[^a-zA-Z_0-9])off_t[^a-zA-Z_0-9]" >/dev/null 2>&1; then
+  rm -rf conftest*
   ac_cv_type_off_t=yes
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-ac_cv_type_off_t=no
+  rm -rf conftest*
+  ac_cv_type_off_t=no
 fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
-fi
-echo "$as_me:$LINENO: result: $ac_cv_type_off_t" >&5
-echo "${ECHO_T}$ac_cv_type_off_t" >&6
-if test $ac_cv_type_off_t = yes; then
-  :
-else
+rm -f conftest*
 
-cat >>confdefs.h <<_ACEOF
+fi
+echo "$ac_t""$ac_cv_type_off_t" 1>&6
+if test $ac_cv_type_off_t = no; then
+  cat >> confdefs.h <<\EOF
 #define off_t long
-_ACEOF
+EOF
 
 fi
 
-echo "$as_me:$LINENO: checking for pid_t" >&5
-echo $ECHO_N "checking for pid_t... $ECHO_C" >&6
-if test "${ac_cv_type_pid_t+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+echo $ac_n "checking for pid_t""... $ac_c" 1>&6
+echo "configure:6291: checking for pid_t" >&5
+if eval "test \"`echo '$''{'ac_cv_type_pid_t'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-$ac_includes_default
-int
-main ()
-{
-if ((pid_t *) 0)
-  return 0;
-if (sizeof (pid_t))
-  return 0;
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
+  cat > conftest.$ac_ext <<EOF
+#line 6296 "configure"
+#include "confdefs.h"
+#include <sys/types.h>
+#if STDC_HEADERS
+#include <stdlib.h>
+#include <stddef.h>
+#endif
+EOF
+if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+  egrep "(^|[^a-zA-Z_0-9])pid_t[^a-zA-Z_0-9]" >/dev/null 2>&1; then
+  rm -rf conftest*
   ac_cv_type_pid_t=yes
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-ac_cv_type_pid_t=no
+  rm -rf conftest*
+  ac_cv_type_pid_t=no
 fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
-fi
-echo "$as_me:$LINENO: result: $ac_cv_type_pid_t" >&5
-echo "${ECHO_T}$ac_cv_type_pid_t" >&6
-if test $ac_cv_type_pid_t = yes; then
-  :
-else
+rm -f conftest*
 
-cat >>confdefs.h <<_ACEOF
+fi
+echo "$ac_t""$ac_cv_type_pid_t" 1>&6
+if test $ac_cv_type_pid_t = no; then
+  cat >> confdefs.h <<\EOF
 #define pid_t int
-_ACEOF
+EOF
 
 fi
 
-echo "$as_me:$LINENO: checking for size_t" >&5
-echo $ECHO_N "checking for size_t... $ECHO_C" >&6
-if test "${ac_cv_type_size_t+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+echo $ac_n "checking for size_t""... $ac_c" 1>&6
+echo "configure:6324: checking for size_t" >&5
+if eval "test \"`echo '$''{'ac_cv_type_size_t'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-$ac_includes_default
-int
-main ()
-{
-if ((size_t *) 0)
-  return 0;
-if (sizeof (size_t))
-  return 0;
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
+  cat > conftest.$ac_ext <<EOF
+#line 6329 "configure"
+#include "confdefs.h"
+#include <sys/types.h>
+#if STDC_HEADERS
+#include <stdlib.h>
+#include <stddef.h>
+#endif
+EOF
+if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+  egrep "(^|[^a-zA-Z_0-9])size_t[^a-zA-Z_0-9]" >/dev/null 2>&1; then
+  rm -rf conftest*
   ac_cv_type_size_t=yes
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-ac_cv_type_size_t=no
+  rm -rf conftest*
+  ac_cv_type_size_t=no
 fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
-fi
-echo "$as_me:$LINENO: result: $ac_cv_type_size_t" >&5
-echo "${ECHO_T}$ac_cv_type_size_t" >&6
-if test $ac_cv_type_size_t = yes; then
-  :
-else
+rm -f conftest*
 
-cat >>confdefs.h <<_ACEOF
+fi
+echo "$ac_t""$ac_cv_type_size_t" 1>&6
+if test $ac_cv_type_size_t = no; then
+  cat >> confdefs.h <<\EOF
 #define size_t unsigned
-_ACEOF
+EOF
 
 fi
 
-echo "$as_me:$LINENO: checking for uid_t in sys/types.h" >&5
-echo $ECHO_N "checking for uid_t in sys/types.h... $ECHO_C" >&6
-if test "${ac_cv_type_uid_t+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+echo $ac_n "checking for uid_t in sys/types.h""... $ac_c" 1>&6
+echo "configure:6357: checking for uid_t in sys/types.h" >&5
+if eval "test \"`echo '$''{'ac_cv_type_uid_t'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+  cat > conftest.$ac_ext <<EOF
+#line 6362 "configure"
+#include "confdefs.h"
 #include <sys/types.h>
-
-_ACEOF
+EOF
 if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
-  $EGREP "uid_t" >/dev/null 2>&1; then
+  egrep "uid_t" >/dev/null 2>&1; then
+  rm -rf conftest*
   ac_cv_type_uid_t=yes
 else
+  rm -rf conftest*
   ac_cv_type_uid_t=no
 fi
 rm -f conftest*
 
 fi
-echo "$as_me:$LINENO: result: $ac_cv_type_uid_t" >&5
-echo "${ECHO_T}$ac_cv_type_uid_t" >&6
-if test $ac_cv_type_uid_t = no; then
 
-cat >>confdefs.h <<\_ACEOF
+echo "$ac_t""$ac_cv_type_uid_t" 1>&6
+if test $ac_cv_type_uid_t = no; then
+  cat >> confdefs.h <<\EOF
 #define uid_t int
-_ACEOF
+EOF
 
-
-cat >>confdefs.h <<\_ACEOF
+  cat >> confdefs.h <<\EOF
 #define gid_t int
-_ACEOF
+EOF
 
 fi
 
-echo "$as_me:$LINENO: checking whether time.h and sys/time.h may both be included" >&5
-echo $ECHO_N "checking whether time.h and sys/time.h may both be included... $ECHO_C" >&6
-if test "${ac_cv_header_time+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+echo $ac_n "checking whether time.h and sys/time.h may both be included""... $ac_c" 1>&6
+echo "configure:6391: checking whether time.h and sys/time.h may both be included" >&5
+if eval "test \"`echo '$''{'ac_cv_header_time'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+  cat > conftest.$ac_ext <<EOF
+#line 6396 "configure"
+#include "confdefs.h"
 #include <sys/types.h>
 #include <sys/time.h>
 #include <time.h>
-
-int
-main ()
-{
-if ((struct tm *) 0)
-return 0;
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
+int main() {
+struct tm *tp;
+; return 0; }
+EOF
+if { (eval echo configure:6405: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+  rm -rf conftest*
   ac_cv_header_time=yes
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-ac_cv_header_time=no
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  ac_cv_header_time=no
 fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
+rm -f conftest*
 fi
-echo "$as_me:$LINENO: result: $ac_cv_header_time" >&5
-echo "${ECHO_T}$ac_cv_header_time" >&6
-if test $ac_cv_header_time = yes; then
 
-cat >>confdefs.h <<\_ACEOF
+echo "$ac_t""$ac_cv_header_time" 1>&6
+if test $ac_cv_header_time = yes; then
+  cat >> confdefs.h <<\EOF
 #define TIME_WITH_SYS_TIME 1
-_ACEOF
+EOF
 
 fi
 
-echo "$as_me:$LINENO: checking for ino_t" >&5
-echo $ECHO_N "checking for ino_t... $ECHO_C" >&6
-if test "${ac_cv_type_ino_t+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+echo $ac_n "checking for ino_t""... $ac_c" 1>&6
+echo "configure:6426: checking for ino_t" >&5
+if eval "test \"`echo '$''{'ac_cv_type_ino_t'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-$ac_includes_default
-int
-main ()
-{
-if ((ino_t *) 0)
-  return 0;
-if (sizeof (ino_t))
-  return 0;
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
+  cat > conftest.$ac_ext <<EOF
+#line 6431 "configure"
+#include "confdefs.h"
+#include <sys/types.h>
+#if STDC_HEADERS
+#include <stdlib.h>
+#include <stddef.h>
+#endif
+EOF
+if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+  egrep "(^|[^a-zA-Z_0-9])ino_t[^a-zA-Z_0-9]" >/dev/null 2>&1; then
+  rm -rf conftest*
   ac_cv_type_ino_t=yes
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-ac_cv_type_ino_t=no
+  rm -rf conftest*
+  ac_cv_type_ino_t=no
 fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
-fi
-echo "$as_me:$LINENO: result: $ac_cv_type_ino_t" >&5
-echo "${ECHO_T}$ac_cv_type_ino_t" >&6
-if test $ac_cv_type_ino_t = yes; then
-  :
-else
+rm -f conftest*
 
-cat >>confdefs.h <<_ACEOF
+fi
+echo "$ac_t""$ac_cv_type_ino_t" 1>&6
+if test $ac_cv_type_ino_t = no; then
+  cat >> confdefs.h <<\EOF
 #define ino_t long
-_ACEOF
+EOF
 
 fi
 
-echo "$as_me:$LINENO: checking for dev_t" >&5
-echo $ECHO_N "checking for dev_t... $ECHO_C" >&6
-if test "${ac_cv_type_dev_t+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+echo $ac_n "checking for dev_t""... $ac_c" 1>&6
+echo "configure:6459: checking for dev_t" >&5
+if eval "test \"`echo '$''{'ac_cv_type_dev_t'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-$ac_includes_default
-int
-main ()
-{
-if ((dev_t *) 0)
-  return 0;
-if (sizeof (dev_t))
-  return 0;
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
+  cat > conftest.$ac_ext <<EOF
+#line 6464 "configure"
+#include "confdefs.h"
+#include <sys/types.h>
+#if STDC_HEADERS
+#include <stdlib.h>
+#include <stddef.h>
+#endif
+EOF
+if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+  egrep "(^|[^a-zA-Z_0-9])dev_t[^a-zA-Z_0-9]" >/dev/null 2>&1; then
+  rm -rf conftest*
   ac_cv_type_dev_t=yes
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-ac_cv_type_dev_t=no
+  rm -rf conftest*
+  ac_cv_type_dev_t=no
 fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
-fi
-echo "$as_me:$LINENO: result: $ac_cv_type_dev_t" >&5
-echo "${ECHO_T}$ac_cv_type_dev_t" >&6
-if test $ac_cv_type_dev_t = yes; then
-  :
-else
+rm -f conftest*
 
-cat >>confdefs.h <<_ACEOF
+fi
+echo "$ac_t""$ac_cv_type_dev_t" 1>&6
+if test $ac_cv_type_dev_t = no; then
+  cat >> confdefs.h <<\EOF
 #define dev_t unsigned
-_ACEOF
+EOF
 
 fi
 
 
-echo "$as_me:$LINENO: checking for rlim_t" >&5
-echo $ECHO_N "checking for rlim_t... $ECHO_C" >&6
+echo $ac_n "checking for rlim_t""... $ac_c" 1>&6
+echo "configure:6493: checking for rlim_t" >&5
 if eval "test \"`echo '$''{'ac_cv_type_rlim_t'+set}'`\" = set"; then
-  echo "$as_me:$LINENO: result: (cached) $ac_cv_type_rlim_t" >&5
-echo "${ECHO_T}(cached) $ac_cv_type_rlim_t" >&6
+  echo "$ac_t""(cached) $ac_cv_type_rlim_t" 1>&6
 else
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+  cat > conftest.$ac_ext <<EOF
+#line 6498 "configure"
+#include "confdefs.h"
 
 #include <sys/types.h>
 #if STDC_HEADERS
@@ -11369,18 +6505,19 @@
 #ifdef HAVE_SYS_RESOURCE_H
 #include <sys/resource.h>
 #endif
-
-_ACEOF
+	  
+EOF
 if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
-  $EGREP "(^|[^a-zA-Z_0-9])rlim_t[^a-zA-Z_0-9]" >/dev/null 2>&1; then
+  egrep "(^|[^a-zA-Z_0-9])rlim_t[^a-zA-Z_0-9]" >/dev/null 2>&1; then
+  rm -rf conftest*
   ac_cv_type_rlim_t=yes
 else
+  rm -rf conftest*
   ac_cv_type_rlim_t=no
 fi
 rm -f conftest*
 
-	  echo "$as_me:$LINENO: result: $ac_cv_type_rlim_t" >&5
-echo "${ECHO_T}$ac_cv_type_rlim_t" >&6
+	  echo "$ac_t""$ac_cv_type_rlim_t" 1>&6
 fi
 if test $ac_cv_type_rlim_t = no; then
   cat >> confdefs.h <<\EOF
@@ -11388,18 +6525,14 @@
 EOF
 fi
 
-echo "$as_me:$LINENO: checking for stack_t" >&5
-echo $ECHO_N "checking for stack_t... $ECHO_C" >&6
+echo $ac_n "checking for stack_t""... $ac_c" 1>&6
+echo "configure:6530: checking for stack_t" >&5
 if eval "test \"`echo '$''{'ac_cv_type_stack_t'+set}'`\" = set"; then
-  echo "$as_me:$LINENO: result: (cached) $ac_cv_type_stack_t" >&5
-echo "${ECHO_T}(cached) $ac_cv_type_stack_t" >&6
+  echo "$ac_t""(cached) $ac_cv_type_stack_t" 1>&6
 else
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+  cat > conftest.$ac_ext <<EOF
+#line 6535 "configure"
+#include "confdefs.h"
 
 #include <sys/types.h>
 #if STDC_HEADERS
@@ -11407,18 +6540,19 @@
 #include <stddef.h>
 #endif
 #include <signal.h>
-
-_ACEOF
+	  
+EOF
 if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
-  $EGREP "stack_t" >/dev/null 2>&1; then
+  egrep "stack_t" >/dev/null 2>&1; then
+  rm -rf conftest*
   ac_cv_type_stack_t=yes
 else
+  rm -rf conftest*
   ac_cv_type_stack_t=no
 fi
 rm -f conftest*
 
-	  echo "$as_me:$LINENO: result: $ac_cv_type_stack_t" >&5
-echo "${ECHO_T}$ac_cv_type_stack_t" >&6
+	  echo "$ac_t""$ac_cv_type_stack_t" 1>&6
 fi
 if test $ac_cv_type_stack_t = no; then
   cat >> confdefs.h <<\EOF
@@ -11426,14 +6560,11 @@
 EOF
 fi
 
-echo "$as_me:$LINENO: checking whether stack_t has an ss_base field" >&5
-echo $ECHO_N "checking whether stack_t has an ss_base field... $ECHO_C" >&6
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+echo $ac_n "checking whether stack_t has an ss_base field""... $ac_c" 1>&6
+echo "configure:6565: checking whether stack_t has an ss_base field" >&5
+cat > conftest.$ac_ext <<EOF
+#line 6567 "configure"
+#include "confdefs.h"
 
 #include <sys/types.h>
 #if STDC_HEADERS
@@ -11442,851 +6573,470 @@
 #endif
 #include <signal.h>
 #include "confdefs.h"
-
-int
-main ()
-{
-stack_t sigstk; sigstk.ss_base = 0;
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6; cat >>confdefs.h <<\_ACEOF
+			
+int main() {
+stack_t sigstk; sigstk.ss_base = 0; 
+; return 0; }
+EOF
+if { (eval echo configure:6582: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+  rm -rf conftest*
+  echo "$ac_t""yes" 1>&6; cat >> confdefs.h <<\EOF
 #define HAVE_SS_BASE 1
-_ACEOF
+EOF
 
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  echo "$ac_t""no" 1>&6
 fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
+rm -f conftest*
 
 olibs="$LIBS"
-echo "$as_me:$LINENO: checking --with-tlib argument" >&5
-echo $ECHO_N "checking --with-tlib argument... $ECHO_C" >&6
-
+echo $ac_n "checking --with-tlib argument""... $ac_c" 1>&6
+echo "configure:6598: checking --with-tlib argument" >&5
 # Check whether --with-tlib or --without-tlib was given.
 if test "${with_tlib+set}" = set; then
   withval="$with_tlib"
+  :
+fi
 
-fi;
 if test -n "$with_tlib"; then
-  echo "$as_me:$LINENO: result: $with_tlib" >&5
-echo "${ECHO_T}$with_tlib" >&6
+  echo "$ac_t""$with_tlib" 1>&6
   LIBS="$LIBS -l$with_tlib"
-  echo "$as_me:$LINENO: checking for linking with $with_tlib library" >&5
-echo $ECHO_N "checking for linking with $with_tlib library... $ECHO_C" >&6
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+  echo $ac_n "checking for linking with $with_tlib library""... $ac_c" 1>&6
+echo "configure:6609: checking for linking with $with_tlib library" >&5
+  cat > conftest.$ac_ext <<EOF
+#line 6611 "configure"
+#include "confdefs.h"
 
-int
-main ()
-{
+int main() {
 
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  echo "$as_me:$LINENO: result: OK" >&5
-echo "${ECHO_T}OK" >&6
+; return 0; }
+EOF
+if { (eval echo configure:6618: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  echo "$ac_t""OK" 1>&6
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-{ { echo "$as_me:$LINENO: error: FAILED" >&5
-echo "$as_me: error: FAILED" >&2;}
-   { (exit 1); exit 1; }; }
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  { echo "configure: error: FAILED" 1>&2; exit 1; }
 fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
+rm -f conftest*
     olibs="$LIBS"
 else
-  echo "$as_me:$LINENO: result: empty: automatic terminal library selection" >&5
-echo "${ECHO_T}empty: automatic terminal library selection" >&6
+  echo "$ac_t""empty: automatic terminal library selection" 1>&6
             case "`uname -s 2>/dev/null`" in
 	OSF1)	tlibs="ncurses curses termlib termcap";;
 	*)	tlibs="ncurses termlib termcap curses";;
   esac
   for libname in $tlibs; do
-
-as_ac_Lib=`echo "ac_cv_lib_${libname}''_tgetent" | $as_tr_sh`
-echo "$as_me:$LINENO: checking for tgetent in -l${libname}" >&5
-echo $ECHO_N "checking for tgetent in -l${libname}... $ECHO_C" >&6
-if eval "test \"\${$as_ac_Lib+set}\" = set"; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+    echo $ac_n "checking for tgetent in -l${libname}""... $ac_c" 1>&6
+echo "configure:6637: checking for tgetent in -l${libname}" >&5
+ac_lib_var=`echo ${libname}'_'tgetent | sed 'y%./+-%__p_%'`
+if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-  ac_check_lib_save_LIBS=$LIBS
+  ac_save_LIBS="$LIBS"
 LIBS="-l${libname}  $LIBS"
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
+cat > conftest.$ac_ext <<EOF
+#line 6645 "configure"
+#include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
-#ifdef __cplusplus
-extern "C"
-#endif
 /* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
-char tgetent ();
-int
-main ()
-{
-tgetent ();
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  eval "$as_ac_Lib=yes"
+    builtin and then its argument prototype would still apply.  */
+char tgetent();
+
+int main() {
+tgetent()
+; return 0; }
+EOF
+if { (eval echo configure:6656: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=yes"
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=no"
+fi
+rm -f conftest*
+LIBS="$ac_save_LIBS"
 
-eval "$as_ac_Lib=no"
 fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
-fi
-echo "$as_me:$LINENO: result: `eval echo '${'$as_ac_Lib'}'`" >&5
-echo "${ECHO_T}`eval echo '${'$as_ac_Lib'}'`" >&6
-if test `eval echo '${'$as_ac_Lib'}'` = yes; then
-  cat >>confdefs.h <<_ACEOF
-#define `echo "HAVE_LIB${libname}" | $as_tr_cpp` 1
-_ACEOF
+if eval "test \"`echo '$ac_cv_lib_'$ac_lib_var`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
+    ac_tr_lib=HAVE_LIB`echo ${libname} | sed -e 's/[^a-zA-Z0-9_]/_/g' \
+    -e 'y/abcdefghijklmnopqrstuvwxyz/ABCDEFGHIJKLMNOPQRSTUVWXYZ/'`
+  cat >> confdefs.h <<EOF
+#define $ac_tr_lib 1
+EOF
 
   LIBS="-l${libname} $LIBS"
 
+else
+  echo "$ac_t""no" 1>&6
 fi
 
     if test "x$olibs" != "x$LIBS"; then
                         if test "$cross_compiling" = yes; then
   res="FAIL"
 else
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+  cat > conftest.$ac_ext <<EOF
+#line 6688 "configure"
+#include "confdefs.h"
 
 #ifdef HAVE_TERMCAP_H
 # include <termcap.h>
 #endif
 main() {char *s; s=(char *)tgoto("%p1%d", 0, 1); exit(0); }
-_ACEOF
-rm -f conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && { ac_try='./conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
+EOF
+if { (eval echo configure:6696: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
+then
   res="OK"
 else
-  echo "$as_me: program exited with status $ac_status" >&5
-echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-( exit $ac_status )
-res="FAIL"
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -fr conftest*
+  res="FAIL"
 fi
-rm -f core *.core gmon.out bb.out conftest$ac_exeext conftest.$ac_objext conftest.$ac_ext
+rm -fr conftest*
 fi
+
       if test "$res" = "OK"; then
 	break
       fi
-      echo "$as_me:$LINENO: result: $libname library is not usable" >&5
-echo "${ECHO_T}$libname library is not usable" >&6
+      echo "$ac_t""$libname library is not usable" 1>&6
       LIBS="$olibs"
     fi
   done
   if test "x$olibs" = "x$LIBS"; then
-    echo "$as_me:$LINENO: result: no terminal library found" >&5
-echo "${ECHO_T}no terminal library found" >&6
+    echo "$ac_t""no terminal library found" 1>&6
   fi
 fi
 
 if test "x$olibs" = "x$LIBS"; then
-  echo "$as_me:$LINENO: checking for tgetent()" >&5
-echo $ECHO_N "checking for tgetent()... $ECHO_C" >&6
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+  echo $ac_n "checking for tgetent()""... $ac_c" 1>&6
+echo "configure:6722: checking for tgetent()" >&5
+  cat > conftest.$ac_ext <<EOF
+#line 6724 "configure"
+#include "confdefs.h"
 
-int
-main ()
-{
+int main() {
 char s[10000]; int res = tgetent(s, "thisterminaldoesnotexist");
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6
+; return 0; }
+EOF
+if { (eval echo configure:6731: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  echo "$ac_t""yes" 1>&6
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-{ { echo "$as_me:$LINENO: error: NOT FOUND!
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  { echo "configure: error: NOT FOUND!
       You need to install a terminal library; for example ncurses.
-      Or specify the name of the library with --with-tlib." >&5
-echo "$as_me: error: NOT FOUND!
-      You need to install a terminal library; for example ncurses.
-      Or specify the name of the library with --with-tlib." >&2;}
-   { (exit 1); exit 1; }; }
+      Or specify the name of the library with --with-tlib." 1>&2; exit 1; }
 fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
+rm -f conftest*
 fi
 
-echo "$as_me:$LINENO: checking whether we talk terminfo" >&5
-echo $ECHO_N "checking whether we talk terminfo... $ECHO_C" >&6
+echo $ac_n "checking whether we talk terminfo""... $ac_c" 1>&6
+echo "configure:6746: checking whether we talk terminfo" >&5
 if test "$cross_compiling" = yes; then
-  { { echo "$as_me:$LINENO: error: failed to compile test program." >&5
-echo "$as_me: error: failed to compile test program." >&2;}
-   { (exit 1); exit 1; }; }
+  { echo "configure: error: failed to compile test program." 1>&2; exit 1; }
 else
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+  cat > conftest.$ac_ext <<EOF
+#line 6751 "configure"
+#include "confdefs.h"
 
 #ifdef HAVE_TERMCAP_H
 # include <termcap.h>
 #endif
 main()
 {char *s; s=(char *)tgoto("%p1%d", 0, 1); exit(!strcmp(s==0 ? "" : s, "1")); }
-_ACEOF
-rm -f conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && { ac_try='./conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  echo "$as_me:$LINENO: result: no -- we are in termcap land" >&5
-echo "${ECHO_T}no -- we are in termcap land" >&6
+EOF
+if { (eval echo configure:6760: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
+then
+  echo "$ac_t""no -- we are in termcap land" 1>&6
 else
-  echo "$as_me: program exited with status $ac_status" >&5
-echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-( exit $ac_status )
-echo "$as_me:$LINENO: result: yes -- terminfo spoken here" >&5
-echo "${ECHO_T}yes -- terminfo spoken here" >&6; cat >>confdefs.h <<\_ACEOF
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -fr conftest*
+  echo "$ac_t""yes -- terminfo spoken here" 1>&6; cat >> confdefs.h <<\EOF
 #define TERMINFO 1
-_ACEOF
+EOF
 
 fi
-rm -f core *.core gmon.out bb.out conftest$ac_exeext conftest.$ac_objext conftest.$ac_ext
+rm -fr conftest*
 fi
 
+
 if test "x$olibs" != "x$LIBS"; then
-  echo "$as_me:$LINENO: checking what tgetent() returns for an unknown terminal" >&5
-echo $ECHO_N "checking what tgetent() returns for an unknown terminal... $ECHO_C" >&6
+  echo $ac_n "checking what tgetent() returns for an unknown terminal""... $ac_c" 1>&6
+echo "configure:6778: checking what tgetent() returns for an unknown terminal" >&5
   if test "$cross_compiling" = yes; then
-  { { echo "$as_me:$LINENO: error: failed to compile test program." >&5
-echo "$as_me: error: failed to compile test program." >&2;}
-   { (exit 1); exit 1; }; }
+  { echo "configure: error: failed to compile test program." 1>&2; exit 1; }
 else
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+  cat > conftest.$ac_ext <<EOF
+#line 6783 "configure"
+#include "confdefs.h"
 
 #ifdef HAVE_TERMCAP_H
 # include <termcap.h>
 #endif
 main()
 {char s[10000]; int res = tgetent(s, "thisterminaldoesnotexist"); exit(res != 0); }
-_ACEOF
-rm -f conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && { ac_try='./conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  echo "$as_me:$LINENO: result: zero" >&5
-echo "${ECHO_T}zero" >&6; cat >>confdefs.h <<\_ACEOF
+EOF
+if { (eval echo configure:6792: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
+then
+  echo "$ac_t""zero" 1>&6; cat >> confdefs.h <<\EOF
 #define TGETENT_ZERO_ERR 0
-_ACEOF
+EOF
 
 else
-  echo "$as_me: program exited with status $ac_status" >&5
-echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-( exit $ac_status )
-echo "$as_me:$LINENO: result: non-zero" >&5
-echo "${ECHO_T}non-zero" >&6
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -fr conftest*
+  echo "$ac_t""non-zero" 1>&6
 fi
-rm -f core *.core gmon.out bb.out conftest$ac_exeext conftest.$ac_objext conftest.$ac_ext
+rm -fr conftest*
 fi
+
 fi
 
-echo "$as_me:$LINENO: checking whether termcap.h contains ospeed" >&5
-echo $ECHO_N "checking whether termcap.h contains ospeed... $ECHO_C" >&6
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+echo $ac_n "checking whether termcap.h contains ospeed""... $ac_c" 1>&6
+echo "configure:6810: checking whether termcap.h contains ospeed" >&5
+cat > conftest.$ac_ext <<EOF
+#line 6812 "configure"
+#include "confdefs.h"
 
 #ifdef HAVE_TERMCAP_H
 # include <termcap.h>
 #endif
-
-int
-main ()
-{
+			
+int main() {
 ospeed = 20000
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6; cat >>confdefs.h <<\_ACEOF
+; return 0; }
+EOF
+if { (eval echo configure:6823: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  echo "$ac_t""yes" 1>&6; cat >> confdefs.h <<\EOF
 #define HAVE_OSPEED 1
-_ACEOF
+EOF
 
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  echo "$ac_t""no" 1>&6
+	echo $ac_n "checking whether ospeed can be extern""... $ac_c" 1>&6
+echo "configure:6835: checking whether ospeed can be extern" >&5
+	cat > conftest.$ac_ext <<EOF
+#line 6837 "configure"
+#include "confdefs.h"
 
-echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
-	echo "$as_me:$LINENO: checking whether ospeed can be extern" >&5
-echo $ECHO_N "checking whether ospeed can be extern... $ECHO_C" >&6
-	cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
 #ifdef HAVE_TERMCAP_H
 # include <termcap.h>
 #endif
 extern short ospeed;
-
-int
-main ()
-{
+			
+int main() {
 ospeed = 20000
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6; cat >>confdefs.h <<\_ACEOF
+; return 0; }
+EOF
+if { (eval echo configure:6849: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  echo "$ac_t""yes" 1>&6; cat >> confdefs.h <<\EOF
 #define OSPEED_EXTERN 1
-_ACEOF
+EOF
 
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  echo "$ac_t""no" 1>&6
 fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
-
+rm -f conftest*
+	
 fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
+rm -f conftest*
 
-echo "$as_me:$LINENO: checking whether termcap.h contains UP, BC and PC" >&5
-echo $ECHO_N "checking whether termcap.h contains UP, BC and PC... $ECHO_C" >&6
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+echo $ac_n "checking whether termcap.h contains UP, BC and PC""... $ac_c" 1>&6
+echo "configure:6867: checking whether termcap.h contains UP, BC and PC" >&5
+cat > conftest.$ac_ext <<EOF
+#line 6869 "configure"
+#include "confdefs.h"
 
 #ifdef HAVE_TERMCAP_H
 # include <termcap.h>
 #endif
-
-int
-main ()
-{
+			
+int main() {
 if (UP == 0 && BC == 0) PC = 1
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6; cat >>confdefs.h <<\_ACEOF
+; return 0; }
+EOF
+if { (eval echo configure:6880: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  echo "$ac_t""yes" 1>&6; cat >> confdefs.h <<\EOF
 #define HAVE_UP_BC_PC 1
-_ACEOF
+EOF
 
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  echo "$ac_t""no" 1>&6
+	echo $ac_n "checking whether UP, BC and PC can be extern""... $ac_c" 1>&6
+echo "configure:6892: checking whether UP, BC and PC can be extern" >&5
+	cat > conftest.$ac_ext <<EOF
+#line 6894 "configure"
+#include "confdefs.h"
 
-echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
-	echo "$as_me:$LINENO: checking whether UP, BC and PC can be extern" >&5
-echo $ECHO_N "checking whether UP, BC and PC can be extern... $ECHO_C" >&6
-	cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
 #ifdef HAVE_TERMCAP_H
 # include <termcap.h>
 #endif
 extern char *UP, *BC, PC;
-
-int
-main ()
-{
+			
+int main() {
 if (UP == 0 && BC == 0) PC = 1
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6; cat >>confdefs.h <<\_ACEOF
+; return 0; }
+EOF
+if { (eval echo configure:6906: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  echo "$ac_t""yes" 1>&6; cat >> confdefs.h <<\EOF
 #define UP_BC_PC_EXTERN 1
-_ACEOF
+EOF
 
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  echo "$ac_t""no" 1>&6
 fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
-
+rm -f conftest*
+	
 fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
+rm -f conftest*
 
-echo "$as_me:$LINENO: checking whether tputs() uses outfuntype" >&5
-echo $ECHO_N "checking whether tputs() uses outfuntype... $ECHO_C" >&6
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+echo $ac_n "checking whether tputs() uses outfuntype""... $ac_c" 1>&6
+echo "configure:6924: checking whether tputs() uses outfuntype" >&5
+cat > conftest.$ac_ext <<EOF
+#line 6926 "configure"
+#include "confdefs.h"
 
 #ifdef HAVE_TERMCAP_H
 # include <termcap.h>
 #endif
-
-int
-main ()
-{
+			
+int main() {
 extern int xx(); tputs("test", 1, (outfuntype)xx)
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6; cat >>confdefs.h <<\_ACEOF
+; return 0; }
+EOF
+if { (eval echo configure:6937: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+  rm -rf conftest*
+  echo "$ac_t""yes" 1>&6; cat >> confdefs.h <<\EOF
 #define HAVE_OUTFUNTYPE 1
-_ACEOF
+EOF
 
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  echo "$ac_t""no" 1>&6
 fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
+rm -f conftest*
 
-echo "$as_me:$LINENO: checking whether sys/select.h and sys/time.h may both be included" >&5
-echo $ECHO_N "checking whether sys/select.h and sys/time.h may both be included... $ECHO_C" >&6
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+echo $ac_n "checking whether sys/select.h and sys/time.h may both be included""... $ac_c" 1>&6
+echo "configure:6952: checking whether sys/select.h and sys/time.h may both be included" >&5
+cat > conftest.$ac_ext <<EOF
+#line 6954 "configure"
+#include "confdefs.h"
 
 #include <sys/types.h>
 #include <sys/time.h>
 #include <sys/select.h>
-int
-main ()
-{
+int main() {
 
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6
-			cat >>confdefs.h <<\_ACEOF
+; return 0; }
+EOF
+if { (eval echo configure:6964: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+  rm -rf conftest*
+  echo "$ac_t""yes" 1>&6
+			cat >> confdefs.h <<\EOF
 #define SYS_SELECT_WITH_SYS_TIME 1
-_ACEOF
+EOF
 
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  echo "$ac_t""no" 1>&6
 fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
+rm -f conftest*
 
 
-echo "$as_me:$LINENO: checking for /dev/ptc" >&5
-echo $ECHO_N "checking for /dev/ptc... $ECHO_C" >&6
+echo $ac_n "checking for /dev/ptc""... $ac_c" 1>&6
+echo "configure:6981: checking for /dev/ptc" >&5
 if test -r /dev/ptc; then
-  cat >>confdefs.h <<\_ACEOF
+  cat >> confdefs.h <<\EOF
 #define HAVE_DEV_PTC 1
-_ACEOF
+EOF
 
-  echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6
+  echo "$ac_t""yes" 1>&6
 else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
+  echo "$ac_t""no" 1>&6
 fi
 
-echo "$as_me:$LINENO: checking for SVR4 ptys" >&5
-echo $ECHO_N "checking for SVR4 ptys... $ECHO_C" >&6
+echo $ac_n "checking for SVR4 ptys""... $ac_c" 1>&6
+echo "configure:6993: checking for SVR4 ptys" >&5
 if test -c /dev/ptmx ; then
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+  cat > conftest.$ac_ext <<EOF
+#line 6996 "configure"
+#include "confdefs.h"
 
-int
-main ()
-{
+int main() {
 ptsname(0);grantpt(0);unlockpt(0);
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6; cat >>confdefs.h <<\_ACEOF
+; return 0; }
+EOF
+if { (eval echo configure:7003: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  echo "$ac_t""yes" 1>&6; cat >> confdefs.h <<\EOF
 #define HAVE_SVR4_PTYS 1
-_ACEOF
+EOF
 
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  echo "$ac_t""no" 1>&6
 fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
+rm -f conftest*
 else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
+  echo "$ac_t""no" 1>&6
 fi
 
-echo "$as_me:$LINENO: checking for ptyranges" >&5
-echo $ECHO_N "checking for ptyranges... $ECHO_C" >&6
+echo $ac_n "checking for ptyranges""... $ac_c" 1>&6
+echo "configure:7021: checking for ptyranges" >&5
 if test -d /dev/ptym ; then
   pdir='/dev/ptym'
 else
   pdir='/dev'
 fi
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+cat > conftest.$ac_ext <<EOF
+#line 7028 "configure"
+#include "confdefs.h"
 #ifdef M_UNIX
    yes;
 #endif
-
-_ACEOF
+	
+EOF
 if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
-  $EGREP "yes" >/dev/null 2>&1; then
+  egrep "yes" >/dev/null 2>&1; then
+  rm -rf conftest*
   ptys=`echo /dev/ptyp??`
 else
+  rm -rf conftest*
   ptys=`echo $pdir/pty??`
 fi
 rm -f conftest*
@@ -12294,35 +7044,28 @@
 if test "$ptys" != "$pdir/pty??" ; then
   p0=`echo $ptys | tr ' ' '\012' | sed -e 's/^.*\(.\).$/\1/g' | sort -u | tr -d '\012'`
   p1=`echo $ptys | tr ' ' '\012' | sed -e 's/^.*\(.\)$/\1/g'  | sort -u | tr -d '\012'`
-  cat >>confdefs.h <<_ACEOF
+  cat >> confdefs.h <<EOF
 #define PTYRANGE0 "$p0"
-_ACEOF
+EOF
 
-  cat >>confdefs.h <<_ACEOF
+  cat >> confdefs.h <<EOF
 #define PTYRANGE1 "$p1"
-_ACEOF
+EOF
 
-  echo "$as_me:$LINENO: result: $p0 / $p1" >&5
-echo "${ECHO_T}$p0 / $p1" >&6
+  echo "$ac_t""$p0 / $p1" 1>&6
 else
-  echo "$as_me:$LINENO: result: don't know" >&5
-echo "${ECHO_T}don't know" >&6
+  echo "$ac_t""don't know" 1>&6
 fi
 
-echo "$as_me:$LINENO: checking default tty permissions/group" >&5
-echo $ECHO_N "checking default tty permissions/group... $ECHO_C" >&6
+echo $ac_n "checking default tty permissions/group""... $ac_c" 1>&6
+echo "configure:7062: checking default tty permissions/group" >&5
 rm -f conftest_grp
 if test "$cross_compiling" = yes; then
-  { { echo "$as_me:$LINENO: error: failed to compile test program" >&5
-echo "$as_me: error: failed to compile test program" >&2;}
-   { (exit 1); exit 1; }; }
+  { echo "configure: error: failed to compile test program" 1>&2; exit 1; }
 else
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+  cat > conftest.$ac_ext <<EOF
+#line 7068 "configure"
+#include "confdefs.h"
 
 #include <sys/types.h>
 #include <sys/stat.h>
@@ -12352,65 +7095,49 @@
   exit(0);
 }
 
-_ACEOF
-rm -f conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && { ac_try='./conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-
+EOF
+if { (eval echo configure:7100: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
+then
+  
     if test -f conftest_grp; then
 	ptygrp=`cat conftest_grp`
-	echo "$as_me:$LINENO: result: pty mode: 0620, group: $ptygrp" >&5
-echo "${ECHO_T}pty mode: 0620, group: $ptygrp" >&6
-	cat >>confdefs.h <<\_ACEOF
+	echo "$ac_t""pty mode: 0620, group: $ptygrp" 1>&6
+	cat >> confdefs.h <<\EOF
 #define PTYMODE 0620
-_ACEOF
+EOF
 
-	cat >>confdefs.h <<_ACEOF
+	cat >> confdefs.h <<EOF
 #define PTYGROUP $ptygrp
-_ACEOF
+EOF
 
     else
-	echo "$as_me:$LINENO: result: ptys are world accessable" >&5
-echo "${ECHO_T}ptys are world accessable" >&6
+	echo "$ac_t""ptys are world accessable" 1>&6
     fi
 
 else
-  echo "$as_me: program exited with status $ac_status" >&5
-echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-( exit $ac_status )
-echo "$as_me:$LINENO: result: can't determine - assume ptys are world accessable" >&5
-echo "${ECHO_T}can't determine - assume ptys are world accessable" >&6
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -fr conftest*
+  echo "$ac_t""can't determine - assume ptys are world accessable" 1>&6
 fi
-rm -f core *.core gmon.out bb.out conftest$ac_exeext conftest.$ac_objext conftest.$ac_ext
+rm -fr conftest*
 fi
+
 rm -f conftest_grp
 
 
-echo "$as_me:$LINENO: checking return type of signal handlers" >&5
-echo $ECHO_N "checking return type of signal handlers... $ECHO_C" >&6
-if test "${ac_cv_type_signal+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+echo $ac_n "checking return type of signal handlers""... $ac_c" 1>&6
+echo "configure:7131: checking return type of signal handlers" >&5
+if eval "test \"`echo '$''{'ac_cv_type_signal'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+  cat > conftest.$ac_ext <<EOF
+#line 7136 "configure"
+#include "confdefs.h"
 #include <sys/types.h>
 #include <signal.h>
 #ifdef signal
-# undef signal
+#undef signal
 #endif
 #ifdef __cplusplus
 extern "C" void (*signal (int, void (*)(int)))(int);
@@ -12418,74 +7145,46 @@
 void (*signal ()) ();
 #endif
 
-int
-main ()
-{
+int main() {
 int i;
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
+; return 0; }
+EOF
+if { (eval echo configure:7153: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+  rm -rf conftest*
   ac_cv_type_signal=void
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-ac_cv_type_signal=int
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  ac_cv_type_signal=int
 fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
+rm -f conftest*
 fi
-echo "$as_me:$LINENO: result: $ac_cv_type_signal" >&5
-echo "${ECHO_T}$ac_cv_type_signal" >&6
 
-cat >>confdefs.h <<_ACEOF
+echo "$ac_t""$ac_cv_type_signal" 1>&6
+cat >> confdefs.h <<EOF
 #define RETSIGTYPE $ac_cv_type_signal
-_ACEOF
+EOF
 
 
 
 if test $ac_cv_type_signal = void; then
-  cat >>confdefs.h <<\_ACEOF
+  cat >> confdefs.h <<\EOF
 #define SIGRETURN return
-_ACEOF
+EOF
 
 else
-  cat >>confdefs.h <<\_ACEOF
+  cat >> confdefs.h <<\EOF
 #define SIGRETURN return 0
-_ACEOF
+EOF
 
 fi
 
-echo "$as_me:$LINENO: checking for struct sigcontext" >&5
-echo $ECHO_N "checking for struct sigcontext... $ECHO_C" >&6
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+echo $ac_n "checking for struct sigcontext""... $ac_c" 1>&6
+echo "configure:7185: checking for struct sigcontext" >&5
+cat > conftest.$ac_ext <<EOF
+#line 7187 "configure"
+#include "confdefs.h"
 
 #include <signal.h>
 test_sig()
@@ -12493,65 +7192,34 @@
     struct sigcontext *scont;
     scont = (struct sigcontext *)0;
     return 1;
-}
-int
-main ()
-{
+} 
+int main() {
 
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6
-		cat >>confdefs.h <<\_ACEOF
+; return 0; }
+EOF
+if { (eval echo configure:7201: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+  rm -rf conftest*
+  echo "$ac_t""yes" 1>&6
+		cat >> confdefs.h <<\EOF
 #define HAVE_SIGCONTEXT 1
-_ACEOF
+EOF
 
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  echo "$ac_t""no" 1>&6
 fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
+rm -f conftest*
 
-echo "$as_me:$LINENO: checking getcwd implementation" >&5
-echo $ECHO_N "checking getcwd implementation... $ECHO_C" >&6
+echo $ac_n "checking getcwd implementation""... $ac_c" 1>&6
+echo "configure:7217: checking getcwd implementation" >&5
 if test "$cross_compiling" = yes; then
-  { { echo "$as_me:$LINENO: error: failed to compile test program" >&5
-echo "$as_me: error: failed to compile test program" >&2;}
-   { (exit 1); exit 1; }; }
+  { echo "configure: error: failed to compile test program" 1>&2; exit 1; }
 else
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+  cat > conftest.$ac_ext <<EOF
+#line 7222 "configure"
+#include "confdefs.h"
 
 char *dagger[] = { "IFS=pwd", 0 };
 main()
@@ -12561,82 +7229,24 @@
   environ = dagger;
   return getcwd(buffer, 500) ? 0 : 1;
 }
-_ACEOF
-rm -f conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && { ac_try='./conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  echo "$as_me:$LINENO: result: it is usable" >&5
-echo "${ECHO_T}it is usable" >&6
+EOF
+if { (eval echo configure:7234: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
+then
+  echo "$ac_t""it is usable" 1>&6
 else
-  echo "$as_me: program exited with status $ac_status" >&5
-echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-( exit $ac_status )
-echo "$as_me:$LINENO: result: it stinks" >&5
-echo "${ECHO_T}it stinks" >&6
-		cat >>confdefs.h <<\_ACEOF
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -fr conftest*
+  echo "$ac_t""it stinks" 1>&6
+		cat >> confdefs.h <<\EOF
 #define BAD_GETCWD 1
-_ACEOF
+EOF
 
 fi
-rm -f core *.core gmon.out bb.out conftest$ac_exeext conftest.$ac_objext conftest.$ac_ext
+rm -fr conftest*
 fi
 
 
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
 for ac_func in bcmp fchdir fchown fseeko fsync ftello getcwd getpseudotty \
 	getpwnam getpwuid getrlimit gettimeofday getwd lstat memcmp \
 	memset nanosleep opendir putenv qsort readlink select setenv \
@@ -12645,727 +7255,398 @@
 	strnicmp strpbrk strtol tgetent towlower towupper iswupper \
 	usleep utime utimes
 do
-as_ac_var=`echo "ac_cv_func_$ac_func" | $as_tr_sh`
-echo "$as_me:$LINENO: checking for $ac_func" >&5
-echo $ECHO_N "checking for $ac_func... $ECHO_C" >&6
-if eval "test \"\${$as_ac_var+set}\" = set"; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
+echo "configure:7260: checking for $ac_func" >&5
+if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-/* Define $ac_func to an innocuous variant, in case <limits.h> declares $ac_func.
-   For example, HP-UX 11i <limits.h> declares gettimeofday.  */
-#define $ac_func innocuous_$ac_func
-
+  cat > conftest.$ac_ext <<EOF
+#line 7265 "configure"
+#include "confdefs.h"
 /* System header to define __stub macros and hopefully few prototypes,
-    which can conflict with char $ac_func (); below.
-    Prefer <limits.h> to <assert.h> if __STDC__ is defined, since
-    <limits.h> exists even on freestanding compilers.  */
-
-#ifdef __STDC__
-# include <limits.h>
-#else
-# include <assert.h>
-#endif
-
-#undef $ac_func
-
+    which can conflict with char $ac_func(); below.  */
+#include <assert.h>
 /* Override any gcc2 internal prototype to avoid an error.  */
-#ifdef __cplusplus
-extern "C"
-{
-#endif
 /* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
-char $ac_func ();
+    builtin and then its argument prototype would still apply.  */
+char $ac_func();
+
+int main() {
+
 /* The GNU C library defines this for functions which it implements
     to always fail with ENOSYS.  Some functions are actually named
     something starting with __ and the normal name is an alias.  */
 #if defined (__stub_$ac_func) || defined (__stub___$ac_func)
 choke me
 #else
-char (*f) () = $ac_func;
+$ac_func();
 #endif
-#ifdef __cplusplus
-}
-#endif
 
-int
-main ()
-{
-return f != $ac_func;
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  eval "$as_ac_var=yes"
+; return 0; }
+EOF
+if { (eval echo configure:7288: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  eval "ac_cv_func_$ac_func=yes"
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-eval "$as_ac_var=no"
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_func_$ac_func=no"
 fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
+rm -f conftest*
 fi
-echo "$as_me:$LINENO: result: `eval echo '${'$as_ac_var'}'`" >&5
-echo "${ECHO_T}`eval echo '${'$as_ac_var'}'`" >&6
-if test `eval echo '${'$as_ac_var'}'` = yes; then
-  cat >>confdefs.h <<_ACEOF
-#define `echo "HAVE_$ac_func" | $as_tr_cpp` 1
-_ACEOF
 
+if eval "test \"`echo '$ac_cv_func_'$ac_func`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
+    ac_tr_func=HAVE_`echo $ac_func | tr 'abcdefghijklmnopqrstuvwxyz' 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'`
+  cat >> confdefs.h <<EOF
+#define $ac_tr_func 1
+EOF
+ 
+else
+  echo "$ac_t""no" 1>&6
 fi
 done
 
 
-echo "$as_me:$LINENO: checking for st_blksize" >&5
-echo $ECHO_N "checking for st_blksize... $ECHO_C" >&6
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+echo $ac_n "checking for st_blksize""... $ac_c" 1>&6
+echo "configure:7314: checking for st_blksize" >&5
+cat > conftest.$ac_ext <<EOF
+#line 7316 "configure"
+#include "confdefs.h"
 #include <sys/types.h>
 #include <sys/stat.h>
-int
-main ()
-{
+int main() {
 	struct stat st;
 	int n;
 
 	stat("/", &st);
 	n = (int)st.st_blksize;
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6; cat >>confdefs.h <<\_ACEOF
+; return 0; }
+EOF
+if { (eval echo configure:7328: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+  rm -rf conftest*
+  echo "$ac_t""yes" 1>&6; cat >> confdefs.h <<\EOF
 #define HAVE_ST_BLKSIZE 1
-_ACEOF
+EOF
 
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  echo "$ac_t""no" 1>&6
 fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
+rm -f conftest*
 
-echo "$as_me:$LINENO: checking whether stat() ignores a trailing slash" >&5
-echo $ECHO_N "checking whether stat() ignores a trailing slash... $ECHO_C" >&6
+echo $ac_n "checking whether stat() ignores a trailing slash""... $ac_c" 1>&6
+echo "configure:7343: checking whether stat() ignores a trailing slash" >&5
 if test "$cross_compiling" = yes; then
-  { { echo "$as_me:$LINENO: error: failed to compile test program" >&5
-echo "$as_me: error: failed to compile test program" >&2;}
-   { (exit 1); exit 1; }; }
+  { echo "configure: error: failed to compile test program" 1>&2; exit 1; }
 else
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+  cat > conftest.$ac_ext <<EOF
+#line 7348 "configure"
+#include "confdefs.h"
 #include <sys/types.h>
 #include <sys/stat.h>
 main() {struct stat st;  exit(stat("configure/", &st) != 0); }
-_ACEOF
-rm -f conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && { ac_try='./conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6; cat >>confdefs.h <<\_ACEOF
+EOF
+if { (eval echo configure:7354: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
+then
+  echo "$ac_t""yes" 1>&6; cat >> confdefs.h <<\EOF
 #define STAT_IGNORES_SLASH 1
-_ACEOF
+EOF
 
 else
-  echo "$as_me: program exited with status $ac_status" >&5
-echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-( exit $ac_status )
-echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -fr conftest*
+  echo "$ac_t""no" 1>&6
 fi
-rm -f core *.core gmon.out bb.out conftest$ac_exeext conftest.$ac_objext conftest.$ac_ext
+rm -fr conftest*
 fi
 
-echo "$as_me:$LINENO: checking for iconv_open()" >&5
-echo $ECHO_N "checking for iconv_open()... $ECHO_C" >&6
+
+echo $ac_n "checking for iconv_open()""... $ac_c" 1>&6
+echo "configure:7371: checking for iconv_open()" >&5
 save_LIBS="$LIBS"
 LIBS="$LIBS -liconv"
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+cat > conftest.$ac_ext <<EOF
+#line 7375 "configure"
+#include "confdefs.h"
 
 #ifdef HAVE_ICONV_H
 # include <iconv.h>
 #endif
-
-int
-main ()
-{
+    
+int main() {
 iconv_open("fr", "to");
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  echo "$as_me:$LINENO: result: yes; with -liconv" >&5
-echo "${ECHO_T}yes; with -liconv" >&6; cat >>confdefs.h <<\_ACEOF
+; return 0; }
+EOF
+if { (eval echo configure:7386: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  echo "$ac_t""yes; with -liconv" 1>&6; cat >> confdefs.h <<\EOF
 #define HAVE_ICONV 1
-_ACEOF
+EOF
 
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  LIBS="$save_LIBS"
+    cat > conftest.$ac_ext <<EOF
+#line 7398 "configure"
+#include "confdefs.h"
 
-LIBS="$save_LIBS"
-    cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
 #ifdef HAVE_ICONV_H
 # include <iconv.h>
 #endif
-
-int
-main ()
-{
+	
+int main() {
 iconv_open("fr", "to");
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6; cat >>confdefs.h <<\_ACEOF
+; return 0; }
+EOF
+if { (eval echo configure:7409: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  echo "$ac_t""yes" 1>&6; cat >> confdefs.h <<\EOF
 #define HAVE_ICONV 1
-_ACEOF
+EOF
 
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  echo "$ac_t""no" 1>&6
 fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
+rm -f conftest*
 fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
+rm -f conftest*
 
 
-echo "$as_me:$LINENO: checking for nl_langinfo(CODESET)" >&5
-echo $ECHO_N "checking for nl_langinfo(CODESET)... $ECHO_C" >&6
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+echo $ac_n "checking for nl_langinfo(CODESET)""... $ac_c" 1>&6
+echo "configure:7427: checking for nl_langinfo(CODESET)" >&5
+cat > conftest.$ac_ext <<EOF
+#line 7429 "configure"
+#include "confdefs.h"
 
 #ifdef HAVE_LANGINFO_H
 # include <langinfo.h>
 #endif
 
-int
-main ()
-{
+int main() {
 char *cs = nl_langinfo(CODESET);
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6; cat >>confdefs.h <<\_ACEOF
+; return 0; }
+EOF
+if { (eval echo configure:7440: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  echo "$ac_t""yes" 1>&6; cat >> confdefs.h <<\EOF
 #define HAVE_NL_LANGINFO_CODESET 1
-_ACEOF
+EOF
 
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  echo "$ac_t""no" 1>&6
 fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
+rm -f conftest*
 
-echo "$as_me:$LINENO: checking --disable-acl argument" >&5
-echo $ECHO_N "checking --disable-acl argument... $ECHO_C" >&6
+echo $ac_n "checking --disable-acl argument""... $ac_c" 1>&6
+echo "configure:7455: checking --disable-acl argument" >&5
 # Check whether --enable-acl or --disable-acl was given.
 if test "${enable_acl+set}" = set; then
   enableval="$enable_acl"
-
+  :
 else
   enable_acl="yes"
-fi;
+fi
+
 if test "$enable_acl" = "yes"; then
-echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
-echo "$as_me:$LINENO: checking for acl_get_file in -lposix1e" >&5
-echo $ECHO_N "checking for acl_get_file in -lposix1e... $ECHO_C" >&6
-if test "${ac_cv_lib_posix1e_acl_get_file+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+echo "$ac_t""no" 1>&6
+echo $ac_n "checking for acl_get_file in -lposix1e""... $ac_c" 1>&6
+echo "configure:7467: checking for acl_get_file in -lposix1e" >&5
+ac_lib_var=`echo posix1e'_'acl_get_file | sed 'y%./+-%__p_%'`
+if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-  ac_check_lib_save_LIBS=$LIBS
+  ac_save_LIBS="$LIBS"
 LIBS="-lposix1e  $LIBS"
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
+cat > conftest.$ac_ext <<EOF
+#line 7475 "configure"
+#include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
-#ifdef __cplusplus
-extern "C"
-#endif
 /* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
-char acl_get_file ();
-int
-main ()
-{
-acl_get_file ();
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_cv_lib_posix1e_acl_get_file=yes
+    builtin and then its argument prototype would still apply.  */
+char acl_get_file();
+
+int main() {
+acl_get_file()
+; return 0; }
+EOF
+if { (eval echo configure:7486: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=yes"
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=no"
+fi
+rm -f conftest*
+LIBS="$ac_save_LIBS"
 
-ac_cv_lib_posix1e_acl_get_file=no
 fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
-fi
-echo "$as_me:$LINENO: result: $ac_cv_lib_posix1e_acl_get_file" >&5
-echo "${ECHO_T}$ac_cv_lib_posix1e_acl_get_file" >&6
-if test $ac_cv_lib_posix1e_acl_get_file = yes; then
+if eval "test \"`echo '$ac_cv_lib_'$ac_lib_var`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
   LIBS="$LIBS -lposix1e"
 else
-  echo "$as_me:$LINENO: checking for acl_get_file in -lacl" >&5
-echo $ECHO_N "checking for acl_get_file in -lacl... $ECHO_C" >&6
-if test "${ac_cv_lib_acl_acl_get_file+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+  echo "$ac_t""no" 1>&6
+echo $ac_n "checking for acl_get_file in -lacl""... $ac_c" 1>&6
+echo "configure:7505: checking for acl_get_file in -lacl" >&5
+ac_lib_var=`echo acl'_'acl_get_file | sed 'y%./+-%__p_%'`
+if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-  ac_check_lib_save_LIBS=$LIBS
+  ac_save_LIBS="$LIBS"
 LIBS="-lacl  $LIBS"
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
+cat > conftest.$ac_ext <<EOF
+#line 7513 "configure"
+#include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
-#ifdef __cplusplus
-extern "C"
-#endif
 /* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
-char acl_get_file ();
-int
-main ()
-{
-acl_get_file ();
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_cv_lib_acl_acl_get_file=yes
+    builtin and then its argument prototype would still apply.  */
+char acl_get_file();
+
+int main() {
+acl_get_file()
+; return 0; }
+EOF
+if { (eval echo configure:7524: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=yes"
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=no"
+fi
+rm -f conftest*
+LIBS="$ac_save_LIBS"
 
-ac_cv_lib_acl_acl_get_file=no
 fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
-fi
-echo "$as_me:$LINENO: result: $ac_cv_lib_acl_acl_get_file" >&5
-echo "${ECHO_T}$ac_cv_lib_acl_acl_get_file" >&6
-if test $ac_cv_lib_acl_acl_get_file = yes; then
+if eval "test \"`echo '$ac_cv_lib_'$ac_lib_var`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
   LIBS="$LIBS -lacl"
-		  echo "$as_me:$LINENO: checking for fgetxattr in -lattr" >&5
-echo $ECHO_N "checking for fgetxattr in -lattr... $ECHO_C" >&6
-if test "${ac_cv_lib_attr_fgetxattr+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+		  echo $ac_n "checking for fgetxattr in -lattr""... $ac_c" 1>&6
+echo "configure:7541: checking for fgetxattr in -lattr" >&5
+ac_lib_var=`echo attr'_'fgetxattr | sed 'y%./+-%__p_%'`
+if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-  ac_check_lib_save_LIBS=$LIBS
+  ac_save_LIBS="$LIBS"
 LIBS="-lattr  $LIBS"
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
+cat > conftest.$ac_ext <<EOF
+#line 7549 "configure"
+#include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
-#ifdef __cplusplus
-extern "C"
-#endif
 /* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
-char fgetxattr ();
-int
-main ()
-{
-fgetxattr ();
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_cv_lib_attr_fgetxattr=yes
+    builtin and then its argument prototype would still apply.  */
+char fgetxattr();
+
+int main() {
+fgetxattr()
+; return 0; }
+EOF
+if { (eval echo configure:7560: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=yes"
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=no"
+fi
+rm -f conftest*
+LIBS="$ac_save_LIBS"
 
-ac_cv_lib_attr_fgetxattr=no
 fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
-fi
-echo "$as_me:$LINENO: result: $ac_cv_lib_attr_fgetxattr" >&5
-echo "${ECHO_T}$ac_cv_lib_attr_fgetxattr" >&6
-if test $ac_cv_lib_attr_fgetxattr = yes; then
+if eval "test \"`echo '$ac_cv_lib_'$ac_lib_var`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
   LIBS="$LIBS -lattr"
+else
+  echo "$ac_t""no" 1>&6
 fi
 
+else
+  echo "$ac_t""no" 1>&6
 fi
 
 fi
 
 
-echo "$as_me:$LINENO: checking for POSIX ACL support" >&5
-echo $ECHO_N "checking for POSIX ACL support... $ECHO_C" >&6
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+echo $ac_n "checking for POSIX ACL support""... $ac_c" 1>&6
+echo "configure:7588: checking for POSIX ACL support" >&5
+cat > conftest.$ac_ext <<EOF
+#line 7590 "configure"
+#include "confdefs.h"
 
 #include <sys/types.h>
 #ifdef HAVE_SYS_ACL_H
 # include <sys/acl.h>
 #endif
 acl_t acl;
-int
-main ()
-{
+int main() {
 acl = acl_get_file("foo", ACL_TYPE_ACCESS);
 	acl_set_file("foo", ACL_TYPE_ACCESS, acl);
 	acl_free(acl);
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6; cat >>confdefs.h <<\_ACEOF
+; return 0; }
+EOF
+if { (eval echo configure:7604: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  echo "$ac_t""yes" 1>&6; cat >> confdefs.h <<\EOF
 #define HAVE_POSIX_ACL 1
-_ACEOF
+EOF
 
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  echo "$ac_t""no" 1>&6
 fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
+rm -f conftest*
 
-echo "$as_me:$LINENO: checking for Solaris ACL support" >&5
-echo $ECHO_N "checking for Solaris ACL support... $ECHO_C" >&6
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+echo $ac_n "checking for Solaris ACL support""... $ac_c" 1>&6
+echo "configure:7619: checking for Solaris ACL support" >&5
+cat > conftest.$ac_ext <<EOF
+#line 7621 "configure"
+#include "confdefs.h"
 
 #ifdef HAVE_SYS_ACL_H
 # include <sys/acl.h>
 #endif
-int
-main ()
-{
+int main() {
 acl("foo", GETACLCNT, 0, NULL);
-
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6; cat >>confdefs.h <<\_ACEOF
+	
+; return 0; }
+EOF
+if { (eval echo configure:7632: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  echo "$ac_t""yes" 1>&6; cat >> confdefs.h <<\EOF
 #define HAVE_SOLARIS_ACL 1
-_ACEOF
+EOF
 
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  echo "$ac_t""no" 1>&6
 fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
+rm -f conftest*
 
-echo "$as_me:$LINENO: checking for AIX ACL support" >&5
-echo $ECHO_N "checking for AIX ACL support... $ECHO_C" >&6
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+echo $ac_n "checking for AIX ACL support""... $ac_c" 1>&6
+echo "configure:7647: checking for AIX ACL support" >&5
+cat > conftest.$ac_ext <<EOF
+#line 7649 "configure"
+#include "confdefs.h"
 
 #ifdef HAVE_SYS_ACL_H
 # include <sys/acl.h>
@@ -13379,208 +7660,116 @@
 
 int aclsize;
 struct acl *aclent;
-int
-main ()
-{
+int main() {
 aclsize = sizeof(struct acl);
 	aclent = (void *)malloc(aclsize);
 	statacl("foo", STX_NORMAL, aclent, aclsize);
-
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6; cat >>confdefs.h <<\_ACEOF
+	
+; return 0; }
+EOF
+if { (eval echo configure:7671: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  echo "$ac_t""yes" 1>&6; cat >> confdefs.h <<\EOF
 #define HAVE_AIX_ACL 1
-_ACEOF
+EOF
 
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  echo "$ac_t""no" 1>&6
 fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
+rm -f conftest*
 else
-  echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6
+  echo "$ac_t""yes" 1>&6
 fi
 
-echo "$as_me:$LINENO: checking --disable-gpm argument" >&5
-echo $ECHO_N "checking --disable-gpm argument... $ECHO_C" >&6
+echo $ac_n "checking --disable-gpm argument""... $ac_c" 1>&6
+echo "configure:7689: checking --disable-gpm argument" >&5
 # Check whether --enable-gpm or --disable-gpm was given.
 if test "${enable_gpm+set}" = set; then
   enableval="$enable_gpm"
-
+  :
 else
   enable_gpm="yes"
-fi;
+fi
 
+
 if test "$enable_gpm" = "yes"; then
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
-    echo "$as_me:$LINENO: checking for gpm" >&5
-echo $ECHO_N "checking for gpm... $ECHO_C" >&6
-if test "${vi_cv_have_gpm+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+  echo "$ac_t""no" 1>&6
+    echo $ac_n "checking for gpm""... $ac_c" 1>&6
+echo "configure:7702: checking for gpm" >&5
+if eval "test \"`echo '$''{'vi_cv_have_gpm'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
   olibs="$LIBS" ; LIBS="-lgpm"
-	cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+	cat > conftest.$ac_ext <<EOF
+#line 7708 "configure"
+#include "confdefs.h"
 #include <gpm.h>
 	    #include <linux/keyboard.h>
-int
-main ()
-{
+int main() {
 Gpm_GetLibVersion(NULL);
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
+; return 0; }
+EOF
+if { (eval echo configure:7716: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
   	    	    vi_cv_have_gpm=yes
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-vi_cv_have_gpm=no
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  vi_cv_have_gpm=no
 fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
+rm -f conftest*
 	LIBS="$olibs"
-
+    
 fi
-echo "$as_me:$LINENO: result: $vi_cv_have_gpm" >&5
-echo "${ECHO_T}$vi_cv_have_gpm" >&6
+
+echo "$ac_t""$vi_cv_have_gpm" 1>&6
   if test $vi_cv_have_gpm = yes; then
     LIBS="$LIBS -lgpm"
-    cat >>confdefs.h <<\_ACEOF
+    cat >> confdefs.h <<\EOF
 #define HAVE_GPM 1
-_ACEOF
+EOF
 
   fi
 else
-  echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6
+  echo "$ac_t""yes" 1>&6
 fi
 
-echo "$as_me:$LINENO: checking for rename" >&5
-echo $ECHO_N "checking for rename... $ECHO_C" >&6
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+echo $ac_n "checking for rename""... $ac_c" 1>&6
+echo "configure:7743: checking for rename" >&5
+cat > conftest.$ac_ext <<EOF
+#line 7745 "configure"
+#include "confdefs.h"
 #include <stdio.h>
-int
-main ()
-{
+int main() {
 rename("this", "that")
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6; cat >>confdefs.h <<\_ACEOF
+; return 0; }
+EOF
+if { (eval echo configure:7752: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  echo "$ac_t""yes" 1>&6; cat >> confdefs.h <<\EOF
 #define HAVE_RENAME 1
-_ACEOF
+EOF
 
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  echo "$ac_t""no" 1>&6
 fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
+rm -f conftest*
 
-echo "$as_me:$LINENO: checking for sysctl" >&5
-echo $ECHO_N "checking for sysctl... $ECHO_C" >&6
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+echo $ac_n "checking for sysctl""... $ac_c" 1>&6
+echo "configure:7767: checking for sysctl" >&5
+cat > conftest.$ac_ext <<EOF
+#line 7769 "configure"
+#include "confdefs.h"
 #include <sys/types.h>
 #include <sys/sysctl.h>
-int
-main ()
-{
+int main() {
 	int mib[2], r;
 	size_t len;
 
@@ -13588,178 +7777,91 @@
 	mib[1] = HW_USERMEM;
 	len = sizeof(r);
 	(void)sysctl(mib, 2, &r, &len, (void *)0, (size_t)0);
-
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6; cat >>confdefs.h <<\_ACEOF
+	
+; return 0; }
+EOF
+if { (eval echo configure:7784: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+  rm -rf conftest*
+  echo "$ac_t""yes" 1>&6; cat >> confdefs.h <<\EOF
 #define HAVE_SYSCTL 1
-_ACEOF
+EOF
 
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-echo "$as_me:$LINENO: result: not usable" >&5
-echo "${ECHO_T}not usable" >&6
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  echo "$ac_t""not usable" 1>&6
 fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
+rm -f conftest*
 
-echo "$as_me:$LINENO: checking for sysinfo" >&5
-echo $ECHO_N "checking for sysinfo... $ECHO_C" >&6
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+echo $ac_n "checking for sysinfo""... $ac_c" 1>&6
+echo "configure:7799: checking for sysinfo" >&5
+cat > conftest.$ac_ext <<EOF
+#line 7801 "configure"
+#include "confdefs.h"
 #include <sys/types.h>
 #include <sys/sysinfo.h>
-int
-main ()
-{
+int main() {
 	struct sysinfo sinfo;
 	int t;
 
 	(void)sysinfo(&sinfo);
 	t = sinfo.totalram;
-
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6; cat >>confdefs.h <<\_ACEOF
+	
+; return 0; }
+EOF
+if { (eval echo configure:7814: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+  rm -rf conftest*
+  echo "$ac_t""yes" 1>&6; cat >> confdefs.h <<\EOF
 #define HAVE_SYSINFO 1
-_ACEOF
+EOF
 
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-echo "$as_me:$LINENO: result: not usable" >&5
-echo "${ECHO_T}not usable" >&6
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  echo "$ac_t""not usable" 1>&6
 fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
+rm -f conftest*
 
-echo "$as_me:$LINENO: checking for sysconf" >&5
-echo $ECHO_N "checking for sysconf... $ECHO_C" >&6
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+echo $ac_n "checking for sysconf""... $ac_c" 1>&6
+echo "configure:7829: checking for sysconf" >&5
+cat > conftest.$ac_ext <<EOF
+#line 7831 "configure"
+#include "confdefs.h"
 #include <unistd.h>
-int
-main ()
-{
+int main() {
 	(void)sysconf(_SC_PAGESIZE);
 	(void)sysconf(_SC_PHYS_PAGES);
-
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6; cat >>confdefs.h <<\_ACEOF
+	
+; return 0; }
+EOF
+if { (eval echo configure:7840: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+  rm -rf conftest*
+  echo "$ac_t""yes" 1>&6; cat >> confdefs.h <<\EOF
 #define HAVE_SYSCONF 1
-_ACEOF
+EOF
 
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-echo "$as_me:$LINENO: result: not usable" >&5
-echo "${ECHO_T}not usable" >&6
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  echo "$ac_t""not usable" 1>&6
 fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
+rm -f conftest*
 
 
-echo "$as_me:$LINENO: checking size of int" >&5
-echo $ECHO_N "checking size of int... $ECHO_C" >&6
-if test "${ac_cv_sizeof_int+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+echo $ac_n "checking size of int""... $ac_c" 1>&6
+echo "configure:7856: checking size of int" >&5
+if eval "test \"`echo '$''{'ac_cv_sizeof_int'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
   if test "$cross_compiling" = yes; then
-  { { echo "$as_me:$LINENO: error: failed to compile test program" >&5
-echo "$as_me: error: failed to compile test program" >&2;}
-   { (exit 1); exit 1; }; }
+  { echo "configure: error: failed to compile test program" 1>&2; exit 1; }
 else
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+  cat > conftest.$ac_ext <<EOF
+#line 7864 "configure"
+#include "confdefs.h"
 #include <stdio.h>
 		main()
 		{
@@ -13768,40 +7870,29 @@
 		  fprintf(f, "%d\n", (int)sizeof(int));
 		  exit(0);
 		}
-_ACEOF
-rm -f conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && { ac_try='./conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
+EOF
+if { (eval echo configure:7875: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
+then
   ac_cv_sizeof_int=`cat conftestval`
 else
-  echo "$as_me: program exited with status $ac_status" >&5
-echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-( exit $ac_status )
-ac_cv_sizeof_int=0
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -fr conftest*
+  ac_cv_sizeof_int=0
 fi
-rm -f core *.core gmon.out bb.out conftest$ac_exeext conftest.$ac_objext conftest.$ac_ext
+rm -fr conftest*
 fi
+
 fi
 
-echo "$as_me:$LINENO: result: $ac_cv_sizeof_int" >&5
-echo "${ECHO_T}$ac_cv_sizeof_int" >&6
-cat >>confdefs.h <<_ACEOF
+echo "$ac_t""$ac_cv_sizeof_int" 1>&6
+cat >> confdefs.h <<EOF
 #define SIZEOF_INT $ac_cv_sizeof_int
-_ACEOF
+EOF
 
 
-echo "$as_me:$LINENO: checking whether memmove/bcopy/memcpy handle overlaps" >&5
-echo $ECHO_N "checking whether memmove/bcopy/memcpy handle overlaps... $ECHO_C" >&6
+echo $ac_n "checking whether memmove/bcopy/memcpy handle overlaps""... $ac_c" 1>&6
+echo "configure:7896: checking whether memmove/bcopy/memcpy handle overlaps" >&5
 bcopy_test_prog='
 main() {
   char buf[10];
@@ -13818,311 +7909,173 @@
 
 
 if test "$cross_compiling" = yes; then
-  { { echo "$as_me:$LINENO: error: failed to compile test program" >&5
-echo "$as_me: error: failed to compile test program" >&2;}
-   { (exit 1); exit 1; }; }
+  { echo "configure: error: failed to compile test program" 1>&2; exit 1; }
 else
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+  cat > conftest.$ac_ext <<EOF
+#line 7916 "configure"
+#include "confdefs.h"
 #define mch_memmove(s,d,l) memmove(d,s,l) $bcopy_test_prog
-_ACEOF
-rm -f conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && { ac_try='./conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  cat >>confdefs.h <<\_ACEOF
+EOF
+if { (eval echo configure:7920: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
+then
+  cat >> confdefs.h <<\EOF
 #define USEMEMMOVE 1
-_ACEOF
- echo "$as_me:$LINENO: result: memmove does" >&5
-echo "${ECHO_T}memmove does" >&6
+EOF
+ echo "$ac_t""memmove does" 1>&6
 else
-  echo "$as_me: program exited with status $ac_status" >&5
-echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-( exit $ac_status )
-if test "$cross_compiling" = yes; then
-  { { echo "$as_me:$LINENO: error: failed to compile test program" >&5
-echo "$as_me: error: failed to compile test program" >&2;}
-   { (exit 1); exit 1; }; }
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -fr conftest*
+  if test "$cross_compiling" = yes; then
+  { echo "configure: error: failed to compile test program" 1>&2; exit 1; }
 else
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+  cat > conftest.$ac_ext <<EOF
+#line 7934 "configure"
+#include "confdefs.h"
 #define mch_memmove(s,d,l) bcopy(d,s,l) $bcopy_test_prog
-_ACEOF
-rm -f conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && { ac_try='./conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  cat >>confdefs.h <<\_ACEOF
+EOF
+if { (eval echo configure:7938: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
+then
+  cat >> confdefs.h <<\EOF
 #define USEBCOPY 1
-_ACEOF
- echo "$as_me:$LINENO: result: bcopy does" >&5
-echo "${ECHO_T}bcopy does" >&6
+EOF
+ echo "$ac_t""bcopy does" 1>&6
 else
-  echo "$as_me: program exited with status $ac_status" >&5
-echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-( exit $ac_status )
-if test "$cross_compiling" = yes; then
-  { { echo "$as_me:$LINENO: error: failed to compile test program" >&5
-echo "$as_me: error: failed to compile test program" >&2;}
-   { (exit 1); exit 1; }; }
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -fr conftest*
+  if test "$cross_compiling" = yes; then
+  { echo "configure: error: failed to compile test program" 1>&2; exit 1; }
 else
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+  cat > conftest.$ac_ext <<EOF
+#line 7952 "configure"
+#include "confdefs.h"
 #define mch_memmove(s,d,l) memcpy(d,s,l) $bcopy_test_prog
-_ACEOF
-rm -f conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && { ac_try='./conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  cat >>confdefs.h <<\_ACEOF
+EOF
+if { (eval echo configure:7956: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
+then
+  cat >> confdefs.h <<\EOF
 #define USEMEMCPY 1
-_ACEOF
- echo "$as_me:$LINENO: result: memcpy does" >&5
-echo "${ECHO_T}memcpy does" >&6
+EOF
+ echo "$ac_t""memcpy does" 1>&6
 else
-  echo "$as_me: program exited with status $ac_status" >&5
-echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-( exit $ac_status )
-echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -fr conftest*
+  echo "$ac_t""no" 1>&6
 fi
-rm -f core *.core gmon.out bb.out conftest$ac_exeext conftest.$ac_objext conftest.$ac_ext
+rm -fr conftest*
 fi
+
 fi
-rm -f core *.core gmon.out bb.out conftest$ac_exeext conftest.$ac_objext conftest.$ac_ext
+rm -fr conftest*
 fi
+
 fi
-rm -f core *.core gmon.out bb.out conftest$ac_exeext conftest.$ac_objext conftest.$ac_ext
+rm -fr conftest*
 fi
 
 
+
 if test "$enable_multibyte" = "yes"; then
   cflags_save=$CFLAGS
   ldflags_save=$LDFLAGS
   if test -n "$x_includes" ; then
     CFLAGS="$CFLAGS -I$x_includes"
     LDFLAGS="$X_LIBS $LDFLAGS -lX11"
-    echo "$as_me:$LINENO: checking whether X_LOCALE needed" >&5
-echo $ECHO_N "checking whether X_LOCALE needed... $ECHO_C" >&6
-    cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+    echo $ac_n "checking whether X_LOCALE needed""... $ac_c" 1>&6
+echo "configure:7988: checking whether X_LOCALE needed" >&5
+    cat > conftest.$ac_ext <<EOF
+#line 7990 "configure"
+#include "confdefs.h"
 #include <X11/Xlocale.h>
-int
-main ()
-{
+int main() {
 
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
+; return 0; }
+EOF
+if { (eval echo configure:7997: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+  rm -rf conftest*
+  cat > conftest.$ac_ext <<EOF
+#line 8000 "configure"
+#include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
-#ifdef __cplusplus
-extern "C"
-#endif
 /* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
-char _Xsetlocale ();
-int
-main ()
-{
-_Xsetlocale ();
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6
-		cat >>confdefs.h <<\_ACEOF
+    builtin and then its argument prototype would still apply.  */
+char _Xsetlocale();
+
+int main() {
+_Xsetlocale()
+; return 0; }
+EOF
+if { (eval echo configure:8011: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  echo "$ac_t""yes" 1>&6
+		cat >> confdefs.h <<\EOF
 #define X_LOCALE 1
-_ACEOF
+EOF
 
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  echo "$ac_t""no" 1>&6
 fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
+rm -f conftest*
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  echo "$ac_t""no" 1>&6
 fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
+rm -f conftest*
   fi
   CFLAGS=$cflags_save
   LDFLAGS=$ldflags_save
 fi
 
-echo "$as_me:$LINENO: checking for _xpg4_setrunelocale in -lxpg4" >&5
-echo $ECHO_N "checking for _xpg4_setrunelocale in -lxpg4... $ECHO_C" >&6
-if test "${ac_cv_lib_xpg4__xpg4_setrunelocale+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+echo $ac_n "checking for _xpg4_setrunelocale in -lxpg4""... $ac_c" 1>&6
+echo "configure:8038: checking for _xpg4_setrunelocale in -lxpg4" >&5
+ac_lib_var=`echo xpg4'_'_xpg4_setrunelocale | sed 'y%./+-%__p_%'`
+if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-  ac_check_lib_save_LIBS=$LIBS
+  ac_save_LIBS="$LIBS"
 LIBS="-lxpg4  $LIBS"
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
+cat > conftest.$ac_ext <<EOF
+#line 8046 "configure"
+#include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
-#ifdef __cplusplus
-extern "C"
-#endif
 /* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
-char _xpg4_setrunelocale ();
-int
-main ()
-{
-_xpg4_setrunelocale ();
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_cv_lib_xpg4__xpg4_setrunelocale=yes
+    builtin and then its argument prototype would still apply.  */
+char _xpg4_setrunelocale();
+
+int main() {
+_xpg4_setrunelocale()
+; return 0; }
+EOF
+if { (eval echo configure:8057: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=yes"
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=no"
+fi
+rm -f conftest*
+LIBS="$ac_save_LIBS"
 
-ac_cv_lib_xpg4__xpg4_setrunelocale=no
 fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
-fi
-echo "$as_me:$LINENO: result: $ac_cv_lib_xpg4__xpg4_setrunelocale" >&5
-echo "${ECHO_T}$ac_cv_lib_xpg4__xpg4_setrunelocale" >&6
-if test $ac_cv_lib_xpg4__xpg4_setrunelocale = yes; then
+if eval "test \"`echo '$ac_cv_lib_'$ac_lib_var`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
   LIBS="$LIBS -lxpg4"
+else
+  echo "$ac_t""no" 1>&6
 fi
 
 
-echo "$as_me:$LINENO: checking how to create tags" >&5
-echo $ECHO_N "checking how to create tags... $ECHO_C" >&6
+echo $ac_n "checking how to create tags""... $ac_c" 1>&6
+echo "configure:8079: checking how to create tags" >&5
 test -f tags && mv tags tags.save
 if (eval ctags --version /dev/null | grep Exuberant) < /dev/null 1>&5 2>&1; then
   TAGPRG="ctags -I INIT+ --fields=+S"
@@ -14136,1158 +8089,494 @@
   (eval ctags -i+m /dev/null) < /dev/null 1>&5 2>&1 && TAGPRG="ctags -i+m"
 fi
 test -f tags.save && mv tags.save tags
-echo "$as_me:$LINENO: result: $TAGPRG" >&5
-echo "${ECHO_T}$TAGPRG" >&6
+echo "$ac_t""$TAGPRG" 1>&6 
 
-echo "$as_me:$LINENO: checking how to run man with a section nr" >&5
-echo $ECHO_N "checking how to run man with a section nr... $ECHO_C" >&6
+echo $ac_n "checking how to run man with a section nr""... $ac_c" 1>&6
+echo "configure:8096: checking how to run man with a section nr" >&5
 MANDEF="man"
 (eval man -s 2 read) < /dev/null > /dev/null 2>&5 && MANDEF="man -s"
-echo "$as_me:$LINENO: result: $MANDEF" >&5
-echo "${ECHO_T}$MANDEF" >&6
+echo "$ac_t""$MANDEF" 1>&6
 if test "$MANDEF" = "man -s"; then
-  cat >>confdefs.h <<\_ACEOF
+  cat >> confdefs.h <<\EOF
 #define USEMAN_S 1
-_ACEOF
+EOF
 
 fi
 
-echo "$as_me:$LINENO: checking --disable-nls argument" >&5
-echo $ECHO_N "checking --disable-nls argument... $ECHO_C" >&6
+echo $ac_n "checking --disable-nls argument""... $ac_c" 1>&6
+echo "configure:8108: checking --disable-nls argument" >&5
 # Check whether --enable-nls or --disable-nls was given.
 if test "${enable_nls+set}" = set; then
   enableval="$enable_nls"
-
+  :
 else
   enable_nls="yes"
-fi;
+fi
 
+
 if test "$enable_nls" = "yes"; then
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
+  echo "$ac_t""no" 1>&6
 
   INSTALL_LANGS=install-languages
-
+  
   INSTALL_TOOL_LANGS=install-tool-languages
+  
 
-
   # Extract the first word of "msgfmt", so it can be a program name with args.
 set dummy msgfmt; ac_word=$2
-echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
-if test "${ac_cv_prog_MSGFMT+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
+echo "configure:8129: checking for $ac_word" >&5
+if eval "test \"`echo '$''{'ac_cv_prog_MSGFMT'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
   if test -n "$MSGFMT"; then
   ac_cv_prog_MSGFMT="$MSGFMT" # Let the user override the test.
 else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
-    ac_cv_prog_MSGFMT="msgfmt"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-
+  IFS="${IFS= 	}"; ac_save_ifs="$IFS"; IFS=":"
+  ac_dummy="$PATH"
+  for ac_dir in $ac_dummy; do
+    test -z "$ac_dir" && ac_dir=.
+    if test -f $ac_dir/$ac_word; then
+      ac_cv_prog_MSGFMT="msgfmt"
+      break
+    fi
+  done
+  IFS="$ac_save_ifs"
 fi
 fi
-MSGFMT=$ac_cv_prog_MSGFMT
+MSGFMT="$ac_cv_prog_MSGFMT"
 if test -n "$MSGFMT"; then
-  echo "$as_me:$LINENO: result: $MSGFMT" >&5
-echo "${ECHO_T}$MSGFMT" >&6
+  echo "$ac_t""$MSGFMT" 1>&6
 else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
+  echo "$ac_t""no" 1>&6
 fi
 
-  echo "$as_me:$LINENO: checking for NLS" >&5
-echo $ECHO_N "checking for NLS... $ECHO_C" >&6
+  echo $ac_n "checking for NLS""... $ac_c" 1>&6
+echo "configure:8156: checking for NLS" >&5
   if test -f po/Makefile; then
     have_gettext="no"
     if test -n "$MSGFMT"; then
-      cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+      cat > conftest.$ac_ext <<EOF
+#line 8161 "configure"
+#include "confdefs.h"
 #include <libintl.h>
-int
-main ()
-{
+int main() {
 gettext("Test");
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  echo "$as_me:$LINENO: result: gettext() works" >&5
-echo "${ECHO_T}gettext() works" >&6; have_gettext="yes"
+; return 0; }
+EOF
+if { (eval echo configure:8168: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  echo "$ac_t""gettext() works" 1>&6; have_gettext="yes"
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-olibs=$LIBS
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  olibs=$LIBS
 	  LIBS="$LIBS -lintl"
-	  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+	  cat > conftest.$ac_ext <<EOF
+#line 8178 "configure"
+#include "confdefs.h"
 #include <libintl.h>
-int
-main ()
-{
+int main() {
 gettext("Test");
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  echo "$as_me:$LINENO: result: gettext() works with -lintl" >&5
-echo "${ECHO_T}gettext() works with -lintl" >&6; have_gettext="yes"
+; return 0; }
+EOF
+if { (eval echo configure:8185: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  echo "$ac_t""gettext() works with -lintl" 1>&6; have_gettext="yes"
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-echo "$as_me:$LINENO: result: gettext() doesn't work" >&5
-echo "${ECHO_T}gettext() doesn't work" >&6;
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  echo "$ac_t""gettext() doesn't work" 1>&6;
 	      LIBS=$olibs
 fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
+rm -f conftest*
 fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
+rm -f conftest*
     else
-      echo "$as_me:$LINENO: result: msgfmt not found - disabled" >&5
-echo "${ECHO_T}msgfmt not found - disabled" >&6;
+      echo "$ac_t""msgfmt not found - disabled" 1>&6;
     fi
     if test $have_gettext = "yes"; then
-      cat >>confdefs.h <<\_ACEOF
+      cat >> confdefs.h <<\EOF
 #define HAVE_GETTEXT 1
-_ACEOF
+EOF
 
       MAKEMO=yes
-
-
-for ac_func in bind_textdomain_codeset
+      
+            for ac_func in bind_textdomain_codeset
 do
-as_ac_var=`echo "ac_cv_func_$ac_func" | $as_tr_sh`
-echo "$as_me:$LINENO: checking for $ac_func" >&5
-echo $ECHO_N "checking for $ac_func... $ECHO_C" >&6
-if eval "test \"\${$as_ac_var+set}\" = set"; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
+echo "configure:8211: checking for $ac_func" >&5
+if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-/* Define $ac_func to an innocuous variant, in case <limits.h> declares $ac_func.
-   For example, HP-UX 11i <limits.h> declares gettimeofday.  */
-#define $ac_func innocuous_$ac_func
-
+  cat > conftest.$ac_ext <<EOF
+#line 8216 "configure"
+#include "confdefs.h"
 /* System header to define __stub macros and hopefully few prototypes,
-    which can conflict with char $ac_func (); below.
-    Prefer <limits.h> to <assert.h> if __STDC__ is defined, since
-    <limits.h> exists even on freestanding compilers.  */
-
-#ifdef __STDC__
-# include <limits.h>
-#else
-# include <assert.h>
-#endif
-
-#undef $ac_func
-
+    which can conflict with char $ac_func(); below.  */
+#include <assert.h>
 /* Override any gcc2 internal prototype to avoid an error.  */
-#ifdef __cplusplus
-extern "C"
-{
-#endif
 /* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
-char $ac_func ();
+    builtin and then its argument prototype would still apply.  */
+char $ac_func();
+
+int main() {
+
 /* The GNU C library defines this for functions which it implements
     to always fail with ENOSYS.  Some functions are actually named
     something starting with __ and the normal name is an alias.  */
 #if defined (__stub_$ac_func) || defined (__stub___$ac_func)
 choke me
 #else
-char (*f) () = $ac_func;
+$ac_func();
 #endif
-#ifdef __cplusplus
-}
-#endif
 
-int
-main ()
-{
-return f != $ac_func;
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  eval "$as_ac_var=yes"
+; return 0; }
+EOF
+if { (eval echo configure:8239: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  eval "ac_cv_func_$ac_func=yes"
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-eval "$as_ac_var=no"
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_func_$ac_func=no"
 fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
+rm -f conftest*
 fi
-echo "$as_me:$LINENO: result: `eval echo '${'$as_ac_var'}'`" >&5
-echo "${ECHO_T}`eval echo '${'$as_ac_var'}'`" >&6
-if test `eval echo '${'$as_ac_var'}'` = yes; then
-  cat >>confdefs.h <<_ACEOF
-#define `echo "HAVE_$ac_func" | $as_tr_cpp` 1
-_ACEOF
 
+if eval "test \"`echo '$ac_cv_func_'$ac_func`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
+    ac_tr_func=HAVE_`echo $ac_func | tr 'abcdefghijklmnopqrstuvwxyz' 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'`
+  cat >> confdefs.h <<EOF
+#define $ac_tr_func 1
+EOF
+ 
+else
+  echo "$ac_t""no" 1>&6
 fi
 done
 
-            echo "$as_me:$LINENO: checking for _nl_msg_cat_cntr" >&5
-echo $ECHO_N "checking for _nl_msg_cat_cntr... $ECHO_C" >&6
-      cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+            echo $ac_n "checking for _nl_msg_cat_cntr""... $ac_c" 1>&6
+echo "configure:8264: checking for _nl_msg_cat_cntr" >&5
+      cat > conftest.$ac_ext <<EOF
+#line 8266 "configure"
+#include "confdefs.h"
 #include <libintl.h>
 		extern int _nl_msg_cat_cntr;
-int
-main ()
-{
+int main() {
 ++_nl_msg_cat_cntr;
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6; cat >>confdefs.h <<\_ACEOF
+; return 0; }
+EOF
+if { (eval echo configure:8274: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  echo "$ac_t""yes" 1>&6; cat >> confdefs.h <<\EOF
 #define HAVE_NL_MSG_CAT_CNTR 1
-_ACEOF
+EOF
 
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  echo "$ac_t""no" 1>&6
 fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
+rm -f conftest*
     fi
   else
-    echo "$as_me:$LINENO: result: no \"po/Makefile\" - disabled" >&5
-echo "${ECHO_T}no \"po/Makefile\" - disabled" >&6;
+    echo "$ac_t""no "po/Makefile" - disabled" 1>&6;
   fi
 else
-  echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6
+  echo "$ac_t""yes" 1>&6
 fi
 
-if test "${ac_cv_header_dlfcn_h+set}" = set; then
-  echo "$as_me:$LINENO: checking for dlfcn.h" >&5
-echo $ECHO_N "checking for dlfcn.h... $ECHO_C" >&6
-if test "${ac_cv_header_dlfcn_h+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-fi
-echo "$as_me:$LINENO: result: $ac_cv_header_dlfcn_h" >&5
-echo "${ECHO_T}$ac_cv_header_dlfcn_h" >&6
+ac_safe=`echo "dlfcn.h" | sed 'y%./+-%__p_%'`
+echo $ac_n "checking for dlfcn.h""... $ac_c" 1>&6
+echo "configure:8297: checking for dlfcn.h" >&5
+if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-  # Is the header compilable?
-echo "$as_me:$LINENO: checking dlfcn.h usability" >&5
-echo $ECHO_N "checking dlfcn.h usability... $ECHO_C" >&6
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-$ac_includes_default
+  cat > conftest.$ac_ext <<EOF
+#line 8302 "configure"
+#include "confdefs.h"
 #include <dlfcn.h>
-_ACEOF
-rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_header_compiler=yes
+EOF
+ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
+{ (eval echo configure:8307: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
+ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
+if test -z "$ac_err"; then
+  rm -rf conftest*
+  eval "ac_cv_header_$ac_safe=yes"
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-ac_header_compiler=no
+  echo "$ac_err" >&5
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_header_$ac_safe=no"
 fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
-echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
-echo "${ECHO_T}$ac_header_compiler" >&6
-
-# Is the header present?
-echo "$as_me:$LINENO: checking dlfcn.h presence" >&5
-echo $ECHO_N "checking dlfcn.h presence... $ECHO_C" >&6
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-#include <dlfcn.h>
-_ACEOF
-if { (eval echo "$as_me:$LINENO: \"$ac_cpp conftest.$ac_ext\"") >&5
-  (eval $ac_cpp conftest.$ac_ext) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } >/dev/null; then
-  if test -s conftest.err; then
-    ac_cpp_err=$ac_c_preproc_warn_flag
-    ac_cpp_err=$ac_cpp_err$ac_c_werror_flag
-  else
-    ac_cpp_err=
-  fi
-else
-  ac_cpp_err=yes
+rm -f conftest*
 fi
-if test -z "$ac_cpp_err"; then
-  ac_header_preproc=yes
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-  ac_header_preproc=no
-fi
-rm -f conftest.err conftest.$ac_ext
-echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
-echo "${ECHO_T}$ac_header_preproc" >&6
-
-# So?  What about this header?
-case $ac_header_compiler:$ac_header_preproc:$ac_c_preproc_warn_flag in
-  yes:no: )
-    { echo "$as_me:$LINENO: WARNING: dlfcn.h: accepted by the compiler, rejected by the preprocessor!" >&5
-echo "$as_me: WARNING: dlfcn.h: accepted by the compiler, rejected by the preprocessor!" >&2;}
-    { echo "$as_me:$LINENO: WARNING: dlfcn.h: proceeding with the compiler's result" >&5
-echo "$as_me: WARNING: dlfcn.h: proceeding with the compiler's result" >&2;}
-    ac_header_preproc=yes
-    ;;
-  no:yes:* )
-    { echo "$as_me:$LINENO: WARNING: dlfcn.h: present but cannot be compiled" >&5
-echo "$as_me: WARNING: dlfcn.h: present but cannot be compiled" >&2;}
-    { echo "$as_me:$LINENO: WARNING: dlfcn.h:     check for missing prerequisite headers?" >&5
-echo "$as_me: WARNING: dlfcn.h:     check for missing prerequisite headers?" >&2;}
-    { echo "$as_me:$LINENO: WARNING: dlfcn.h: see the Autoconf documentation" >&5
-echo "$as_me: WARNING: dlfcn.h: see the Autoconf documentation" >&2;}
-    { echo "$as_me:$LINENO: WARNING: dlfcn.h:     section \"Present But Cannot Be Compiled\"" >&5
-echo "$as_me: WARNING: dlfcn.h:     section \"Present But Cannot Be Compiled\"" >&2;}
-    { echo "$as_me:$LINENO: WARNING: dlfcn.h: proceeding with the preprocessor's result" >&5
-echo "$as_me: WARNING: dlfcn.h: proceeding with the preprocessor's result" >&2;}
-    { echo "$as_me:$LINENO: WARNING: dlfcn.h: in the future, the compiler will take precedence" >&5
-echo "$as_me: WARNING: dlfcn.h: in the future, the compiler will take precedence" >&2;}
-    (
-      cat <<\_ASBOX
-## ------------------------------------------ ##
-## Report this to the AC_PACKAGE_NAME lists.  ##
-## ------------------------------------------ ##
-_ASBOX
-    ) |
-      sed "s/^/$as_me: WARNING:     /" >&2
-    ;;
-esac
-echo "$as_me:$LINENO: checking for dlfcn.h" >&5
-echo $ECHO_N "checking for dlfcn.h... $ECHO_C" >&6
-if test "${ac_cv_header_dlfcn_h+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  ac_cv_header_dlfcn_h=$ac_header_preproc
-fi
-echo "$as_me:$LINENO: result: $ac_cv_header_dlfcn_h" >&5
-echo "${ECHO_T}$ac_cv_header_dlfcn_h" >&6
-
-fi
-if test $ac_cv_header_dlfcn_h = yes; then
+if eval "test \"`echo '$ac_cv_header_'$ac_safe`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
   DLL=dlfcn.h
 else
-  if test "${ac_cv_header_dl_h+set}" = set; then
-  echo "$as_me:$LINENO: checking for dl.h" >&5
-echo $ECHO_N "checking for dl.h... $ECHO_C" >&6
-if test "${ac_cv_header_dl_h+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-fi
-echo "$as_me:$LINENO: result: $ac_cv_header_dl_h" >&5
-echo "${ECHO_T}$ac_cv_header_dl_h" >&6
+  echo "$ac_t""no" 1>&6
+ac_safe=`echo "dl.h" | sed 'y%./+-%__p_%'`
+echo $ac_n "checking for dl.h""... $ac_c" 1>&6
+echo "configure:8328: checking for dl.h" >&5
+if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-  # Is the header compilable?
-echo "$as_me:$LINENO: checking dl.h usability" >&5
-echo $ECHO_N "checking dl.h usability... $ECHO_C" >&6
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-$ac_includes_default
+  cat > conftest.$ac_ext <<EOF
+#line 8333 "configure"
+#include "confdefs.h"
 #include <dl.h>
-_ACEOF
-rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_header_compiler=yes
+EOF
+ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
+{ (eval echo configure:8338: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
+ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
+if test -z "$ac_err"; then
+  rm -rf conftest*
+  eval "ac_cv_header_$ac_safe=yes"
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-ac_header_compiler=no
+  echo "$ac_err" >&5
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_header_$ac_safe=no"
 fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
-echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
-echo "${ECHO_T}$ac_header_compiler" >&6
-
-# Is the header present?
-echo "$as_me:$LINENO: checking dl.h presence" >&5
-echo $ECHO_N "checking dl.h presence... $ECHO_C" >&6
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-#include <dl.h>
-_ACEOF
-if { (eval echo "$as_me:$LINENO: \"$ac_cpp conftest.$ac_ext\"") >&5
-  (eval $ac_cpp conftest.$ac_ext) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } >/dev/null; then
-  if test -s conftest.err; then
-    ac_cpp_err=$ac_c_preproc_warn_flag
-    ac_cpp_err=$ac_cpp_err$ac_c_werror_flag
-  else
-    ac_cpp_err=
-  fi
-else
-  ac_cpp_err=yes
+rm -f conftest*
 fi
-if test -z "$ac_cpp_err"; then
-  ac_header_preproc=yes
+if eval "test \"`echo '$ac_cv_header_'$ac_safe`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
+  DLL=dl.h
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-  ac_header_preproc=no
+  echo "$ac_t""no" 1>&6
 fi
-rm -f conftest.err conftest.$ac_ext
-echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
-echo "${ECHO_T}$ac_header_preproc" >&6
 
-# So?  What about this header?
-case $ac_header_compiler:$ac_header_preproc:$ac_c_preproc_warn_flag in
-  yes:no: )
-    { echo "$as_me:$LINENO: WARNING: dl.h: accepted by the compiler, rejected by the preprocessor!" >&5
-echo "$as_me: WARNING: dl.h: accepted by the compiler, rejected by the preprocessor!" >&2;}
-    { echo "$as_me:$LINENO: WARNING: dl.h: proceeding with the compiler's result" >&5
-echo "$as_me: WARNING: dl.h: proceeding with the compiler's result" >&2;}
-    ac_header_preproc=yes
-    ;;
-  no:yes:* )
-    { echo "$as_me:$LINENO: WARNING: dl.h: present but cannot be compiled" >&5
-echo "$as_me: WARNING: dl.h: present but cannot be compiled" >&2;}
-    { echo "$as_me:$LINENO: WARNING: dl.h:     check for missing prerequisite headers?" >&5
-echo "$as_me: WARNING: dl.h:     check for missing prerequisite headers?" >&2;}
-    { echo "$as_me:$LINENO: WARNING: dl.h: see the Autoconf documentation" >&5
-echo "$as_me: WARNING: dl.h: see the Autoconf documentation" >&2;}
-    { echo "$as_me:$LINENO: WARNING: dl.h:     section \"Present But Cannot Be Compiled\"" >&5
-echo "$as_me: WARNING: dl.h:     section \"Present But Cannot Be Compiled\"" >&2;}
-    { echo "$as_me:$LINENO: WARNING: dl.h: proceeding with the preprocessor's result" >&5
-echo "$as_me: WARNING: dl.h: proceeding with the preprocessor's result" >&2;}
-    { echo "$as_me:$LINENO: WARNING: dl.h: in the future, the compiler will take precedence" >&5
-echo "$as_me: WARNING: dl.h: in the future, the compiler will take precedence" >&2;}
-    (
-      cat <<\_ASBOX
-## ------------------------------------------ ##
-## Report this to the AC_PACKAGE_NAME lists.  ##
-## ------------------------------------------ ##
-_ASBOX
-    ) |
-      sed "s/^/$as_me: WARNING:     /" >&2
-    ;;
-esac
-echo "$as_me:$LINENO: checking for dl.h" >&5
-echo $ECHO_N "checking for dl.h... $ECHO_C" >&6
-if test "${ac_cv_header_dl_h+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  ac_cv_header_dl_h=$ac_header_preproc
 fi
-echo "$as_me:$LINENO: result: $ac_cv_header_dl_h" >&5
-echo "${ECHO_T}$ac_cv_header_dl_h" >&6
 
-fi
-if test $ac_cv_header_dl_h = yes; then
-  DLL=dl.h
-fi
-
-
-fi
-
-
 if test x${DLL} = xdlfcn.h; then
-
-cat >>confdefs.h <<\_ACEOF
+  cat >> confdefs.h <<\EOF
 #define HAVE_DLFCN_H 1
-_ACEOF
+EOF
 
-  echo "$as_me:$LINENO: checking for dlopen()" >&5
-echo $ECHO_N "checking for dlopen()... $ECHO_C" >&6
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+  echo $ac_n "checking for dlopen()""... $ac_c" 1>&6
+echo "configure:8367: checking for dlopen()" >&5
+  cat > conftest.$ac_ext <<EOF
+#line 8369 "configure"
+#include "confdefs.h"
 
-int
-main ()
-{
+int main() {
 
 		extern void* dlopen();
 		dlopen();
-
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6;
-
-cat >>confdefs.h <<\_ACEOF
+      
+; return 0; }
+EOF
+if { (eval echo configure:8379: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  echo "$ac_t""yes" 1>&6;
+	      cat >> confdefs.h <<\EOF
 #define HAVE_DLOPEN 1
-_ACEOF
+EOF
 
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6;
-	      echo "$as_me:$LINENO: checking for dlopen() in -ldl" >&5
-echo $ECHO_N "checking for dlopen() in -ldl... $ECHO_C" >&6
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  echo "$ac_t""no" 1>&6;
+	      echo $ac_n "checking for dlopen() in -ldl""... $ac_c" 1>&6
+echo "configure:8392: checking for dlopen() in -ldl" >&5
 	      olibs=$LIBS
 	      LIBS="$LIBS -ldl"
-	      cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+	      cat > conftest.$ac_ext <<EOF
+#line 8396 "configure"
+#include "confdefs.h"
 
-int
-main ()
-{
+int main() {
 
 				extern void* dlopen();
 				dlopen();
-
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6;
-
-cat >>confdefs.h <<\_ACEOF
+		 
+; return 0; }
+EOF
+if { (eval echo configure:8406: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  echo "$ac_t""yes" 1>&6;
+			  cat >> confdefs.h <<\EOF
 #define HAVE_DLOPEN 1
-_ACEOF
+EOF
 
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6;
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  echo "$ac_t""no" 1>&6;
 			  LIBS=$olibs
 fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
+rm -f conftest*
 fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
-      echo "$as_me:$LINENO: checking for dlsym()" >&5
-echo $ECHO_N "checking for dlsym()... $ECHO_C" >&6
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+rm -f conftest*
+      echo $ac_n "checking for dlsym()""... $ac_c" 1>&6
+echo "configure:8424: checking for dlsym()" >&5
+  cat > conftest.$ac_ext <<EOF
+#line 8426 "configure"
+#include "confdefs.h"
 
-int
-main ()
-{
+int main() {
 
 		extern void* dlsym();
 		dlsym();
-
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6;
-
-cat >>confdefs.h <<\_ACEOF
+      
+; return 0; }
+EOF
+if { (eval echo configure:8436: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  echo "$ac_t""yes" 1>&6;
+	      cat >> confdefs.h <<\EOF
 #define HAVE_DLSYM 1
-_ACEOF
+EOF
 
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6;
-	      echo "$as_me:$LINENO: checking for dlsym() in -ldl" >&5
-echo $ECHO_N "checking for dlsym() in -ldl... $ECHO_C" >&6
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  echo "$ac_t""no" 1>&6;
+	      echo $ac_n "checking for dlsym() in -ldl""... $ac_c" 1>&6
+echo "configure:8449: checking for dlsym() in -ldl" >&5
 	      olibs=$LIBS
 	      LIBS="$LIBS -ldl"
-	      cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+	      cat > conftest.$ac_ext <<EOF
+#line 8453 "configure"
+#include "confdefs.h"
 
-int
-main ()
-{
+int main() {
 
 				extern void* dlsym();
 				dlsym();
-
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6;
-
-cat >>confdefs.h <<\_ACEOF
+		 
+; return 0; }
+EOF
+if { (eval echo configure:8463: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  echo "$ac_t""yes" 1>&6;
+			  cat >> confdefs.h <<\EOF
 #define HAVE_DLSYM 1
-_ACEOF
+EOF
 
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6;
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  echo "$ac_t""no" 1>&6;
 			  LIBS=$olibs
 fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
+rm -f conftest*
 fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
+rm -f conftest*
 elif test x${DLL} = xdl.h; then
-
-cat >>confdefs.h <<\_ACEOF
+  cat >> confdefs.h <<\EOF
 #define HAVE_DL_H 1
-_ACEOF
+EOF
 
-  echo "$as_me:$LINENO: checking for shl_load()" >&5
-echo $ECHO_N "checking for shl_load()... $ECHO_C" >&6
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+  echo $ac_n "checking for shl_load()""... $ac_c" 1>&6
+echo "configure:8486: checking for shl_load()" >&5
+  cat > conftest.$ac_ext <<EOF
+#line 8488 "configure"
+#include "confdefs.h"
 
-int
-main ()
-{
+int main() {
 
 		extern void* shl_load();
 		shl_load();
-
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6;
-
-cat >>confdefs.h <<\_ACEOF
+     
+; return 0; }
+EOF
+if { (eval echo configure:8498: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  echo "$ac_t""yes" 1>&6;
+	  cat >> confdefs.h <<\EOF
 #define HAVE_SHL_LOAD 1
-_ACEOF
+EOF
 
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6;
-	  echo "$as_me:$LINENO: checking for shl_load() in -ldld" >&5
-echo $ECHO_N "checking for shl_load() in -ldld... $ECHO_C" >&6
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  echo "$ac_t""no" 1>&6;
+	  echo $ac_n "checking for shl_load() in -ldld""... $ac_c" 1>&6
+echo "configure:8511: checking for shl_load() in -ldld" >&5
 	  olibs=$LIBS
 	  LIBS="$LIBS -ldld"
-	  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+	  cat > conftest.$ac_ext <<EOF
+#line 8515 "configure"
+#include "confdefs.h"
 
-int
-main ()
-{
+int main() {
 
 			extern void* shl_load();
 			shl_load();
-
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6;
-
-cat >>confdefs.h <<\_ACEOF
+	     
+; return 0; }
+EOF
+if { (eval echo configure:8525: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  echo "$ac_t""yes" 1>&6;
+		  cat >> confdefs.h <<\EOF
 #define HAVE_SHL_LOAD 1
-_ACEOF
+EOF
 
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6;
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  echo "$ac_t""no" 1>&6;
 		  LIBS=$olibs
 fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
+rm -f conftest*
 fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
+rm -f conftest*
 fi
-
-for ac_header in setjmp.h
+for ac_hdr in setjmp.h
 do
-as_ac_Header=`echo "ac_cv_header_$ac_header" | $as_tr_sh`
-if eval "test \"\${$as_ac_Header+set}\" = set"; then
-  echo "$as_me:$LINENO: checking for $ac_header" >&5
-echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6
-if eval "test \"\${$as_ac_Header+set}\" = set"; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-fi
-echo "$as_me:$LINENO: result: `eval echo '${'$as_ac_Header'}'`" >&5
-echo "${ECHO_T}`eval echo '${'$as_ac_Header'}'`" >&6
+ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
+echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
+echo "configure:8547: checking for $ac_hdr" >&5
+if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-  # Is the header compilable?
-echo "$as_me:$LINENO: checking $ac_header usability" >&5
-echo $ECHO_N "checking $ac_header usability... $ECHO_C" >&6
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-$ac_includes_default
-#include <$ac_header>
-_ACEOF
-rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"
-			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_header_compiler=yes
+  cat > conftest.$ac_ext <<EOF
+#line 8552 "configure"
+#include "confdefs.h"
+#include <$ac_hdr>
+EOF
+ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
+{ (eval echo configure:8557: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
+ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
+if test -z "$ac_err"; then
+  rm -rf conftest*
+  eval "ac_cv_header_$ac_safe=yes"
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-ac_header_compiler=no
+  echo "$ac_err" >&5
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_header_$ac_safe=no"
 fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
-echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
-echo "${ECHO_T}$ac_header_compiler" >&6
-
-# Is the header present?
-echo "$as_me:$LINENO: checking $ac_header presence" >&5
-echo $ECHO_N "checking $ac_header presence... $ECHO_C" >&6
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-#include <$ac_header>
-_ACEOF
-if { (eval echo "$as_me:$LINENO: \"$ac_cpp conftest.$ac_ext\"") >&5
-  (eval $ac_cpp conftest.$ac_ext) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } >/dev/null; then
-  if test -s conftest.err; then
-    ac_cpp_err=$ac_c_preproc_warn_flag
-    ac_cpp_err=$ac_cpp_err$ac_c_werror_flag
-  else
-    ac_cpp_err=
-  fi
-else
-  ac_cpp_err=yes
+rm -f conftest*
 fi
-if test -z "$ac_cpp_err"; then
-  ac_header_preproc=yes
+if eval "test \"`echo '$ac_cv_header_'$ac_safe`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
+    ac_tr_hdr=HAVE_`echo $ac_hdr | sed 'y%abcdefghijklmnopqrstuvwxyz./-%ABCDEFGHIJKLMNOPQRSTUVWXYZ___%'`
+  cat >> confdefs.h <<EOF
+#define $ac_tr_hdr 1
+EOF
+ 
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-  ac_header_preproc=no
+  echo "$ac_t""no" 1>&6
 fi
-rm -f conftest.err conftest.$ac_ext
-echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
-echo "${ECHO_T}$ac_header_preproc" >&6
-
-# So?  What about this header?
-case $ac_header_compiler:$ac_header_preproc:$ac_c_preproc_warn_flag in
-  yes:no: )
-    { echo "$as_me:$LINENO: WARNING: $ac_header: accepted by the compiler, rejected by the preprocessor!" >&5
-echo "$as_me: WARNING: $ac_header: accepted by the compiler, rejected by the preprocessor!" >&2;}
-    { echo "$as_me:$LINENO: WARNING: $ac_header: proceeding with the compiler's result" >&5
-echo "$as_me: WARNING: $ac_header: proceeding with the compiler's result" >&2;}
-    ac_header_preproc=yes
-    ;;
-  no:yes:* )
-    { echo "$as_me:$LINENO: WARNING: $ac_header: present but cannot be compiled" >&5
-echo "$as_me: WARNING: $ac_header: present but cannot be compiled" >&2;}
-    { echo "$as_me:$LINENO: WARNING: $ac_header:     check for missing prerequisite headers?" >&5
-echo "$as_me: WARNING: $ac_header:     check for missing prerequisite headers?" >&2;}
-    { echo "$as_me:$LINENO: WARNING: $ac_header: see the Autoconf documentation" >&5
-echo "$as_me: WARNING: $ac_header: see the Autoconf documentation" >&2;}
-    { echo "$as_me:$LINENO: WARNING: $ac_header:     section \"Present But Cannot Be Compiled\"" >&5
-echo "$as_me: WARNING: $ac_header:     section \"Present But Cannot Be Compiled\"" >&2;}
-    { echo "$as_me:$LINENO: WARNING: $ac_header: proceeding with the preprocessor's result" >&5
-echo "$as_me: WARNING: $ac_header: proceeding with the preprocessor's result" >&2;}
-    { echo "$as_me:$LINENO: WARNING: $ac_header: in the future, the compiler will take precedence" >&5
-echo "$as_me: WARNING: $ac_header: in the future, the compiler will take precedence" >&2;}
-    (
-      cat <<\_ASBOX
-## ------------------------------------------ ##
-## Report this to the AC_PACKAGE_NAME lists.  ##
-## ------------------------------------------ ##
-_ASBOX
-    ) |
-      sed "s/^/$as_me: WARNING:     /" >&2
-    ;;
-esac
-echo "$as_me:$LINENO: checking for $ac_header" >&5
-echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6
-if eval "test \"\${$as_ac_Header+set}\" = set"; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  eval "$as_ac_Header=\$ac_header_preproc"
-fi
-echo "$as_me:$LINENO: result: `eval echo '${'$as_ac_Header'}'`" >&5
-echo "${ECHO_T}`eval echo '${'$as_ac_Header'}'`" >&6
-
-fi
-if test `eval echo '${'$as_ac_Header'}'` = yes; then
-  cat >>confdefs.h <<_ACEOF
-#define `echo "HAVE_$ac_header" | $as_tr_cpp` 1
-_ACEOF
-
-fi
-
 done
 
 
@@ -15300,24 +8589,22 @@
 
 if test "x$MACOSX" = "xyes" && test "x$CARBON" = "xyes" \
 	&& test "x$GUITYPE" != "xCARBONGUI"; then
-  echo "$as_me:$LINENO: checking whether we need -framework Carbon" >&5
-echo $ECHO_N "checking whether we need -framework Carbon... $ECHO_C" >&6
+  echo $ac_n "checking whether we need -framework Carbon""... $ac_c" 1>&6
+echo "configure:8594: checking whether we need -framework Carbon" >&5
     if test "x$enable_multibyte" = "xyes" || test "x$features" == "xbig" \
 	|| test "x$features" = "xhuge"; then
     LIBS="$LIBS -framework Carbon"
-    echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6
+    echo "$ac_t""yes" 1>&6
   else
-    echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
+    echo "$ac_t""no" 1>&6
   fi
 fi
 if test "x$MACARCH" = "xboth"; then
   LDFLAGS="$LDFLAGS -isysroot /Developer/SDKs/MacOSX10.4u.sdk -arch i386 -arch ppc"
 fi
 
-echo "$as_me:$LINENO: checking for GCC 3 or later" >&5
-echo $ECHO_N "checking for GCC 3 or later... $ECHO_C" >&6
+echo $ac_n "checking for GCC 3 or later""... $ac_c" 1>&6
+echo "configure:8608: checking for GCC 3 or later" >&5
 DEPEND_CFLAGS_FILTER=
 if test "$GCC" = yes; then
   gccmajor=`echo "$gccversion" | sed -e 's/^\([1-9]\)\..*$/\1/g'`
@@ -15326,1202 +8613,545 @@
   fi
 fi
 if test "$DEPEND_CFLAGS_FILTER" = ""; then
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
+  echo "$ac_t""no" 1>&6
 else
-  echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6
+  echo "$ac_t""yes" 1>&6
 fi
 
 
-          ac_config_files="$ac_config_files auto/config.mk:config.mk.in"
-cat >confcache <<\_ACEOF
-# This file is a shell script that caches the results of configure
-# tests run on this system so they can be shared between configure
-# scripts and configure runs, see configure's option --config-cache.
-# It is not useful on other systems.  If it contains results you don't
-# want to keep, you may remove or edit it.
-#
-# config.status only pays attention to the cache file if you give it
-# the --recheck option to rerun configure.
-#
-# `ac_cv_env_foo' variables (set or unset) will be overridden when
-# loading this file, other *unset* `ac_cv_foo' will be assigned the
-# following values.
-
-_ACEOF
-
-# The following way of writing the cache mishandles newlines in values,
-# but we know of no workaround that is simple, portable, and efficient.
-# So, don't put newlines in cache variables' values.
-# Ultrix sh set writes to stderr and can't be redirected directly,
-# and sets the high bit in the cache file unless we assign to the vars.
-{
-  (set) 2>&1 |
-    case `(ac_space=' '; set | grep ac_space) 2>&1` in
-    *ac_space=\ *)
-      # `set' does not quote correctly, so add quotes (double-quote
-      # substitution turns \\\\ into \\, and sed turns \\ into \).
-      sed -n \
-	"s/'/'\\\\''/g;
-	  s/^\\([_$as_cr_alnum]*_cv_[_$as_cr_alnum]*\\)=\\(.*\\)/\\1='\\2'/p"
-      ;;
-    *)
-      # `set' quotes correctly as required by POSIX, so do not add quotes.
-      sed -n \
-	"s/^\\([_$as_cr_alnum]*_cv_[_$as_cr_alnum]*\\)=\\(.*\\)/\\1=\\2/p"
-      ;;
-    esac;
-} |
-  sed '
-     t clear
-     : clear
-     s/^\([^=]*\)=\(.*[{}].*\)$/test "${\1+set}" = set || &/
-     t end
-     /^ac_cv_env/!s/^\([^=]*\)=\(.*\)$/\1=${\1=\2}/
-     : end' >>confcache
-if diff $cache_file confcache >/dev/null 2>&1; then :; else
-  if test -w $cache_file; then
-    test "x$cache_file" != "x/dev/null" && echo "updating cache $cache_file"
-    cat confcache >$cache_file
-  else
-    echo "not updating unwritable cache $cache_file"
-  fi
-fi
-rm -f confcache
-
-test "x$prefix" = xNONE && prefix=$ac_default_prefix
-# Let make expand exec_prefix.
-test "x$exec_prefix" = xNONE && exec_prefix='${prefix}'
-
-# VPATH may cause trouble with some makes, so we remove $(srcdir),
-# ${srcdir} and @srcdir@ from VPATH if srcdir is ".", strip leading and
-# trailing colons and then remove the whole line if VPATH becomes empty
-# (actually we leave an empty line to preserve line numbers).
-if test "x$srcdir" = x.; then
-  ac_vpsub='/^[	 ]*VPATH[	 ]*=/{
-s/:*\$(srcdir):*/:/;
-s/:*\${srcdir}:*/:/;
-s/:*@srcdir@:*/:/;
-s/^\([^=]*=[	 ]*\):*/\1/;
-s/:*$//;
-s/^[^=]*=[	 ]*$//;
-}'
-fi
-
-DEFS=-DHAVE_CONFIG_H
-
-ac_libobjs=
-ac_ltlibobjs=
-for ac_i in : $LIBOBJS; do test "x$ac_i" = x: && continue
-  # 1. Remove the extension, and $U if already installed.
-  ac_i=`echo "$ac_i" |
-	 sed 's/\$U\././;s/\.o$//;s/\.obj$//'`
-  # 2. Add them.
-  ac_libobjs="$ac_libobjs $ac_i\$U.$ac_objext"
-  ac_ltlibobjs="$ac_ltlibobjs $ac_i"'$U.lo'
-done
-LIBOBJS=$ac_libobjs
-
-LTLIBOBJS=$ac_ltlibobjs
-
-
-
-: ${CONFIG_STATUS=./config.status}
-ac_clean_files_save=$ac_clean_files
-ac_clean_files="$ac_clean_files $CONFIG_STATUS"
-{ echo "$as_me:$LINENO: creating $CONFIG_STATUS" >&5
-echo "$as_me: creating $CONFIG_STATUS" >&6;}
-cat >$CONFIG_STATUS <<_ACEOF
-#! $SHELL
-# Generated by $as_me.
-# Run this file to recreate the current configuration.
-# Compiler output produced by configure, useful for debugging
-# configure, is in config.log if it exists.
-
-debug=false
-ac_cs_recheck=false
-ac_cs_silent=false
-SHELL=\${CONFIG_SHELL-$SHELL}
-_ACEOF
-
-cat >>$CONFIG_STATUS <<\_ACEOF
-## --------------------- ##
-## M4sh Initialization.  ##
-## --------------------- ##
-
-# Be Bourne compatible
-if test -n "${ZSH_VERSION+set}" && (emulate sh) >/dev/null 2>&1; then
-  emulate sh
-  NULLCMD=:
-  # Zsh 3.x and 4.x performs word splitting on ${1+"$@"}, which
-  # is contrary to our usage.  Disable this feature.
-  alias -g '${1+"$@"}'='"$@"'
-elif test -n "${BASH_VERSION+set}" && (set -o posix) >/dev/null 2>&1; then
-  set -o posix
-fi
-DUALCASE=1; export DUALCASE # for MKS sh
-
-# Support unset when possible.
-if ( (MAIL=60; unset MAIL) || exit) >/dev/null 2>&1; then
-  as_unset=unset
+if test "$(uname)" = "Darwin"; then
+      LIBS="$LIBS"
 else
-  as_unset=false
+      LIBS="$LIBS -lutil"
 fi
-
-
-# Work around bugs in pre-3.0 UWIN ksh.
-$as_unset ENV MAIL MAILPATH
-PS1='$ '
-PS2='> '
-PS4='+ '
-
-# NLS nuisances.
-for as_var in \
-  LANG LANGUAGE LC_ADDRESS LC_ALL LC_COLLATE LC_CTYPE LC_IDENTIFICATION \
-  LC_MEASUREMENT LC_MESSAGES LC_MONETARY LC_NAME LC_NUMERIC LC_PAPER \
-  LC_TELEPHONE LC_TIME
+for ac_hdr in pty.h libutil.h stdint.h
 do
-  if (set +x; test -z "`(eval $as_var=C; export $as_var) 2>&1`"); then
-    eval $as_var=C; export $as_var
-  else
-    $as_unset $as_var
-  fi
-done
-
-# Required to use basename.
-if expr a : '\(a\)' >/dev/null 2>&1; then
-  as_expr=expr
+ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
+echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
+echo "configure:8632: checking for $ac_hdr" >&5
+if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
 else
-  as_expr=false
-fi
-
-if (basename /) >/dev/null 2>&1 && test "X`basename / 2>&1`" = "X/"; then
-  as_basename=basename
+  cat > conftest.$ac_ext <<EOF
+#line 8637 "configure"
+#include "confdefs.h"
+#include <$ac_hdr>
+EOF
+ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
+{ (eval echo configure:8642: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
+ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
+if test -z "$ac_err"; then
+  rm -rf conftest*
+  eval "ac_cv_header_$ac_safe=yes"
 else
-  as_basename=false
+  echo "$ac_err" >&5
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_header_$ac_safe=no"
 fi
-
-
-# Name of the executable.
-as_me=`$as_basename "$0" ||
-$as_expr X/"$0" : '.*/\([^/][^/]*\)/*$' \| \
-	 X"$0" : 'X\(//\)$' \| \
-	 X"$0" : 'X\(/\)$' \| \
-	 .     : '\(.\)' 2>/dev/null ||
-echo X/"$0" |
-    sed '/^.*\/\([^/][^/]*\)\/*$/{ s//\1/; q; }
-  	  /^X\/\(\/\/\)$/{ s//\1/; q; }
-  	  /^X\/\(\/\).*/{ s//\1/; q; }
-  	  s/.*/./; q'`
-
-
-# PATH needs CR, and LINENO needs CR and PATH.
-# Avoid depending upon Character Ranges.
-as_cr_letters='abcdefghijklmnopqrstuvwxyz'
-as_cr_LETTERS='ABCDEFGHIJKLMNOPQRSTUVWXYZ'
-as_cr_Letters=$as_cr_letters$as_cr_LETTERS
-as_cr_digits='0123456789'
-as_cr_alnum=$as_cr_Letters$as_cr_digits
-
-# The user is always right.
-if test "${PATH_SEPARATOR+set}" != set; then
-  echo "#! /bin/sh" >conf$$.sh
-  echo  "exit 0"   >>conf$$.sh
-  chmod +x conf$$.sh
-  if (PATH="/nonexistent;."; conf$$.sh) >/dev/null 2>&1; then
-    PATH_SEPARATOR=';'
-  else
-    PATH_SEPARATOR=:
-  fi
-  rm -f conf$$.sh
+rm -f conftest*
 fi
-
-
-  as_lineno_1=$LINENO
-  as_lineno_2=$LINENO
-  as_lineno_3=`(expr $as_lineno_1 + 1) 2>/dev/null`
-  test "x$as_lineno_1" != "x$as_lineno_2" &&
-  test "x$as_lineno_3"  = "x$as_lineno_2"  || {
-  # Find who we are.  Look in the path if we contain no path at all
-  # relative or not.
-  case $0 in
-    *[\\/]* ) as_myself=$0 ;;
-    *) as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  test -r "$as_dir/$0" && as_myself=$as_dir/$0 && break
+if eval "test \"`echo '$ac_cv_header_'$ac_safe`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
+    ac_tr_hdr=HAVE_`echo $ac_hdr | sed 'y%abcdefghijklmnopqrstuvwxyz./-%ABCDEFGHIJKLMNOPQRSTUVWXYZ___%'`
+  cat >> confdefs.h <<EOF
+#define $ac_tr_hdr 1
+EOF
+ 
+else
+  echo "$ac_t""no" 1>&6
+fi
 done
 
-       ;;
-  esac
-  # We did not find ourselves, most probably we were run as `sh COMMAND'
-  # in which case we are not to be found in the path.
-  if test "x$as_myself" = x; then
-    as_myself=$0
-  fi
-  if test ! -f "$as_myself"; then
-    { { echo "$as_me:$LINENO: error: cannot find myself; rerun with an absolute path" >&5
-echo "$as_me: error: cannot find myself; rerun with an absolute path" >&2;}
-   { (exit 1); exit 1; }; }
-  fi
-  case $CONFIG_SHELL in
-  '')
-    as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in /bin$PATH_SEPARATOR/usr/bin$PATH_SEPARATOR$PATH
+for ac_func in forkpty
 do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for as_base in sh bash ksh sh5; do
-	 case $as_dir in
-	 /*)
-	   if ("$as_dir/$as_base" -c '
-  as_lineno_1=$LINENO
-  as_lineno_2=$LINENO
-  as_lineno_3=`(expr $as_lineno_1 + 1) 2>/dev/null`
-  test "x$as_lineno_1" != "x$as_lineno_2" &&
-  test "x$as_lineno_3"  = "x$as_lineno_2" ') 2>/dev/null; then
-	     $as_unset BASH_ENV || test "${BASH_ENV+set}" != set || { BASH_ENV=; export BASH_ENV; }
-	     $as_unset ENV || test "${ENV+set}" != set || { ENV=; export ENV; }
-	     CONFIG_SHELL=$as_dir/$as_base
-	     export CONFIG_SHELL
-	     exec "$CONFIG_SHELL" "$0" ${1+"$@"}
-	   fi;;
-	 esac
-       done
-done
-;;
-  esac
+echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
+echo "configure:8671: checking for $ac_func" >&5
+if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
+else
+  cat > conftest.$ac_ext <<EOF
+#line 8676 "configure"
+#include "confdefs.h"
+/* System header to define __stub macros and hopefully few prototypes,
+    which can conflict with char $ac_func(); below.  */
+#include <assert.h>
+/* Override any gcc2 internal prototype to avoid an error.  */
+/* We use char because int might match the return type of a gcc2
+    builtin and then its argument prototype would still apply.  */
+char $ac_func();
 
-  # Create $as_me.lineno as a copy of $as_myself, but with $LINENO
-  # uniformly replaced by the line number.  The first 'sed' inserts a
-  # line-number line before each line; the second 'sed' does the real
-  # work.  The second script uses 'N' to pair each line-number line
-  # with the numbered line, and appends trailing '-' during
-  # substitution so that $LINENO is not a special case at line end.
-  # (Raja R Harinath suggested sed '=', and Paul Eggert wrote the
-  # second 'sed' script.  Blame Lee E. McMahon for sed's syntax.  :-)
-  sed '=' <$as_myself |
-    sed '
-      N
-      s,$,-,
-      : loop
-      s,^\(['$as_cr_digits']*\)\(.*\)[$]LINENO\([^'$as_cr_alnum'_]\),\1\2\1\3,
-      t loop
-      s,-$,,
-      s,^['$as_cr_digits']*\n,,
-    ' >$as_me.lineno &&
-  chmod +x $as_me.lineno ||
-    { { echo "$as_me:$LINENO: error: cannot create $as_me.lineno; rerun with a POSIX shell" >&5
-echo "$as_me: error: cannot create $as_me.lineno; rerun with a POSIX shell" >&2;}
-   { (exit 1); exit 1; }; }
+int main() {
 
-  # Don't try to exec as it changes $[0], causing all sort of problems
-  # (the dirname of $[0] is not the place where we might find the
-  # original and so on.  Autoconf is especially sensible to this).
-  . ./$as_me.lineno
-  # Exit status is that of the last command.
-  exit
-}
+/* The GNU C library defines this for functions which it implements
+    to always fail with ENOSYS.  Some functions are actually named
+    something starting with __ and the normal name is an alias.  */
+#if defined (__stub_$ac_func) || defined (__stub___$ac_func)
+choke me
+#else
+$ac_func();
+#endif
 
-
-case `echo "testing\c"; echo 1,2,3`,`echo -n testing; echo 1,2,3` in
-  *c*,-n*) ECHO_N= ECHO_C='
-' ECHO_T='	' ;;
-  *c*,*  ) ECHO_N=-n ECHO_C= ECHO_T= ;;
-  *)       ECHO_N= ECHO_C='\c' ECHO_T= ;;
-esac
-
-if expr a : '\(a\)' >/dev/null 2>&1; then
-  as_expr=expr
+; return 0; }
+EOF
+if { (eval echo configure:8699: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  eval "ac_cv_func_$ac_func=yes"
 else
-  as_expr=false
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_func_$ac_func=no"
 fi
-
-rm -f conf$$ conf$$.exe conf$$.file
-echo >conf$$.file
-if ln -s conf$$.file conf$$ 2>/dev/null; then
-  # We could just check for DJGPP; but this test a) works b) is more generic
-  # and c) will remain valid once DJGPP supports symlinks (DJGPP 2.04).
-  if test -f conf$$.exe; then
-    # Don't use ln at all; we don't have any links
-    as_ln_s='cp -p'
-  else
-    as_ln_s='ln -s'
-  fi
-elif ln conf$$.file conf$$ 2>/dev/null; then
-  as_ln_s=ln
-else
-  as_ln_s='cp -p'
+rm -f conftest*
 fi
-rm -f conf$$ conf$$.exe conf$$.file
 
-if mkdir -p . 2>/dev/null; then
-  as_mkdir_p=:
+if eval "test \"`echo '$ac_cv_func_'$ac_func`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
+    ac_tr_func=HAVE_`echo $ac_func | tr 'abcdefghijklmnopqrstuvwxyz' 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'`
+  cat >> confdefs.h <<EOF
+#define $ac_tr_func 1
+EOF
+ 
 else
-  test -d ./-p && rmdir ./-p
-  as_mkdir_p=false
+  echo "$ac_t""no" 1>&6
 fi
+done
 
-as_executable_p="test -f"
-
-# Sed expression to map a string onto a valid CPP name.
-as_tr_cpp="eval sed 'y%*$as_cr_letters%P$as_cr_LETTERS%;s%[^_$as_cr_alnum]%_%g'"
-
-# Sed expression to map a string onto a valid variable name.
-as_tr_sh="eval sed 'y%*+%pp%;s%[^_$as_cr_alnum]%_%g'"
-
-
-# IFS
-# We need space, tab and new line, in precisely that order.
-as_nl='
-'
-IFS=" 	$as_nl"
-
-# CDPATH.
-$as_unset CDPATH
-
-exec 6>&1
-
-# Open the log real soon, to keep \$[0] and so on meaningful, and to
-# report actual input values of CONFIG_FILES etc. instead of their
-# values after options handling.  Logging --version etc. is OK.
-exec 5>>auto/config.log
-{
-  echo
-  sed 'h;s/./-/g;s/^.../## /;s/...$/ ##/;p;x;p;x' <<_ASBOX
-## Running $as_me. ##
-_ASBOX
-} >&5
-cat >&5 <<_CSEOF
-
-This file was extended by $as_me, which was
-generated by GNU Autoconf 2.59.  Invocation command line was
-
-  CONFIG_FILES    = $CONFIG_FILES
-  CONFIG_HEADERS  = $CONFIG_HEADERS
-  CONFIG_LINKS    = $CONFIG_LINKS
-  CONFIG_COMMANDS = $CONFIG_COMMANDS
-  $ $0 $@
-
-_CSEOF
-echo "on `(hostname || uname -n) 2>/dev/null | sed 1q`" >&5
-echo >&5
-_ACEOF
-
-# Files that config.status was made for.
-if test -n "$ac_config_files"; then
-  echo "config_files=\"$ac_config_files\"" >>$CONFIG_STATUS
+if test $ac_cv_func_forkpty = no; then
+    { echo "configure: error: vimshell needs forkpty - sorry." 1>&2; exit 1; }
 fi
 
-if test -n "$ac_config_headers"; then
-  echo "config_headers=\"$ac_config_headers\"" >>$CONFIG_STATUS
-fi
-
-if test -n "$ac_config_links"; then
-  echo "config_links=\"$ac_config_links\"" >>$CONFIG_STATUS
-fi
-
-if test -n "$ac_config_commands"; then
-  echo "config_commands=\"$ac_config_commands\"" >>$CONFIG_STATUS
-fi
-
-cat >>$CONFIG_STATUS <<\_ACEOF
-
-ac_cs_usage="\
-\`$as_me' instantiates files from templates according to the
-current configuration.
-
-Usage: $0 [OPTIONS] [FILE]...
-
-  -h, --help       print this help, then exit
-  -V, --version    print version number, then exit
-  -q, --quiet      do not print progress messages
-  -d, --debug      don't remove temporary files
-      --recheck    update $as_me by reconfiguring in the same conditions
-  --file=FILE[:TEMPLATE]
-		   instantiate the configuration file FILE
-  --header=FILE[:TEMPLATE]
-		   instantiate the configuration header FILE
-
-Configuration files:
-$config_files
-
-Configuration headers:
-$config_headers
-
-Report bugs to <bug-autoconf@gnu.org>."
-_ACEOF
-
-cat >>$CONFIG_STATUS <<_ACEOF
-ac_cs_version="\\
-config.status
-configured by $0, generated by GNU Autoconf 2.59,
-  with options \\"`echo "$ac_configure_args" | sed 's/[\\""\`\$]/\\\\&/g'`\\"
-
-Copyright (C) 2003 Free Software Foundation, Inc.
-This config.status script is free software; the Free Software Foundation
-gives unlimited permission to copy, distribute and modify it."
-srcdir=$srcdir
-_ACEOF
-
-cat >>$CONFIG_STATUS <<\_ACEOF
-# If no file are specified by the user, then we need to provide default
-# value.  By we need to know if files were specified by the user.
-ac_need_defaults=:
-while test $# != 0
-do
-  case $1 in
-  --*=*)
-    ac_option=`expr "x$1" : 'x\([^=]*\)='`
-    ac_optarg=`expr "x$1" : 'x[^=]*=\(.*\)'`
-    ac_shift=:
+trap '' 1 2 15
+cat > confcache <<\EOF
+# This file is a shell script that caches the results of configure
+# tests run on this system so they can be shared between configure
+# scripts and configure runs.  It is not useful on other systems.
+# If it contains results you don't want to keep, you may remove or edit it.
+#
+# By default, configure uses ./config.cache as the cache file,
+# creating it if it does not exist already.  You can give configure
+# the --cache-file=FILE option to use a different cache file; that is
+# what configure does when it calls configure scripts in
+# subdirectories, so they share the cache.
+# Giving --cache-file=/dev/null disables caching, for debugging configure.
+# config.status only pays attention to the cache file if you give it the
+# --recheck option to rerun configure.
+#
+EOF
+# The following way of writing the cache mishandles newlines in values,
+# but we know of no workaround that is simple, portable, and efficient.
+# So, don't put newlines in cache variables' values.
+# Ultrix sh set writes to stderr and can't be redirected directly,
+# and sets the high bit in the cache file unless we assign to the vars.
+(set) 2>&1 |
+  case `(ac_space=' '; set | grep ac_space) 2>&1` in
+  *ac_space=\ *)
+    # `set' does not quote correctly, so add quotes (double-quote substitution
+    # turns \\\\ into \\, and sed turns \\ into \).
+    sed -n \
+      -e "s/'/'\\\\''/g" \
+      -e "s/^\\([a-zA-Z0-9_]*_cv_[a-zA-Z0-9_]*\\)=\\(.*\\)/\\1=\${\\1='\\2'}/p"
     ;;
-  -*)
-    ac_option=$1
-    ac_optarg=$2
-    ac_shift=shift
+  *)
+    # `set' quotes correctly as required by POSIX, so do not add quotes.
+    sed -n -e 's/^\([a-zA-Z0-9_]*_cv_[a-zA-Z0-9_]*\)=\(.*\)/\1=${\1=\2}/p'
     ;;
-  *) # This is not an option, so the user has probably given explicit
-     # arguments.
-     ac_option=$1
-     ac_need_defaults=false;;
-  esac
+  esac >> confcache
+if cmp -s $cache_file confcache; then
+  :
+else
+  if test -w $cache_file; then
+    echo "updating cache $cache_file"
+    cat confcache > $cache_file
+  else
+    echo "not updating unwritable cache $cache_file"
+  fi
+fi
+rm -f confcache
 
-  case $ac_option in
-  # Handling of the options.
-_ACEOF
-cat >>$CONFIG_STATUS <<\_ACEOF
-  -recheck | --recheck | --rechec | --reche | --rech | --rec | --re | --r)
-    ac_cs_recheck=: ;;
-  --version | --vers* | -V )
-    echo "$ac_cs_version"; exit 0 ;;
-  --he | --h)
-    # Conflict between --help and --header
-    { { echo "$as_me:$LINENO: error: ambiguous option: $1
-Try \`$0 --help' for more information." >&5
-echo "$as_me: error: ambiguous option: $1
-Try \`$0 --help' for more information." >&2;}
-   { (exit 1); exit 1; }; };;
-  --help | --hel | -h )
-    echo "$ac_cs_usage"; exit 0 ;;
-  --debug | --d* | -d )
-    debug=: ;;
-  --file | --fil | --fi | --f )
-    $ac_shift
-    CONFIG_FILES="$CONFIG_FILES $ac_optarg"
-    ac_need_defaults=false;;
-  --header | --heade | --head | --hea )
-    $ac_shift
-    CONFIG_HEADERS="$CONFIG_HEADERS $ac_optarg"
-    ac_need_defaults=false;;
-  -q | -quiet | --quiet | --quie | --qui | --qu | --q \
-  | -silent | --silent | --silen | --sile | --sil | --si | --s)
-    ac_cs_silent=: ;;
+trap 'rm -fr conftest* confdefs* core core.* *.core $ac_clean_files; exit 1' 1 2 15
 
-  # This is an error.
-  -*) { { echo "$as_me:$LINENO: error: unrecognized option: $1
-Try \`$0 --help' for more information." >&5
-echo "$as_me: error: unrecognized option: $1
-Try \`$0 --help' for more information." >&2;}
-   { (exit 1); exit 1; }; } ;;
+test "x$prefix" = xNONE && prefix=$ac_default_prefix
+# Let make expand exec_prefix.
+test "x$exec_prefix" = xNONE && exec_prefix='${prefix}'
 
-  *) ac_config_targets="$ac_config_targets $1" ;;
-
-  esac
-  shift
-done
-
-ac_configure_extra_args=
-
-if $ac_cs_silent; then
-  exec 6>/dev/null
-  ac_configure_extra_args="$ac_configure_extra_args --silent"
+# Any assignment to VPATH causes Sun make to only execute
+# the first set of double-colon rules, so remove it if not needed.
+# If there is a colon in the path, we need to keep it.
+if test "x$srcdir" = x.; then
+  ac_vpsub='/^[ 	]*VPATH[ 	]*=[^:]*$/d'
 fi
 
-_ACEOF
-cat >>$CONFIG_STATUS <<_ACEOF
-if \$ac_cs_recheck; then
-  echo "running $SHELL $0 " $ac_configure_args \$ac_configure_extra_args " --no-create --no-recursion" >&6
-  exec $SHELL $0 $ac_configure_args \$ac_configure_extra_args --no-create --no-recursion
-fi
+trap 'rm -f $CONFIG_STATUS conftest*; exit 1' 1 2 15
 
-_ACEOF
+DEFS=-DHAVE_CONFIG_H
 
+# Without the "./", some shells look in PATH for config.status.
+: ${CONFIG_STATUS=./config.status}
 
+echo creating $CONFIG_STATUS
+rm -f $CONFIG_STATUS
+cat > $CONFIG_STATUS <<EOF
+#! /bin/sh
+# Generated automatically by configure.
+# Run this file to recreate the current configuration.
+# This directory was configured as follows,
+# on host `(hostname || uname -n) 2>/dev/null | sed 1q`:
+#
+# $0 $ac_configure_args
+#
+# Compiler output produced by configure, useful for debugging
+# configure, is in auto/config.log if it exists.
 
-
-
-cat >>$CONFIG_STATUS <<\_ACEOF
-for ac_config_target in $ac_config_targets
+ac_cs_usage="Usage: $CONFIG_STATUS [--recheck] [--version] [--help]"
+for ac_option
 do
-  case "$ac_config_target" in
-  # Handling of arguments.
-  "auto/config.mk" ) CONFIG_FILES="$CONFIG_FILES auto/config.mk:config.mk.in" ;;
-  "auto/config.h" ) CONFIG_HEADERS="$CONFIG_HEADERS auto/config.h:config.h.in" ;;
-  *) { { echo "$as_me:$LINENO: error: invalid argument: $ac_config_target" >&5
-echo "$as_me: error: invalid argument: $ac_config_target" >&2;}
-   { (exit 1); exit 1; }; };;
+  case "\$ac_option" in
+  -recheck | --recheck | --rechec | --reche | --rech | --rec | --re | --r)
+    echo "running \${CONFIG_SHELL-/bin/sh} $0 $ac_configure_args --no-create --no-recursion"
+    exec \${CONFIG_SHELL-/bin/sh} $0 $ac_configure_args --no-create --no-recursion ;;
+  -version | --version | --versio | --versi | --vers | --ver | --ve | --v)
+    echo "$CONFIG_STATUS generated by autoconf version 2.13"
+    exit 0 ;;
+  -help | --help | --hel | --he | --h)
+    echo "\$ac_cs_usage"; exit 0 ;;
+  *) echo "\$ac_cs_usage"; exit 1 ;;
   esac
 done
 
-# If the user did not use the arguments to specify the items to instantiate,
-# then the envvar interface is used.  Set only those that are not.
-# We use the long form for the default assignment because of an extremely
-# bizarre bug on SunOS 4.1.3.
-if $ac_need_defaults; then
-  test "${CONFIG_FILES+set}" = set || CONFIG_FILES=$config_files
-  test "${CONFIG_HEADERS+set}" = set || CONFIG_HEADERS=$config_headers
-fi
+ac_given_srcdir=$srcdir
 
-# Have a temporary directory for convenience.  Make it in the build tree
-# simply because there is no reason to put it here, and in addition,
-# creating and moving files from /tmp can sometimes cause problems.
-# Create a temporary directory, and hook for its removal unless debugging.
-$debug ||
-{
-  trap 'exit_status=$?; rm -rf $tmp && exit $exit_status' 0
-  trap '{ (exit 1); exit 1; }' 1 2 13 15
-}
+trap 'rm -fr `echo "auto/config.mk:config.mk.in auto/config.h:config.h.in" | sed "s/:[^ ]*//g"` conftest*; exit 1' 1 2 15
+EOF
+cat >> $CONFIG_STATUS <<EOF
 
-# Create a (secure) tmp directory for tmp files.
+# Protect against being on the right side of a sed subst in config.status.
+sed 's/%@/@@/; s/@%/@@/; s/%g\$/@g/; /@g\$/s/[\\\\&%]/\\\\&/g;
+ s/@@/%@/; s/@@/@%/; s/@g\$/%g/' > conftest.subs <<\\CEOF
+$ac_vpsub
+$extrasub
+s%@SHELL@%$SHELL%g
+s%@CFLAGS@%$CFLAGS%g
+s%@CPPFLAGS@%$CPPFLAGS%g
+s%@CXXFLAGS@%$CXXFLAGS%g
+s%@FFLAGS@%$FFLAGS%g
+s%@DEFS@%$DEFS%g
+s%@LDFLAGS@%$LDFLAGS%g
+s%@LIBS@%$LIBS%g
+s%@exec_prefix@%$exec_prefix%g
+s%@prefix@%$prefix%g
+s%@program_transform_name@%$program_transform_name%g
+s%@bindir@%$bindir%g
+s%@sbindir@%$sbindir%g
+s%@libexecdir@%$libexecdir%g
+s%@datadir@%$datadir%g
+s%@sysconfdir@%$sysconfdir%g
+s%@sharedstatedir@%$sharedstatedir%g
+s%@localstatedir@%$localstatedir%g
+s%@libdir@%$libdir%g
+s%@includedir@%$includedir%g
+s%@oldincludedir@%$oldincludedir%g
+s%@infodir@%$infodir%g
+s%@mandir@%$mandir%g
+s%@SET_MAKE@%$SET_MAKE%g
+s%@CC@%$CC%g
+s%@CPP@%$CPP%g
+s%@AWK@%$AWK%g
+s%@STRIP@%$STRIP%g
+s%@EXEEXT@%$EXEEXT%g
+s%@CPP_MM@%$CPP_MM%g
+s%@OS_EXTRA_SRC@%$OS_EXTRA_SRC%g
+s%@OS_EXTRA_OBJ@%$OS_EXTRA_OBJ%g
+s%@VIMNAME@%$VIMNAME%g
+s%@EXNAME@%$EXNAME%g
+s%@VIEWNAME@%$VIEWNAME%g
+s%@line_break@%$line_break%g
+s%@dovimdiff@%$dovimdiff%g
+s%@dogvimdiff@%$dogvimdiff%g
+s%@compiledby@%$compiledby%g
+s%@vi_cv_path_mzscheme@%$vi_cv_path_mzscheme%g
+s%@MZSCHEME_SRC@%$MZSCHEME_SRC%g
+s%@MZSCHEME_OBJ@%$MZSCHEME_OBJ%g
+s%@MZSCHEME_PRO@%$MZSCHEME_PRO%g
+s%@MZSCHEME_LIBS@%$MZSCHEME_LIBS%g
+s%@MZSCHEME_CFLAGS@%$MZSCHEME_CFLAGS%g
+s%@vi_cv_path_perl@%$vi_cv_path_perl%g
+s%@vi_cv_perllib@%$vi_cv_perllib%g
+s%@shrpenv@%$shrpenv%g
+s%@PERL_SRC@%$PERL_SRC%g
+s%@PERL_OBJ@%$PERL_OBJ%g
+s%@PERL_PRO@%$PERL_PRO%g
+s%@PERL_CFLAGS@%$PERL_CFLAGS%g
+s%@PERL_LIBS@%$PERL_LIBS%g
+s%@vi_cv_path_python@%$vi_cv_path_python%g
+s%@PYTHON_CONFDIR@%$PYTHON_CONFDIR%g
+s%@PYTHON_LIBS@%$PYTHON_LIBS%g
+s%@PYTHON_GETPATH_CFLAGS@%$PYTHON_GETPATH_CFLAGS%g
+s%@PYTHON_CFLAGS@%$PYTHON_CFLAGS%g
+s%@PYTHON_SRC@%$PYTHON_SRC%g
+s%@PYTHON_OBJ@%$PYTHON_OBJ%g
+s%@vi_cv_path_tcl@%$vi_cv_path_tcl%g
+s%@TCL_SRC@%$TCL_SRC%g
+s%@TCL_OBJ@%$TCL_OBJ%g
+s%@TCL_PRO@%$TCL_PRO%g
+s%@TCL_CFLAGS@%$TCL_CFLAGS%g
+s%@TCL_LIBS@%$TCL_LIBS%g
+s%@vi_cv_path_ruby@%$vi_cv_path_ruby%g
+s%@RUBY_SRC@%$RUBY_SRC%g
+s%@RUBY_OBJ@%$RUBY_OBJ%g
+s%@RUBY_PRO@%$RUBY_PRO%g
+s%@RUBY_CFLAGS@%$RUBY_CFLAGS%g
+s%@RUBY_LIBS@%$RUBY_LIBS%g
+s%@WORKSHOP_SRC@%$WORKSHOP_SRC%g
+s%@WORKSHOP_OBJ@%$WORKSHOP_OBJ%g
+s%@NETBEANS_SRC@%$NETBEANS_SRC%g
+s%@NETBEANS_OBJ@%$NETBEANS_OBJ%g
+s%@SNIFF_SRC@%$SNIFF_SRC%g
+s%@SNIFF_OBJ@%$SNIFF_OBJ%g
+s%@xmkmfpath@%$xmkmfpath%g
+s%@X_CFLAGS@%$X_CFLAGS%g
+s%@X_PRE_LIBS@%$X_PRE_LIBS%g
+s%@X_LIBS@%$X_LIBS%g
+s%@X_EXTRA_LIBS@%$X_EXTRA_LIBS%g
+s%@X_LIB@%$X_LIB%g
+s%@GTK_CONFIG@%$GTK_CONFIG%g
+s%@GTK12_CONFIG@%$GTK12_CONFIG%g
+s%@PKG_CONFIG@%$PKG_CONFIG%g
+s%@GTK_CFLAGS@%$GTK_CFLAGS%g
+s%@GTK_LIBS@%$GTK_LIBS%g
+s%@GTK_LIBNAME@%$GTK_LIBNAME%g
+s%@GNOME_LIBS@%$GNOME_LIBS%g
+s%@GNOME_LIBDIR@%$GNOME_LIBDIR%g
+s%@GNOME_INCLUDEDIR@%$GNOME_INCLUDEDIR%g
+s%@GNOME_CONFIG@%$GNOME_CONFIG%g
+s%@MOTIF_LIBNAME@%$MOTIF_LIBNAME%g
+s%@NARROW_PROTO@%$NARROW_PROTO%g
+s%@GUI_INC_LOC@%$GUI_INC_LOC%g
+s%@GUI_LIB_LOC@%$GUI_LIB_LOC%g
+s%@GUITYPE@%$GUITYPE%g
+s%@GUI_X_LIBS@%$GUI_X_LIBS%g
+s%@HANGULIN_SRC@%$HANGULIN_SRC%g
+s%@HANGULIN_OBJ@%$HANGULIN_OBJ%g
+s%@TAGPRG@%$TAGPRG%g
+s%@INSTALL_LANGS@%$INSTALL_LANGS%g
+s%@INSTALL_TOOL_LANGS@%$INSTALL_TOOL_LANGS%g
+s%@MSGFMT@%$MSGFMT%g
+s%@MAKEMO@%$MAKEMO%g
+s%@DEPEND_CFLAGS_FILTER@%$DEPEND_CFLAGS_FILTER%g
 
-{
-  tmp=`(umask 077 && mktemp -d -q "./confstatXXXXXX") 2>/dev/null` &&
-  test -n "$tmp" && test -d "$tmp"
-}  ||
-{
-  tmp=./confstat$$-$RANDOM
-  (umask 077 && mkdir $tmp)
-} ||
-{
-   echo "$me: cannot create a temporary directory in ." >&2
-   { (exit 1); exit 1; }
-}
-
-_ACEOF
-
-cat >>$CONFIG_STATUS <<_ACEOF
-
-#
-# CONFIG_FILES section.
-#
-
-# No need to generate the scripts if there are no CONFIG_FILES.
-# This happens for instance when ./config.status config.h
-if test -n "\$CONFIG_FILES"; then
-  # Protect against being on the right side of a sed subst in config.status.
-  sed 's/,@/@@/; s/@,/@@/; s/,;t t\$/@;t t/; /@;t t\$/s/[\\\\&,]/\\\\&/g;
-   s/@@/,@/; s/@@/@,/; s/@;t t\$/,;t t/' >\$tmp/subs.sed <<\\CEOF
-s,@SHELL@,$SHELL,;t t
-s,@PATH_SEPARATOR@,$PATH_SEPARATOR,;t t
-s,@PACKAGE_NAME@,$PACKAGE_NAME,;t t
-s,@PACKAGE_TARNAME@,$PACKAGE_TARNAME,;t t
-s,@PACKAGE_VERSION@,$PACKAGE_VERSION,;t t
-s,@PACKAGE_STRING@,$PACKAGE_STRING,;t t
-s,@PACKAGE_BUGREPORT@,$PACKAGE_BUGREPORT,;t t
-s,@exec_prefix@,$exec_prefix,;t t
-s,@prefix@,$prefix,;t t
-s,@program_transform_name@,$program_transform_name,;t t
-s,@bindir@,$bindir,;t t
-s,@sbindir@,$sbindir,;t t
-s,@libexecdir@,$libexecdir,;t t
-s,@datadir@,$datadir,;t t
-s,@sysconfdir@,$sysconfdir,;t t
-s,@sharedstatedir@,$sharedstatedir,;t t
-s,@localstatedir@,$localstatedir,;t t
-s,@libdir@,$libdir,;t t
-s,@includedir@,$includedir,;t t
-s,@oldincludedir@,$oldincludedir,;t t
-s,@infodir@,$infodir,;t t
-s,@mandir@,$mandir,;t t
-s,@build_alias@,$build_alias,;t t
-s,@host_alias@,$host_alias,;t t
-s,@target_alias@,$target_alias,;t t
-s,@DEFS@,$DEFS,;t t
-s,@ECHO_C@,$ECHO_C,;t t
-s,@ECHO_N@,$ECHO_N,;t t
-s,@ECHO_T@,$ECHO_T,;t t
-s,@LIBS@,$LIBS,;t t
-s,@SET_MAKE@,$SET_MAKE,;t t
-s,@CC@,$CC,;t t
-s,@CFLAGS@,$CFLAGS,;t t
-s,@LDFLAGS@,$LDFLAGS,;t t
-s,@CPPFLAGS@,$CPPFLAGS,;t t
-s,@ac_ct_CC@,$ac_ct_CC,;t t
-s,@EXEEXT@,$EXEEXT,;t t
-s,@OBJEXT@,$OBJEXT,;t t
-s,@CPP@,$CPP,;t t
-s,@EGREP@,$EGREP,;t t
-s,@AWK@,$AWK,;t t
-s,@STRIP@,$STRIP,;t t
-s,@CPP_MM@,$CPP_MM,;t t
-s,@OS_EXTRA_SRC@,$OS_EXTRA_SRC,;t t
-s,@OS_EXTRA_OBJ@,$OS_EXTRA_OBJ,;t t
-s,@VIMNAME@,$VIMNAME,;t t
-s,@EXNAME@,$EXNAME,;t t
-s,@VIEWNAME@,$VIEWNAME,;t t
-s,@line_break@,$line_break,;t t
-s,@dovimdiff@,$dovimdiff,;t t
-s,@dogvimdiff@,$dogvimdiff,;t t
-s,@compiledby@,$compiledby,;t t
-s,@vi_cv_path_mzscheme@,$vi_cv_path_mzscheme,;t t
-s,@MZSCHEME_SRC@,$MZSCHEME_SRC,;t t
-s,@MZSCHEME_OBJ@,$MZSCHEME_OBJ,;t t
-s,@MZSCHEME_PRO@,$MZSCHEME_PRO,;t t
-s,@MZSCHEME_LIBS@,$MZSCHEME_LIBS,;t t
-s,@MZSCHEME_CFLAGS@,$MZSCHEME_CFLAGS,;t t
-s,@vi_cv_path_perl@,$vi_cv_path_perl,;t t
-s,@vi_cv_perllib@,$vi_cv_perllib,;t t
-s,@shrpenv@,$shrpenv,;t t
-s,@PERL_SRC@,$PERL_SRC,;t t
-s,@PERL_OBJ@,$PERL_OBJ,;t t
-s,@PERL_PRO@,$PERL_PRO,;t t
-s,@PERL_CFLAGS@,$PERL_CFLAGS,;t t
-s,@PERL_LIBS@,$PERL_LIBS,;t t
-s,@vi_cv_path_python@,$vi_cv_path_python,;t t
-s,@PYTHON_CONFDIR@,$PYTHON_CONFDIR,;t t
-s,@PYTHON_LIBS@,$PYTHON_LIBS,;t t
-s,@PYTHON_GETPATH_CFLAGS@,$PYTHON_GETPATH_CFLAGS,;t t
-s,@PYTHON_CFLAGS@,$PYTHON_CFLAGS,;t t
-s,@PYTHON_SRC@,$PYTHON_SRC,;t t
-s,@PYTHON_OBJ@,$PYTHON_OBJ,;t t
-s,@vi_cv_path_tcl@,$vi_cv_path_tcl,;t t
-s,@TCL_SRC@,$TCL_SRC,;t t
-s,@TCL_OBJ@,$TCL_OBJ,;t t
-s,@TCL_PRO@,$TCL_PRO,;t t
-s,@TCL_CFLAGS@,$TCL_CFLAGS,;t t
-s,@TCL_LIBS@,$TCL_LIBS,;t t
-s,@vi_cv_path_ruby@,$vi_cv_path_ruby,;t t
-s,@RUBY_SRC@,$RUBY_SRC,;t t
-s,@RUBY_OBJ@,$RUBY_OBJ,;t t
-s,@RUBY_PRO@,$RUBY_PRO,;t t
-s,@RUBY_CFLAGS@,$RUBY_CFLAGS,;t t
-s,@RUBY_LIBS@,$RUBY_LIBS,;t t
-s,@WORKSHOP_SRC@,$WORKSHOP_SRC,;t t
-s,@WORKSHOP_OBJ@,$WORKSHOP_OBJ,;t t
-s,@NETBEANS_SRC@,$NETBEANS_SRC,;t t
-s,@NETBEANS_OBJ@,$NETBEANS_OBJ,;t t
-s,@SNIFF_SRC@,$SNIFF_SRC,;t t
-s,@SNIFF_OBJ@,$SNIFF_OBJ,;t t
-s,@xmkmfpath@,$xmkmfpath,;t t
-s,@X_CFLAGS@,$X_CFLAGS,;t t
-s,@X_PRE_LIBS@,$X_PRE_LIBS,;t t
-s,@X_LIBS@,$X_LIBS,;t t
-s,@X_EXTRA_LIBS@,$X_EXTRA_LIBS,;t t
-s,@X_LIB@,$X_LIB,;t t
-s,@GTK_CONFIG@,$GTK_CONFIG,;t t
-s,@GTK12_CONFIG@,$GTK12_CONFIG,;t t
-s,@PKG_CONFIG@,$PKG_CONFIG,;t t
-s,@GTK_CFLAGS@,$GTK_CFLAGS,;t t
-s,@GTK_LIBS@,$GTK_LIBS,;t t
-s,@GTK_LIBNAME@,$GTK_LIBNAME,;t t
-s,@GNOME_LIBS@,$GNOME_LIBS,;t t
-s,@GNOME_LIBDIR@,$GNOME_LIBDIR,;t t
-s,@GNOME_INCLUDEDIR@,$GNOME_INCLUDEDIR,;t t
-s,@GNOME_CONFIG@,$GNOME_CONFIG,;t t
-s,@MOTIF_LIBNAME@,$MOTIF_LIBNAME,;t t
-s,@NARROW_PROTO@,$NARROW_PROTO,;t t
-s,@GUI_INC_LOC@,$GUI_INC_LOC,;t t
-s,@GUI_LIB_LOC@,$GUI_LIB_LOC,;t t
-s,@GUITYPE@,$GUITYPE,;t t
-s,@GUI_X_LIBS@,$GUI_X_LIBS,;t t
-s,@HANGULIN_SRC@,$HANGULIN_SRC,;t t
-s,@HANGULIN_OBJ@,$HANGULIN_OBJ,;t t
-s,@TAGPRG@,$TAGPRG,;t t
-s,@INSTALL_LANGS@,$INSTALL_LANGS,;t t
-s,@INSTALL_TOOL_LANGS@,$INSTALL_TOOL_LANGS,;t t
-s,@MSGFMT@,$MSGFMT,;t t
-s,@MAKEMO@,$MAKEMO,;t t
-s,@DEPEND_CFLAGS_FILTER@,$DEPEND_CFLAGS_FILTER,;t t
-s,@LIBOBJS@,$LIBOBJS,;t t
-s,@LTLIBOBJS@,$LTLIBOBJS,;t t
 CEOF
+EOF
 
-_ACEOF
+cat >> $CONFIG_STATUS <<\EOF
 
-  cat >>$CONFIG_STATUS <<\_ACEOF
-  # Split the substitutions into bite-sized pieces for seds with
-  # small command number limits, like on Digital OSF/1 and HP-UX.
-  ac_max_sed_lines=48
-  ac_sed_frag=1 # Number of current file.
-  ac_beg=1 # First line for current file.
-  ac_end=$ac_max_sed_lines # Line after last line for current file.
-  ac_more_lines=:
-  ac_sed_cmds=
-  while $ac_more_lines; do
-    if test $ac_beg -gt 1; then
-      sed "1,${ac_beg}d; ${ac_end}q" $tmp/subs.sed >$tmp/subs.frag
+# Split the substitutions into bite-sized pieces for seds with
+# small command number limits, like on Digital OSF/1 and HP-UX.
+ac_max_sed_cmds=90 # Maximum number of lines to put in a sed script.
+ac_file=1 # Number of current file.
+ac_beg=1 # First line for current file.
+ac_end=$ac_max_sed_cmds # Line after last line for current file.
+ac_more_lines=:
+ac_sed_cmds=""
+while $ac_more_lines; do
+  if test $ac_beg -gt 1; then
+    sed "1,${ac_beg}d; ${ac_end}q" conftest.subs > conftest.s$ac_file
+  else
+    sed "${ac_end}q" conftest.subs > conftest.s$ac_file
+  fi
+  if test ! -s conftest.s$ac_file; then
+    ac_more_lines=false
+    rm -f conftest.s$ac_file
+  else
+    if test -z "$ac_sed_cmds"; then
+      ac_sed_cmds="sed -f conftest.s$ac_file"
     else
-      sed "${ac_end}q" $tmp/subs.sed >$tmp/subs.frag
+      ac_sed_cmds="$ac_sed_cmds | sed -f conftest.s$ac_file"
     fi
-    if test ! -s $tmp/subs.frag; then
-      ac_more_lines=false
-    else
-      # The purpose of the label and of the branching condition is to
-      # speed up the sed processing (if there are no `@' at all, there
-      # is no need to browse any of the substitutions).
-      # These are the two extra sed commands mentioned above.
-      (echo ':t
-  /@[a-zA-Z_][a-zA-Z_0-9]*@/!b' && cat $tmp/subs.frag) >$tmp/subs-$ac_sed_frag.sed
-      if test -z "$ac_sed_cmds"; then
-	ac_sed_cmds="sed -f $tmp/subs-$ac_sed_frag.sed"
-      else
-	ac_sed_cmds="$ac_sed_cmds | sed -f $tmp/subs-$ac_sed_frag.sed"
-      fi
-      ac_sed_frag=`expr $ac_sed_frag + 1`
-      ac_beg=$ac_end
-      ac_end=`expr $ac_end + $ac_max_sed_lines`
-    fi
-  done
-  if test -z "$ac_sed_cmds"; then
-    ac_sed_cmds=cat
+    ac_file=`expr $ac_file + 1`
+    ac_beg=$ac_end
+    ac_end=`expr $ac_end + $ac_max_sed_cmds`
   fi
-fi # test -n "$CONFIG_FILES"
+done
+if test -z "$ac_sed_cmds"; then
+  ac_sed_cmds=cat
+fi
+EOF
 
-_ACEOF
-cat >>$CONFIG_STATUS <<\_ACEOF
-for ac_file in : $CONFIG_FILES; do test "x$ac_file" = x: && continue
+cat >> $CONFIG_STATUS <<EOF
+
+CONFIG_FILES=\${CONFIG_FILES-"auto/config.mk:config.mk.in"}
+EOF
+cat >> $CONFIG_STATUS <<\EOF
+for ac_file in .. $CONFIG_FILES; do if test "x$ac_file" != x..; then
   # Support "outfile[:infile[:infile...]]", defaulting infile="outfile.in".
-  case $ac_file in
-  - | *:- | *:-:* ) # input from stdin
-	cat >$tmp/stdin
-	ac_file_in=`echo "$ac_file" | sed 's,[^:]*:,,'`
-	ac_file=`echo "$ac_file" | sed 's,:.*,,'` ;;
-  *:* ) ac_file_in=`echo "$ac_file" | sed 's,[^:]*:,,'`
-	ac_file=`echo "$ac_file" | sed 's,:.*,,'` ;;
-  * )   ac_file_in=$ac_file.in ;;
+  case "$ac_file" in
+  *:*) ac_file_in=`echo "$ac_file"|sed 's%[^:]*:%%'`
+       ac_file=`echo "$ac_file"|sed 's%:.*%%'` ;;
+  *) ac_file_in="${ac_file}.in" ;;
   esac
 
-  # Compute @srcdir@, @top_srcdir@, and @INSTALL@ for subdirectories.
-  ac_dir=`(dirname "$ac_file") 2>/dev/null ||
-$as_expr X"$ac_file" : 'X\(.*[^/]\)//*[^/][^/]*/*$' \| \
-	 X"$ac_file" : 'X\(//\)[^/]' \| \
-	 X"$ac_file" : 'X\(//\)$' \| \
-	 X"$ac_file" : 'X\(/\)' \| \
-	 .     : '\(.\)' 2>/dev/null ||
-echo X"$ac_file" |
-    sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{ s//\1/; q; }
-  	  /^X\(\/\/\)[^/].*/{ s//\1/; q; }
-  	  /^X\(\/\/\)$/{ s//\1/; q; }
-  	  /^X\(\/\).*/{ s//\1/; q; }
-  	  s/.*/./; q'`
-  { if $as_mkdir_p; then
-    mkdir -p "$ac_dir"
-  else
-    as_dir="$ac_dir"
-    as_dirs=
-    while test ! -d "$as_dir"; do
-      as_dirs="$as_dir $as_dirs"
-      as_dir=`(dirname "$as_dir") 2>/dev/null ||
-$as_expr X"$as_dir" : 'X\(.*[^/]\)//*[^/][^/]*/*$' \| \
-	 X"$as_dir" : 'X\(//\)[^/]' \| \
-	 X"$as_dir" : 'X\(//\)$' \| \
-	 X"$as_dir" : 'X\(/\)' \| \
-	 .     : '\(.\)' 2>/dev/null ||
-echo X"$as_dir" |
-    sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{ s//\1/; q; }
-  	  /^X\(\/\/\)[^/].*/{ s//\1/; q; }
-  	  /^X\(\/\/\)$/{ s//\1/; q; }
-  	  /^X\(\/\).*/{ s//\1/; q; }
-  	  s/.*/./; q'`
-    done
-    test ! -n "$as_dirs" || mkdir $as_dirs
-  fi || { { echo "$as_me:$LINENO: error: cannot create directory \"$ac_dir\"" >&5
-echo "$as_me: error: cannot create directory \"$ac_dir\"" >&2;}
-   { (exit 1); exit 1; }; }; }
+  # Adjust a relative srcdir, top_srcdir, and INSTALL for subdirectories.
 
-  ac_builddir=.
-
-if test "$ac_dir" != .; then
-  ac_dir_suffix=/`echo "$ac_dir" | sed 's,^\.[\\/],,'`
-  # A "../" for each directory in $ac_dir_suffix.
-  ac_top_builddir=`echo "$ac_dir_suffix" | sed 's,/[^\\/]*,../,g'`
-else
-  ac_dir_suffix= ac_top_builddir=
-fi
-
-case $srcdir in
-  .)  # No --srcdir option.  We are building in place.
-    ac_srcdir=.
-    if test -z "$ac_top_builddir"; then
-       ac_top_srcdir=.
-    else
-       ac_top_srcdir=`echo $ac_top_builddir | sed 's,/$,,'`
-    fi ;;
-  [\\/]* | ?:[\\/]* )  # Absolute path.
-    ac_srcdir=$srcdir$ac_dir_suffix;
-    ac_top_srcdir=$srcdir ;;
-  *) # Relative path.
-    ac_srcdir=$ac_top_builddir$srcdir$ac_dir_suffix
-    ac_top_srcdir=$ac_top_builddir$srcdir ;;
-esac
-
-# Do not use `cd foo && pwd` to compute absolute paths, because
-# the directories may not exist.
-case `pwd` in
-.) ac_abs_builddir="$ac_dir";;
-*)
-  case "$ac_dir" in
-  .) ac_abs_builddir=`pwd`;;
-  [\\/]* | ?:[\\/]* ) ac_abs_builddir="$ac_dir";;
-  *) ac_abs_builddir=`pwd`/"$ac_dir";;
-  esac;;
-esac
-case $ac_abs_builddir in
-.) ac_abs_top_builddir=${ac_top_builddir}.;;
-*)
-  case ${ac_top_builddir}. in
-  .) ac_abs_top_builddir=$ac_abs_builddir;;
-  [\\/]* | ?:[\\/]* ) ac_abs_top_builddir=${ac_top_builddir}.;;
-  *) ac_abs_top_builddir=$ac_abs_builddir/${ac_top_builddir}.;;
-  esac;;
-esac
-case $ac_abs_builddir in
-.) ac_abs_srcdir=$ac_srcdir;;
-*)
-  case $ac_srcdir in
-  .) ac_abs_srcdir=$ac_abs_builddir;;
-  [\\/]* | ?:[\\/]* ) ac_abs_srcdir=$ac_srcdir;;
-  *) ac_abs_srcdir=$ac_abs_builddir/$ac_srcdir;;
-  esac;;
-esac
-case $ac_abs_builddir in
-.) ac_abs_top_srcdir=$ac_top_srcdir;;
-*)
-  case $ac_top_srcdir in
-  .) ac_abs_top_srcdir=$ac_abs_builddir;;
-  [\\/]* | ?:[\\/]* ) ac_abs_top_srcdir=$ac_top_srcdir;;
-  *) ac_abs_top_srcdir=$ac_abs_builddir/$ac_top_srcdir;;
-  esac;;
-esac
-
-
-
-  if test x"$ac_file" != x-; then
-    { echo "$as_me:$LINENO: creating $ac_file" >&5
-echo "$as_me: creating $ac_file" >&6;}
-    rm -f "$ac_file"
-  fi
-  # Let's still pretend it is `configure' which instantiates (i.e., don't
-  # use $as_me), people would be surprised to read:
-  #    /* config.h.  Generated by config.status.  */
-  if test x"$ac_file" = x-; then
-    configure_input=
+  # Remove last slash and all that follows it.  Not all systems have dirname.
+  ac_dir=`echo $ac_file|sed 's%/[^/][^/]*$%%'`
+  if test "$ac_dir" != "$ac_file" && test "$ac_dir" != .; then
+    # The file is in a subdirectory.
+    test ! -d "$ac_dir" && mkdir "$ac_dir"
+    ac_dir_suffix="/`echo $ac_dir|sed 's%^\./%%'`"
+    # A "../" for each directory in $ac_dir_suffix.
+    ac_dots=`echo $ac_dir_suffix|sed 's%/[^/]*%../%g'`
   else
-    configure_input="$ac_file.  "
+    ac_dir_suffix= ac_dots=
   fi
-  configure_input=$configure_input"Generated from `echo $ac_file_in |
-				     sed 's,.*/,,'` by configure."
 
-  # First look for the input files in the build tree, otherwise in the
-  # src tree.
-  ac_file_inputs=`IFS=:
-    for f in $ac_file_in; do
-      case $f in
-      -) echo $tmp/stdin ;;
-      [\\/$]*)
-	 # Absolute (can't be DOS-style, as IFS=:)
-	 test -f "$f" || { { echo "$as_me:$LINENO: error: cannot find input file: $f" >&5
-echo "$as_me: error: cannot find input file: $f" >&2;}
-   { (exit 1); exit 1; }; }
-	 echo "$f";;
-      *) # Relative
-	 if test -f "$f"; then
-	   # Build tree
-	   echo "$f"
-	 elif test -f "$srcdir/$f"; then
-	   # Source tree
-	   echo "$srcdir/$f"
-	 else
-	   # /dev/null tree
-	   { { echo "$as_me:$LINENO: error: cannot find input file: $f" >&5
-echo "$as_me: error: cannot find input file: $f" >&2;}
-   { (exit 1); exit 1; }; }
-	 fi;;
-      esac
-    done` || { (exit 1); exit 1; }
-_ACEOF
-cat >>$CONFIG_STATUS <<_ACEOF
-  sed "$ac_vpsub
-$extrasub
-_ACEOF
-cat >>$CONFIG_STATUS <<\_ACEOF
-:t
-/@[a-zA-Z_][a-zA-Z_0-9]*@/!b
-s,@configure_input@,$configure_input,;t t
-s,@srcdir@,$ac_srcdir,;t t
-s,@abs_srcdir@,$ac_abs_srcdir,;t t
-s,@top_srcdir@,$ac_top_srcdir,;t t
-s,@abs_top_srcdir@,$ac_abs_top_srcdir,;t t
-s,@builddir@,$ac_builddir,;t t
-s,@abs_builddir@,$ac_abs_builddir,;t t
-s,@top_builddir@,$ac_top_builddir,;t t
-s,@abs_top_builddir@,$ac_abs_top_builddir,;t t
-" $ac_file_inputs | (eval "$ac_sed_cmds") >$tmp/out
-  rm -f $tmp/stdin
-  if test x"$ac_file" != x-; then
-    mv $tmp/out $ac_file
-  else
-    cat $tmp/out
-    rm -f $tmp/out
-  fi
+  case "$ac_given_srcdir" in
+  .)  srcdir=.
+      if test -z "$ac_dots"; then top_srcdir=.
+      else top_srcdir=`echo $ac_dots|sed 's%/$%%'`; fi ;;
+  /*) srcdir="$ac_given_srcdir$ac_dir_suffix"; top_srcdir="$ac_given_srcdir" ;;
+  *) # Relative path.
+    srcdir="$ac_dots$ac_given_srcdir$ac_dir_suffix"
+    top_srcdir="$ac_dots$ac_given_srcdir" ;;
+  esac
 
-done
-_ACEOF
-cat >>$CONFIG_STATUS <<\_ACEOF
 
-#
-# CONFIG_HEADER section.
-#
+  echo creating "$ac_file"
+  rm -f "$ac_file"
+  configure_input="Generated automatically from `echo $ac_file_in|sed 's%.*/%%'` by configure."
+  case "$ac_file" in
+  *Makefile*) ac_comsub="1i\\
+# $configure_input" ;;
+  *) ac_comsub= ;;
+  esac
 
+  ac_file_inputs=`echo $ac_file_in|sed -e "s%^%$ac_given_srcdir/%" -e "s%:% $ac_given_srcdir/%g"`
+  sed -e "$ac_comsub
+s%@configure_input@%$configure_input%g
+s%@srcdir@%$srcdir%g
+s%@top_srcdir@%$top_srcdir%g
+" $ac_file_inputs | (eval "$ac_sed_cmds") > $ac_file
+fi; done
+rm -f conftest.s*
+
 # These sed commands are passed to sed as "A NAME B NAME C VALUE D", where
 # NAME is the cpp macro being defined and VALUE is the value it is being given.
 #
 # ac_d sets the value in "#define NAME VALUE" lines.
-ac_dA='s,^\([	 ]*\)#\([	 ]*define[	 ][	 ]*\)'
-ac_dB='[	 ].*$,\1#\2'
-ac_dC=' '
-ac_dD=',;t'
-# ac_u turns "#undef NAME" without trailing blanks into "#define NAME VALUE".
-ac_uA='s,^\([	 ]*\)#\([	 ]*\)undef\([	 ][	 ]*\)'
-ac_uB='$,\1#\2define\3'
+ac_dA='s%^\([ 	]*\)#\([ 	]*define[ 	][ 	]*\)'
+ac_dB='\([ 	][ 	]*\)[^ 	]*%\1#\2'
+ac_dC='\3'
+ac_dD='%g'
+# ac_u turns "#undef NAME" with trailing blanks into "#define NAME VALUE".
+ac_uA='s%^\([ 	]*\)#\([ 	]*\)undef\([ 	][ 	]*\)'
+ac_uB='\([ 	]\)%\1#\2define\3'
 ac_uC=' '
-ac_uD=',;t'
+ac_uD='\4%g'
+# ac_e turns "#undef NAME" without trailing blanks into "#define NAME VALUE".
+ac_eA='s%^\([ 	]*\)#\([ 	]*\)undef\([ 	][ 	]*\)'
+ac_eB='$%\1#\2define\3'
+ac_eC=' '
+ac_eD='%g'
 
-for ac_file in : $CONFIG_HEADERS; do test "x$ac_file" = x: && continue
+if test "${CONFIG_HEADERS+set}" != set; then
+EOF
+cat >> $CONFIG_STATUS <<EOF
+  CONFIG_HEADERS="auto/config.h:config.h.in"
+EOF
+cat >> $CONFIG_STATUS <<\EOF
+fi
+for ac_file in .. $CONFIG_HEADERS; do if test "x$ac_file" != x..; then
   # Support "outfile[:infile[:infile...]]", defaulting infile="outfile.in".
-  case $ac_file in
-  - | *:- | *:-:* ) # input from stdin
-	cat >$tmp/stdin
-	ac_file_in=`echo "$ac_file" | sed 's,[^:]*:,,'`
-	ac_file=`echo "$ac_file" | sed 's,:.*,,'` ;;
-  *:* ) ac_file_in=`echo "$ac_file" | sed 's,[^:]*:,,'`
-	ac_file=`echo "$ac_file" | sed 's,:.*,,'` ;;
-  * )   ac_file_in=$ac_file.in ;;
+  case "$ac_file" in
+  *:*) ac_file_in=`echo "$ac_file"|sed 's%[^:]*:%%'`
+       ac_file=`echo "$ac_file"|sed 's%:.*%%'` ;;
+  *) ac_file_in="${ac_file}.in" ;;
   esac
 
-  test x"$ac_file" != x- && { echo "$as_me:$LINENO: creating $ac_file" >&5
-echo "$as_me: creating $ac_file" >&6;}
+  echo creating $ac_file
 
-  # First look for the input files in the build tree, otherwise in the
-  # src tree.
-  ac_file_inputs=`IFS=:
-    for f in $ac_file_in; do
-      case $f in
-      -) echo $tmp/stdin ;;
-      [\\/$]*)
-	 # Absolute (can't be DOS-style, as IFS=:)
-	 test -f "$f" || { { echo "$as_me:$LINENO: error: cannot find input file: $f" >&5
-echo "$as_me: error: cannot find input file: $f" >&2;}
-   { (exit 1); exit 1; }; }
-	 # Do quote $f, to prevent DOS paths from being IFS'd.
-	 echo "$f";;
-      *) # Relative
-	 if test -f "$f"; then
-	   # Build tree
-	   echo "$f"
-	 elif test -f "$srcdir/$f"; then
-	   # Source tree
-	   echo "$srcdir/$f"
-	 else
-	   # /dev/null tree
-	   { { echo "$as_me:$LINENO: error: cannot find input file: $f" >&5
-echo "$as_me: error: cannot find input file: $f" >&2;}
-   { (exit 1); exit 1; }; }
-	 fi;;
-      esac
-    done` || { (exit 1); exit 1; }
-  # Remove the trailing spaces.
-  sed 's/[	 ]*$//' $ac_file_inputs >$tmp/in
+  rm -f conftest.frag conftest.in conftest.out
+  ac_file_inputs=`echo $ac_file_in|sed -e "s%^%$ac_given_srcdir/%" -e "s%:% $ac_given_srcdir/%g"`
+  cat $ac_file_inputs > conftest.in
 
-_ACEOF
+EOF
 
-# Transform confdefs.h into two sed scripts, `conftest.defines' and
-# `conftest.undefs', that substitutes the proper values into
-# config.h.in to produce config.h.  The first handles `#define'
-# templates, and the second `#undef' templates.
-# And first: Protect against being on the right side of a sed subst in
-# config.status.  Protect against being in an unquoted here document
-# in config.status.
-rm -f conftest.defines conftest.undefs
-# Using a here document instead of a string reduces the quoting nightmare.
-# Putting comments in sed scripts is not portable.
-#
-# `end' is used to avoid that the second main sed command (meant for
-# 0-ary CPP macros) applies to n-ary macro definitions.
-# See the Autoconf documentation for `clear'.
-cat >confdef2sed.sed <<\_ACEOF
-s/[\\&,]/\\&/g
-s,[\\$`],\\&,g
-t clear
-: clear
-s,^[	 ]*#[	 ]*define[	 ][	 ]*\([^	 (][^	 (]*\)\(([^)]*)\)[	 ]*\(.*\)$,${ac_dA}\1${ac_dB}\1\2${ac_dC}\3${ac_dD},gp
-t end
-s,^[	 ]*#[	 ]*define[	 ][	 ]*\([^	 ][^	 ]*\)[	 ]*\(.*\)$,${ac_dA}\1${ac_dB}\1${ac_dC}\2${ac_dD},gp
-: end
-_ACEOF
-# If some macros were called several times there might be several times
-# the same #defines, which is useless.  Nevertheless, we may not want to
-# sort them, since we want the *last* AC-DEFINE to be honored.
-uniq confdefs.h | sed -n -f confdef2sed.sed >conftest.defines
-sed 's/ac_d/ac_u/g' conftest.defines >conftest.undefs
-rm -f confdef2sed.sed
+# Transform confdefs.h into a sed script conftest.vals that substitutes
+# the proper values into config.h.in to produce config.h.  And first:
+# Protect against being on the right side of a sed subst in config.status.
+# Protect against being in an unquoted here document in config.status.
+rm -f conftest.vals
+cat > conftest.hdr <<\EOF
+s/[\\&%]/\\&/g
+s%[\\$`]%\\&%g
+s%#define \([A-Za-z_][A-Za-z0-9_]*\) *\(.*\)%${ac_dA}\1${ac_dB}\1${ac_dC}\2${ac_dD}%gp
+s%ac_d%ac_u%gp
+s%ac_u%ac_e%gp
+EOF
+sed -n -f conftest.hdr confdefs.h > conftest.vals
+rm -f conftest.hdr
 
 # This sed command replaces #undef with comments.  This is necessary, for
 # example, in the case of _POSIX_SOURCE, which is predefined and required
 # on some systems where configure will not decide to define it.
-cat >>conftest.undefs <<\_ACEOF
-s,^[	 ]*#[	 ]*undef[	 ][	 ]*[a-zA-Z_][a-zA-Z_0-9]*,/* & */,
-_ACEOF
+cat >> conftest.vals <<\EOF
+s%^[ 	]*#[ 	]*undef[ 	][ 	]*[a-zA-Z_][a-zA-Z_0-9]*%/* & */%
+EOF
 
-# Break up conftest.defines because some shells have a limit on the size
-# of here documents, and old seds have small limits too (100 cmds).
-echo '  # Handle all the #define templates only if necessary.' >>$CONFIG_STATUS
-echo '  if grep "^[	 ]*#[	 ]*define" $tmp/in >/dev/null; then' >>$CONFIG_STATUS
-echo '  # If there are no defines, we may have an empty if/fi' >>$CONFIG_STATUS
-echo '  :' >>$CONFIG_STATUS
-rm -f conftest.tail
-while grep . conftest.defines >/dev/null
-do
-  # Write a limited-size here document to $tmp/defines.sed.
-  echo '  cat >$tmp/defines.sed <<CEOF' >>$CONFIG_STATUS
-  # Speed up: don't consider the non `#define' lines.
-  echo '/^[	 ]*#[	 ]*define/!b' >>$CONFIG_STATUS
-  # Work around the forget-to-reset-the-flag bug.
-  echo 't clr' >>$CONFIG_STATUS
-  echo ': clr' >>$CONFIG_STATUS
-  sed ${ac_max_here_lines}q conftest.defines >>$CONFIG_STATUS
-  echo 'CEOF
-  sed -f $tmp/defines.sed $tmp/in >$tmp/out
-  rm -f $tmp/in
-  mv $tmp/out $tmp/in
-' >>$CONFIG_STATUS
-  sed 1,${ac_max_here_lines}d conftest.defines >conftest.tail
-  rm -f conftest.defines
-  mv conftest.tail conftest.defines
-done
-rm -f conftest.defines
-echo '  fi # grep' >>$CONFIG_STATUS
-echo >>$CONFIG_STATUS
+# Break up conftest.vals because some shells have a limit on
+# the size of here documents, and old seds have small limits too.
 
-# Break up conftest.undefs because some shells have a limit on the size
-# of here documents, and old seds have small limits too (100 cmds).
-echo '  # Handle all the #undef templates' >>$CONFIG_STATUS
 rm -f conftest.tail
-while grep . conftest.undefs >/dev/null
+while :
 do
-  # Write a limited-size here document to $tmp/undefs.sed.
-  echo '  cat >$tmp/undefs.sed <<CEOF' >>$CONFIG_STATUS
-  # Speed up: don't consider the non `#undef'
-  echo '/^[	 ]*#[	 ]*undef/!b' >>$CONFIG_STATUS
-  # Work around the forget-to-reset-the-flag bug.
-  echo 't clr' >>$CONFIG_STATUS
-  echo ': clr' >>$CONFIG_STATUS
-  sed ${ac_max_here_lines}q conftest.undefs >>$CONFIG_STATUS
+  ac_lines=`grep -c . conftest.vals`
+  # grep -c gives empty output for an empty file on some AIX systems.
+  if test -z "$ac_lines" || test "$ac_lines" -eq 0; then break; fi
+  # Write a limited-size here document to conftest.frag.
+  echo '  cat > conftest.frag <<CEOF' >> $CONFIG_STATUS
+  sed ${ac_max_here_lines}q conftest.vals >> $CONFIG_STATUS
   echo 'CEOF
-  sed -f $tmp/undefs.sed $tmp/in >$tmp/out
-  rm -f $tmp/in
-  mv $tmp/out $tmp/in
-' >>$CONFIG_STATUS
-  sed 1,${ac_max_here_lines}d conftest.undefs >conftest.tail
-  rm -f conftest.undefs
-  mv conftest.tail conftest.undefs
+  sed -f conftest.frag conftest.in > conftest.out
+  rm -f conftest.in
+  mv conftest.out conftest.in
+' >> $CONFIG_STATUS
+  sed 1,${ac_max_here_lines}d conftest.vals > conftest.tail
+  rm -f conftest.vals
+  mv conftest.tail conftest.vals
 done
-rm -f conftest.undefs
+rm -f conftest.vals
 
-cat >>$CONFIG_STATUS <<\_ACEOF
-  # Let's still pretend it is `configure' which instantiates (i.e., don't
-  # use $as_me), people would be surprised to read:
-  #    /* config.h.  Generated by config.status.  */
-  if test x"$ac_file" = x-; then
-    echo "/* Generated by configure.  */" >$tmp/config.h
+cat >> $CONFIG_STATUS <<\EOF
+  rm -f conftest.frag conftest.h
+  echo "/* $ac_file.  Generated automatically by configure.  */" > conftest.h
+  cat conftest.in >> conftest.h
+  rm -f conftest.in
+  if cmp -s $ac_file conftest.h 2>/dev/null; then
+    echo "$ac_file is unchanged"
+    rm -f conftest.h
   else
-    echo "/* $ac_file.  Generated by configure.  */" >$tmp/config.h
-  fi
-  cat $tmp/in >>$tmp/config.h
-  rm -f $tmp/in
-  if test x"$ac_file" != x-; then
-    if diff $ac_file $tmp/config.h >/dev/null 2>&1; then
-      { echo "$as_me:$LINENO: $ac_file is unchanged" >&5
-echo "$as_me: $ac_file is unchanged" >&6;}
-    else
-      ac_dir=`(dirname "$ac_file") 2>/dev/null ||
-$as_expr X"$ac_file" : 'X\(.*[^/]\)//*[^/][^/]*/*$' \| \
-	 X"$ac_file" : 'X\(//\)[^/]' \| \
-	 X"$ac_file" : 'X\(//\)$' \| \
-	 X"$ac_file" : 'X\(/\)' \| \
-	 .     : '\(.\)' 2>/dev/null ||
-echo X"$ac_file" |
-    sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{ s//\1/; q; }
-  	  /^X\(\/\/\)[^/].*/{ s//\1/; q; }
-  	  /^X\(\/\/\)$/{ s//\1/; q; }
-  	  /^X\(\/\).*/{ s//\1/; q; }
-  	  s/.*/./; q'`
-      { if $as_mkdir_p; then
-    mkdir -p "$ac_dir"
-  else
-    as_dir="$ac_dir"
-    as_dirs=
-    while test ! -d "$as_dir"; do
-      as_dirs="$as_dir $as_dirs"
-      as_dir=`(dirname "$as_dir") 2>/dev/null ||
-$as_expr X"$as_dir" : 'X\(.*[^/]\)//*[^/][^/]*/*$' \| \
-	 X"$as_dir" : 'X\(//\)[^/]' \| \
-	 X"$as_dir" : 'X\(//\)$' \| \
-	 X"$as_dir" : 'X\(/\)' \| \
-	 .     : '\(.\)' 2>/dev/null ||
-echo X"$as_dir" |
-    sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{ s//\1/; q; }
-  	  /^X\(\/\/\)[^/].*/{ s//\1/; q; }
-  	  /^X\(\/\/\)$/{ s//\1/; q; }
-  	  /^X\(\/\).*/{ s//\1/; q; }
-  	  s/.*/./; q'`
-    done
-    test ! -n "$as_dirs" || mkdir $as_dirs
-  fi || { { echo "$as_me:$LINENO: error: cannot create directory \"$ac_dir\"" >&5
-echo "$as_me: error: cannot create directory \"$ac_dir\"" >&2;}
-   { (exit 1); exit 1; }; }; }
-
-      rm -f $ac_file
-      mv $tmp/config.h $ac_file
+    # Remove last slash and all that follows it.  Not all systems have dirname.
+      ac_dir=`echo $ac_file|sed 's%/[^/][^/]*$%%'`
+      if test "$ac_dir" != "$ac_file" && test "$ac_dir" != .; then
+      # The file is in a subdirectory.
+      test ! -d "$ac_dir" && mkdir "$ac_dir"
     fi
-  else
-    cat $tmp/config.h
-    rm -f $tmp/config.h
+    rm -f $ac_file
+    mv conftest.h $ac_file
   fi
-done
-_ACEOF
+fi; done
 
-cat >>$CONFIG_STATUS <<\_ACEOF
+EOF
+cat >> $CONFIG_STATUS <<EOF
 
-{ (exit 0); exit 0; }
-_ACEOF
+EOF
+cat >> $CONFIG_STATUS <<\EOF
+
+exit 0
+EOF
 chmod +x $CONFIG_STATUS
-ac_clean_files=$ac_clean_files_save
+rm -fr confdefs* $ac_clean_files
+test "$no_create" = yes || ${CONFIG_SHELL-/bin/sh} $CONFIG_STATUS || exit 1
 
 
-# configure is writing to config.log, and then calls config.status.
-# config.status does its own redirection, appending to config.log.
-# Unfortunately, on DOS this fails, as config.log is still kept open
-# by configure, so config.status won't be able to write to it; its
-# output is simply discarded.  So we exec the FD to /dev/null,
-# effectively closing config.log, so it can be properly (re)opened and
-# appended to by config.status.  When coming back to configure, we
-# need to make the FD available again.
-if test "$no_create" != yes; then
-  ac_cs_success=:
-  ac_config_status_args=
-  test "$silent" = yes &&
-    ac_config_status_args="$ac_config_status_args --quiet"
-  exec 5>/dev/null
-  $SHELL $CONFIG_STATUS $ac_config_status_args || ac_cs_success=false
-  exec 5>>auto/config.log
-  # Use ||, not &&, to avoid exiting from the if with $? = 1, which
-  # would make configure fail if this is the last instruction.
-  $ac_cs_success || { (exit 1); exit 1; }
-fi
-
-

Property changes on: src/auto
___________________________________________________________________
Name: svn:ignore
   + 


Index: src/window.c
===================================================================
--- src/window.c	(.../branches/V7_0)	(revision 120)
+++ src/window.c	(.../trunk)	(revision 120)
@@ -125,6 +125,12 @@
 # define CHECK_CMDWIN
 #endif
 
+#ifdef FEAT_VIMSHELL
+# define CHECK_VIMSHELL if (curwin->w_buffer->is_shell != 0) { EMSG("VIMSHELL: command not available for shell windows"); break; }
+#else
+# define CHECK_VIMSHELL
+#endif
+
     switch (nchar)
     {
 /* split current window in two parts, horizontally */
@@ -480,6 +486,7 @@
 #if defined(FEAT_QUICKFIX)
     case '}':
 		CHECK_CMDWIN
+		CHECK_VIMSHELL
 		if (Prenum)
 		    g_do_tagpreview = Prenum;
 		else
@@ -489,6 +496,7 @@
     case ']':
     case Ctrl_RSB:
 		CHECK_CMDWIN
+		CHECK_VIMSHELL
 #ifdef FEAT_VISUAL
 		reset_VIsual_and_resel();	/* stop Visual mode */
 #endif
@@ -509,6 +517,7 @@
     case Ctrl_F:
 wingotofile:
 		CHECK_CMDWIN
+		CHECK_VIMSHELL
 
 		ptr = grab_file_name(Prenum1, &lnum);
 		if (ptr != NULL)
@@ -546,6 +555,7 @@
     case 'd':			    /* Go to definition, using 'define' */
     case Ctrl_D:
 		CHECK_CMDWIN
+		CHECK_VIMSHELL
 		if ((len = find_ident_under_cursor(&ptr, FIND_IDENT)) == 0)
 		    break;
 		find_pattern_in_path(ptr, 0, len, TRUE,
@@ -577,6 +587,7 @@
     case 'g':
     case Ctrl_G:
 		CHECK_CMDWIN
+		CHECK_VIMSHELL
 #ifdef USE_ON_FLY_SCROLL
 		dont_scroll = TRUE;		/* disallow scrolling here */
 #endif
@@ -5338,6 +5349,15 @@
     wp->w_redr_status = TRUE;
 #endif
     invalidate_botline_win(wp);
+
+#ifdef FEAT_VIMSHELL
+    if(wp->w_buffer->is_shell!=0)
+    {
+	struct vim_shell_window *shell=wp->w_buffer->shell;
+	vim_shell_resize(shell, shell->size_x, height);
+	redraw_win_later(wp, CLEAR);
+    }
+#endif
 }
 
 #ifdef FEAT_VERTSPLIT
@@ -5360,6 +5380,14 @@
     }
     redraw_win_later(wp, NOT_VALID);
     wp->w_redr_status = TRUE;
+#ifdef FEAT_VIMSHELL
+    if(wp->w_buffer->is_shell!=0)
+    {
+	struct vim_shell_window *shell=wp->w_buffer->shell;
+	vim_shell_resize(shell, width, shell->size_y);
+	redraw_win_later(wp, CLEAR);
+    }
+#endif
 }
 #endif
 
Index: test.txt
===================================================================
--- test.txt	(.../branches/V7_0)	(revision 0)
+++ test.txt	(.../trunk)	(revision 120)
@@ -0,0 +1,2 @@
+asdfasdfA
+:q
Index: README_vimshell.txt
===================================================================
--- README_vimshell.txt	(.../branches/V7_0)	(revision 0)
+++ README_vimshell.txt	(.../trunk)	(revision 120)
@@ -0,0 +1,12 @@
+TESTING
+=======
+
+shell-read with poll(2)
+shell-read with select(2) - works
+compiling VIM without builtin terminals - only termcap or terminfo - works
+GUI-VIM ohne builtin_terms ?
+
+DOCUMENTATION
+=============
+
+See :help vimshell for documentation.

Property changes on: README_vimshell.txt
___________________________________________________________________
Name: svn:keywords
   + author date id revision
Name: svn:eol-style
   + native

